(window.webpackJsonp=window.webpackJsonp||[]).push([[124],{Jn5w:function(e,t,a){"use strict";a.r(t),a.d(t,"CoreTagIndexPageModule",(function(){return D}));var n=a("tyNb"),o=a("vY5A"),i=a("fg4u"),r=a("Y+03"),c=a("L3Fv"),s=a("mrSG"),d=a("3LXp"),l=a("kWmn"),g=a("J82s"),m=a("pHTc"),h=a("fXoL"),p=a("TEn/"),u=a("nt/U"),_=a("46ml"),I=a("PgjG"),f=a("ofXK"),x=a("3CSS"),T=a("r8G5"),P=a("sYmb");function CoreTagIndexPage_ion_list_15_ion_item_1_Template(e,t){1&e&&(h.Ec(0,"ion-item",9),h.zc(1,"ion-icon",10),h.Ec(2,"ion-label",11),h.pd(3),h.Pc(4,"translate"),h.Dc(),h.Dc()),2&e&&(h.lc(3),h.qd(h.Qc(4,1,"core.tag.warningareasnotsupported")))}const _c0=function(e){return{count:e}};function CoreTagIndexPage_ion_list_15_ion_item_2_ion_badge_6_Template(e,t){if(1&e&&(h.Ec(0,"ion-badge",14),h.Ec(1,"span",15),h.pd(2),h.Dc(),h.Ec(3,"span",16),h.pd(4),h.Pc(5,"translate"),h.Dc(),h.Dc()),2&e){const e=h.Oc().$implicit;h.lc(2),h.qd(e.badge),h.lc(2),h.qd(h.Rc(5,2,"core.tag.tagareabadgedescription",h.ad(5,_c0,e.badge)))}}function CoreTagIndexPage_ion_list_15_ion_item_2_Template(e,t){if(1&e){const e=h.Fc();h.Ec(0,"ion-item",12),h.Mc("click",(function CoreTagIndexPage_ion_list_15_ion_item_2_Template_ion_item_click_0_listener(){h.fd(e);const a=t.$implicit;return h.Oc(2).openArea(a)})),h.Pc(1,"translate"),h.Ec(2,"ion-label"),h.Ec(3,"h2"),h.pd(4),h.Pc(5,"translate"),h.Dc(),h.Dc(),h.nd(6,CoreTagIndexPage_ion_list_15_ion_item_2_ion_badge_6_Template,6,7,"ion-badge",13),h.Dc()}if(2&e){const e=t.$implicit,a=h.Oc(2);h.mc("aria-label",h.Qc(1,4,e.nameKey))("aria-current",e.id==a.selectedAreaId?"page":"false"),h.lc(4),h.qd(h.Qc(5,6,e.nameKey)),h.lc(2),h.Vc("ngIf",e.badge)}}function CoreTagIndexPage_ion_list_15_Template(e,t){if(1&e&&(h.Ec(0,"ion-list"),h.nd(1,CoreTagIndexPage_ion_list_15_ion_item_1_Template,5,3,"ion-item",7),h.nd(2,CoreTagIndexPage_ion_list_15_ion_item_2_Template,7,8,"ion-item",8),h.Dc()),2&e){const e=h.Oc();h.lc(1),h.Vc("ngIf",e.hasUnsupportedAreas),h.lc(1),h.Vc("ngForOf",e.areas)}}const _c1=function(e){return{$a:e}};function CoreTagIndexPage_core_empty_box_16_Template(e,t){if(1&e&&(h.zc(0,"core-empty-box",17),h.Pc(1,"translate")),2&e){const e=h.Oc();h.Vc("message",h.Rc(1,1,"core.tag.noresultsfor",h.ad(4,_c1,e.tagName)))}}let b=(()=>{class CoreTagIndexPage{constructor(){this.tagId=0,this.tagName="",this.collectionId=0,this.areaId=0,this.fromContextId=0,this.contextId=0,this.recursive=!0,this.loaded=!1,this.hasUnsupportedAreas=!1,this.areas=[]}ngOnInit(){var e;return Object(s.a)(this,void 0,void 0,(function*(){this.tagId=m.a.getRouteNumberParam("tagId")||this.tagId,this.tagName=m.a.getRouteParam("tagName")||this.tagName,this.collectionId=m.a.getRouteNumberParam("collectionId")||this.collectionId,this.areaId=m.a.getRouteNumberParam("areaId")||this.areaId,this.fromContextId=m.a.getRouteNumberParam("fromContextId")||this.fromContextId,this.contextId=m.a.getRouteNumberParam("contextId")||this.contextId,this.recursive=null===(e=m.a.getRouteBooleanParam("recursive"))||void 0===e||e;try{if(yield this.fetchData(),r.a.isTablet&&this.areas&&this.areas.length>0){const e=this.areas.find((e=>e.id==this.areaId));this.openArea(e||this.areas[0])}}finally{this.loaded=!0}}))}fetchData(){return Object(s.a)(this,void 0,void 0,(function*(){try{const e=yield l.a.getTagIndexPerArea(this.tagId,this.tagName,this.collectionId,this.areaId,this.fromContextId,this.contextId,this.recursive,0);this.areas=[],this.hasUnsupportedAreas=!1;const t=[];yield Promise.all(e.map((e=>Object(s.a)(this,void 0,void 0,(function*(){const a=yield g.a.parseContent(e.component,e.itemtype,e.content);if(!a||!a.length)return this.hasUnsupportedAreas=!0,void 0;t.push({id:e.ta,componentName:e.component,itemType:e.itemtype,nameKey:g.a.getDisplayNameKey(e.component,e.itemtype),items:a,canLoadMore:!!e.nextpageurl,badge:a&&a.length?a.length+(e.nextpageurl?"+":""):""})}))))),this.areas=t}catch(e){d.a.showErrorModalDefault(e,"Error loading tag index")}}))}refreshData(e){l.a.invalidateTagIndexPerArea(this.tagId,this.tagName,this.collectionId,this.areaId,this.fromContextId,this.contextId,this.recursive).finally((()=>{this.fetchData().finally((()=>{null==e?void 0:e.complete()}))}))}openArea(e){this.selectedAreaId=e.id;const t={tagId:this.tagId,tagName:this.tagName,collectionId:this.collectionId,areaId:e.id,fromContextId:this.fromContextId,contextId:this.contextId,recursive:this.recursive,areaNameKey:e.nameKey,componentName:e.componentName,itemType:e.itemType,items:e.items.slice(),canLoadMore:e.canLoadMore,nextPage:1},a=m.a.isCurrentPathInTablet("**/tag/index/index-area");m.a.navigate((a?"../":"")+"index-area",{params:t})}}return CoreTagIndexPage.ɵfac=function CoreTagIndexPage_Factory(e){return new(e||CoreTagIndexPage)},CoreTagIndexPage.ɵcmp=h.sc({type:CoreTagIndexPage,selectors:[["page-core-tag-index"]],decls:17,vars:14,consts:[["slot","start"],[3,"text"],["slot","fixed",3,"disabled","ionRefresh"],[3,"pullingText"],[3,"hideUntil"],[4,"ngIf"],["icon","fas-tag",3,"message",4,"ngIf"],["class","core-warning-item",4,"ngIf"],["class","ion-text-wrap","button","","detail","true",3,"click",4,"ngFor","ngForOf"],[1,"core-warning-item"],["slot","start","name","fas-exclamation-triangle","color","warning","aria-hidden","true"],[1,"ion-text-wrap"],["button","","detail","true",1,"ion-text-wrap",3,"click"],["slot","end",4,"ngIf"],["slot","end"],["aria-hidden","true"],[1,"sr-only"],["icon","fas-tag",3,"message"]],template:function CoreTagIndexPage_Template(e,t){1&e&&(h.Ec(0,"ion-header"),h.Ec(1,"ion-toolbar"),h.Ec(2,"ion-buttons",0),h.zc(3,"ion-back-button",1),h.Pc(4,"translate"),h.Dc(),h.Ec(5,"ion-title"),h.Ec(6,"h1"),h.pd(7),h.Pc(8,"translate"),h.Dc(),h.Dc(),h.Dc(),h.Dc(),h.Ec(9,"ion-content"),h.Ec(10,"core-split-view"),h.Ec(11,"ion-refresher",2),h.Mc("ionRefresh",(function CoreTagIndexPage_Template_ion_refresher_ionRefresh_11_listener(e){return t.refreshData(e.target)})),h.zc(12,"ion-refresher-content",3),h.Pc(13,"translate"),h.Dc(),h.Ec(14,"core-loading",4),h.nd(15,CoreTagIndexPage_ion_list_15_Template,3,2,"ion-list",5),h.nd(16,CoreTagIndexPage_core_empty_box_16_Template,2,6,"core-empty-box",6),h.Dc(),h.Dc(),h.Dc()),2&e&&(h.lc(3),h.Vc("text",h.Qc(4,8,"core.back")),h.lc(4),h.sd("",h.Qc(8,10,"core.tag.tag"),": ",t.tagName,""),h.lc(4),h.Vc("disabled",!t.loaded),h.lc(1),h.Wc("pullingText",h.Qc(13,12,"core.pulltorefresh")),h.lc(2),h.Vc("hideUntil",t.loaded),h.lc(1),h.Vc("ngIf",t.hasUnsupportedAreas||t.areas.length),h.lc(1),h.Vc("ngIf",!(t.hasUnsupportedAreas||t.areas&&t.areas.length)))},directives:[p.C,p.Ab,p.m,p.h,p.i,p.yb,u.a,p.v,_.a,p.bb,p.cb,I.a,f.t,p.P,f.s,p.I,p.D,x.a,p.O,p.k,T.a],pipes:[P.d],encapsulation:2}),CoreTagIndexPage})();const C=[{path:"",component:b},i.CoreTagIndexAreaRoute],y=[{path:"",component:b,children:[i.CoreTagIndexAreaRoute]}],v=[...Object(o.c)(C,(()=>r.a.isMobile)),...Object(o.c)(y,(()=>r.a.isTablet))];let D=(()=>{class CoreTagIndexPageModule{}return CoreTagIndexPageModule.ɵmod=h.wc({type:CoreTagIndexPageModule}),CoreTagIndexPageModule.ɵinj=h.vc({factory:function CoreTagIndexPageModule_Factory(e){return new(e||CoreTagIndexPageModule)},imports:[[n.m.forChild(v),c.a],n.m]}),CoreTagIndexPageModule})();void(("undefined"==typeof ngJitMode||ngJitMode)&&h.kd(D,{declarations:[b],imports:[n.m,c.a],exports:[n.m]}))}}]);
(window.webpackJsonp=window.webpackJsonp||[]).push([[64],{kNee:function(t,e,c){"use strict";c.r(e),c.d(e,"AddonModH5PActivityUserAttemptsPageModule",(function(){return b}));var i=c("tyNb"),o=c("L3Fv"),n=c("mrSG"),a=c("4pns"),s=c("pHTc"),d=c("9+EE"),r=c("3LXp"),l=c("bFG1"),m=c("pOwY"),_=c("fXoL"),p=c("TEn/"),u=c("ofXK"),A=c("nt/U"),g=c("PgjG"),P=c("hMzs"),h=c("nu3w"),f=c("FeAf"),v=c("r8G5"),y=c("3CSS"),M=c("sYmb"),I=c("uYHD");function AddonModH5PActivityUserAttemptsPage_core_format_text_7_Template(t,e){if(1&t&&_.zc(0,"core-format-text",11),2&t){const t=_.Oc();_.Vc("text",t.h5pActivity.name)("contextInstanceId",t.h5pActivity.coursemodule)("courseId",t.courseId)}}function AddonModH5PActivityUserAttemptsPage_ion_item_13_Template(t,e){if(1&t&&(_.Ec(0,"ion-item",12),_.zc(1,"core-user-avatar",13),_.Ec(2,"ion-label"),_.Ec(3,"h2"),_.pd(4),_.Dc(),_.Dc(),_.Dc()),2&t){const t=_.Oc();_.Vc("userId",t.user.id)("courseId",t.courseId),_.mc("aria-label",t.user.fullname),_.lc(1),_.Vc("user",t.user)("courseId",t.courseId)("linkProfile",!1),_.lc(3),_.qd(t.user.fullname)}}function AddonModH5PActivityUserAttemptsPage_ion_item_14_Template(t,e){if(1&t&&(_.Ec(0,"ion-item",14),_.zc(1,"core-user-avatar",15),_.Ec(2,"ion-label"),_.Ec(3,"h2"),_.pd(4),_.Pc(5,"translate"),_.Dc(),_.Dc(),_.Dc()),2&t){const t=_.Oc();_.lc(1),_.Vc("user",t.user)("courseId",t.courseId),_.lc(3),_.qd(_.Qc(5,3,"addon.mod_h5pactivity.myattempts"))}}function AddonModH5PActivityUserAttemptsPage_ion_list_15_ng_container_1_ng_container_5_Template(t,e){1&t&&_.Ac(0)}const _c0=function(t){return{attempts:t}};function AddonModH5PActivityUserAttemptsPage_ion_list_15_ng_container_1_Template(t,e){if(1&t&&(_.Cc(0),_.Ec(1,"ion-item-divider"),_.Ec(2,"ion-label"),_.Ec(3,"h2"),_.pd(4),_.Dc(),_.Dc(),_.Dc(),_.nd(5,AddonModH5PActivityUserAttemptsPage_ion_list_15_ng_container_1_ng_container_5_Template,1,0,"ng-container",16),_.Bc()),2&t){const t=_.Oc(2),e=_.ed(18);_.lc(4),_.qd(t.attemptsData.scored.title),_.lc(1),_.Vc("ngTemplateOutlet",e)("ngTemplateOutletContext",_.ad(3,_c0,t.attemptsData.scored.attempts))}}function AddonModH5PActivityUserAttemptsPage_ion_list_15_ng_container_2_ng_container_6_Template(t,e){1&t&&_.Ac(0)}function AddonModH5PActivityUserAttemptsPage_ion_list_15_ng_container_2_Template(t,e){if(1&t&&(_.Cc(0),_.Ec(1,"ion-item-divider"),_.Ec(2,"ion-label"),_.Ec(3,"h2"),_.pd(4),_.Pc(5,"translate"),_.Dc(),_.Dc(),_.Dc(),_.nd(6,AddonModH5PActivityUserAttemptsPage_ion_list_15_ng_container_2_ng_container_6_Template,1,0,"ng-container",16),_.Bc()),2&t){const t=_.Oc(2),e=_.ed(18);_.lc(4),_.qd(_.Qc(5,3,"addon.mod_h5pactivity.all_attempts")),_.lc(2),_.Vc("ngTemplateOutlet",e)("ngTemplateOutletContext",_.ad(5,_c0,t.attemptsData.attempts))}}function AddonModH5PActivityUserAttemptsPage_ion_list_15_Template(t,e){if(1&t&&(_.Ec(0,"ion-list"),_.nd(1,AddonModH5PActivityUserAttemptsPage_ion_list_15_ng_container_1_Template,6,5,"ng-container",8),_.nd(2,AddonModH5PActivityUserAttemptsPage_ion_list_15_ng_container_2_Template,7,7,"ng-container",8),_.Dc()),2&t){const t=_.Oc();_.lc(1),_.Vc("ngIf",t.attemptsData.scored),_.lc(1),_.Vc("ngIf",t.attemptsData.attempts&&t.attemptsData.attempts.length)}}function AddonModH5PActivityUserAttemptsPage_core_empty_box_16_Template(t,e){1&t&&(_.zc(0,"core-empty-box",17),_.Pc(1,"translate")),2&t&&_.Vc("message",_.Qc(1,1,"addon.mod_h5pactivity.attempts_none"))}function AddonModH5PActivityUserAttemptsPage_ng_template_17_ion_item_23_img_18_Template(t,e){1&t&&(_.zc(0,"img",32),_.Pc(1,"translate")),2&t&&_.Vc("alt",_.Qc(1,1,"addon.mod_h5pactivity.attempt_completion_yes"))}function AddonModH5PActivityUserAttemptsPage_ng_template_17_ion_item_23_img_19_Template(t,e){1&t&&(_.zc(0,"img",33),_.Pc(1,"translate")),2&t&&_.Vc("alt",_.Qc(1,1,"addon.mod_h5pactivity.attempt_completion_no"))}function AddonModH5PActivityUserAttemptsPage_ng_template_17_ion_item_23_ion_icon_21_Template(t,e){1&t&&(_.zc(0,"ion-icon",34),_.Pc(1,"translate")),2&t&&_.mc("aria-label",_.Qc(1,1,"addon.mod_h5pactivity.attempt_success_pass"))}function AddonModH5PActivityUserAttemptsPage_ng_template_17_ion_item_23_ion_icon_22_Template(t,e){1&t&&(_.zc(0,"ion-icon",35),_.Pc(1,"translate")),2&t&&_.mc("aria-label",_.Qc(1,1,"addon.mod_h5pactivity.attempt_success_fail"))}function AddonModH5PActivityUserAttemptsPage_ng_template_17_ion_item_23_img_23_Template(t,e){1&t&&(_.zc(0,"img",36),_.Pc(1,"translate")),2&t&&_.Vc("alt",_.Qc(1,1,"addon.mod_h5pactivity.attempt_success_unknown"))}const _c1=function(t){return{$a:t}};function AddonModH5PActivityUserAttemptsPage_ng_template_17_ion_item_23_Template(t,e){if(1&t){const t=_.Fc();_.Ec(0,"ion-item",24),_.Mc("click",(function AddonModH5PActivityUserAttemptsPage_ng_template_17_ion_item_23_Template_ion_item_click_0_listener(){_.fd(t);const c=e.$implicit;return _.Oc(2).openAttempt(c)})),_.Pc(1,"translate"),_.Ec(2,"ion-label"),_.Ec(3,"ion-row",19),_.Ec(4,"ion-col",20),_.pd(5),_.Dc(),_.Ec(6,"ion-col",21),_.pd(7),_.Pc(8,"coreFormatDate"),_.Dc(),_.Ec(9,"ion-col",20),_.pd(10),_.Ec(11,"span",25),_.pd(12),_.Dc(),_.Dc(),_.Ec(13,"ion-col",22),_.pd(14),_.Dc(),_.Ec(15,"ion-col",22),_.pd(16),_.Dc(),_.Ec(17,"ion-col",22),_.nd(18,AddonModH5PActivityUserAttemptsPage_ng_template_17_ion_item_23_img_18_Template,2,3,"img",26),_.nd(19,AddonModH5PActivityUserAttemptsPage_ng_template_17_ion_item_23_img_19_Template,2,3,"img",27),_.Dc(),_.Ec(20,"ion-col",28),_.nd(21,AddonModH5PActivityUserAttemptsPage_ng_template_17_ion_item_23_ion_icon_21_Template,2,3,"ion-icon",29),_.nd(22,AddonModH5PActivityUserAttemptsPage_ng_template_17_ion_item_23_ion_icon_22_Template,2,3,"ion-icon",30),_.nd(23,AddonModH5PActivityUserAttemptsPage_ng_template_17_ion_item_23_img_23_Template,2,3,"img",31),_.Dc(),_.Dc(),_.Dc(),_.Dc()}if(2&t){const t=e.$implicit;_.mc("aria-label",_.Rc(1,12,"addon.mod_h5pactivity.viewattempt",_.ad(18,_c1,t.attempt))),_.lc(5),_.qd(t.attempt),_.lc(2),_.rd(" ",_.Rc(8,15,t.timemodified,"strftimedatetimeshort")," "),_.lc(3),_.rd(" ",t.rawscore,""),_.lc(2),_.rd(" / ",t.maxscore,""),_.lc(2),_.qd(t.maxscore),_.lc(2),_.qd(t.durationReadable),_.lc(2),_.Vc("ngIf",t.completion),_.lc(1),_.Vc("ngIf",!t.completion),_.lc(2),_.Vc("ngIf",null!==t.success&&t.success),_.lc(1),_.Vc("ngIf",null!==t.success&&!t.success),_.lc(1),_.Vc("ngIf",null===t.success)}}function AddonModH5PActivityUserAttemptsPage_ng_template_17_Template(t,e){if(1&t&&(_.Ec(0,"ion-item",18),_.Ec(1,"ion-label"),_.Ec(2,"ion-row",19),_.Ec(3,"ion-col",20),_.pd(4,"#"),_.Dc(),_.Ec(5,"ion-col",21),_.pd(6),_.Pc(7,"translate"),_.Dc(),_.Ec(8,"ion-col",20),_.pd(9),_.Pc(10,"translate"),_.Dc(),_.Ec(11,"ion-col",22),_.pd(12),_.Pc(13,"translate"),_.Dc(),_.Ec(14,"ion-col",22),_.pd(15),_.Pc(16,"translate"),_.Dc(),_.Ec(17,"ion-col",22),_.pd(18),_.Pc(19,"translate"),_.Dc(),_.Ec(20,"ion-col",20),_.pd(21),_.Pc(22,"translate"),_.Dc(),_.Dc(),_.Dc(),_.Dc(),_.nd(23,AddonModH5PActivityUserAttemptsPage_ng_template_17_ion_item_23_Template,24,20,"ion-item",23)),2&t){const t=e.attempts;_.Vc("detail",!1),_.lc(6),_.qd(_.Qc(7,8,"core.date")),_.lc(3),_.qd(_.Qc(10,10,"addon.mod_h5pactivity.score")),_.lc(3),_.qd(_.Qc(13,12,"addon.mod_h5pactivity.maxscore")),_.lc(3),_.qd(_.Qc(16,14,"addon.mod_h5pactivity.duration")),_.lc(3),_.qd(_.Qc(19,16,"addon.mod_h5pactivity.completion")),_.lc(3),_.qd(_.Qc(22,18,"core.success")),_.lc(2),_.Vc("ngForOf",t)}}let D=(()=>{class AddonModH5PActivityUserAttemptsPage{constructor(){this.loaded=!1,this.isCurrentUser=!1,this.fetchSuccess=!1}ngOnInit(){return Object(n.a)(this,void 0,void 0,(function*(){try{this.courseId=s.a.getRequiredRouteNumberParam("courseId"),this.cmId=s.a.getRequiredRouteNumberParam("cmId"),this.userId=s.a.getRouteNumberParam("userId")||d.b.getCurrentSiteUserId()}catch(t){return r.a.showErrorModal(t),s.a.back(),void 0}this.isCurrentUser=this.userId==d.b.getCurrentSiteUserId(),yield this.fetchData()}))}doRefresh(t){this.refreshData().finally((()=>{t.complete()}))}fetchData(){return Object(n.a)(this,void 0,void 0,(function*(){try{this.h5pActivity=yield m.a.getH5PActivity(this.courseId,this.cmId),yield Promise.all([this.fetchAttempts(),this.fetchUserProfile()]),this.fetchSuccess||(this.fetchSuccess=!0,l.a.ignoreErrors(m.a.logViewReport(this.h5pActivity.id,this.h5pActivity.name,{userId:this.userId})))}catch(t){r.a.showErrorModalDefault(t,"Error loading attempts.")}finally{this.loaded=!0}}))}fetchAttempts(){return Object(n.a)(this,void 0,void 0,(function*(){this.h5pActivity&&(this.attemptsData=yield m.a.getUserAttempts(this.h5pActivity.id,{cmId:this.cmId,userId:this.userId}))}))}fetchUserProfile(){return Object(n.a)(this,void 0,void 0,(function*(){try{this.user=yield a.a.getProfile(this.userId,this.courseId,!0)}catch(t){}}))}refreshData(){return Object(n.a)(this,void 0,void 0,(function*(){const t=[m.a.invalidateActivityData(this.courseId)];this.h5pActivity&&t.push(m.a.invalidateUserAttempts(this.h5pActivity.id,this.userId)),yield l.a.ignoreErrors(Promise.all(t)),yield this.fetchData()}))}openAttempt(t){s.a.navigate(`../../attemptresults/${t.id}`)}}return AddonModH5PActivityUserAttemptsPage.ɵfac=function AddonModH5PActivityUserAttemptsPage_Factory(t){return new(t||AddonModH5PActivityUserAttemptsPage)},AddonModH5PActivityUserAttemptsPage.ɵcmp=_.sc({type:AddonModH5PActivityUserAttemptsPage,selectors:[["page-addon-mod-h5pactivity-user-attempts"]],decls:19,vars:13,consts:[["slot","start"],[3,"text"],["contextLevel","module",3,"text","contextInstanceId","courseId",4,"ngIf"],["slot","fixed",3,"disabled","ionRefresh"],[3,"pullingText"],[3,"hideUntil"],["class","ion-text-wrap","core-user-link","","button","","detail","true",3,"userId","courseId",4,"ngIf"],["class","ion-text-wrap",4,"ngIf"],[4,"ngIf"],["icon","fas-chart-bar",3,"message",4,"ngIf"],["attemptsTemplate",""],["contextLevel","module",3,"text","contextInstanceId","courseId"],["core-user-link","","button","","detail","true",1,"ion-text-wrap",3,"userId","courseId"],["slot","start",3,"user","courseId","linkProfile"],[1,"ion-text-wrap"],["slot","start",3,"user","courseId"],[4,"ngTemplateOutlet","ngTemplateOutletContext"],["icon","fas-chart-bar",3,"message"],[1,"ion-text-wrap","addon-mod_h5pactivity-table-header",3,"detail"],[1,"ion-align-items-center"],[1,"ion-text-center"],["size","5","size-md","2",1,"ion-text-center"],[1,"ion-text-center","ion-hide-md-down"],["class","ion-text-wrap addon-mod_h5pactivity-table-row","button","","detail","true",3,"click",4,"ngFor","ngForOf"],["button","","detail","true",1,"ion-text-wrap","addon-mod_h5pactivity-table-row",3,"click"],[1,"ion-hide-md-up"],["src","assets/img/completion/completion-auto-y.svg",3,"alt",4,"ngIf"],["src","assets/img/completion/completion-auto-n.svg",3,"alt",4,"ngIf"],[1,"ion-text-center","addon-mod_h5pactivity-table-success-col"],["name","fas-check-circle",4,"ngIf"],["name","far-circle",4,"ngIf"],["src","assets/img/icons/empty.svg",3,"alt",4,"ngIf"],["src","assets/img/completion/completion-auto-y.svg",3,"alt"],["src","assets/img/completion/completion-auto-n.svg",3,"alt"],["name","fas-check-circle"],["name","far-circle"],["src","assets/img/icons/empty.svg",3,"alt"]],template:function AddonModH5PActivityUserAttemptsPage_Template(t,e){1&t&&(_.Ec(0,"ion-header"),_.Ec(1,"ion-toolbar"),_.Ec(2,"ion-buttons",0),_.zc(3,"ion-back-button",1),_.Pc(4,"translate"),_.Dc(),_.Ec(5,"ion-title"),_.Ec(6,"h1"),_.nd(7,AddonModH5PActivityUserAttemptsPage_core_format_text_7_Template,1,3,"core-format-text",2),_.Dc(),_.Dc(),_.Dc(),_.Dc(),_.Ec(8,"ion-content"),_.Ec(9,"ion-refresher",3),_.Mc("ionRefresh",(function AddonModH5PActivityUserAttemptsPage_Template_ion_refresher_ionRefresh_9_listener(t){return e.doRefresh(t.target)})),_.zc(10,"ion-refresher-content",4),_.Pc(11,"translate"),_.Dc(),_.Ec(12,"core-loading",5),_.nd(13,AddonModH5PActivityUserAttemptsPage_ion_item_13_Template,5,7,"ion-item",6),_.nd(14,AddonModH5PActivityUserAttemptsPage_ion_item_14_Template,6,5,"ion-item",7),_.nd(15,AddonModH5PActivityUserAttemptsPage_ion_list_15_Template,3,2,"ion-list",8),_.nd(16,AddonModH5PActivityUserAttemptsPage_core_empty_box_16_Template,2,3,"core-empty-box",9),_.Dc(),_.Dc(),_.nd(17,AddonModH5PActivityUserAttemptsPage_ng_template_17_Template,24,20,"ng-template",null,10,_.od)),2&t&&(_.lc(3),_.Vc("text",_.Qc(4,9,"core.back")),_.lc(4),_.Vc("ngIf",e.h5pActivity),_.lc(2),_.Vc("disabled",!e.loaded),_.lc(1),_.Wc("pullingText",_.Qc(11,11,"core.pulltorefresh")),_.lc(2),_.Vc("hideUntil",e.loaded),_.lc(1),_.Vc("ngIf",e.user&&!e.isCurrentUser),_.lc(1),_.Vc("ngIf",e.user&&e.isCurrentUser),_.lc(1),_.Vc("ngIf",e.attemptsData),_.lc(1),_.Vc("ngIf",e.attemptsData&&(!e.attemptsData.attempts||!e.attemptsData.attempts.length)))},directives:[p.C,p.Ab,p.m,p.h,p.i,p.yb,u.t,A.a,p.v,p.bb,p.cb,g.a,P.a,p.I,h.a,f.a,p.O,p.P,p.J,u.A,v.a,p.hb,p.u,u.s,p.D,y.a],pipes:[M.d,I.a],styles:["[_nghost-%COMP%]   .addon-mod_h5pactivity-table-header[_ngcontent-%COMP%]{font-weight:700}[_nghost-%COMP%]   .addon-mod_h5pactivity-table-row[_ngcontent-%COMP%]   .addon-mod_h5pactivity-table-success-col[_ngcontent-%COMP%]{font-size:1.2em}"]}),AddonModH5PActivityUserAttemptsPage})();const U=[{path:"",component:D}];let b=(()=>{class AddonModH5PActivityUserAttemptsPageModule{}return AddonModH5PActivityUserAttemptsPageModule.ɵmod=_.wc({type:AddonModH5PActivityUserAttemptsPageModule}),AddonModH5PActivityUserAttemptsPageModule.ɵinj=_.vc({factory:function AddonModH5PActivityUserAttemptsPageModule_Factory(t){return new(t||AddonModH5PActivityUserAttemptsPageModule)},imports:[[i.m.forChild(U),o.a],i.m]}),AddonModH5PActivityUserAttemptsPageModule})();void(("undefined"==typeof ngJitMode||ngJitMode)&&_.kd(b,{declarations:[D],imports:[i.m,o.a],exports:[i.m]}))}}]);
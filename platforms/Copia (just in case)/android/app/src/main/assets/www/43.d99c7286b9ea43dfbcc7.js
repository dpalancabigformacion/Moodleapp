(window.webpackJsonp=window.webpackJsonp||[]).push([[43],{FguK:function(e,t,i){"use strict";i.r(t),i.d(t,"AddonMessageOutputAirnotifierDevicesPageModule",(function(){return _}));var n=i("tyNb"),o=i("L3Fv"),s=i("mrSG"),c=i("3LXp"),r=i("Afn4"),a=i("FEUt"),d=i("bFG1"),u=i("fXoL"),l=i("TEn/"),g=i("nt/U"),p=i("PgjG"),f=i("ofXK"),v=i("3zv0"),D=i("3Pt+"),m=i("sYmb");function AddonMessageOutputAirnotifierDevicesPage_ion_item_15_span_4_Template(e,t){1&e&&(u.Ec(0,"span"),u.pd(1),u.Pc(2,"translate"),u.Dc()),2&e&&(u.lc(1),u.rd("(",u.Qc(2,1,"core.currentdevice"),")"))}function AddonMessageOutputAirnotifierDevicesPage_ion_item_15_Template(e,t){if(1&e){const e=u.Fc();u.Ec(0,"ion-item",6),u.Ec(1,"ion-label"),u.Ec(2,"p",7),u.pd(3),u.nd(4,AddonMessageOutputAirnotifierDevicesPage_ion_item_15_span_4_Template,3,3,"span",8),u.Dc(),u.Ec(5,"p"),u.pd(6),u.Dc(),u.Dc(),u.Ec(7,"core-button-with-spinner",9),u.Ec(8,"ion-toggle",10),u.Mc("ngModelChange",(function AddonMessageOutputAirnotifierDevicesPage_ion_item_15_Template_ion_toggle_ngModelChange_8_listener(i){u.fd(e);return t.$implicit.enable=i}))("ngModelChange",(function AddonMessageOutputAirnotifierDevicesPage_ion_item_15_Template_ion_toggle_ngModelChange_8_listener(){u.fd(e);const i=t.$implicit;return u.Oc().enableDevice(i,i.enable)})),u.Dc(),u.Dc(),u.Dc()}if(2&e){const e=t.$implicit;u.qc("item-current",e.current),u.lc(1),u.qc("core-bold",e.current),u.lc(2),u.sd(" ",e.name," ",e.model," "),u.lc(1),u.Vc("ngIf",e.current),u.lc(2),u.sd("",e.platform," ",e.version,""),u.lc(1),u.Vc("loading",e.updating),u.lc(1),u.Vc("ngModel",e.enable)}}let h=(()=>{class AddonMessageOutputAirnotifierDevicesPage{constructor(){this.devices=[],this.devicesLoaded=!1}ngOnInit(){this.fetchDevices()}fetchDevices(){return Object(s.a)(this,void 0,void 0,(function*(){try{const e=yield a.a.getUserDevices();this.devices=this.formatDevices(e)}catch(e){c.a.showErrorModal(e)}finally{this.devicesLoaded=!0}}))}formatDevices(e){const t=e,i=r.a.getPushId();return t.forEach((e=>{e.enable=!!e.enable,e.current=!(!i||i!=e.pushid)})),t.sort(((e,t)=>{const i=e.name.toLowerCase(),n=t.name.toLowerCase();return i.localeCompare(n)}))}updateDevicesAfterDelay(){this.updateTimeout&&clearTimeout(this.updateTimeout),this.updateTimeout=window.setTimeout((()=>{this.updateTimeout=void 0,this.updateDevices()}),5e3)}updateDevices(){return Object(s.a)(this,void 0,void 0,(function*(){yield d.a.ignoreErrors(a.a.invalidateUserDevices()),yield a.a.getUserDevices()}))}refreshDevices(e){return Object(s.a)(this,void 0,void 0,(function*(){try{yield d.a.ignoreErrors(a.a.invalidateUserDevices()),yield this.fetchDevices()}finally{null==e?void 0:e.complete()}}))}enableDevice(e,t){return Object(s.a)(this,void 0,void 0,(function*(){e.updating=!0;try{yield a.a.enableDevice(e.id,t),this.updateDevicesAfterDelay()}catch(t){c.a.showErrorModal(t),e.enable=!e.enable}finally{e.updating=!1}}))}ngOnDestroy(){this.updateTimeout&&(clearTimeout(this.updateTimeout),this.updateDevices())}}return AddonMessageOutputAirnotifierDevicesPage.ɵfac=function AddonMessageOutputAirnotifierDevicesPage_Factory(e){return new(e||AddonMessageOutputAirnotifierDevicesPage)},AddonMessageOutputAirnotifierDevicesPage.ɵcmp=u.sc({type:AddonMessageOutputAirnotifierDevicesPage,selectors:[["page-addon-message-output-airnotifier-devices"]],decls:16,vars:12,consts:[["slot","start"],[3,"text"],["slot","fixed",3,"disabled","ionRefresh"],[3,"pullingText"],[3,"hideUntil"],["class","ion-text-wrap",3,"item-current",4,"ngFor","ngForOf"],[1,"ion-text-wrap"],[1,"item-heading"],[4,"ngIf"],["slot","end",3,"loading"],[3,"ngModel","ngModelChange"]],template:function AddonMessageOutputAirnotifierDevicesPage_Template(e,t){1&e&&(u.Ec(0,"ion-header"),u.Ec(1,"ion-toolbar"),u.Ec(2,"ion-buttons",0),u.zc(3,"ion-back-button",1),u.Pc(4,"translate"),u.Dc(),u.Ec(5,"ion-title"),u.Ec(6,"h1"),u.pd(7),u.Pc(8,"translate"),u.Dc(),u.Dc(),u.Dc(),u.Dc(),u.Ec(9,"ion-content"),u.Ec(10,"ion-refresher",2),u.Mc("ionRefresh",(function AddonMessageOutputAirnotifierDevicesPage_Template_ion_refresher_ionRefresh_10_listener(e){return t.refreshDevices(e.target)})),u.zc(11,"ion-refresher-content",3),u.Pc(12,"translate"),u.Dc(),u.Ec(13,"core-loading",4),u.Ec(14,"ion-list"),u.nd(15,AddonMessageOutputAirnotifierDevicesPage_ion_item_15_Template,9,11,"ion-item",5),u.Dc(),u.Dc(),u.Dc()),2&e&&(u.lc(3),u.Vc("text",u.Qc(4,6,"core.back")),u.lc(4),u.qd(u.Qc(8,8,"addon.messageoutput_airnotifier.processorsettingsdesc")),u.lc(3),u.Vc("disabled",!t.devicesLoaded),u.lc(1),u.Wc("pullingText",u.Qc(12,10,"core.pulltorefresh")),u.lc(2),u.Vc("hideUntil",t.devicesLoaded),u.lc(2),u.Vc("ngForOf",t.devices))},directives:[l.C,l.Ab,l.m,l.h,l.i,l.yb,g.a,l.v,l.bb,l.cb,p.a,l.P,f.s,l.I,l.O,f.t,v.a,l.zb,l.d,D.r,D.u],pipes:[m.d],encapsulation:2}),AddonMessageOutputAirnotifierDevicesPage})();const A=[{path:"",component:h}];let _=(()=>{class AddonMessageOutputAirnotifierDevicesPageModule{}return AddonMessageOutputAirnotifierDevicesPageModule.ɵmod=u.wc({type:AddonMessageOutputAirnotifierDevicesPageModule}),AddonMessageOutputAirnotifierDevicesPageModule.ɵinj=u.vc({factory:function AddonMessageOutputAirnotifierDevicesPageModule_Factory(e){return new(e||AddonMessageOutputAirnotifierDevicesPageModule)},imports:[[n.m.forChild(A),o.a],n.m]}),AddonMessageOutputAirnotifierDevicesPageModule})();void(("undefined"==typeof ngJitMode||ngJitMode)&&u.kd(_,{declarations:[h],imports:[n.m,o.a],exports:[n.m]}))}}]);
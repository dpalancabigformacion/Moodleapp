(window.webpackJsonp=window.webpackJsonp||[]).push([[58],{B1At:function(e,o,n){"use strict";n.r(o),n.d(o,"AddonModFeedbackNonRespondentsPageModule",(function(){return R}));var t=n("L3Fv"),d=n("tyNb"),a=n("mrSG"),c=n("mWdr"),s=n("pHTc"),r=n("3LXp"),i=n("bFG1"),l=n("MNPK"),p=n("96hm"),u=n("fXoL"),g=n("TEn/"),_=n("nt/U"),h=n("PgjG"),b=n("WPIK"),f=n("ofXK"),m=n("xpMl"),M=n("FeAf"),k=n("sYmb");function AddonModFeedbackNonRespondentsPage_ng_container_21_ion_item_1_ion_badge_6_Template(e,o){1&e&&(u.Ec(0,"ion-badge",15),u.pd(1),u.Pc(2,"translate"),u.Dc()),2&e&&(u.lc(1),u.rd(" ",u.Qc(2,1,"addon.mod_feedback.started")," "))}function AddonModFeedbackNonRespondentsPage_ng_container_21_ion_item_1_ion_badge_7_Template(e,o){1&e&&(u.Ec(0,"ion-badge",16),u.pd(1),u.Pc(2,"translate"),u.Dc()),2&e&&(u.lc(1),u.rd(" ",u.Qc(2,1,"addon.mod_feedback.not_started")," "))}function AddonModFeedbackNonRespondentsPage_ng_container_21_ion_item_1_Template(e,o){if(1&e&&(u.Ec(0,"ion-item",10),u.zc(1,"core-user-avatar",11),u.Ec(2,"ion-label"),u.Ec(3,"p",12),u.pd(4),u.Dc(),u.Ec(5,"p"),u.nd(6,AddonModFeedbackNonRespondentsPage_ng_container_21_ion_item_1_ion_badge_6_Template,3,3,"ion-badge",13),u.nd(7,AddonModFeedbackNonRespondentsPage_ng_container_21_ion_item_1_ion_badge_7_Template,3,3,"ion-badge",14),u.Dc(),u.Dc(),u.Dc()),2&e){const e=o.$implicit;u.lc(1),u.Vc("user",e),u.lc(3),u.qd(e.fullname),u.lc(2),u.Vc("ngIf",e.started),u.lc(1),u.Vc("ngIf",!e.started)}}function AddonModFeedbackNonRespondentsPage_ng_container_21_Template(e,o){if(1&e&&(u.Cc(0),u.nd(1,AddonModFeedbackNonRespondentsPage_ng_container_21_ion_item_1_Template,8,4,"ion-item",9),u.Bc()),2&e){const e=u.Oc();u.lc(1),u.Vc("ngForOf",e.users)}}const _c0=function(e){return{$a:e}};let P=(()=>{class AddonModFeedbackNonRespondentsPage{constructor(){this.page=0,this.users=[],this.total=0,this.canLoadMore=!1,this.loaded=!1,this.loadMoreError=!1}ngOnInit(){try{this.cmId=s.a.getRequiredRouteNumberParam("cmId"),this.courseId=s.a.getRequiredRouteNumberParam("courseId"),this.selectedGroup=s.a.getRouteNumberParam("group")||0}catch(e){return r.a.showErrorModal(e),s.a.back(),void 0}this.fetchData()}fetchData(e=!1){return Object(a.a)(this,void 0,void 0,(function*(){this.page=0,this.total=0,this.users=[];try{this.feedback=yield l.a.getFeedback(this.courseId,this.cmId),this.groupInfo=yield c.a.getActivityGroupInfo(this.cmId),this.selectedGroup=c.a.validateGroupId(this.selectedGroup,this.groupInfo),yield this.loadGroupUsers(this.selectedGroup)}catch(o){r.a.showErrorModalDefault(o,"core.course.errorgetmodule",!0),e||s.a.back()}}))}loadGroupUsers(e){return Object(a.a)(this,void 0,void 0,(function*(){this.loadMoreError=!1,void 0===e?this.page++:(this.selectedGroup=e,this.page=0,this.total=0,this.users=[],this.loaded=!1);try{const e=yield p.a.getNonRespondents(this.feedback.id,{groupId:this.selectedGroup,page:this.page,cmId:this.cmId});this.total=e.total,this.users.length<e.total&&(this.users=this.users.concat(e.users)),this.canLoadMore=this.users.length<e.total}catch(e){throw this.loadMoreError=!0,e}finally{this.loaded=!0}}))}loadAttempts(e,o){return Object(a.a)(this,void 0,void 0,(function*(){try{yield this.loadGroupUsers(e)}catch(e){r.a.showErrorModalDefault(e,"core.course.errorgetmodule",!0)}finally{o&&o()}}))}refreshFeedback(e){return Object(a.a)(this,void 0,void 0,(function*(){try{const o=[];o.push(c.a.invalidateActivityGroupInfo(this.cmId)),this.feedback&&o.push(l.a.invalidateNonRespondentsData(this.feedback.id)),yield i.a.ignoreErrors(Promise.all(o)),yield this.fetchData(!0)}finally{e.complete()}}))}}return AddonModFeedbackNonRespondentsPage.ɵfac=function AddonModFeedbackNonRespondentsPage_Factory(e){return new(e||AddonModFeedbackNonRespondentsPage)},AddonModFeedbackNonRespondentsPage.ɵcmp=u.sc({type:AddonModFeedbackNonRespondentsPage,selectors:[["page-addon-mod-feedback-nonrespondents"]],decls:23,vars:22,consts:[["slot","start"],[3,"text"],["slot","fixed",3,"disabled","ionRefresh"],[3,"pullingText"],[3,"hideUntil"],[1,"ion-no-margin"],[3,"groupInfo","selected","selectedChange"],[4,"ngIf"],[3,"enabled","error","action"],["class","ion-text-wrap",4,"ngFor","ngForOf"],[1,"ion-text-wrap"],["slot","start",3,"user"],[1,"item-heading"],["color","success",4,"ngIf"],["color","danger",4,"ngIf"],["color","success"],["color","danger"]],template:function AddonModFeedbackNonRespondentsPage_Template(e,o){1&e&&(u.Ec(0,"ion-header"),u.Ec(1,"ion-toolbar"),u.Ec(2,"ion-buttons",0),u.zc(3,"ion-back-button",1),u.Pc(4,"translate"),u.Dc(),u.Ec(5,"ion-title"),u.Ec(6,"h1"),u.pd(7),u.Pc(8,"translate"),u.Dc(),u.Dc(),u.Dc(),u.Dc(),u.Ec(9,"ion-content"),u.Ec(10,"ion-refresher",2),u.Mc("ionRefresh",(function AddonModFeedbackNonRespondentsPage_Template_ion_refresher_ionRefresh_10_listener(e){return o.refreshFeedback(e.target)})),u.zc(11,"ion-refresher-content",3),u.Pc(12,"translate"),u.Dc(),u.Ec(13,"core-loading",4),u.Ec(14,"ion-list",5),u.Ec(15,"core-group-selector",6),u.Mc("selectedChange",(function AddonModFeedbackNonRespondentsPage_Template_core_group_selector_selectedChange_15_listener(e){return o.selectedGroup=e}))("selectedChange",(function AddonModFeedbackNonRespondentsPage_Template_core_group_selector_selectedChange_15_listener(){return o.loadAttempts(o.selectedGroup)})),u.Dc(),u.Ec(16,"ion-item-divider"),u.Ec(17,"ion-label"),u.Ec(18,"h2"),u.pd(19),u.Pc(20,"translate"),u.Dc(),u.Dc(),u.Dc(),u.nd(21,AddonModFeedbackNonRespondentsPage_ng_container_21_Template,2,1,"ng-container",7),u.Ec(22,"core-infinite-loading",8),u.Mc("action",(function AddonModFeedbackNonRespondentsPage_Template_core_infinite_loading_action_22_listener(e){return o.loadAttempts(void 0,e)})),u.Dc(),u.Dc(),u.Dc(),u.Dc()),2&e&&(u.lc(3),u.Vc("text",u.Qc(4,11,"core.back")),u.lc(4),u.qd(u.Qc(8,13,"addon.mod_feedback.responses")),u.lc(3),u.Vc("disabled",!o.loaded),u.lc(1),u.Wc("pullingText",u.Qc(12,15,"core.pulltorefresh")),u.lc(2),u.Vc("hideUntil",o.loaded),u.lc(2),u.Vc("groupInfo",o.groupInfo)("selected",o.selectedGroup),u.lc(4),u.qd(u.Rc(20,17,"addon.mod_feedback.non_respondents_students",u.ad(20,_c0,o.total))),u.lc(2),u.Vc("ngIf",o.total>0),u.lc(1),u.Vc("enabled",o.canLoadMore)("error",o.loadMoreError))},directives:[g.C,g.Ab,g.m,g.h,g.i,g.yb,_.a,g.v,g.bb,g.cb,h.a,g.P,b.a,g.J,g.O,f.t,m.a,f.s,g.I,M.a,g.k],pipes:[k.d],encapsulation:2}),AddonModFeedbackNonRespondentsPage})();const F=[{path:"",component:P}];let R=(()=>{class AddonModFeedbackNonRespondentsPageModule{}return AddonModFeedbackNonRespondentsPageModule.ɵmod=u.wc({type:AddonModFeedbackNonRespondentsPageModule}),AddonModFeedbackNonRespondentsPageModule.ɵinj=u.vc({factory:function AddonModFeedbackNonRespondentsPageModule_Factory(e){return new(e||AddonModFeedbackNonRespondentsPageModule)},imports:[[d.m.forChild(F),t.a],d.m]}),AddonModFeedbackNonRespondentsPageModule})();void(("undefined"==typeof ngJitMode||ngJitMode)&&u.kd(R,{declarations:[P],imports:[d.m,t.a],exports:[d.m]}))}}]);
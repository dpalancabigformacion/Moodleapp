(window.webpackJsonp=window.webpackJsonp||[]).push([[6],{NdFX:function(e,o,i){"use strict";i.r(o),i.d(o,"AddonForumNewDiscussionPageModule",(function(){return U}));var s=i("tyNb"),n=i("AzLI"),t=i("MLi9"),c=i("ekpb"),d=i("L3Fv"),a=i("mrSG"),r=i("3Pt+"),u=i("fjkH"),l=i("mWdr"),m=i("pHTc"),h=i("ZCW2"),g=i("N5Lt"),p=i("pET4"),_=i("9+EE"),f=i("3LXp"),D=i("j3ag"),w=i("uT8i"),I=i("h709"),b=i("bFG1"),v=i("VF9H"),P=i("hSQQ"),M=i("vuGA"),A=i("4reR"),N=i("nFEd"),C=i("LVzu"),O=i("baaQ"),E=i("fXoL"),F=i("46ml"),T=i("TEn/"),y=i("nt/U"),S=i("OZH1"),G=i("PgjG"),x=i("ofXK"),V=i("3CSS"),j=i("ACYt"),k=i("M9y5"),R=i("sYmb");const L=["newDiscFormEl"];function AddonModForumNewDiscussionPage_form_15_div_21_ion_item_1_Template(e,o){if(1&e){const e=E.Fc();E.Ec(0,"ion-item"),E.Ec(1,"ion-label"),E.pd(2),E.Pc(3,"translate"),E.Dc(),E.Ec(4,"ion-toggle",22),E.Mc("ngModelChange",(function AddonModForumNewDiscussionPage_form_15_div_21_ion_item_1_Template_ion_toggle_ngModelChange_4_listener(o){E.fd(e);return E.Oc(3).newDiscussion.postToAllGroups=o})),E.Dc(),E.Dc()}if(2&e){const e=E.Oc(3);E.lc(2),E.qd(E.Qc(3,2,"addon.mod_forum.posttomygroups")),E.lc(2),E.Vc("ngModel",e.newDiscussion.postToAllGroups)}}function AddonModForumNewDiscussionPage_form_15_div_21_ion_item_2_ion_select_option_6_Template(e,o){if(1&e&&(E.Ec(0,"ion-select-option",27),E.pd(1),E.Dc()),2&e){const e=o.$implicit;E.Vc("value",e.id),E.lc(1),E.qd(e.name)}}const _c1=function(e){return{header:e}};function AddonModForumNewDiscussionPage_form_15_div_21_ion_item_2_Template(e,o){if(1&e){const e=E.Fc();E.Ec(0,"ion-item",23),E.Ec(1,"ion-label",24),E.pd(2),E.Pc(3,"translate"),E.Dc(),E.Ec(4,"ion-select",25),E.Mc("ngModelChange",(function AddonModForumNewDiscussionPage_form_15_div_21_ion_item_2_Template_ion_select_ngModelChange_4_listener(o){E.fd(e);return E.Oc(3).newDiscussion.groupId=o}))("ionChange",(function AddonModForumNewDiscussionPage_form_15_div_21_ion_item_2_Template_ion_select_ionChange_4_listener(){E.fd(e);return E.Oc(3).calculateGroupName()})),E.Pc(5,"translate"),E.nd(6,AddonModForumNewDiscussionPage_form_15_div_21_ion_item_2_ion_select_option_6_Template,2,2,"ion-select-option",26),E.Dc(),E.Dc()}if(2&e){const e=E.Oc(3);E.lc(2),E.qd(E.Qc(3,5,"addon.mod_forum.group")),E.lc(2),E.Vc("ngModel",e.newDiscussion.groupId)("disabled",e.newDiscussion.postToAllGroups)("interfaceOptions",E.ad(9,_c1,E.Qc(5,7,"addon.mod_forum.group"))),E.lc(2),E.Vc("ngForOf",e.groups)}}function AddonModForumNewDiscussionPage_form_15_div_21_ion_item_8_Template(e,o){if(1&e){const e=E.Fc();E.Ec(0,"ion-item"),E.Ec(1,"ion-label"),E.pd(2),E.Pc(3,"translate"),E.Dc(),E.Ec(4,"ion-toggle",28),E.Mc("ngModelChange",(function AddonModForumNewDiscussionPage_form_15_div_21_ion_item_8_Template_ion_toggle_ngModelChange_4_listener(o){E.fd(e);return E.Oc(3).newDiscussion.pin=o})),E.Dc(),E.Dc()}if(2&e){const e=E.Oc(3);E.lc(2),E.qd(E.Qc(3,2,"addon.mod_forum.discussionpinned")),E.lc(2),E.Vc("ngModel",e.newDiscussion.pin)}}function AddonModForumNewDiscussionPage_form_15_div_21_core_attachments_9_Template(e,o){if(1&e&&E.zc(0,"core-attachments",29),2&e){const e=E.Oc(3);E.Vc("files",e.newDiscussion.files)("maxSize",e.forum.maxbytes)("maxSubmissions",e.forum.maxattachments)("component",e.component)("componentId",e.forum.cmid)("allowOffline",!0)("courseId",e.courseId)}}function AddonModForumNewDiscussionPage_form_15_div_21_Template(e,o){if(1&e){const e=E.Fc();E.Ec(0,"div",18),E.nd(1,AddonModForumNewDiscussionPage_form_15_div_21_ion_item_1_Template,5,4,"ion-item",7),E.nd(2,AddonModForumNewDiscussionPage_form_15_div_21_ion_item_2_Template,7,11,"ion-item",19),E.Ec(3,"ion-item"),E.Ec(4,"ion-label"),E.pd(5),E.Pc(6,"translate"),E.Dc(),E.Ec(7,"ion-toggle",20),E.Mc("ngModelChange",(function AddonModForumNewDiscussionPage_form_15_div_21_Template_ion_toggle_ngModelChange_7_listener(o){E.fd(e);return E.Oc(2).newDiscussion.subscribe=o})),E.Dc(),E.Dc(),E.nd(8,AddonModForumNewDiscussionPage_form_15_div_21_ion_item_8_Template,5,4,"ion-item",7),E.nd(9,AddonModForumNewDiscussionPage_form_15_div_21_core_attachments_9_Template,1,7,"core-attachments",21),E.Dc()}if(2&e){const e=E.Oc(2);E.lc(1),E.Vc("ngIf",e.showGroups&&e.groupIds.length>1&&e.accessInfo.cancanposttomygroups),E.lc(1),E.Vc("ngIf",e.showGroups),E.lc(3),E.qd(E.Qc(6,6,"addon.mod_forum.discussionsubscription")),E.lc(2),E.Vc("ngModel",e.newDiscussion.subscribe),E.lc(1),E.Vc("ngIf",e.canPin),E.lc(1),E.Vc("ngIf",e.canCreateAttachments&&e.forum&&e.forum.maxattachments>0)}}const _c2=function(e){return{groupname:e}};function AddonModForumNewDiscussionPage_form_15_ion_item_22_Template(e,o){if(1&e&&(E.Ec(0,"ion-item",30),E.zc(1,"ion-icon",31),E.Ec(2,"ion-label"),E.pd(3),E.Pc(4,"translate"),E.Dc(),E.Dc()),2&e){const e=E.Oc(2);E.lc(3),E.qd(E.Rc(4,1,"addon.mod_forum.postingroup",E.ad(4,_c2,e.groupName)))}}function AddonModForumNewDiscussionPage_form_15_ion_col_26_Template(e,o){if(1&e){const e=E.Fc();E.Ec(0,"ion-col"),E.Ec(1,"ion-button",32),E.Mc("click",(function AddonModForumNewDiscussionPage_form_15_ion_col_26_Template_ion_button_click_1_listener(){E.fd(e);return E.Oc(2).discard()})),E.pd(2),E.Pc(3,"translate"),E.Dc(),E.Dc()}2&e&&(E.lc(2),E.qd(E.Qc(3,1,"core.discard")))}function AddonModForumNewDiscussionPage_form_15_Template(e,o){if(1&e){const e=E.Fc();E.Ec(0,"form",null,8),E.Ec(2,"ion-item"),E.Ec(3,"ion-label",9),E.pd(4),E.Pc(5,"translate"),E.Dc(),E.Ec(6,"ion-input",10),E.Mc("ngModelChange",(function AddonModForumNewDiscussionPage_form_15_Template_ion_input_ngModelChange_6_listener(o){E.fd(e);return E.Oc().newDiscussion.subject=o})),E.Pc(7,"translate"),E.Dc(),E.Dc(),E.Ec(8,"ion-item"),E.Ec(9,"ion-label",9),E.pd(10),E.Pc(11,"translate"),E.Dc(),E.Ec(12,"core-rich-text-editor",11),E.Mc("contentChanged",(function AddonModForumNewDiscussionPage_form_15_Template_core_rich_text_editor_contentChanged_12_listener(o){E.fd(e);return E.Oc().onMessageChange(o)})),E.Pc(13,"translate"),E.Dc(),E.Dc(),E.Ec(14,"ion-item",12),E.Mc("click",(function AddonModForumNewDiscussionPage_form_15_Template_ion_item_click_14_listener(){E.fd(e);return E.Oc().toggleAdvanced()})),E.Pc(15,"translate"),E.zc(16,"ion-icon",13),E.Ec(17,"ion-label"),E.Ec(18,"h2"),E.pd(19),E.Pc(20,"translate"),E.Dc(),E.Dc(),E.Dc(),E.nd(21,AddonModForumNewDiscussionPage_form_15_div_21_Template,10,8,"div",14),E.nd(22,AddonModForumNewDiscussionPage_form_15_ion_item_22_Template,5,6,"ion-item",15),E.Ec(23,"ion-item",16),E.Ec(24,"ion-label"),E.Ec(25,"ion-row"),E.nd(26,AddonModForumNewDiscussionPage_form_15_ion_col_26_Template,4,3,"ion-col",7),E.Ec(27,"ion-col"),E.Ec(28,"ion-button",17),E.Mc("click",(function AddonModForumNewDiscussionPage_form_15_Template_ion_button_click_28_listener(){E.fd(e);return E.Oc().add()})),E.pd(29),E.Pc(30,"translate"),E.Dc(),E.Dc(),E.Dc(),E.Dc(),E.Dc(),E.Dc()}if(2&e){const e=E.Oc();E.lc(4),E.qd(E.Qc(5,20,"addon.mod_forum.subject")),E.lc(2),E.Vc("ngModel",e.newDiscussion.subject)("placeholder",E.Qc(7,22,"addon.mod_forum.subject")),E.lc(4),E.qd(E.Qc(11,24,"addon.mod_forum.message")),E.lc(2),E.Vc("control",e.messageControl)("placeholder",E.Qc(13,26,"addon.mod_forum.message"))("component",e.component)("componentId",e.forum.cmid)("autoSave",!0)("contextInstanceId",e.forum.cmid),E.lc(2),E.mc("aria-expanded",e.advanced)("aria-label",E.Qc(15,28,e.advanced?"core.hideadvanced":"core.showadvanced")),E.lc(2),E.qc("expandable-status-icon-expanded",e.advanced),E.lc(3),E.qd(E.Qc(20,30,"addon.mod_forum.advanced")),E.lc(2),E.Vc("ngIf",e.advanced),E.lc(1),E.Vc("ngIf",e.showGroups&&e.groupName&&!e.newDiscussion.postToAllGroups),E.lc(4),E.Vc("ngIf",e.hasOffline),E.lc(2),E.Vc("disabled",""==e.newDiscussion.subject||null==e.newDiscussion.message),E.lc(1),E.rd(" ",E.Qc(30,32,"addon.mod_forum.posttoforum")," ")}}let Q=(()=>{class AddonModForumNewDiscussionPage{constructor(e,o){this.route=e,this.splitView=o,this.component=h.b.COMPONENT,this.messageControl=new r.g,this.groupsLoaded=!1,this.showGroups=!1,this.hasOffline=!1,this.canCreateAttachments=!0,this.canPin=!1,this.showForm=!1,this.groups=[],this.groupIds=[],this.newDiscussion={subject:"",message:null,postToAllGroups:!1,groupId:0,subscribe:!0,pin:!1,files:[]},this.advanced=!1,this.accessInfo={},this.isDestroyed=!1,this.forceLeave=!1}ngOnInit(){var e,o;return Object(a.a)(this,void 0,void 0,(function*(){try{const i=this.route.snapshot.data;if(this.courseId=m.a.getRequiredRouteNumberParam("courseId"),this.cmId=m.a.getRequiredRouteNumberParam("cmId"),this.forumId=m.a.getRequiredRouteNumberParam("forumId"),this.timeCreated=m.a.getRequiredRouteNumberParam("timeCreated"),this.initialGroupId=m.a.getRouteNumberParam("groupId"),this.initialGroupId=0===this.initialGroupId?h.b.ALL_PARTICIPANTS:this.initialGroupId,0!==this.timeCreated&&(null===(e=i.swipeEnabled)||void 0===e||e)){const e=O.a.getOrCreateSource(C.a,[this.courseId,this.cmId,null!==(o=i.discussionsPathPrefix)&&void 0!==o?o:""]);this.discussions=new new_discussion_page_AddonModForumNewDiscussionDiscussionsSwipeManager(e),yield this.discussions.start()}}catch(e){return f.a.showErrorModal(e),this.goBack(),void 0}this.fetchDiscussionData().finally((()=>{this.groupsLoaded=!0}))}))}ionViewDidEnter(){this.syncObserver||(this.syncObserver=u.b.on(p.b.AUTO_SYNCED,(e=>{e.forumId==this.forumId&&e.userId==_.b.getCurrentSiteUserId()&&(f.a.showAlertTranslated("core.notice","core.contenteditingsynced"),this.returnToDiscussions())}),_.b.getCurrentSiteId()))}fetchDiscussionData(e){return Object(a.a)(this,void 0,void 0,(function*(){try{const o=yield l.a.getActivityGroupMode(this.cmId),i=[];o===l.b.SEPARATEGROUPS||o===l.b.VISIBLEGROUPS?i.push(l.a.instance.getActivityAllowedGroups(this.cmId).then((e=>{let i;return i=o===l.b.VISIBLEGROUPS?this.validateVisibleGroups(e.groups):this.addAllParticipantsOption(e.groups,!0),i.then((e=>{if(e.length>0)return this.groups=e,this.groupIds=e.map((e=>e.id)).filter((e=>e>0)),this.newDiscussion.groupId=this.newDiscussion.groupId||this.getInitialGroupId(),this.showGroups=!0,this.calculateGroupName(),this.groupIds.length<=1&&(this.newDiscussion.postToAllGroups=!1),void 0;throw new Error(D.J.instant(o===l.b.SEPARATEGROUPS?"addon.mod_forum.cannotadddiscussionall":"addon.mod_forum.cannotadddiscussion"))}))}))):(this.showGroups=!1,this.newDiscussion.postToAllGroups=!1,i.push(b.a.ignoreErrors(h.a.instance.canAddDiscussionToAll(this.forumId,{cmId:this.cmId}).then((e=>{this.canPin=!!e.canpindiscussions,this.canCreateAttachments=!!e.cancreateattachment}))))),i.push(h.a.getForum(this.courseId,this.cmId).then((e=>this.forum=e))),i.push(h.a.instance.getAccessInformation(this.forumId,{cmId:this.cmId}).then((e=>this.accessInfo=e))),yield Promise.all(i),this.timeCreated&&!e&&(this.syncId=p.a.getForumSyncId(this.forumId),yield p.a.waitForSync(this.syncId).then((()=>(this.isDestroyed||w.a.blockOperation(h.b.COMPONENT,this.syncId),I.a.instance.getNewDiscussion(this.forumId,this.timeCreated).then((e=>Object(a.a)(this,void 0,void 0,(function*(){if(this.hasOffline=!0,e.options=e.options||{},e.groupid==h.b.ALL_GROUPS?(this.newDiscussion.groupId=this.groups[0].id,this.newDiscussion.postToAllGroups=!0):(this.newDiscussion.groupId=e.groupid,this.newDiscussion.postToAllGroups=!1),this.newDiscussion.subject=e.subject,this.newDiscussion.message=e.message,this.newDiscussion.subscribe=!!e.options.discussionsubscribe,this.newDiscussion.pin=!!e.options.discussionpinned,this.messageControl.setValue(e.message),this.calculateGroupName(),"object"==typeof e.options.attachmentsid&&e.options.attachmentsid.offline){const e=yield v.a.getNewDiscussionStoredFiles(this.forumId,this.timeCreated);this.newDiscussion.files=e}(!this.newDiscussion.subscribe||this.newDiscussion.pin||this.newDiscussion.files.length||this.groups.length>0&&this.newDiscussion.groupId!=this.groups[0].id||this.newDiscussion.postToAllGroups)&&(this.advanced=!0)})))))))),this.originalData||(this.originalData={subject:this.newDiscussion.subject,message:this.newDiscussion.message,files:this.newDiscussion.files.slice()}),this.showForm=!0}catch(e){f.a.showErrorModalDefault(e,"addon.mod_forum.errorgetgroups",!0),this.showForm=!1}}))}validateVisibleGroups(e){return Object(a.a)(this,void 0,void 0,(function*(){let o;try{o=yield h.a.canAddDiscussionToAll(this.forumId,{cmId:this.cmId})}catch(e){o={status:!1,canpindiscussions:!1,cancreateattachment:!0}}if(this.canPin=!!o.canpindiscussions,this.canCreateAttachments=!!o.cancreateattachment,o.status)return this.addAllParticipantsOption(e,!1);const i=[],s=[];return e.forEach((e=>{i.push(h.a.instance.canAddDiscussion(this.forumId,e.id,{cmId:this.cmId}).catch((()=>({status:!0}))).then((o=>{o.status&&s.push(e)})))})),yield Promise.all(i),s}))}filterGroups(e,o){const i=o.map((e=>e.id));return e.filter((e=>i.indexOf(e.id)>-1))}getInitialGroupId(){return this.initialGroupId&&this.groups.find((e=>e.id===this.initialGroupId))?this.initialGroupId:this.groups[0].id}addAllParticipantsOption(e,o){let i;return i=o?h.a.canAddDiscussionToAll(this.forumId,{cmId:this.cmId}).then((e=>(this.canPin=!!e.canpindiscussions,this.canCreateAttachments=!!e.cancreateattachment,e.status))).catch((()=>!1)):Promise.resolve(!0),i.then((o=>(o&&e.unshift({courseid:this.courseId,id:h.b.ALL_PARTICIPANTS,name:D.J.instant("core.allparticipants")}),e)))}refreshGroups(e){const o=[l.a.invalidateActivityGroupMode(this.cmId),l.a.invalidateActivityAllowedGroups(this.cmId),h.a.invalidateCanAddDiscussion(this.forumId)];Promise.all(o).finally((()=>{this.fetchDiscussionData(!0).finally((()=>{null==e?void 0:e.complete()}))}))}returnToDiscussions(e,o){var i;this.forceLeave=!0,P.a.clearTmpFiles(this.newDiscussion.files),u.b.trigger(h.b.NEW_DISCUSSION_EVENT,{forumId:this.forumId,cmId:this.cmId,discussionIds:e,discTimecreated:o,groupId:this.showGroups&&!this.newDiscussion.postToAllGroups?this.newDiscussion.groupId:void 0},_.b.getCurrentSiteId()),(null===(i=this.splitView)||void 0===i?void 0:i.outletActivated)?(this.hasOffline=!1,this.newDiscussion.subject="",this.newDiscussion.message=null,this.newDiscussion.files=[],this.newDiscussion.postToAllGroups=!1,this.messageEditor.clearText(),this.originalData=b.a.clone(this.newDiscussion)):m.a.back()}onMessageChange(e){this.newDiscussion.message=e}add(){return Object(a.a)(this,void 0,void 0,(function*(){const e=this.forum.name,o=this.newDiscussion.subject;let i=this.newDiscussion.message||"";const s=this.newDiscussion.pin,n=this.newDiscussion.files,t=this.timeCreated||Date.now(),c={discussionsubscribe:!!this.newDiscussion.subscribe};if(!o)return f.a.showErrorModal("addon.mod_forum.erroremptysubject",!0),void 0;if(!i)return f.a.showErrorModal("addon.mod_forum.erroremptymessage",!0),void 0;const d=yield f.a.showModalLoading("core.sending",!0);i=M.a.formatHtmlLines(i),s&&(c.discussionpinned=!0);const a=this.newDiscussion.postToAllGroups?this.groupIds:[this.newDiscussion.groupId];try{const s=yield v.a.addNewDiscussion(this.forumId,e,this.courseId,o,i,n,c,a,t);s&&(v.a.deleteNewDiscussionStoredFiles(this.forumId,t),u.b.trigger(u.b.ACTIVITY_DATA_SENT,{module:"forum"})),s&&s.length<a.length&&f.a.showErrorModalDefault(null,"addon.mod_forum.errorposttoallgroups",!0),A.a.triggerFormSubmittedEvent(this.formElement,!!s,_.b.getCurrentSiteId()),this.returnToDiscussions(s,t)}catch(e){f.a.showErrorModalDefault(e,"addon.mod_forum.cannotcreatediscussion",!0)}finally{d.dismiss()}}))}discard(){return Object(a.a)(this,void 0,void 0,(function*(){try{yield f.a.showConfirm(D.J.instant("core.areyousure"));const e=[];e.push(I.a.deleteNewDiscussion(this.forumId,this.timeCreated)),e.push(b.a.ignoreErrors(v.a.deleteNewDiscussionStoredFiles(this.forumId,this.timeCreated))),yield Promise.all(e),A.a.triggerFormCancelledEvent(this.formElement,_.b.getCurrentSiteId()),this.returnToDiscussions()}catch(e){}}))}toggleAdvanced(){this.advanced=!this.advanced}calculateGroupName(){var e;this.groupName=this.newDiscussion.groupId<=0||null===(e=this.groups.find((e=>e.id===this.newDiscussion.groupId)))||void 0===e?void 0:e.name}canLeave(){return Object(a.a)(this,void 0,void 0,(function*(){return this.forceLeave||(v.a.hasPostDataChanged(this.newDiscussion,this.originalData)&&(yield f.a.showConfirm(D.J.instant("core.confirmcanceledit"))),P.a.clearTmpFiles(this.newDiscussion.files),this.formElement&&A.a.triggerFormCancelledEvent(this.formElement,_.b.getCurrentSiteId())),!0}))}ionViewWillLeave(){this.syncObserver&&this.syncObserver.off(),delete this.syncObserver}goBack(){var e;(null===(e=this.splitView)||void 0===e?void 0:e.outletActivated)?m.a.navigate("../../"):m.a.back()}ngOnDestroy(){var e;this.syncId&&w.a.unblockOperation(h.b.COMPONENT,this.syncId),this.isDestroyed=!0,null===(e=this.discussions)||void 0===e||e.destroy()}}return AddonModForumNewDiscussionPage.ɵfac=function AddonModForumNewDiscussionPage_Factory(e){return new(e||AddonModForumNewDiscussionPage)(E.yc(s.a),E.yc(F.a,8))},AddonModForumNewDiscussionPage.ɵcmp=E.sc({type:AddonModForumNewDiscussionPage,selectors:[["page-addon-mod-forum-new-discussion"]],viewQuery:function AddonModForumNewDiscussionPage_Query(e,o){var i;(1&e&&(E.ud(L,!0),E.ud(g.a,!0)),2&e)&&(E.dd(i=E.Nc())&&(o.formElement=i.first),E.dd(i=E.Nc())&&(o.messageEditor=i.first))},decls:16,vars:13,consts:[["slot","start"],[3,"text"],["slot","end"],[3,"core-swipe-navigation"],["slot","fixed",3,"disabled","ionRefresh"],[3,"pullingText"],[3,"hideUntil"],[4,"ngIf"],["newDiscFormEl",""],["position","stacked"],["type","text","name","subject",3,"ngModel","placeholder","ngModelChange"],["name","addon_mod_forum_new_discussion","contextLevel","module","elementId","message",3,"control","placeholder","component","componentId","autoSave","contextInstanceId","contentChanged"],["button","","detail","false","role","heading","aria-controls","addon-mod-forum-new-discussion-advanced",1,"divider","ion-text-wrap",3,"click"],["name","fas-chevron-right","flip-rtl","","slot","start","aria-hidden","true",1,"expandable-status-icon"],["id","addon-mod-forum-new-discussion-advanced",4,"ngIf"],["class","addon-forum-group-info",4,"ngIf"],[1,"addon-forum-new-discussion-buttons"],["expand","block",3,"disabled","click"],["id","addon-mod-forum-new-discussion-advanced"],["class","core-edit-set-group",4,"ngIf"],["name","subscribe",3,"ngModel","ngModelChange"],[3,"files","maxSize","maxSubmissions","component","componentId","allowOffline","courseId",4,"ngIf"],["name","postallgroups",3,"ngModel","ngModelChange"],[1,"core-edit-set-group"],["id","addon-mod-forum-groupslabel"],["aria-labelledby","addon-mod-forum-groupslabel","interface","action-sheet","name","groupid",3,"ngModel","disabled","interfaceOptions","ngModelChange","ionChange"],[3,"value",4,"ngFor","ngForOf"],[3,"value"],["name","pin",3,"ngModel","ngModelChange"],[3,"files","maxSize","maxSubmissions","component","componentId","allowOffline","courseId"],[1,"addon-forum-group-info"],["name","fas-info-circle","slot","start","aria-hidden","true"],["expand","block","fill","outline",3,"click"]],template:function AddonModForumNewDiscussionPage_Template(e,o){1&e&&(E.Ec(0,"ion-header"),E.Ec(1,"ion-toolbar"),E.Ec(2,"ion-buttons",0),E.zc(3,"ion-back-button",1),E.Pc(4,"translate"),E.Dc(),E.Ec(5,"ion-title"),E.Ec(6,"h1"),E.pd(7),E.Pc(8,"translate"),E.Dc(),E.Dc(),E.zc(9,"ion-buttons",2),E.Dc(),E.Dc(),E.Ec(10,"ion-content",3),E.Ec(11,"ion-refresher",4),E.Mc("ionRefresh",(function AddonModForumNewDiscussionPage_Template_ion_refresher_ionRefresh_11_listener(e){return o.refreshGroups(e.target)})),E.zc(12,"ion-refresher-content",5),E.Pc(13,"translate"),E.Dc(),E.Ec(14,"core-loading",6),E.nd(15,AddonModForumNewDiscussionPage_form_15_Template,31,34,"form",7),E.Dc(),E.Dc()),2&e&&(E.lc(3),E.Vc("text",E.Qc(4,7,"core.back")),E.lc(4),E.qd(E.Qc(8,9,"addon.mod_forum.addanewdiscussion")),E.lc(3),E.Vc("core-swipe-navigation",o.discussions),E.lc(1),E.Vc("disabled",!o.groupsLoaded),E.lc(1),E.Wc("pullingText",E.Qc(13,11,"core.pulltorefresh")),E.lc(2),E.Vc("hideUntil",o.groupsLoaded),E.lc(1),E.Vc("ngIf",o.showForm))},directives:[T.C,T.Ab,T.m,T.h,T.i,T.yb,y.a,T.v,S.a,T.bb,T.cb,G.a,x.t,r.H,r.s,r.t,T.I,T.O,T.H,T.Pb,r.r,r.u,g.a,T.D,V.a,T.hb,T.u,j.a,T.l,T.zb,T.d,T.lb,T.Ob,x.s,T.mb,k.a],pipes:[R.d],styles:["[_nghost-%COMP%]   .addon-forum-group-info[_ngcontent-%COMP%] > ion-icon[slot][_ngcontent-%COMP%]{color:var(--ion-color-info);margin-right:16px}@supports ((-webkit-margin-start:0) or (margin-inline-start:0)) or (-webkit-margin-start:0){[_nghost-%COMP%]   .addon-forum-group-info[_ngcontent-%COMP%] > ion-icon[slot][_ngcontent-%COMP%]{margin-right:unset;-webkit-margin-end:16px;margin-inline-end:16px}}[_nghost-%COMP%]   .addon-forum-new-discussion-buttons[_ngcontent-%COMP%]   ion-label[_ngcontent-%COMP%]{margin-top:0}[_nghost-%COMP%]   .addon-forum-new-discussion-buttons[_ngcontent-%COMP%]   ion-col[_ngcontent-%COMP%]{padding-top:0;padding-bottom:0}"]}),AddonModForumNewDiscussionPage})();class new_discussion_page_AddonModForumNewDiscussionDiscussionsSwipeManager extends N.a{getSelectedItemPathFromRoute(e){return`${this.getSource().DISCUSSIONS_PATH_PREFIX}new/${e.params.timeCreated}`}}const q=[{path:"",component:Q,canDeactivate:[t.a]}];let U=(()=>{class AddonForumNewDiscussionPageModule{}return AddonForumNewDiscussionPageModule.ɵmod=E.wc({type:AddonForumNewDiscussionPageModule}),AddonForumNewDiscussionPageModule.ɵinj=E.vc({factory:function AddonForumNewDiscussionPageModule_Factory(e){return new(e||AddonForumNewDiscussionPageModule)},imports:[[s.m.forChild(q),d.a,n.a,c.a]]}),AddonForumNewDiscussionPageModule})();void(("undefined"==typeof ngJitMode||ngJitMode)&&E.kd(U,{declarations:[Q],imports:[s.m,d.a,n.a,c.a]}))},eoiU:function(e,o,i){"use strict";i.d(o,"a",(function(){return CoreSwipeNavigationItemsManager}));var s=i("mrSG"),n=i("pHTc"),t=i("CtbY");class CoreSwipeNavigationItemsManager extends t.a{start(){return Object(s.a)(this,void 0,void 0,(function*(){this.updateSelectedItem()}))}navigateToNextItem(){return Object(s.a)(this,void 0,void 0,(function*(){yield this.navigateToItemBy(1,"forward")}))}navigateToPreviousItem(){return Object(s.a)(this,void 0,void 0,(function*(){yield this.navigateToItemBy(-1,"back")}))}hasNextItem(){return Object(s.a)(this,void 0,void 0,(function*(){return!!(yield this.getItemBy(1))}))}hasPreviousItem(){return Object(s.a)(this,void 0,void 0,(function*(){return!!(yield this.getItemBy(-1))}))}getCurrentPageRoute(){return n.a.getCurrentRoute()}getSelectedItemPathFromRoute(e){const o=[];for(;e&&(o.push(...e.url),e.firstChild);)e=e.firstChild;return o.map((e=>e.path)).join("/").replace(/\/+/,"/").trim()||null}navigateToItemBy(e,o){return Object(s.a)(this,void 0,void 0,(function*(){const i=yield this.getItemBy(e);i&&(yield this.navigateToItem(i,{animationDirection:o,replace:!0}))}))}getItemBy(e){var o;return Object(s.a)(this,void 0,void 0,(function*(){const i=this.getSource().getItems(),s=null!==(o=this.selectedItem&&(null==i?void 0:i.indexOf(this.selectedItem)))&&void 0!==o?o:-1;if(-1===s||null===i)return null;const n=e>0?1:-1;let t=s,c=0;for(;c!==e&&(t+=n,!(t<0||t>=i.length));)this.skipItemInSwipe(i[t])||(c+=n);return c===e?i[t]:this.getSource().isCompleted()?null:(yield this.getSource().load(),this.getItemBy(e))}))}skipItemInSwipe(e){return!1}}}}]);
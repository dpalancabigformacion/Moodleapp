(window.webpackJsonp=window.webpackJsonp||[]).push([[92],{"ABl/":function(e,o,t){"use strict";t.r(o),t.d(o,"CoreCourseIndexPageModule",(function(){return V}));var r=t("fXoL"),s=t("tyNb"),c=t("vY5A"),n=t("L3Fv"),i=t("mrSG"),a=t("NhJP"),u=t("blhJ"),l=t("nxay"),d=t("fjkH"),h=t("ULAo"),g=t("GBcW"),m=t("bFG1"),p=t("pHTc"),C=t("fxbH"),b=t("3LXp"),P=t("ZSwf"),_=t("Hu/H"),v=t("9cfD"),f=t("TEn/"),I=t("4JiN"),x=t("hMzs"),O=t("ACYt"),M=t("3CSS"),T=t("ofXK"),y=t("NcPy"),E=t("TKc2"),N=t("sYmb");const w=["courseThumb"];function CoreCourseIndexPage_ng_container_14_div_1_ion_icon_2_Template(e,o){1&e&&r.zc(0,"ion-icon",16)}function CoreCourseIndexPage_ng_container_14_div_1_Template(e,o){if(1&e&&(r.Ec(0,"div",13,14),r.nd(2,CoreCourseIndexPage_ng_container_14_div_1_ion_icon_2_Template,1,0,"ion-icon",15),r.Dc()),2&e){const e=r.Oc(2);r.lc(2),r.Vc("ngIf",!e.course.courseImage)}}function CoreCourseIndexPage_ng_container_14_ion_avatar_2_Template(e,o){if(1&e&&(r.Ec(0,"ion-avatar",13),r.zc(1,"img",17),r.Dc()),2&e){const e=r.Oc(2);r.lc(1),r.Vc("src",e.course.courseImage,r.id)}}function CoreCourseIndexPage_ng_container_14_Template(e,o){if(1&e&&(r.Cc(0),r.nd(1,CoreCourseIndexPage_ng_container_14_div_1_Template,3,1,"div",12),r.nd(2,CoreCourseIndexPage_ng_container_14_ion_avatar_2_Template,2,1,"ion-avatar",12),r.Bc()),2&e){const e=r.Oc();r.lc(1),r.Vc("ngIf",!e.course.courseImage),r.lc(1),r.Vc("ngIf",e.course.courseImage)}}function CoreCourseIndexPage_div_18_Template(e,o){if(1&e&&(r.Ec(0,"div",18),r.zc(1,"core-progress-bar",19),r.Dc()),2&e){const e=r.Oc();r.lc(1),r.Vc("progress",e.progress)}}let D=(()=>{class CoreCourseIndexPage{constructor(e){this.route=e,this.title="",this.category="",this.tabs=[],this.loaded=!1,this.currentPagePath="",this.sections=[],this.isGuest=!1,this.openModule=!0,this.contentsTab={page:C.a,title:"core.course",pageParams:{}},this.selectTabObserver=d.b.on(d.b.SELECT_COURSE_TAB,(e=>{var o,t;if(e.name){if(this.tabs){const o=this.tabs.findIndex((o=>o.name==e.name));o>=0&&(null===(t=this.tabsComponent)||void 0===t?void 0:t.selectByIndex(o))}}else e.sectionId&&(this.contentsTab.pageParams.sectionId=e.sectionId),e.sectionNumber&&(this.contentsTab.pageParams.sectionNumber=e.sectionNumber),null===(o=this.tabsComponent)||void 0===o||o.selectByIndex(0)})),this.completionObserver=d.b.on(d.b.MANUAL_COMPLETION_CHANGED,(e=>{var o;if(e.completion.courseId!=(null===(o=this.course)||void 0===o?void 0:o.id))return;if(!1!==e.completion.valueused||!this.course||!("progress"in this.course)||"number"!=typeof this.course.progress)return;const t=[].concat(...this.sections.map((e=>e.modules))).map((e=>e.completion&&e.completion>0?1:e.completion)).reduce(((e,o)=>(e||0)+(o||0)),0),r=100/(t||1);this.course.progress=e.completion.state===h.c.COMPLETION_COMPLETE?Math.min(100,this.course.progress+r):Math.max(0,this.course.progress-r),this.updateProgress()}))}ngOnInit(){var e;return Object(i.a)(this,void 0,void 0,(function*(){const o=p.a.getRouteFullPath(this.route.snapshot);p.a.increaseRouteDepth(o.replace(/(\/deep)+/,""));try{this.course=p.a.getRequiredRouteParam("course")}catch(e){return b.a.showErrorModal(e),p.a.back(),this.loaded=!0,void 0}if(this.firstTabName=p.a.getRouteParam("selectedTab"),this.module=p.a.getRouteParam("module"),this.isGuest=!!p.a.getRouteBooleanParam("isGuest"),this.modNavOptions=p.a.getRouteParam("modNavOptions"),this.openModule=null===(e=p.a.getRouteBooleanParam("openModule"))||void 0===e||e,!this.modNavOptions){const e=p.a.getRouteParam("modParams");e&&(this.modNavOptions={params:e})}this.currentPagePath=p.a.getCurrentPath(),this.contentsTab.page=v.a.concatenatePaths(this.currentPagePath,this.contentsTab.page),this.contentsTab.pageParams={course:this.course,sectionId:p.a.getRouteNumberParam("sectionId"),sectionNumber:p.a.getRouteNumberParam("sectionNumber"),isGuest:this.isGuest},this.module&&(this.contentsTab.pageParams.moduleId=this.module.id,this.contentsTab.pageParams.sectionId||this.contentsTab.pageParams.sectionNumber||(this.contentsTab.pageParams.sectionId=this.module.section)),this.tabs.push(this.contentsTab),this.loaded=!0,yield Promise.all([this.loadCourseHandlers(),this.loadBasinInfo()])}))}tabSelected(){this.module&&this.course&&this.openModule&&(g.a.openModule(this.module,this.course.id,{sectionId:this.contentsTab.pageParams.sectionId,modNavOptions:this.modNavOptions}),delete this.module)}loadCourseHandlers(){var e;return Object(i.a)(this,void 0,void 0,(function*(){if(!this.course)return;const o=yield l.a.getHandlersToDisplay(this.course,!1,this.isGuest);let t;o.forEach(((e,o)=>{e.data.page=v.a.concatenatePaths(this.currentPagePath,e.data.page),e.data.pageParams=e.data.pageParams||{},this.firstTabName&&e.name==this.firstTabName&&(t=o+1)})),this.tabs=[...this.tabs,...o.map((e=>Object.assign(Object.assign({},e.data),{name:e.name})))],this.firstTabName=void 0,t&&(yield m.a.nextTick(),null===(e=this.tabsComponent)||void 0===e||e.selectByIndex(t))}))}loadBasinInfo(){return Object(i.a)(this,void 0,void 0,(function*(){this.course&&(this.title=u.a.getCourseTitle(this.course),yield this.setCourseColor(),this.updateProgress(),this.sections=yield m.a.ignoreErrors(h.a.getSections(this.course.id,!1,!0),[]),this.sections&&(this.title=u.a.getCourseTitle(this.course,this.sections)))}))}ngOnDestroy(){var e,o;const t=p.a.getRouteFullPath(this.route.snapshot);p.a.decreaseRouteDepth(t.replace(/(\/deep)+/,"")),null===(e=this.selectTabObserver)||void 0===e||e.off(),null===(o=this.completionObserver)||void 0===o||o.off()}ionViewDidEnter(){var e;null===(e=this.tabsComponent)||void 0===e?void 0:e.ionViewDidEnter()}ionViewDidLeave(){var e;null===(e=this.tabsComponent)||void 0===e?void 0:e.ionViewDidLeave()}openCourseSummary(){this.course&&g.a.openCourseSummary(this.course)}updateProgress(){if(!this.course||!("progress"in this.course)||"number"!=typeof this.course.progress||this.course.progress<0||!1===this.course.completionusertracked)return this.progress=void 0,void 0;this.progress=this.course.progress}setCourseColor(){return Object(i.a)(this,void 0,void 0,(function*(){if(this.course&&(yield P.a.loadCourseColorAndImage(this.course),this.courseThumb))if(this.course.color){this.courseThumb.nativeElement.style.setProperty("--course-color",this.course.color);const e=_.a.lighter(this.course.color,50);this.courseThumb.nativeElement.style.setProperty("--course-color-tint",e)}else void 0!==this.course.colorNumber&&this.courseThumb.nativeElement.classList.add("course-color-"+this.course.colorNumber)}))}}return CoreCourseIndexPage.ɵfac=function CoreCourseIndexPage_Factory(e){return new(e||CoreCourseIndexPage)(r.yc(s.a))},CoreCourseIndexPage.ɵcmp=r.sc({type:CoreCourseIndexPage,selectors:[["page-core-course-index"]],viewQuery:function CoreCourseIndexPage_Query(e,o){var t;(1&e&&(r.ud(a.a,!0),r.ud(w,!0)),2&e)&&(r.dd(t=r.Nc())&&(o.tabsComponent=t.first),r.dd(t=r.Nc())&&(o.courseThumb=t.first))},decls:20,vars:15,consts:[[3,"collapsible"],["slot","start"],[3,"text"],["contextLevel","course",3,"text","contextInstanceId"],["slot","end"],["fill","clear",3,"click"],["name","fas-info-circle","slot","icon-only","aria-hidden","true"],[1,"core-course-header"],["collapsible","",1,"core-format-progress-list","ion-text-wrap","list-item-limited-width"],[4,"ngIf"],["class","core-course-progress",4,"ngIf"],[3,"tabs","hideUntil","ionChange"],["slot","start","class","core-course-thumb",4,"ngIf"],["slot","start",1,"core-course-thumb"],["courseThumb",""],["name","fas-graduation-cap","class","course-icon","aria-hidden","true",4,"ngIf"],["name","fas-graduation-cap","aria-hidden","true",1,"course-icon"],["core-external-content","","alt","",3,"src"],[1,"core-course-progress"],["a11yText","core.course.aria:sectionprogress",3,"progress"]],template:function CoreCourseIndexPage_Template(e,o){1&e&&(r.Ec(0,"ion-header",0),r.Ec(1,"ion-toolbar"),r.Ec(2,"ion-buttons",1),r.zc(3,"ion-back-button",2),r.Pc(4,"translate"),r.Dc(),r.Ec(5,"ion-title"),r.Ec(6,"h1"),r.zc(7,"core-format-text",3),r.Dc(),r.Dc(),r.Ec(8,"ion-buttons",4),r.Ec(9,"ion-button",5),r.Mc("click",(function CoreCourseIndexPage_Template_ion_button_click_9_listener(){return o.openCourseSummary()})),r.Pc(10,"translate"),r.zc(11,"ion-icon",6),r.Dc(),r.Dc(),r.Dc(),r.Dc(),r.Ec(12,"div",7),r.Ec(13,"ion-item",8),r.nd(14,CoreCourseIndexPage_ng_container_14_Template,3,2,"ng-container",9),r.Ec(15,"ion-label"),r.Ec(16,"h1"),r.zc(17,"core-format-text",3),r.Dc(),r.nd(18,CoreCourseIndexPage_div_18_Template,2,1,"div",10),r.Dc(),r.Dc(),r.Dc(),r.Ec(19,"core-tabs-outlet",11),r.Mc("ionChange",(function CoreCourseIndexPage_Template_core_tabs_outlet_ionChange_19_listener(){return o.tabSelected()})),r.Dc()),2&e&&(r.Vc("collapsible",0==(null==o.tabsComponent?null:o.tabsComponent.selectedIndex)||void 0===(null==o.tabsComponent?null:o.tabsComponent.selectedIndex)),r.lc(3),r.Vc("text",r.Qc(4,11,"core.back")),r.lc(4),r.Vc("text",o.title)("contextInstanceId",null==o.course?null:o.course.id),r.lc(2),r.mc("aria-label",r.Qc(10,13,"core.course.coursesummary")),r.lc(5),r.Vc("ngIf",o.course),r.lc(3),r.Vc("text",o.title)("contextInstanceId",null==o.course?null:o.course.id),r.lc(1),r.Vc("ngIf",void 0!==o.progress),r.lc(1),r.Vc("tabs",o.tabs)("hideUntil",o.loaded))},directives:[f.C,I.b,f.Ab,f.m,f.h,f.i,f.yb,x.a,O.a,f.l,f.D,M.a,f.I,T.t,f.O,a.a,f.g,y.a,E.a],pipes:[N.d],styles:["[_nghost-%COMP%]   .core-format-progress-list[_ngcontent-%COMP%]{width:100%}[_nghost-%COMP%]   .core-course-thumb[_ngcontent-%COMP%]{height:var(--core-courseimage-on-course-size);min-height:var(--core-courseimage-on-course-size);width:var(--core-courseimage-on-course-size);min-width:var(--core-courseimage-on-course-size);--border-radius:var(--core-courseimage-radius);margin:8px 16px 8px 0}@supports ((-webkit-margin-start:0) or (margin-inline-start:0)) or (-webkit-margin-start:0){[_nghost-%COMP%]   .core-course-thumb[_ngcontent-%COMP%]{margin-left:unset;margin-right:unset;-webkit-margin-start:0;margin-inline-start:0;-webkit-margin-end:16px;margin-inline-end:16px}}[_nghost-%COMP%]   .core-course-thumb.course-color-0[_ngcontent-%COMP%]{--course-color:var(--core-course-color-0);--course-color-tint:var(--core-course-color-0-tint)}[_nghost-%COMP%]   .core-course-thumb.course-color-1[_ngcontent-%COMP%]{--course-color:var(--core-course-color-1);--course-color-tint:var(--core-course-color-1-tint)}[_nghost-%COMP%]   .core-course-thumb.course-color-2[_ngcontent-%COMP%]{--course-color:var(--core-course-color-2);--course-color-tint:var(--core-course-color-2-tint)}[_nghost-%COMP%]   .core-course-thumb.course-color-3[_ngcontent-%COMP%]{--course-color:var(--core-course-color-3);--course-color-tint:var(--core-course-color-3-tint)}[_nghost-%COMP%]   .core-course-thumb.course-color-4[_ngcontent-%COMP%]{--course-color:var(--core-course-color-4);--course-color-tint:var(--core-course-color-4-tint)}[_nghost-%COMP%]   .core-course-thumb.course-color-5[_ngcontent-%COMP%]{--course-color:var(--core-course-color-5);--course-color-tint:var(--core-course-color-5-tint)}[_nghost-%COMP%]   .core-course-thumb.course-color-6[_ngcontent-%COMP%]{--course-color:var(--core-course-color-6);--course-color-tint:var(--core-course-color-6-tint)}[_nghost-%COMP%]   .core-course-thumb.course-color-7[_ngcontent-%COMP%]{--course-color:var(--core-course-color-7);--course-color-tint:var(--core-course-color-7-tint)}[_nghost-%COMP%]   .core-course-thumb.course-color-8[_ngcontent-%COMP%]{--course-color:var(--core-course-color-8);--course-color-tint:var(--core-course-color-8-tint)}[_nghost-%COMP%]   .core-course-thumb.course-color-9[_ngcontent-%COMP%]{--course-color:var(--core-course-color-9);--course-color-tint:var(--core-course-color-9-tint)}[_nghost-%COMP%]   .core-course-thumb[_ngcontent-%COMP%]   ion-icon.course-icon[_ngcontent-%COMP%]{padding:12px;font-size:calc(var(--core-courseimage-on-course-size) - 24px);border-radius:var(--border-radius);color:var(--course-color-tint);background:var(--course-color,transparent)}[_nghost-%COMP%]   h1[_ngcontent-%COMP%]{font-size:20px}[_nghost-%COMP%]   .core-course-header[_ngcontent-%COMP%]{background:var(--ion-item-background)}"]}),CoreCourseIndexPage})();var k=t("8jEl"),R=t("I3gK");function buildRoutes(e){const o=Object(c.d)(e,k.a);return[{path:"",component:D,data:{isCourseIndex:!0},children:o.children},...o.siblings]}let V=(()=>{class CoreCourseIndexPageModule{}return CoreCourseIndexPageModule.ɵmod=r.wc({type:CoreCourseIndexPageModule}),CoreCourseIndexPageModule.ɵinj=r.vc({factory:function CoreCourseIndexPageModule_Factory(e){return new(e||CoreCourseIndexPageModule)},providers:[{provide:s.g,multi:!0,useFactory:buildRoutes,deps:[r.x]}],imports:[[n.a,R.CoreCoursePreviewPageComponentModule],s.m]}),CoreCourseIndexPageModule})();void(("undefined"==typeof ngJitMode||ngJitMode)&&r.kd(V,{declarations:[D],imports:[n.a,R.CoreCoursePreviewPageComponentModule],exports:[s.m]}))}}]);
{"code":"(window.webpackJsonp=window.webpackJsonp||[]).push([[82],{Iaui:function(e,s,t){\"use strict\";t.r(s),t.d(s,\"AddonModWorkshopLazyModule\",(function(){return ms}));var o=t(\"tyNb\"),a=t(\"MLi9\"),i=t(\"L3Fv\"),n=t(\"ghUQ\"),r=t(\"pHTc\"),d=t(\"20uA\"),c=t(\"fXoL\"),l=t(\"TEn/\"),h=t(\"4JiN\"),m=t(\"hMzs\"),u=t(\"nt/U\"),p=t(\"sYmb\");let g=(()=>{class AddonModWorkshopIndexPage extends n.a{constructor(){super(...arguments),this.selectedGroup=0}ngOnInit(){super.ngOnInit(),this.selectedGroup=r.a.getRouteNumberParam(\"group\")||0}}return AddonModWorkshopIndexPage.ɵfac=function AddonModWorkshopIndexPage_Factory(e){return f(e||AddonModWorkshopIndexPage)},AddonModWorkshopIndexPage.ɵcmp=c.sc({type:AddonModWorkshopIndexPage,selectors:[[\"page-addon-mod-workshop-index\"]],viewQuery:function AddonModWorkshopIndexPage_Query(e,s){var t;(1&e&&c.ud(d.a,!0),2&e)&&(c.dd(t=c.Nc())&&(s.activityComponent=t.first))},features:[c.ic],decls:14,vars:13,consts:[[\"collapsible\",\"\"],[\"slot\",\"start\"],[3,\"text\"],[\"contextLevel\",\"module\",3,\"text\",\"contextInstanceId\",\"courseId\"],[\"slot\",\"end\"],[1,\"limited-width\"],[\"slot\",\"fixed\",3,\"disabled\",\"ionRefresh\"],[3,\"pullingText\"],[3,\"module\",\"courseId\",\"group\",\"dataRetrieved\"]],template:function AddonModWorkshopIndexPage_Template(e,s){1&e&&(c.Ec(0,\"ion-header\",0),c.Ec(1,\"ion-toolbar\"),c.Ec(2,\"ion-buttons\",1),c.zc(3,\"ion-back-button\",2),c.Pc(4,\"translate\"),c.Dc(),c.Ec(5,\"ion-title\"),c.Ec(6,\"h1\"),c.zc(7,\"core-format-text\",3),c.Dc(),c.Dc(),c.zc(8,\"ion-buttons\",4),c.Dc(),c.Dc(),c.Ec(9,\"ion-content\",5),c.Ec(10,\"ion-refresher\",6),c.Mc(\"ionRefresh\",(function AddonModWorkshopIndexPage_Template_ion_refresher_ionRefresh_10_listener(e){return null==s.activityComponent?null:s.activityComponent.doRefresh(e.target)})),c.zc(11,\"ion-refresher-content\",7),c.Pc(12,\"translate\"),c.Dc(),c.Ec(13,\"addon-mod-workshop-index\",8),c.Mc(\"dataRetrieved\",(function AddonModWorkshopIndexPage_Template_addon_mod_workshop_index_dataRetrieved_13_listener(e){return s.updateData(e)})),c.Dc(),c.Dc()),2&e&&(c.lc(3),c.Vc(\"text\",c.Qc(4,9,\"core.back\")),c.lc(4),c.Vc(\"text\",s.title)(\"contextInstanceId\",s.module.id)(\"courseId\",s.courseId),c.lc(3),c.Vc(\"disabled\",null==s.activityComponent?null:s.activityComponent.showLoading),c.lc(1),c.Wc(\"pullingText\",c.Qc(12,11,\"core.pulltorefresh\")),c.lc(2),c.Vc(\"module\",s.module)(\"courseId\",s.courseId)(\"group\",s.selectedGroup))},directives:[l.C,h.b,l.Ab,l.m,l.h,l.i,l.yb,m.a,u.a,l.v,l.bb,l.cb,d.a],pipes:[p.d],encapsulation:2}),AddonModWorkshopIndexPage})();const f=c.Gc(g);var _=t(\"Ie1r\"),b=t(\"WoAp\"),v=t(\"ekpb\"),I=t(\"mrSG\"),k=t(\"3Pt+\"),w=t(\"ULAo\"),A=t(\"FvYb\"),E=t(\"4pns\"),P=t(\"9+EE\"),D=t(\"uT8i\"),y=t(\"3LXp\"),M=t(\"vuGA\"),x=t(\"j3ag\"),W=t(\"fjkH\"),S=t(\"4reR\"),T=t(\"i1f9\"),O=t(\"8/zp\"),F=t(\"EyWp\"),V=t(\"GuJL\"),L=t(\"ACYt\"),C=t(\"ofXK\"),R=t(\"PgjG\"),q=t(\"FeAf\"),G=t(\"Lkkz\"),N=t(\"FasJ\"),z=t(\"N5Lt\");const Q=[\"evaluateFormEl\"];function AddonModWorkshopAssessmentPage_ion_refresher_13_Template(e,s){if(1&e){const e=c.Fc();c.Ec(0,\"ion-refresher\",15),c.Mc(\"ionRefresh\",(function AddonModWorkshopAssessmentPage_ion_refresher_13_Template_ion_refresher_ionRefresh_0_listener(s){c.fd(e);return c.Oc().refreshAssessment(s.target)})),c.zc(1,\"ion-refresher-content\",16),c.Pc(2,\"translate\"),c.Dc()}if(2&e){const e=c.Oc();c.Vc(\"disabled\",!e.loaded),c.lc(1),c.Wc(\"pullingText\",c.Qc(2,2,\"core.pulltorefresh\"))}}function AddonModWorkshopAssessmentPage_core_user_avatar_16_Template(e,s){if(1&e&&c.zc(0,\"core-user-avatar\",17),2&e){const e=c.Oc();c.Vc(\"user\",e.profile)(\"courseId\",e.courseId)(\"userId\",e.profile.id)}}function AddonModWorkshopAssessmentPage_h2_18_Template(e,s){if(1&e&&(c.Ec(0,\"h2\"),c.pd(1),c.Dc()),2&e){const e=c.Oc();c.lc(1),c.qd(e.profile.fullname)}}const _c1=function(e){return{$a:e}};function AddonModWorkshopAssessmentPage_p_19_Template(e,s){if(1&e&&(c.Ec(0,\"p\"),c.pd(1),c.Pc(2,\"translate\"),c.Dc()),2&e){const e=c.Oc();c.lc(1),c.sd(\" \",c.Rc(2,2,\"addon.mod_workshop.submissiongradeof\",c.ad(5,_c1,e.workshop.grade)),\": \",e.assessment.grade,\" \")}}function AddonModWorkshopAssessmentPage_p_20_Template(e,s){if(1&e&&(c.Ec(0,\"p\"),c.pd(1),c.Pc(2,\"translate\"),c.Dc()),2&e){const e=c.Oc();c.qc(\"core-has-overriden-grade\",e.showGrade(e.assessment.gradinggrade)),c.lc(1),c.sd(\" \",c.Rc(2,4,\"addon.mod_workshop.gradinggradeof\",c.ad(7,_c1,e.workshop.gradinggrade)),\": \",e.assessment.gradinggrade,\" \")}}function AddonModWorkshopAssessmentPage_p_21_Template(e,s){if(1&e&&(c.Ec(0,\"p\",18),c.pd(1),c.Pc(2,\"translate\"),c.Dc()),2&e){const e=c.Oc();c.lc(1),c.sd(\" \",c.Qc(2,2,\"addon.mod_workshop.gradinggradeover\"),\": \",e.assessment.gradinggradeover,\" \")}}function AddonModWorkshopAssessmentPage_p_22_Template(e,s){if(1&e&&(c.Ec(0,\"p\"),c.pd(1),c.Pc(2,\"translate\"),c.Dc()),2&e){const e=c.Oc();c.lc(1),c.rd(\" \",c.Rc(2,1,\"addon.mod_workshop.weightinfo\",c.ad(4,_c1,e.assessment.weight)),\" \")}}function AddonModWorkshopAssessmentPage_ion_badge_23_Template(e,s){1&e&&(c.Ec(0,\"ion-badge\",19),c.pd(1),c.Pc(2,\"translate\"),c.Dc()),2&e&&(c.lc(1),c.rd(\" \",c.Qc(2,1,\"addon.mod_workshop.notassessed\"),\" \"))}function AddonModWorkshopAssessmentPage_addon_mod_workshop_assessment_strategy_24_Template(e,s){if(1&e&&c.zc(0,\"addon-mod-workshop-assessment-strategy\",20),2&e){const e=c.Oc();c.Vc(\"workshop\",e.workshop)(\"access\",e.access)(\"assessmentId\",e.assessmentId)(\"userId\",e.profile&&e.profile.id)(\"strategy\",e.strategy)}}function AddonModWorkshopAssessmentPage_form_25_ion_item_7_ion_select_option_7_Template(e,s){if(1&e&&(c.Ec(0,\"ion-select-option\",28),c.pd(1),c.Dc()),2&e){const e=s.$implicit;c.Vc(\"value\",e),c.lc(1),c.qd(e)}}const _c2=function(e){return{header:e}};function AddonModWorkshopAssessmentPage_form_25_ion_item_7_Template(e,s){if(1&e&&(c.Ec(0,\"ion-item\",7),c.Ec(1,\"ion-label\",24),c.Ec(2,\"span\",25),c.pd(3),c.Pc(4,\"translate\"),c.Dc(),c.Dc(),c.Ec(5,\"ion-select\",26),c.Pc(6,\"translate\"),c.nd(7,AddonModWorkshopAssessmentPage_form_25_ion_item_7_ion_select_option_7_Template,2,2,\"ion-select-option\",27),c.Dc(),c.Dc()),2&e){const e=c.Oc(2);c.lc(3),c.rd(\" \",c.Qc(4,3,\"addon.mod_workshop.assessmentweight\"),\" \"),c.lc(2),c.Vc(\"interfaceOptions\",c.ad(7,_c2,c.Qc(6,5,\"addon.mod_workshop.assessmentweight\"))),c.lc(2),c.Vc(\"ngForOf\",e.weights)}}function AddonModWorkshopAssessmentPage_form_25_ion_item_15_ion_select_option_6_Template(e,s){if(1&e&&(c.Ec(0,\"ion-select-option\",28),c.pd(1),c.Dc()),2&e){const e=s.$implicit;c.Vc(\"value\",e.value),c.lc(1),c.rd(\" \",e.label,\" \")}}function AddonModWorkshopAssessmentPage_form_25_ion_item_15_Template(e,s){if(1&e&&(c.Ec(0,\"ion-item\",7),c.Ec(1,\"ion-label\",24),c.pd(2),c.Pc(3,\"translate\"),c.Dc(),c.Ec(4,\"ion-select\",29),c.Pc(5,\"translate\"),c.nd(6,AddonModWorkshopAssessmentPage_form_25_ion_item_15_ion_select_option_6_Template,2,2,\"ion-select-option\",27),c.Dc(),c.Dc()),2&e){const e=c.Oc(2);c.lc(2),c.qd(c.Qc(3,3,\"addon.mod_workshop.gradinggradeover\")),c.lc(2),c.Vc(\"interfaceOptions\",c.ad(7,_c2,c.Qc(5,5,\"addon.mod_workshop.gradinggradeover\"))),c.lc(2),c.Vc(\"ngForOf\",e.evaluationGrades)}}const _c3=function(e){return{asid:e}};function AddonModWorkshopAssessmentPage_form_25_ion_item_16_Template(e,s){if(1&e&&(c.Ec(0,\"ion-item\"),c.Ec(1,\"ion-label\",24),c.pd(2),c.Pc(3,\"translate\"),c.Dc(),c.zc(4,\"core-rich-text-editor\",30),c.Dc()),2&e){const e=c.Oc(2);c.lc(2),c.qd(c.Qc(3,5,\"addon.mod_workshop.feedbackreviewer\")),c.lc(2),c.Vc(\"control\",e.evaluateForm.controls.text)(\"autoSave\",!0)(\"contextInstanceId\",null==e.workshop?null:e.workshop.coursemodule)(\"draftExtraParams\",c.ad(7,_c3,e.assessmentId))}}function AddonModWorkshopAssessmentPage_form_25_Template(e,s){if(1&e&&(c.Ec(0,\"form\",21,22),c.Ec(2,\"ion-item\",7),c.Ec(3,\"ion-label\"),c.Ec(4,\"h2\"),c.pd(5),c.Pc(6,\"translate\"),c.Dc(),c.Dc(),c.Dc(),c.nd(7,AddonModWorkshopAssessmentPage_form_25_ion_item_7_Template,8,9,\"ion-item\",23),c.Ec(8,\"ion-item\",7),c.Ec(9,\"ion-label\"),c.Ec(10,\"h2\"),c.pd(11),c.Pc(12,\"translate\"),c.Dc(),c.Ec(13,\"p\"),c.pd(14),c.Dc(),c.Dc(),c.Dc(),c.nd(15,AddonModWorkshopAssessmentPage_form_25_ion_item_15_Template,7,9,\"ion-item\",23),c.nd(16,AddonModWorkshopAssessmentPage_form_25_ion_item_16_Template,5,9,\"ion-item\",9),c.Dc()),2&e){const e=c.Oc();c.Vc(\"formGroup\",e.evaluateForm),c.lc(5),c.qd(c.Qc(6,7,\"addon.mod_workshop.assessmentsettings\")),c.lc(2),c.Vc(\"ngIf\",null==e.access?null:e.access.canallocate),c.lc(4),c.qd(c.Qc(12,9,\"addon.mod_workshop.gradinggradecalculated\")),c.lc(3),c.qd(e.gradingGrade),c.lc(1),c.Vc(\"ngIf\",null==e.access?null:e.access.canoverridegrades),c.lc(1),c.Vc(\"ngIf\",null==e.access?null:e.access.canoverridegrades)}}function AddonModWorkshopAssessmentPage_ion_list_26_core_user_avatar_2_Template(e,s){if(1&e&&c.zc(0,\"core-user-avatar\",17),2&e){const e=c.Oc(2);c.Vc(\"user\",e.evaluateByProfile)(\"courseId\",e.courseId)(\"userId\",e.evaluateByProfile.id)}}function AddonModWorkshopAssessmentPage_ion_list_26_h2_4_Template(e,s){if(1&e&&(c.Ec(0,\"h2\"),c.pd(1),c.Pc(2,\"translate\"),c.Dc()),2&e){const e=c.Oc(2);c.lc(1),c.rd(\" \",c.Rc(2,1,\"addon.mod_workshop.feedbackby\",c.ad(4,_c1,e.evaluateByProfile.fullname)),\" \")}}function AddonModWorkshopAssessmentPage_ion_list_26_Template(e,s){if(1&e&&(c.Ec(0,\"ion-list\"),c.Ec(1,\"ion-item\",7),c.nd(2,AddonModWorkshopAssessmentPage_ion_list_26_core_user_avatar_2_Template,1,3,\"core-user-avatar\",8),c.Ec(3,\"ion-label\"),c.nd(4,AddonModWorkshopAssessmentPage_ion_list_26_h2_4_Template,3,6,\"h2\",9),c.zc(5,\"core-format-text\",2),c.Dc(),c.Dc(),c.Dc()),2&e){const e=c.Oc();c.lc(2),c.Vc(\"ngIf\",e.evaluateByProfile),c.lc(2),c.Vc(\"ngIf\",e.evaluateByProfile&&e.evaluateByProfile.fullname),c.lc(1),c.Vc(\"text\",e.evaluate.text)(\"contextInstanceId\",null==e.workshop?null:e.workshop.coursemodule)(\"courseId\",e.courseId)}}let U=(()=>{class AddonModWorkshopAssessmentPage{constructor(e){this.fb=e,this.evaluating=!1,this.loaded=!1,this.title=\"\",this.evaluate={text:\"\",grade:-1,weight:1},this.weights=[],this.evaluationGrades=[],this.originalEvaluation={text:\"\",grade:-1,weight:1},this.hasOffline=!1,this.isDestroyed=!1,this.forceLeave=!1,this.siteId=P.b.getCurrentSiteId(),this.currentUserId=P.b.getCurrentSiteUserId(),this.showGrade=O.a.showGrade,this.evaluateForm=new k.j({}),this.evaluateForm.addControl(\"weight\",this.fb.control(\"\",k.F.required)),this.evaluateForm.addControl(\"grade\",this.fb.control(\"\")),this.evaluateForm.addControl(\"text\",this.fb.control(\"\")),this.syncObserver=W.b.on(V.b.AUTO_SYNCED,(e=>{this.workshopId===e.workshopId&&(this.loaded=!1,this.refreshAllData())}),this.siteId)}ngOnInit(){try{this.assessment=r.a.getRequiredRouteParam(\"assessment\"),this.submission=r.a.getRequiredRouteParam(\"submission\"),this.profile=r.a.getRouteParam(\"profile\"),this.courseId=r.a.getRequiredRouteNumberParam(\"courseId\")}catch(e){return y.a.showErrorModal(e),r.a.back(),void 0}this.assessmentId=this.assessment.id,this.workshopId=this.submission.workshopid,this.fetchAssessmentData()}canLeave(){return Object(I.a)(this,void 0,void 0,(function*(){return!(!this.forceLeave&&this.evaluating)||(!this.hasEvaluationChanged()||(yield y.a.showConfirm(x.J.instant(\"core.confirmcanceledit\")),S.a.triggerFormCancelledEvent(this.formElement,this.siteId),!0))}))}fetchAssessmentData(){var e,s;return Object(I.a)(this,void 0,void 0,(function*(){try{this.workshop=yield T.a.getWorkshopById(this.courseId,this.workshopId),this.title=this.workshop.name,this.strategy=this.workshop.strategy;const t=yield w.a.getModuleBasicGradeInfo(this.workshop.coursemodule);if(this.maxGrade=null==t?void 0:t.grade,this.access=yield T.a.getWorkshopAccessInformation(this.workshopId,{cmId:this.workshop.coursemodule}),this.assessmentId&&(this.access.canallocate||this.access.canoverridegrades)?(this.isDestroyed||D.a.blockOperation(T.f.COMPONENT,this.workshopId),this.evaluating=!0):this.evaluating=!1,!this.evaluating&&this.workshop.phase!=T.e.PHASE_CLOSED)return;const o=yield O.a.getReviewerAssessmentById(this.workshopId,this.assessmentId,{userId:null===(e=this.profile)||void 0===e?void 0:e.id,cmId:this.workshop.coursemodule});if(this.assessment=O.a.realGradeValue(this.workshop,o),this.evaluate.text=this.assessment.feedbackreviewer||\"\",this.evaluate.weight=this.assessment.weight,this.gradingGrade=null!==(s=this.assessment.gradinggrade)&&void 0!==s?s:\"-\",this.evaluating){if(this.access.canallocate){this.weights=[];for(let e=16;e>=0;e--)this.weights[e]=e}if(this.access.canoverridegrades){const e=x.J.instant(\"addon.mod_workshop.notoverridden\");this.evaluationGrades=yield A.a.makeGradesMenu(this.workshop.gradinggrade,void 0,e,-1)}try{const e=yield F.a.getEvaluateAssessment(this.workshopId,this.assessmentId);this.hasOffline=!0,this.evaluate.weight=e.weight,this.access.canoverridegrades&&(this.evaluate.text=e.feedbacktext||\"\",this.evaluate.grade=parseInt(e.gradinggradeover,10)||-1)}catch(e){this.hasOffline=!1,this.access.canoverridegrades&&(this.evaluate.text=this.assessment.feedbackreviewer||\"\",this.evaluate.grade=parseInt(String(this.assessment.gradinggradeover),10)||-1)}finally{this.originalEvaluation.weight=this.evaluate.weight,this.access.canoverridegrades&&(this.originalEvaluation.text=this.evaluate.text,this.originalEvaluation.grade=this.evaluate.grade),this.evaluateForm.controls.weight.setValue(this.evaluate.weight),this.access.canoverridegrades&&(this.evaluateForm.controls.grade.setValue(this.evaluate.grade),this.evaluateForm.controls.text.setValue(this.evaluate.text))}}else this.workshop.phase==T.e.PHASE_CLOSED&&this.assessment.gradinggradeoverby&&(this.evaluateByProfile=yield E.a.getProfile(this.assessment.gradinggradeoverby,this.courseId,!0))}catch(e){y.a.showErrorModalDefault(e,\"mm.course.errorgetmodule\",!0)}finally{this.loaded=!0}}))}forceLeavePage(){this.forceLeave=!0,r.a.back()}hasEvaluationChanged(){if(!this.loaded||!this.evaluating)return!1;const e=this.evaluateForm.value;if(this.originalEvaluation.weight!=e.weight)return!0;if(this.access&&this.access.canoverridegrades){if(this.originalEvaluation.text!=e.text)return!0;if(this.originalEvaluation.grade!=e.grade)return!0}return!1}refreshAllData(){return Object(I.a)(this,void 0,void 0,(function*(){const e=[];e.push(T.a.invalidateWorkshopData(this.courseId)),e.push(T.a.invalidateWorkshopAccessInformationData(this.workshopId)),e.push(T.a.invalidateReviewerAssesmentsData(this.workshopId)),this.assessmentId&&(e.push(T.a.invalidateAssessmentFormData(this.workshopId,this.assessmentId)),e.push(T.a.invalidateAssessmentData(this.workshopId,this.assessmentId)));try{yield Promise.all(e)}finally{W.b.trigger(T.f.ASSESSMENT_INVALIDATED,null,this.siteId),yield this.fetchAssessmentData()}}))}refreshAssessment(e){this.loaded&&this.refreshAllData().finally((()=>{null==e?void 0:e.complete()}))}saveEvaluation(){return Object(I.a)(this,void 0,void 0,(function*(){this.hasEvaluationChanged()&&(yield this.sendEvaluation()),this.forceLeavePage()}))}sendEvaluation(){return Object(I.a)(this,void 0,void 0,(function*(){const e=yield y.a.showModalLoading(\"core.sending\",!0),s=this.evaluateForm.value,t=s.grade>=0?String(s.grade):\"\",o=M.a.formatHtmlLines(s.text);try{const a=yield T.a.evaluateAssessment(this.workshopId,this.assessmentId,this.courseId,o,s.weight,t);S.a.triggerFormSubmittedEvent(this.formElement,!!a,this.siteId);const i={workshopId:this.workshopId,assessmentId:this.assessmentId,userId:this.currentUserId};return T.a.invalidateAssessmentData(this.workshopId,this.assessmentId).finally((()=>{W.b.trigger(T.f.ASSESSMENT_SAVED,i,this.siteId)}))}catch(e){y.a.showErrorModalDefault(e,\"Cannot save assessment evaluation\")}finally{e.dismiss()}}))}ngOnDestroy(){var e;this.isDestroyed=!0,null===(e=this.syncObserver)||void 0===e||e.off(),D.a.unblockOperation(T.f.COMPONENT,this.workshopId)}}return AddonModWorkshopAssessmentPage.ɵfac=function AddonModWorkshopAssessmentPage_Factory(e){return new(e||AddonModWorkshopAssessmentPage)(c.yc(k.f))},AddonModWorkshopAssessmentPage.ɵcmp=c.sc({type:AddonModWorkshopAssessmentPage,selectors:[[\"page-addon-mod-workshop-assessment-page\"]],viewQuery:function AddonModWorkshopAssessmentPage_Query(e,s){var t;(1&e&&c.ud(Q,!0),2&e)&&(c.dd(t=c.Nc())&&(s.formElement=t.first))},decls:27,vars:22,consts:[[\"slot\",\"start\"],[3,\"text\"],[\"contextLevel\",\"module\",3,\"text\",\"contextInstanceId\",\"courseId\"],[\"slot\",\"end\",3,\"hidden\"],[\"fill\",\"clear\",3,\"click\"],[\"slot\",\"fixed\",3,\"disabled\",\"ionRefresh\",4,\"ngIf\"],[3,\"hideUntil\"],[1,\"ion-text-wrap\"],[\"slot\",\"start\",3,\"user\",\"courseId\",\"userId\",4,\"ngIf\"],[4,\"ngIf\"],[3,\"core-has-overriden-grade\",4,\"ngIf\"],[\"class\",\"core-overriden-grade\",4,\"ngIf\"],[\"color\",\"danger\",4,\"ngIf\"],[3,\"workshop\",\"access\",\"assessmentId\",\"userId\",\"strategy\",4,\"ngIf\"],[3,\"formGroup\",4,\"ngIf\"],[\"slot\",\"fixed\",3,\"disabled\",\"ionRefresh\"],[3,\"pullingText\"],[\"slot\",\"start\",3,\"user\",\"courseId\",\"userId\"],[1,\"core-overriden-grade\"],[\"color\",\"danger\"],[3,\"workshop\",\"access\",\"assessmentId\",\"userId\",\"strategy\"],[3,\"formGroup\"],[\"evaluateFormEl\",\"\"],[\"class\",\"ion-text-wrap\",4,\"ngIf\"],[\"position\",\"stacked\"],[\"core-mark-required\",\"true\"],[\"formControlName\",\"weight\",\"required\",\"true\",\"interface\",\"action-sheet\",3,\"interfaceOptions\"],[3,\"value\",4,\"ngFor\",\"ngForOf\"],[3,\"value\"],[\"formControlName\",\"grade\",\"interface\",\"action-sheet\",3,\"interfaceOptions\"],[\"name\",\"text\",\"contextLevel\",\"module\",\"elementId\",\"feedbackreviewer_editor\",3,\"control\",\"autoSave\",\"contextInstanceId\",\"draftExtraParams\"]],template:function AddonModWorkshopAssessmentPage_Template(e,s){1&e&&(c.Ec(0,\"ion-header\"),c.Ec(1,\"ion-toolbar\"),c.Ec(2,\"ion-buttons\",0),c.zc(3,\"ion-back-button\",1),c.Pc(4,\"translate\"),c.Dc(),c.Ec(5,\"ion-title\"),c.Ec(6,\"h1\"),c.zc(7,\"core-format-text\",2),c.Dc(),c.Dc(),c.Ec(8,\"ion-buttons\",3),c.Ec(9,\"ion-button\",4),c.Mc(\"click\",(function AddonModWorkshopAssessmentPage_Template_ion_button_click_9_listener(){return s.saveEvaluation()})),c.pd(10),c.Pc(11,\"translate\"),c.Dc(),c.Dc(),c.Dc(),c.Dc(),c.Ec(12,\"ion-content\"),c.nd(13,AddonModWorkshopAssessmentPage_ion_refresher_13_Template,3,4,\"ion-refresher\",5),c.Ec(14,\"core-loading\",6),c.Ec(15,\"ion-item\",7),c.nd(16,AddonModWorkshopAssessmentPage_core_user_avatar_16_Template,1,3,\"core-user-avatar\",8),c.Ec(17,\"ion-label\"),c.nd(18,AddonModWorkshopAssessmentPage_h2_18_Template,2,1,\"h2\",9),c.nd(19,AddonModWorkshopAssessmentPage_p_19_Template,3,7,\"p\",9),c.nd(20,AddonModWorkshopAssessmentPage_p_20_Template,3,9,\"p\",10),c.nd(21,AddonModWorkshopAssessmentPage_p_21_Template,3,4,\"p\",11),c.nd(22,AddonModWorkshopAssessmentPage_p_22_Template,3,6,\"p\",9),c.nd(23,AddonModWorkshopAssessmentPage_ion_badge_23_Template,3,3,\"ion-badge\",12),c.Dc(),c.Dc(),c.nd(24,AddonModWorkshopAssessmentPage_addon_mod_workshop_assessment_strategy_24_Template,1,5,\"addon-mod-workshop-assessment-strategy\",13),c.nd(25,AddonModWorkshopAssessmentPage_form_25_Template,17,11,\"form\",14),c.nd(26,AddonModWorkshopAssessmentPage_ion_list_26_Template,6,5,\"ion-list\",9),c.Dc(),c.Dc()),2&e&&(c.lc(3),c.Vc(\"text\",c.Qc(4,18,\"core.back\")),c.lc(4),c.Vc(\"text\",s.title)(\"contextInstanceId\",s.workshop&&s.workshop.coursemodule)(\"courseId\",s.courseId),c.lc(1),c.Vc(\"hidden\",!s.evaluating),c.lc(2),c.rd(\" \",c.Qc(11,20,\"core.save\"),\" \"),c.lc(3),c.Vc(\"ngIf\",!s.evaluating),c.lc(1),c.Vc(\"hideUntil\",s.loaded),c.lc(2),c.Vc(\"ngIf\",s.profile),c.lc(2),c.Vc(\"ngIf\",s.profile&&s.profile.fullname),c.lc(1),c.Vc(\"ngIf\",s.workshop&&s.assessment&&s.showGrade(s.assessment.grade)),c.lc(1),c.Vc(\"ngIf\",s.workshop&&s.access&&s.access.canviewallsubmissions&&s.assessment&&s.showGrade(s.assessment.gradinggrade)),c.lc(1),c.Vc(\"ngIf\",s.access&&s.access.canviewallsubmissions&&s.assessment&&s.showGrade(s.assessment.gradinggradeover)),c.lc(1),c.Vc(\"ngIf\",s.assessment&&s.assessment.weight&&1!=s.assessment.weight),c.lc(1),c.Vc(\"ngIf\",!s.assessment||!s.showGrade(s.assessment.grade)),c.lc(1),c.Vc(\"ngIf\",s.assessment&&s.assessmentId&&s.showGrade(s.assessment.grade)&&s.workshop&&s.access),c.lc(1),c.Vc(\"ngIf\",s.evaluating),c.lc(1),c.Vc(\"ngIf\",!s.evaluating&&s.evaluate&&s.evaluate.text))},directives:[l.C,l.Ab,l.m,l.h,l.i,l.yb,m.a,L.a,l.l,u.a,l.v,C.t,R.a,l.I,l.O,l.bb,l.cb,q.a,l.k,G.a,k.H,k.s,k.k,N.a,l.lb,l.Ob,k.r,k.i,k.C,C.s,l.mb,z.a,l.P],pipes:[p.d],encapsulation:2}),AddonModWorkshopAssessmentPage})();var j=t(\"93ts\"),B=t(\"hSQQ\"),J=t(\"EmGO\"),H=t(\"L2dF\"),Y=t(\"bFG1\"),K=t(\"M9y5\");const X=[\"editFormEl\"];function AddonModWorkshopEditSubmissionPage_form_16_ion_item_9_Template(e,s){if(1&e&&(c.Ec(0,\"ion-item\"),c.Ec(1,\"ion-label\",9),c.Ec(2,\"span\",14),c.pd(3),c.Pc(4,\"translate\"),c.Dc(),c.Dc(),c.zc(5,\"core-rich-text-editor\",15),c.Pc(6,\"translate\"),c.Dc()),2&e){const e=c.Oc(2);c.lc(2),c.Vc(\"core-mark-required\",e.textRequired),c.lc(1),c.rd(\" \",c.Qc(4,9,\"addon.mod_workshop.submissioncontent\"),\" \"),c.lc(2),c.Vc(\"control\",e.editForm.controls.content)(\"placeholder\",c.Qc(6,11,\"addon.mod_workshop.submissioncontent\"))(\"component\",e.component)(\"componentId\",e.componentId)(\"autoSave\",!0)(\"contextInstanceId\",e.module.id)(\"draftExtraParams\",e.editorExtraParams)}}function AddonModWorkshopEditSubmissionPage_form_16_core_attachments_10_Template(e,s){if(1&e&&c.zc(0,\"core-attachments\",16),2&e){const e=c.Oc(2);c.Vc(\"files\",e.attachments)(\"maxSize\",e.workshop.maxbytes)(\"maxSubmissions\",e.workshop.nattachments)(\"component\",e.component)(\"componentId\",e.workshop.coursemodule)(\"acceptedTypes\",e.workshop.submissionfiletypes)(\"required\",e.fileRequired)(\"courseId\",e.workshop.course)}}function AddonModWorkshopEditSubmissionPage_form_16_Template(e,s){if(1&e&&(c.Ec(0,\"form\",6,7),c.Ec(2,\"ion-item\",8),c.Ec(3,\"ion-label\",9),c.Ec(4,\"span\",10),c.pd(5),c.Pc(6,\"translate\"),c.Dc(),c.Dc(),c.zc(7,\"ion-input\",11),c.Pc(8,\"translate\"),c.Dc(),c.nd(9,AddonModWorkshopEditSubmissionPage_form_16_ion_item_9_Template,7,13,\"ion-item\",12),c.nd(10,AddonModWorkshopEditSubmissionPage_form_16_core_attachments_10_Template,1,8,\"core-attachments\",13),c.Dc()),2&e){const e=c.Oc();c.Vc(\"formGroup\",e.editForm),c.lc(5),c.rd(\" \",c.Qc(6,5,\"addon.mod_workshop.submissiontitle\"),\" \"),c.lc(2),c.Vc(\"placeholder\",c.Qc(8,7,\"addon.mod_workshop.submissiontitle\")),c.lc(2),c.Vc(\"ngIf\",e.textAvailable),c.lc(1),c.Vc(\"ngIf\",e.fileAvailable)}}let Z=(()=>{class AddonModWorkshopEditSubmissionPage{constructor(e){this.fb=e,this.loaded=!1,this.component=T.f.COMPONENT,this.editorExtraParams={},this.textAvailable=!1,this.textRequired=!1,this.fileAvailable=!1,this.fileRequired=!1,this.attachments=[],this.submissionId=0,this.originalData={title:\"\",content:\"\",attachmentfiles:[]},this.hasOffline=!1,this.editing=!1,this.forceLeave=!1,this.isDestroyed=!1,this.userId=P.b.getCurrentSiteUserId(),this.siteId=P.b.getCurrentSiteId(),this.editForm=new k.j({}),this.editForm.addControl(\"title\",this.fb.control(\"\",k.F.required)),this.editForm.addControl(\"content\",this.fb.control(\"\"))}ngOnInit(){try{this.module=r.a.getRequiredRouteParam(\"module\"),this.courseId=r.a.getRequiredRouteNumberParam(\"courseId\"),this.access=r.a.getRequiredRouteParam(\"access\"),this.submissionId=r.a.getRouteNumberParam(\"submissionId\")||0}catch(e){return y.a.showErrorModal(e),r.a.back(),void 0}this.submissionId>0&&(this.editorExtraParams.id=this.submissionId),this.workshopId=this.module.instance,this.componentId=this.module.id,this.isDestroyed||D.a.blockOperation(this.component,this.workshopId),this.fetchSubmissionData()}canLeave(){var e;return Object(I.a)(this,void 0,void 0,(function*(){return this.forceLeave||(this.hasDataChanged()&&(yield y.a.showConfirm(x.J.instant(\"core.confirmcanceledit\"))),(null===(e=this.submission)||void 0===e?void 0:e.attachmentfiles)&&B.a.clearTmpFiles(this.submission.attachmentfiles),S.a.triggerFormCancelledEvent(this.formElement,this.siteId)),!0}))}fetchSubmissionData(){return Object(I.a)(this,void 0,void 0,(function*(){try{if(this.workshop=yield T.a.getWorkshop(this.courseId,this.module.id),this.textAvailable=this.workshop.submissiontypetext!=T.g.SUBMISSION_TYPE_DISABLED,this.textRequired=this.workshop.submissiontypetext==T.g.SUBMISSION_TYPE_REQUIRED,this.fileAvailable=this.workshop.submissiontypefile!=T.g.SUBMISSION_TYPE_DISABLED,this.fileRequired=this.workshop.submissiontypefile==T.g.SUBMISSION_TYPE_REQUIRED,this.editForm.controls.content.setValidators(this.textRequired?k.F.required:null),this.submissionId>0){this.editing=!0,this.submission=yield O.a.getSubmissionById(this.workshopId,this.submissionId,{cmId:this.module.id});if(!(this.userId==this.submission.authorid&&this.access.cansubmit&&this.access.modifyingsubmissionallowed))return this.forceLeavePage(),void 0}else if(!this.access.cansubmit||!this.access.creatingsubmissionallowed)return this.forceLeavePage(),void 0;const e=yield F.a.getSubmissions(this.workshopId);e&&e.length?(this.hasOffline=!0,this.submission=yield O.a.applyOfflineData(this.submission,e)):this.hasOffline=!1,this.submission&&(this.originalData.title=this.submission.title||\"\",this.originalData.content=this.submission.content||\"\",this.originalData.attachmentfiles=[],(this.submission.attachmentfiles||[]).forEach((e=>{let s=J.a.getFileName(e);s||(s=H.a.getFilenameFromPath(e)||\"\"),this.originalData.attachmentfiles.push({filename:s,fileurl:\"fileurl\"in e?e.fileurl:\"\"})})),this.editForm.controls.title.setValue(this.submission.title),this.editForm.controls.content.setValue(this.submission.content),this.attachments=this.submission.attachmentfiles||[]),this.loaded=!0}catch(e){this.loaded=!1,y.a.showErrorModalDefault(e,\"core.course.errorgetmodule\",!0),this.forceLeavePage()}}))}forceLeavePage(){this.forceLeave=!0,r.a.back()}getInputData(){const e={title:this.editForm.value.title,content:\"\",attachmentfiles:[]};return this.textAvailable&&(e.content=this.editForm.value.content||\"\"),this.fileAvailable&&(e.attachmentfiles=this.attachments),e}hasDataChanged(){if(!this.loaded)return!1;const e=this.getInputData();return!!(this.originalData.title!=e.title||this.textAvailable&&this.originalData.content!=e.content)||!!this.fileAvailable&&B.a.areFileListDifferent(e.attachmentfiles,this.originalData.attachmentfiles)}save(){return Object(I.a)(this,void 0,void 0,(function*(){if(this.hasDataChanged())try{yield this.saveSubmission(),this.forceLeavePage()}catch(e){}else this.forceLeavePage()}))}saveSubmission(){var e;return Object(I.a)(this,void 0,void 0,(function*(){const s=this.getInputData();if(!s.title)throw y.a.showAlertTranslated(\"core.notice\",\"addon.mod_workshop.submissionrequiredtitle\"),new j.a(x.J.instant(\"addon.mod_workshop.submissionrequiredtitle\"));const t=M.a.htmlIsBlank(s.content),o=!s.attachmentfiles.length;if(this.textRequired&&t||this.fileRequired&&o||t&&o)throw y.a.showAlertTranslated(\"core.notice\",\"addon.mod_workshop.submissionrequiredcontent\"),new j.a(x.J.instant(\"addon.mod_workshop.submissionrequiredcontent\"));let a=!1;const i=yield y.a.showModalLoading(\"core.sending\",!0),n=null===(e=this.submission)||void 0===e?void 0:e.id;this.textAvailable&&(s.content=M.a.formatHtmlLines(s.content));let r=!s.attachmentfiles.length;try{let e,t,o;try{e=yield O.a.uploadOrStoreSubmissionFiles(this.workshopId,s.attachmentfiles,!1)}catch(e){if(Y.a.isWebServiceError(e))throw e;a=!0,r=!0,t=yield O.a.uploadOrStoreSubmissionFiles(this.workshopId,s.attachmentfiles,!0)}a||this.fileAvailable||(e=void 0),this.editing?a?(yield F.a.saveSubmission(this.workshopId,this.courseId,s.title,s.content,t,n,T.b.UPDATE),o=!1):o=yield T.a.updateSubmission(this.workshopId,n,this.courseId,s.title,s.content,e,void 0,r):a?(yield F.a.saveSubmission(this.workshopId,this.courseId,s.title,s.content,t,void 0,T.b.ADD),o=!1):o=yield T.a.addSubmission(this.workshopId,this.courseId,s.title,s.content,e,void 0,r),S.a.triggerFormSubmittedEvent(this.formElement,!!o,this.siteId);const d={workshopId:this.workshopId};o&&(F.a.deleteSubmissionAction(this.workshopId,this.editing?T.b.UPDATE:T.b.ADD),O.a.deleteSubmissionStoredFiles(this.workshopId,this.siteId),d.submissionId=o),W.b.trigger(W.b.ACTIVITY_DATA_SENT,{module:\"workshop\"});const c=o?T.a.invalidateSubmissionData(this.workshopId,o):Promise.resolve();yield c.finally((()=>{W.b.trigger(T.f.SUBMISSION_CHANGED,d,this.siteId),B.a.clearTmpFiles(s.attachmentfiles)}))}catch(e){y.a.showErrorModalDefault(e,\"Cannot save submission\")}finally{i.dismiss()}}))}getFilesComponentId(){return this.workshopId+\"_\"+(this.submissionId>0?this.submissionId:\"newsub\")}ngOnDestroy(){this.isDestroyed=!0,D.a.unblockOperation(this.component,this.workshopId)}}return AddonModWorkshopEditSubmissionPage.ɵfac=function AddonModWorkshopEditSubmissionPage_Factory(e){return new(e||AddonModWorkshopEditSubmissionPage)(c.yc(k.f))},AddonModWorkshopEditSubmissionPage.ɵcmp=c.sc({type:AddonModWorkshopEditSubmissionPage,selectors:[[\"page-addon-mod-workshop-edit-submission\"]],viewQuery:function AddonModWorkshopEditSubmissionPage_Query(e,s){var t;(1&e&&c.ud(X,!0),2&e)&&(c.dd(t=c.Nc())&&(s.formElement=t.first))},decls:17,vars:14,consts:[[\"slot\",\"start\"],[3,\"text\"],[\"slot\",\"end\"],[\"fill\",\"clear\",3,\"click\"],[3,\"hideUntil\"],[3,\"formGroup\",4,\"ngIf\"],[3,\"formGroup\"],[\"editFormEl\",\"\"],[1,\"ion-text-wrap\"],[\"position\",\"stacked\"],[\"core-mark-required\",\"true\"],[\"name\",\"title\",\"type\",\"text\",\"formControlName\",\"title\",3,\"placeholder\"],[4,\"ngIf\"],[\"allowOffline\",\"true\",3,\"files\",\"maxSize\",\"maxSubmissions\",\"component\",\"componentId\",\"acceptedTypes\",\"required\",\"courseId\",4,\"ngIf\"],[3,\"core-mark-required\"],[\"name\",\"content\",\"contextLevel\",\"module\",\"elementId\",\"content_editor\",3,\"control\",\"placeholder\",\"component\",\"componentId\",\"autoSave\",\"contextInstanceId\",\"draftExtraParams\"],[\"allowOffline\",\"true\",3,\"files\",\"maxSize\",\"maxSubmissions\",\"component\",\"componentId\",\"acceptedTypes\",\"required\",\"courseId\"]],template:function AddonModWorkshopEditSubmissionPage_Template(e,s){1&e&&(c.Ec(0,\"ion-header\"),c.Ec(1,\"ion-toolbar\"),c.Ec(2,\"ion-buttons\",0),c.zc(3,\"ion-back-button\",1),c.Pc(4,\"translate\"),c.Dc(),c.Ec(5,\"ion-title\"),c.Ec(6,\"h1\"),c.pd(7),c.Pc(8,\"translate\"),c.Dc(),c.Dc(),c.Ec(9,\"ion-buttons\",2),c.Ec(10,\"ion-button\",3),c.Mc(\"click\",(function AddonModWorkshopEditSubmissionPage_Template_ion_button_click_10_listener(){return s.save()})),c.Pc(11,\"translate\"),c.pd(12),c.Pc(13,\"translate\"),c.Dc(),c.Dc(),c.Dc(),c.Dc(),c.Ec(14,\"ion-content\"),c.Ec(15,\"core-loading\",4),c.nd(16,AddonModWorkshopEditSubmissionPage_form_16_Template,11,9,\"form\",5),c.Dc(),c.Dc()),2&e&&(c.lc(3),c.Vc(\"text\",c.Qc(4,6,\"core.back\")),c.lc(4),c.qd(c.Qc(8,8,\"addon.mod_workshop.editsubmission\")),c.lc(3),c.mc(\"aria-label\",c.Qc(11,10,\"core.save\")),c.lc(2),c.rd(\" \",c.Qc(13,12,\"core.save\"),\" \"),c.lc(3),c.Vc(\"hideUntil\",s.loaded),c.lc(1),c.Vc(\"ngIf\",s.workshop))},directives:[l.C,l.Ab,l.m,l.h,l.i,l.yb,L.a,l.l,u.a,l.v,R.a,C.t,k.H,k.s,k.k,l.I,l.O,N.a,l.H,l.Pb,k.r,k.i,z.a,K.a],pipes:[p.d],encapsulation:2}),AddonModWorkshopEditSubmissionPage})();var $=t(\"aEIl\"),ee=t(\"3zv0\"),se=t(\"Lmwl\"),te=t(\"4qNr\"),oe=t(\"fQ68\"),ae=t(\"8/N+\"),ie=t(\"0QZc\"),ne=t(\"uHIS\"),re=t(\"w+Pn\"),de=t(\"r8G5\"),ce=t(\"5450\"),le=t(\"W5pS\"),he=t(\"WPIK\"),me=t(\"p+Qc\"),ue=t(\"qNqN\"),pe=t(\"xpMl\"),ge=t(\"FTxb\"),fe=t(\"/K1O\"),_e=t(\"9pYf\"),be=t(\"eAud\"),ve=t(\"ACV2\"),Ie=t(\"/BoF\"),ke=t(\"TKc2\"),we=t(\"whRm\"),Ae=t(\"O4u7\"),Ee=t(\"lqoc\"),Pe=t(\"3lz8\"),De=t(\"46ml\"),ye=t(\"QQhE\"),Me=t(\"MpCO\"),xe=t(\"JYLr\"),We=t(\"vWwc\"),Se=t(\"NhJP\"),Te=t(\"rztj\"),Oe=t(\"rf3J\"),Fe=t(\"nEkO\"),Ve=t(\"TF0o\"),Le=t(\"p5uK\"),Ce=t(\"6uVz\"),Re=t(\"d0nH\"),qe=t(\"NcPy\"),Ge=t(\"yNDK\"),Ne=t(\"3CSS\"),ze=t(\"iSJP\"),Qe=t(\"iJls\"),Ue=t(\"ArDJ\"),je=t(\"nu3w\"),Be=t(\"saTE\"),Je=t(\"8PoL\"),He=t(\"4a38\"),Ye=t(\"OZH1\"),Ke=t(\"edOc\"),Xe=t(\"3jOR\"),Ze=t(\"6A9T\"),$e=t(\"Uzd6\"),es=t(\"0w4i\"),ss=t(\"G92Y\"),ts=t(\"1iFe\"),os=t(\"dne1\"),as=t(\"Cg42\"),is=t(\"llyR\"),ns=t(\"uYHD\"),rs=t(\"SspJ\"),ds=t(\"U2xU\"),cs=t(\"lAaw\"),ls=t(\"1ArG\");const hs=[{path:\":courseId/:cmId\",component:g},{path:\":courseId/:cmId/:submissionId\",component:b.a,canDeactivate:[a.a]},{path:\":courseId/:cmId/:submissionId/edit\",component:Z,canDeactivate:[a.a]},{path:\":courseId/:cmId/:submissionId/:assessmentId\",component:U,canDeactivate:[a.a]}];let ms=(()=>{class AddonModWorkshopLazyModule{}return AddonModWorkshopLazyModule.ɵmod=c.wc({type:AddonModWorkshopLazyModule}),AddonModWorkshopLazyModule.ɵinj=c.vc({factory:function AddonModWorkshopLazyModule_Factory(e){return new(e||AddonModWorkshopLazyModule)},imports:[[o.m.forChild(hs),i.a,_.a,v.a]]}),AddonModWorkshopLazyModule})();void((\"undefined\"==typeof ngJitMode||ngJitMode)&&c.kd(ms,{declarations:[g,b.a,U,Z],imports:[o.m,i.a,_.a,v.a]})),c.jd(b.a,[o.n,o.j,o.l,o.k,o.p,C.q,C.r,C.s,C.t,C.A,C.w,C.x,C.y,C.z,C.u,C.v,K.a,$.a,ee.a,se.a,te.a,oe.a,ae.a,ie.a,ne.a,re.a,de.a,ce.a,le.a,he.a,me.a,ue.a,pe.a,ge.a,R.a,fe.a,N.a,_e.a,be.a,ve.a,Ie.a,ke.a,we.a,Ae.a,Ee.a,Pe.a,De.a,ye.a,Me.a,xe.a,We.a,Se.a,Te.a,q.a,Oe.a,Fe.a,Ve.a,Le.a,Ce.a,Re.a,qe.a,Ge.a,Ne.a,m.a,ze.a,Qe.a,Ue.a,je.a,Be.a,Je.a,He.a,h.b,Ye.a,Ke.a,Xe.a,u.a,L.a,Ze.a,k.H,k.w,k.G,k.c,k.x,k.A,k.a,k.D,k.E,k.z,k.r,k.s,k.C,k.o,k.n,k.y,k.b,k.d,k.u,k.v,k.t,l.f,l.g,l.h,l.j,l.k,l.l,l.m,l.n,l.o,l.p,l.q,l.r,l.s,l.t,l.u,l.v,l.w,l.x,l.y,l.z,l.A,l.B,l.C,l.D,l.E,l.F,l.G,l.H,l.I,l.J,l.K,l.L,l.M,l.N,l.O,l.P,l.Q,l.R,l.S,l.T,l.U,l.V,l.W,l.X,l.Y,l.Z,l.ab,l.bb,l.cb,l.db,l.eb,l.fb,l.hb,l.ib,l.jb,l.kb,l.lb,l.mb,l.nb,l.ob,l.pb,l.qb,l.rb,l.sb,l.tb,l.vb,l.wb,l.xb,l.zb,l.Ab,l.yb,l.ub,l.d,l.Jb,l.Mb,l.Ob,l.Pb,l.gb,l.i,l.Hb,l.Nb,l.Rb,l.Sb,l.Tb,l.Bb,k.h,k.k,k.i,k.l,k.e,p.a,d.a,$e.a,es.a,ss.a,G.a,z.a,g,b.a,U,Z],[C.b,C.G,C.p,C.k,C.E,C.g,C.C,C.F,C.d,C.f,C.i,C.j,C.l,ts.a,os.a,as.a,is.a,ns.a,rs.a,ds.a,cs.a,ls.a,p.d])}}]);","name":"82.a6c41778903e2e6ad377.js","input":"(window[\"webpackJsonp\"] = window[\"webpackJsonp\"] || []).push([[82],{\n\n/***/ \"Iaui\":\n/***/ (function(module, __webpack_exports__, __webpack_require__) {\n\n\"use strict\";\n// ESM COMPAT FLAG\n__webpack_require__.r(__webpack_exports__);\n\n// EXPORTS\n__webpack_require__.d(__webpack_exports__, \"AddonModWorkshopLazyModule\", function() { return /* binding */ workshop_lazy_module_AddonModWorkshopLazyModule; });\n\n// EXTERNAL MODULE: ./node_modules/@angular/router/__ivy_ngcc__/fesm2015/router.js + 10 modules\nvar router = __webpack_require__(\"tyNb\");\n\n// EXTERNAL MODULE: ./src/core/guards/can-leave.ts\nvar can_leave = __webpack_require__(\"MLi9\");\n\n// EXTERNAL MODULE: ./src/core/shared.module.ts + 3 modules\nvar shared_module = __webpack_require__(\"L3Fv\");\n\n// EXTERNAL MODULE: ./src/core/features/course/classes/main-activity-page.ts\nvar main_activity_page = __webpack_require__(\"ghUQ\");\n\n// EXTERNAL MODULE: ./src/core/services/navigator.ts\nvar services_navigator = __webpack_require__(\"pHTc\");\n\n// EXTERNAL MODULE: ./src/addons/mod/workshop/components/index/index.ts\nvar index = __webpack_require__(\"20uA\");\n\n// EXTERNAL MODULE: ./node_modules/@angular/core/__ivy_ngcc__/fesm2015/core.js\nvar core = __webpack_require__(\"fXoL\");\n\n// EXTERNAL MODULE: ./node_modules/@ionic/angular/__ivy_ngcc__/fesm2015/ionic-angular.js + 5 modules\nvar ionic_angular = __webpack_require__(\"TEn/\");\n\n// EXTERNAL MODULE: ./src/core/directives/collapsible-header.ts\nvar collapsible_header = __webpack_require__(\"4JiN\");\n\n// EXTERNAL MODULE: ./src/core/directives/format-text.ts\nvar format_text = __webpack_require__(\"hMzs\");\n\n// EXTERNAL MODULE: ./src/core/directives/content.ts\nvar content = __webpack_require__(\"nt/U\");\n\n// EXTERNAL MODULE: ./node_modules/@ngx-translate/core/__ivy_ngcc__/fesm2015/ngx-translate-core.js + 8 modules\nvar ngx_translate_core = __webpack_require__(\"sYmb\");\n\n// CONCATENATED MODULE: ./src/addons/mod/workshop/pages/index/index.ts\n// (C) Copyright 2015 Moodle Pty Ltd.\n//\n// Licensed under the Apache License, Version 2.0 (the \"License\");\n// you may not use this file except in compliance with the License.\n// You may obtain a copy of the License at\n//\n//     http://www.apache.org/licenses/LICENSE-2.0\n//\n// Unless required by applicable law or agreed to in writing, software\n// distributed under the License is distributed on an \"AS IS\" BASIS,\n// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n// See the License for the specific language governing permissions and\n// limitations under the License.\n\n\n\n\n\n\n\n\n\n\n\n/**\n * Page that displays a workshop.\n */\nlet index_AddonModWorkshopIndexPage = /*@__PURE__*/ (() => {\n    class AddonModWorkshopIndexPage extends main_activity_page[\"a\" /* CoreCourseModuleMainActivityPage */] {\n        constructor() {\n            super(...arguments);\n            this.selectedGroup = 0;\n        }\n        /**\n         * @inheritdoc\n         */\n        ngOnInit() {\n            super.ngOnInit();\n            this.selectedGroup = services_navigator[\"a\" /* CoreNavigator */].getRouteNumberParam('group') || 0;\n        }\n    }\n    AddonModWorkshopIndexPage.ɵfac = function AddonModWorkshopIndexPage_Factory(t) { return ɵAddonModWorkshopIndexPage_BaseFactory(t || AddonModWorkshopIndexPage); };\n    AddonModWorkshopIndexPage.ɵcmp = core[\"sc\" /* ɵɵdefineComponent */]({ type: AddonModWorkshopIndexPage, selectors: [[\"page-addon-mod-workshop-index\"]], viewQuery: function AddonModWorkshopIndexPage_Query(rf, ctx) {\n            if (rf & 1) {\n                core[\"ud\" /* ɵɵviewQuery */](index[\"a\" /* AddonModWorkshopIndexComponent */], true);\n            }\n            if (rf & 2) {\n                var _t;\n                core[\"dd\" /* ɵɵqueryRefresh */](_t = core[\"Nc\" /* ɵɵloadQuery */]()) && (ctx.activityComponent = _t.first);\n            }\n        }, features: [core[\"ic\" /* ɵɵInheritDefinitionFeature */]], decls: 14, vars: 13, consts: [[\"collapsible\", \"\"], [\"slot\", \"start\"], [3, \"text\"], [\"contextLevel\", \"module\", 3, \"text\", \"contextInstanceId\", \"courseId\"], [\"slot\", \"end\"], [1, \"limited-width\"], [\"slot\", \"fixed\", 3, \"disabled\", \"ionRefresh\"], [3, \"pullingText\"], [3, \"module\", \"courseId\", \"group\", \"dataRetrieved\"]], template: function AddonModWorkshopIndexPage_Template(rf, ctx) {\n            if (rf & 1) {\n                core[\"Ec\" /* ɵɵelementStart */](0, \"ion-header\", 0);\n                core[\"Ec\" /* ɵɵelementStart */](1, \"ion-toolbar\");\n                core[\"Ec\" /* ɵɵelementStart */](2, \"ion-buttons\", 1);\n                core[\"zc\" /* ɵɵelement */](3, \"ion-back-button\", 2);\n                core[\"Pc\" /* ɵɵpipe */](4, \"translate\");\n                core[\"Dc\" /* ɵɵelementEnd */]();\n                core[\"Ec\" /* ɵɵelementStart */](5, \"ion-title\");\n                core[\"Ec\" /* ɵɵelementStart */](6, \"h1\");\n                core[\"zc\" /* ɵɵelement */](7, \"core-format-text\", 3);\n                core[\"Dc\" /* ɵɵelementEnd */]();\n                core[\"Dc\" /* ɵɵelementEnd */]();\n                core[\"zc\" /* ɵɵelement */](8, \"ion-buttons\", 4);\n                core[\"Dc\" /* ɵɵelementEnd */]();\n                core[\"Dc\" /* ɵɵelementEnd */]();\n                core[\"Ec\" /* ɵɵelementStart */](9, \"ion-content\", 5);\n                core[\"Ec\" /* ɵɵelementStart */](10, \"ion-refresher\", 6);\n                core[\"Mc\" /* ɵɵlistener */](\"ionRefresh\", function AddonModWorkshopIndexPage_Template_ion_refresher_ionRefresh_10_listener($event) { return ctx.activityComponent == null ? null : ctx.activityComponent.doRefresh($event.target); });\n                core[\"zc\" /* ɵɵelement */](11, \"ion-refresher-content\", 7);\n                core[\"Pc\" /* ɵɵpipe */](12, \"translate\");\n                core[\"Dc\" /* ɵɵelementEnd */]();\n                core[\"Ec\" /* ɵɵelementStart */](13, \"addon-mod-workshop-index\", 8);\n                core[\"Mc\" /* ɵɵlistener */](\"dataRetrieved\", function AddonModWorkshopIndexPage_Template_addon_mod_workshop_index_dataRetrieved_13_listener($event) { return ctx.updateData($event); });\n                core[\"Dc\" /* ɵɵelementEnd */]();\n                core[\"Dc\" /* ɵɵelementEnd */]();\n            }\n            if (rf & 2) {\n                core[\"lc\" /* ɵɵadvance */](3);\n                core[\"Vc\" /* ɵɵproperty */](\"text\", core[\"Qc\" /* ɵɵpipeBind1 */](4, 9, \"core.back\"));\n                core[\"lc\" /* ɵɵadvance */](4);\n                core[\"Vc\" /* ɵɵproperty */](\"text\", ctx.title)(\"contextInstanceId\", ctx.module.id)(\"courseId\", ctx.courseId);\n                core[\"lc\" /* ɵɵadvance */](3);\n                core[\"Vc\" /* ɵɵproperty */](\"disabled\", ctx.activityComponent == null ? null : ctx.activityComponent.showLoading);\n                core[\"lc\" /* ɵɵadvance */](1);\n                core[\"Wc\" /* ɵɵpropertyInterpolate */](\"pullingText\", core[\"Qc\" /* ɵɵpipeBind1 */](12, 11, \"core.pulltorefresh\"));\n                core[\"lc\" /* ɵɵadvance */](2);\n                core[\"Vc\" /* ɵɵproperty */](\"module\", ctx.module)(\"courseId\", ctx.courseId)(\"group\", ctx.selectedGroup);\n            }\n        }, directives: [ionic_angular[\"C\" /* IonHeader */], collapsible_header[\"b\" /* CoreCollapsibleHeaderDirective */], ionic_angular[\"Ab\" /* IonToolbar */], ionic_angular[\"m\" /* IonButtons */], ionic_angular[\"h\" /* IonBackButton */], ionic_angular[\"i\" /* IonBackButtonDelegate */], ionic_angular[\"yb\" /* IonTitle */], format_text[\"a\" /* CoreFormatTextDirective */], content[\"a\" /* CoreContentDirective */], ionic_angular[\"v\" /* IonContent */], ionic_angular[\"bb\" /* IonRefresher */], ionic_angular[\"cb\" /* IonRefresherContent */], index[\"a\" /* AddonModWorkshopIndexComponent */]], pipes: [ngx_translate_core[\"d\" /* TranslatePipe */]], encapsulation: 2 });\n    return AddonModWorkshopIndexPage;\n})();\nconst ɵAddonModWorkshopIndexPage_BaseFactory = /*@__PURE__*/ core[\"Gc\" /* ɵɵgetInheritedFactory */](index_AddonModWorkshopIndexPage);\n\n// EXTERNAL MODULE: ./src/addons/mod/workshop/components/components.module.ts\nvar components_module = __webpack_require__(\"Ie1r\");\n\n// EXTERNAL MODULE: ./src/addons/mod/workshop/pages/submission/submission.ts\nvar submission = __webpack_require__(\"WoAp\");\n\n// EXTERNAL MODULE: ./src/core/features/editor/components/components.module.ts\nvar components_components_module = __webpack_require__(\"ekpb\");\n\n// EXTERNAL MODULE: ./node_modules/tslib/tslib.es6.js\nvar tslib_es6 = __webpack_require__(\"mrSG\");\n\n// EXTERNAL MODULE: ./node_modules/@angular/forms/__ivy_ngcc__/fesm2015/forms.js\nvar fesm2015_forms = __webpack_require__(\"3Pt+\");\n\n// EXTERNAL MODULE: ./src/core/features/course/services/course.ts\nvar course = __webpack_require__(\"ULAo\");\n\n// EXTERNAL MODULE: ./src/core/features/grades/services/grades-helper.ts\nvar grades_helper = __webpack_require__(\"FvYb\");\n\n// EXTERNAL MODULE: ./src/core/features/user/services/user.ts\nvar user = __webpack_require__(\"4pns\");\n\n// EXTERNAL MODULE: ./src/core/services/sites.ts\nvar sites = __webpack_require__(\"9+EE\");\n\n// EXTERNAL MODULE: ./src/core/services/sync.ts\nvar sync = __webpack_require__(\"uT8i\");\n\n// EXTERNAL MODULE: ./src/core/services/utils/dom.ts + 2 modules\nvar dom = __webpack_require__(\"3LXp\");\n\n// EXTERNAL MODULE: ./src/core/services/utils/text.ts + 1 modules\nvar utils_text = __webpack_require__(\"vuGA\");\n\n// EXTERNAL MODULE: ./src/core/singletons/index.ts\nvar singletons = __webpack_require__(\"j3ag\");\n\n// EXTERNAL MODULE: ./src/core/singletons/events.ts\nvar events = __webpack_require__(\"fjkH\");\n\n// EXTERNAL MODULE: ./src/core/singletons/form.ts\nvar singletons_form = __webpack_require__(\"4reR\");\n\n// EXTERNAL MODULE: ./src/addons/mod/workshop/services/workshop.ts\nvar workshop = __webpack_require__(\"i1f9\");\n\n// EXTERNAL MODULE: ./src/addons/mod/workshop/services/workshop-helper.ts\nvar workshop_helper = __webpack_require__(\"8/zp\");\n\n// EXTERNAL MODULE: ./src/addons/mod/workshop/services/workshop-offline.ts\nvar workshop_offline = __webpack_require__(\"EyWp\");\n\n// EXTERNAL MODULE: ./src/addons/mod/workshop/services/workshop-sync.ts\nvar workshop_sync = __webpack_require__(\"GuJL\");\n\n// EXTERNAL MODULE: ./src/core/directives/update-non-reactive-attributes.ts\nvar update_non_reactive_attributes = __webpack_require__(\"ACYt\");\n\n// EXTERNAL MODULE: ./node_modules/@angular/common/__ivy_ngcc__/fesm2015/common.js\nvar common = __webpack_require__(\"ofXK\");\n\n// EXTERNAL MODULE: ./src/core/components/loading/loading.ts\nvar loading = __webpack_require__(\"PgjG\");\n\n// EXTERNAL MODULE: ./src/core/components/user-avatar/user-avatar.ts\nvar user_avatar = __webpack_require__(\"FeAf\");\n\n// EXTERNAL MODULE: ./src/addons/mod/workshop/components/assessment-strategy/assessment-strategy.ts\nvar assessment_strategy = __webpack_require__(\"Lkkz\");\n\n// EXTERNAL MODULE: ./src/core/components/mark-required/mark-required.ts\nvar mark_required = __webpack_require__(\"FasJ\");\n\n// EXTERNAL MODULE: ./src/core/features/editor/components/rich-text-editor/rich-text-editor.ts\nvar rich_text_editor = __webpack_require__(\"N5Lt\");\n\n// CONCATENATED MODULE: ./src/addons/mod/workshop/pages/assessment/assessment.ts\n\n// (C) Copyright 2015 Moodle Pty Ltd.\n//\n// Licensed under the Apache License, Version 2.0 (the \"License\");\n// you may not use this file except in compliance with the License.\n// You may obtain a copy of the License at\n//\n//     http://www.apache.org/licenses/LICENSE-2.0\n//\n// Unless required by applicable law or agreed to in writing, software\n// distributed under the License is distributed on an \"AS IS\" BASIS,\n// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n// See the License for the specific language governing permissions and\n// limitations under the License.\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nconst _c0 = [\"evaluateFormEl\"];\nfunction AddonModWorkshopAssessmentPage_ion_refresher_13_Template(rf, ctx) {\n    if (rf & 1) {\n        const _r12 = core[\"Fc\" /* ɵɵgetCurrentView */]();\n        core[\"Ec\" /* ɵɵelementStart */](0, \"ion-refresher\", 15);\n        core[\"Mc\" /* ɵɵlistener */](\"ionRefresh\", function AddonModWorkshopAssessmentPage_ion_refresher_13_Template_ion_refresher_ionRefresh_0_listener($event) { core[\"fd\" /* ɵɵrestoreView */](_r12); const ctx_r11 = core[\"Oc\" /* ɵɵnextContext */](); return ctx_r11.refreshAssessment($event.target); });\n        core[\"zc\" /* ɵɵelement */](1, \"ion-refresher-content\", 16);\n        core[\"Pc\" /* ɵɵpipe */](2, \"translate\");\n        core[\"Dc\" /* ɵɵelementEnd */]();\n    }\n    if (rf & 2) {\n        const ctx_r0 = core[\"Oc\" /* ɵɵnextContext */]();\n        core[\"Vc\" /* ɵɵproperty */](\"disabled\", !ctx_r0.loaded);\n        core[\"lc\" /* ɵɵadvance */](1);\n        core[\"Wc\" /* ɵɵpropertyInterpolate */](\"pullingText\", core[\"Qc\" /* ɵɵpipeBind1 */](2, 2, \"core.pulltorefresh\"));\n    }\n}\nfunction AddonModWorkshopAssessmentPage_core_user_avatar_16_Template(rf, ctx) {\n    if (rf & 1) {\n        core[\"zc\" /* ɵɵelement */](0, \"core-user-avatar\", 17);\n    }\n    if (rf & 2) {\n        const ctx_r1 = core[\"Oc\" /* ɵɵnextContext */]();\n        core[\"Vc\" /* ɵɵproperty */](\"user\", ctx_r1.profile)(\"courseId\", ctx_r1.courseId)(\"userId\", ctx_r1.profile.id);\n    }\n}\nfunction AddonModWorkshopAssessmentPage_h2_18_Template(rf, ctx) {\n    if (rf & 1) {\n        core[\"Ec\" /* ɵɵelementStart */](0, \"h2\");\n        core[\"pd\" /* ɵɵtext */](1);\n        core[\"Dc\" /* ɵɵelementEnd */]();\n    }\n    if (rf & 2) {\n        const ctx_r2 = core[\"Oc\" /* ɵɵnextContext */]();\n        core[\"lc\" /* ɵɵadvance */](1);\n        core[\"qd\" /* ɵɵtextInterpolate */](ctx_r2.profile.fullname);\n    }\n}\nconst _c1 = function (a0) { return { $a: a0 }; };\nfunction AddonModWorkshopAssessmentPage_p_19_Template(rf, ctx) {\n    if (rf & 1) {\n        core[\"Ec\" /* ɵɵelementStart */](0, \"p\");\n        core[\"pd\" /* ɵɵtext */](1);\n        core[\"Pc\" /* ɵɵpipe */](2, \"translate\");\n        core[\"Dc\" /* ɵɵelementEnd */]();\n    }\n    if (rf & 2) {\n        const ctx_r3 = core[\"Oc\" /* ɵɵnextContext */]();\n        core[\"lc\" /* ɵɵadvance */](1);\n        core[\"sd\" /* ɵɵtextInterpolate2 */](\" \", core[\"Rc\" /* ɵɵpipeBind2 */](2, 2, \"addon.mod_workshop.submissiongradeof\", core[\"ad\" /* ɵɵpureFunction1 */](5, _c1, ctx_r3.workshop.grade)), \": \", ctx_r3.assessment.grade, \" \");\n    }\n}\nfunction AddonModWorkshopAssessmentPage_p_20_Template(rf, ctx) {\n    if (rf & 1) {\n        core[\"Ec\" /* ɵɵelementStart */](0, \"p\");\n        core[\"pd\" /* ɵɵtext */](1);\n        core[\"Pc\" /* ɵɵpipe */](2, \"translate\");\n        core[\"Dc\" /* ɵɵelementEnd */]();\n    }\n    if (rf & 2) {\n        const ctx_r4 = core[\"Oc\" /* ɵɵnextContext */]();\n        core[\"qc\" /* ɵɵclassProp */](\"core-has-overriden-grade\", ctx_r4.showGrade(ctx_r4.assessment.gradinggrade));\n        core[\"lc\" /* ɵɵadvance */](1);\n        core[\"sd\" /* ɵɵtextInterpolate2 */](\" \", core[\"Rc\" /* ɵɵpipeBind2 */](2, 4, \"addon.mod_workshop.gradinggradeof\", core[\"ad\" /* ɵɵpureFunction1 */](7, _c1, ctx_r4.workshop.gradinggrade)), \": \", ctx_r4.assessment.gradinggrade, \" \");\n    }\n}\nfunction AddonModWorkshopAssessmentPage_p_21_Template(rf, ctx) {\n    if (rf & 1) {\n        core[\"Ec\" /* ɵɵelementStart */](0, \"p\", 18);\n        core[\"pd\" /* ɵɵtext */](1);\n        core[\"Pc\" /* ɵɵpipe */](2, \"translate\");\n        core[\"Dc\" /* ɵɵelementEnd */]();\n    }\n    if (rf & 2) {\n        const ctx_r5 = core[\"Oc\" /* ɵɵnextContext */]();\n        core[\"lc\" /* ɵɵadvance */](1);\n        core[\"sd\" /* ɵɵtextInterpolate2 */](\" \", core[\"Qc\" /* ɵɵpipeBind1 */](2, 2, \"addon.mod_workshop.gradinggradeover\"), \": \", ctx_r5.assessment.gradinggradeover, \" \");\n    }\n}\nfunction AddonModWorkshopAssessmentPage_p_22_Template(rf, ctx) {\n    if (rf & 1) {\n        core[\"Ec\" /* ɵɵelementStart */](0, \"p\");\n        core[\"pd\" /* ɵɵtext */](1);\n        core[\"Pc\" /* ɵɵpipe */](2, \"translate\");\n        core[\"Dc\" /* ɵɵelementEnd */]();\n    }\n    if (rf & 2) {\n        const ctx_r6 = core[\"Oc\" /* ɵɵnextContext */]();\n        core[\"lc\" /* ɵɵadvance */](1);\n        core[\"rd\" /* ɵɵtextInterpolate1 */](\" \", core[\"Rc\" /* ɵɵpipeBind2 */](2, 1, \"addon.mod_workshop.weightinfo\", core[\"ad\" /* ɵɵpureFunction1 */](4, _c1, ctx_r6.assessment.weight)), \" \");\n    }\n}\nfunction AddonModWorkshopAssessmentPage_ion_badge_23_Template(rf, ctx) {\n    if (rf & 1) {\n        core[\"Ec\" /* ɵɵelementStart */](0, \"ion-badge\", 19);\n        core[\"pd\" /* ɵɵtext */](1);\n        core[\"Pc\" /* ɵɵpipe */](2, \"translate\");\n        core[\"Dc\" /* ɵɵelementEnd */]();\n    }\n    if (rf & 2) {\n        core[\"lc\" /* ɵɵadvance */](1);\n        core[\"rd\" /* ɵɵtextInterpolate1 */](\" \", core[\"Qc\" /* ɵɵpipeBind1 */](2, 1, \"addon.mod_workshop.notassessed\"), \" \");\n    }\n}\nfunction AddonModWorkshopAssessmentPage_addon_mod_workshop_assessment_strategy_24_Template(rf, ctx) {\n    if (rf & 1) {\n        core[\"zc\" /* ɵɵelement */](0, \"addon-mod-workshop-assessment-strategy\", 20);\n    }\n    if (rf & 2) {\n        const ctx_r8 = core[\"Oc\" /* ɵɵnextContext */]();\n        core[\"Vc\" /* ɵɵproperty */](\"workshop\", ctx_r8.workshop)(\"access\", ctx_r8.access)(\"assessmentId\", ctx_r8.assessmentId)(\"userId\", ctx_r8.profile && ctx_r8.profile.id)(\"strategy\", ctx_r8.strategy);\n    }\n}\nfunction AddonModWorkshopAssessmentPage_form_25_ion_item_7_ion_select_option_7_Template(rf, ctx) {\n    if (rf & 1) {\n        core[\"Ec\" /* ɵɵelementStart */](0, \"ion-select-option\", 28);\n        core[\"pd\" /* ɵɵtext */](1);\n        core[\"Dc\" /* ɵɵelementEnd */]();\n    }\n    if (rf & 2) {\n        const w_r18 = ctx.$implicit;\n        core[\"Vc\" /* ɵɵproperty */](\"value\", w_r18);\n        core[\"lc\" /* ɵɵadvance */](1);\n        core[\"qd\" /* ɵɵtextInterpolate */](w_r18);\n    }\n}\nconst _c2 = function (a0) { return { header: a0 }; };\nfunction AddonModWorkshopAssessmentPage_form_25_ion_item_7_Template(rf, ctx) {\n    if (rf & 1) {\n        core[\"Ec\" /* ɵɵelementStart */](0, \"ion-item\", 7);\n        core[\"Ec\" /* ɵɵelementStart */](1, \"ion-label\", 24);\n        core[\"Ec\" /* ɵɵelementStart */](2, \"span\", 25);\n        core[\"pd\" /* ɵɵtext */](3);\n        core[\"Pc\" /* ɵɵpipe */](4, \"translate\");\n        core[\"Dc\" /* ɵɵelementEnd */]();\n        core[\"Dc\" /* ɵɵelementEnd */]();\n        core[\"Ec\" /* ɵɵelementStart */](5, \"ion-select\", 26);\n        core[\"Pc\" /* ɵɵpipe */](6, \"translate\");\n        core[\"nd\" /* ɵɵtemplate */](7, AddonModWorkshopAssessmentPage_form_25_ion_item_7_ion_select_option_7_Template, 2, 2, \"ion-select-option\", 27);\n        core[\"Dc\" /* ɵɵelementEnd */]();\n        core[\"Dc\" /* ɵɵelementEnd */]();\n    }\n    if (rf & 2) {\n        const ctx_r14 = core[\"Oc\" /* ɵɵnextContext */](2);\n        core[\"lc\" /* ɵɵadvance */](3);\n        core[\"rd\" /* ɵɵtextInterpolate1 */](\" \", core[\"Qc\" /* ɵɵpipeBind1 */](4, 3, \"addon.mod_workshop.assessmentweight\"), \" \");\n        core[\"lc\" /* ɵɵadvance */](2);\n        core[\"Vc\" /* ɵɵproperty */](\"interfaceOptions\", core[\"ad\" /* ɵɵpureFunction1 */](7, _c2, core[\"Qc\" /* ɵɵpipeBind1 */](6, 5, \"addon.mod_workshop.assessmentweight\")));\n        core[\"lc\" /* ɵɵadvance */](2);\n        core[\"Vc\" /* ɵɵproperty */](\"ngForOf\", ctx_r14.weights);\n    }\n}\nfunction AddonModWorkshopAssessmentPage_form_25_ion_item_15_ion_select_option_6_Template(rf, ctx) {\n    if (rf & 1) {\n        core[\"Ec\" /* ɵɵelementStart */](0, \"ion-select-option\", 28);\n        core[\"pd\" /* ɵɵtext */](1);\n        core[\"Dc\" /* ɵɵelementEnd */]();\n    }\n    if (rf & 2) {\n        const grade_r20 = ctx.$implicit;\n        core[\"Vc\" /* ɵɵproperty */](\"value\", grade_r20.value);\n        core[\"lc\" /* ɵɵadvance */](1);\n        core[\"rd\" /* ɵɵtextInterpolate1 */](\" \", grade_r20.label, \" \");\n    }\n}\nfunction AddonModWorkshopAssessmentPage_form_25_ion_item_15_Template(rf, ctx) {\n    if (rf & 1) {\n        core[\"Ec\" /* ɵɵelementStart */](0, \"ion-item\", 7);\n        core[\"Ec\" /* ɵɵelementStart */](1, \"ion-label\", 24);\n        core[\"pd\" /* ɵɵtext */](2);\n        core[\"Pc\" /* ɵɵpipe */](3, \"translate\");\n        core[\"Dc\" /* ɵɵelementEnd */]();\n        core[\"Ec\" /* ɵɵelementStart */](4, \"ion-select\", 29);\n        core[\"Pc\" /* ɵɵpipe */](5, \"translate\");\n        core[\"nd\" /* ɵɵtemplate */](6, AddonModWorkshopAssessmentPage_form_25_ion_item_15_ion_select_option_6_Template, 2, 2, \"ion-select-option\", 27);\n        core[\"Dc\" /* ɵɵelementEnd */]();\n        core[\"Dc\" /* ɵɵelementEnd */]();\n    }\n    if (rf & 2) {\n        const ctx_r15 = core[\"Oc\" /* ɵɵnextContext */](2);\n        core[\"lc\" /* ɵɵadvance */](2);\n        core[\"qd\" /* ɵɵtextInterpolate */](core[\"Qc\" /* ɵɵpipeBind1 */](3, 3, \"addon.mod_workshop.gradinggradeover\"));\n        core[\"lc\" /* ɵɵadvance */](2);\n        core[\"Vc\" /* ɵɵproperty */](\"interfaceOptions\", core[\"ad\" /* ɵɵpureFunction1 */](7, _c2, core[\"Qc\" /* ɵɵpipeBind1 */](5, 5, \"addon.mod_workshop.gradinggradeover\")));\n        core[\"lc\" /* ɵɵadvance */](2);\n        core[\"Vc\" /* ɵɵproperty */](\"ngForOf\", ctx_r15.evaluationGrades);\n    }\n}\nconst _c3 = function (a0) { return { asid: a0 }; };\nfunction AddonModWorkshopAssessmentPage_form_25_ion_item_16_Template(rf, ctx) {\n    if (rf & 1) {\n        core[\"Ec\" /* ɵɵelementStart */](0, \"ion-item\");\n        core[\"Ec\" /* ɵɵelementStart */](1, \"ion-label\", 24);\n        core[\"pd\" /* ɵɵtext */](2);\n        core[\"Pc\" /* ɵɵpipe */](3, \"translate\");\n        core[\"Dc\" /* ɵɵelementEnd */]();\n        core[\"zc\" /* ɵɵelement */](4, \"core-rich-text-editor\", 30);\n        core[\"Dc\" /* ɵɵelementEnd */]();\n    }\n    if (rf & 2) {\n        const ctx_r16 = core[\"Oc\" /* ɵɵnextContext */](2);\n        core[\"lc\" /* ɵɵadvance */](2);\n        core[\"qd\" /* ɵɵtextInterpolate */](core[\"Qc\" /* ɵɵpipeBind1 */](3, 5, \"addon.mod_workshop.feedbackreviewer\"));\n        core[\"lc\" /* ɵɵadvance */](2);\n        core[\"Vc\" /* ɵɵproperty */](\"control\", ctx_r16.evaluateForm.controls[\"text\"])(\"autoSave\", true)(\"contextInstanceId\", ctx_r16.workshop == null ? null : ctx_r16.workshop.coursemodule)(\"draftExtraParams\", core[\"ad\" /* ɵɵpureFunction1 */](7, _c3, ctx_r16.assessmentId));\n    }\n}\nfunction AddonModWorkshopAssessmentPage_form_25_Template(rf, ctx) {\n    if (rf & 1) {\n        core[\"Ec\" /* ɵɵelementStart */](0, \"form\", 21, 22);\n        core[\"Ec\" /* ɵɵelementStart */](2, \"ion-item\", 7);\n        core[\"Ec\" /* ɵɵelementStart */](3, \"ion-label\");\n        core[\"Ec\" /* ɵɵelementStart */](4, \"h2\");\n        core[\"pd\" /* ɵɵtext */](5);\n        core[\"Pc\" /* ɵɵpipe */](6, \"translate\");\n        core[\"Dc\" /* ɵɵelementEnd */]();\n        core[\"Dc\" /* ɵɵelementEnd */]();\n        core[\"Dc\" /* ɵɵelementEnd */]();\n        core[\"nd\" /* ɵɵtemplate */](7, AddonModWorkshopAssessmentPage_form_25_ion_item_7_Template, 8, 9, \"ion-item\", 23);\n        core[\"Ec\" /* ɵɵelementStart */](8, \"ion-item\", 7);\n        core[\"Ec\" /* ɵɵelementStart */](9, \"ion-label\");\n        core[\"Ec\" /* ɵɵelementStart */](10, \"h2\");\n        core[\"pd\" /* ɵɵtext */](11);\n        core[\"Pc\" /* ɵɵpipe */](12, \"translate\");\n        core[\"Dc\" /* ɵɵelementEnd */]();\n        core[\"Ec\" /* ɵɵelementStart */](13, \"p\");\n        core[\"pd\" /* ɵɵtext */](14);\n        core[\"Dc\" /* ɵɵelementEnd */]();\n        core[\"Dc\" /* ɵɵelementEnd */]();\n        core[\"Dc\" /* ɵɵelementEnd */]();\n        core[\"nd\" /* ɵɵtemplate */](15, AddonModWorkshopAssessmentPage_form_25_ion_item_15_Template, 7, 9, \"ion-item\", 23);\n        core[\"nd\" /* ɵɵtemplate */](16, AddonModWorkshopAssessmentPage_form_25_ion_item_16_Template, 5, 9, \"ion-item\", 9);\n        core[\"Dc\" /* ɵɵelementEnd */]();\n    }\n    if (rf & 2) {\n        const ctx_r9 = core[\"Oc\" /* ɵɵnextContext */]();\n        core[\"Vc\" /* ɵɵproperty */](\"formGroup\", ctx_r9.evaluateForm);\n        core[\"lc\" /* ɵɵadvance */](5);\n        core[\"qd\" /* ɵɵtextInterpolate */](core[\"Qc\" /* ɵɵpipeBind1 */](6, 7, \"addon.mod_workshop.assessmentsettings\"));\n        core[\"lc\" /* ɵɵadvance */](2);\n        core[\"Vc\" /* ɵɵproperty */](\"ngIf\", ctx_r9.access == null ? null : ctx_r9.access.canallocate);\n        core[\"lc\" /* ɵɵadvance */](4);\n        core[\"qd\" /* ɵɵtextInterpolate */](core[\"Qc\" /* ɵɵpipeBind1 */](12, 9, \"addon.mod_workshop.gradinggradecalculated\"));\n        core[\"lc\" /* ɵɵadvance */](3);\n        core[\"qd\" /* ɵɵtextInterpolate */](ctx_r9.gradingGrade);\n        core[\"lc\" /* ɵɵadvance */](1);\n        core[\"Vc\" /* ɵɵproperty */](\"ngIf\", ctx_r9.access == null ? null : ctx_r9.access.canoverridegrades);\n        core[\"lc\" /* ɵɵadvance */](1);\n        core[\"Vc\" /* ɵɵproperty */](\"ngIf\", ctx_r9.access == null ? null : ctx_r9.access.canoverridegrades);\n    }\n}\nfunction AddonModWorkshopAssessmentPage_ion_list_26_core_user_avatar_2_Template(rf, ctx) {\n    if (rf & 1) {\n        core[\"zc\" /* ɵɵelement */](0, \"core-user-avatar\", 17);\n    }\n    if (rf & 2) {\n        const ctx_r21 = core[\"Oc\" /* ɵɵnextContext */](2);\n        core[\"Vc\" /* ɵɵproperty */](\"user\", ctx_r21.evaluateByProfile)(\"courseId\", ctx_r21.courseId)(\"userId\", ctx_r21.evaluateByProfile.id);\n    }\n}\nfunction AddonModWorkshopAssessmentPage_ion_list_26_h2_4_Template(rf, ctx) {\n    if (rf & 1) {\n        core[\"Ec\" /* ɵɵelementStart */](0, \"h2\");\n        core[\"pd\" /* ɵɵtext */](1);\n        core[\"Pc\" /* ɵɵpipe */](2, \"translate\");\n        core[\"Dc\" /* ɵɵelementEnd */]();\n    }\n    if (rf & 2) {\n        const ctx_r22 = core[\"Oc\" /* ɵɵnextContext */](2);\n        core[\"lc\" /* ɵɵadvance */](1);\n        core[\"rd\" /* ɵɵtextInterpolate1 */](\" \", core[\"Rc\" /* ɵɵpipeBind2 */](2, 1, \"addon.mod_workshop.feedbackby\", core[\"ad\" /* ɵɵpureFunction1 */](4, _c1, ctx_r22.evaluateByProfile.fullname)), \" \");\n    }\n}\nfunction AddonModWorkshopAssessmentPage_ion_list_26_Template(rf, ctx) {\n    if (rf & 1) {\n        core[\"Ec\" /* ɵɵelementStart */](0, \"ion-list\");\n        core[\"Ec\" /* ɵɵelementStart */](1, \"ion-item\", 7);\n        core[\"nd\" /* ɵɵtemplate */](2, AddonModWorkshopAssessmentPage_ion_list_26_core_user_avatar_2_Template, 1, 3, \"core-user-avatar\", 8);\n        core[\"Ec\" /* ɵɵelementStart */](3, \"ion-label\");\n        core[\"nd\" /* ɵɵtemplate */](4, AddonModWorkshopAssessmentPage_ion_list_26_h2_4_Template, 3, 6, \"h2\", 9);\n        core[\"zc\" /* ɵɵelement */](5, \"core-format-text\", 2);\n        core[\"Dc\" /* ɵɵelementEnd */]();\n        core[\"Dc\" /* ɵɵelementEnd */]();\n        core[\"Dc\" /* ɵɵelementEnd */]();\n    }\n    if (rf & 2) {\n        const ctx_r10 = core[\"Oc\" /* ɵɵnextContext */]();\n        core[\"lc\" /* ɵɵadvance */](2);\n        core[\"Vc\" /* ɵɵproperty */](\"ngIf\", ctx_r10.evaluateByProfile);\n        core[\"lc\" /* ɵɵadvance */](2);\n        core[\"Vc\" /* ɵɵproperty */](\"ngIf\", ctx_r10.evaluateByProfile && ctx_r10.evaluateByProfile.fullname);\n        core[\"lc\" /* ɵɵadvance */](1);\n        core[\"Vc\" /* ɵɵproperty */](\"text\", ctx_r10.evaluate.text)(\"contextInstanceId\", ctx_r10.workshop == null ? null : ctx_r10.workshop.coursemodule)(\"courseId\", ctx_r10.courseId);\n    }\n}\n/**\n * Page that displays a workshop assessment.\n */\nlet assessment_AddonModWorkshopAssessmentPage = /*@__PURE__*/ (() => {\n    class AddonModWorkshopAssessmentPage {\n        constructor(fb) {\n            this.fb = fb;\n            this.evaluating = false;\n            this.loaded = false;\n            this.title = '';\n            this.evaluate = {\n                text: '',\n                grade: -1,\n                weight: 1,\n            };\n            this.weights = [];\n            this.evaluationGrades = [];\n            this.originalEvaluation = {\n                text: '',\n                grade: -1,\n                weight: 1,\n            };\n            this.hasOffline = false;\n            this.isDestroyed = false;\n            this.forceLeave = false;\n            this.siteId = sites[\"b\" /* CoreSites */].getCurrentSiteId();\n            this.currentUserId = sites[\"b\" /* CoreSites */].getCurrentSiteUserId();\n            this.showGrade = workshop_helper[\"a\" /* AddonModWorkshopHelper */].showGrade;\n            this.evaluateForm = new fesm2015_forms[\"j\" /* FormGroup */]({});\n            this.evaluateForm.addControl('weight', this.fb.control('', fesm2015_forms[\"F\" /* Validators */].required));\n            this.evaluateForm.addControl('grade', this.fb.control(''));\n            this.evaluateForm.addControl('text', this.fb.control(''));\n            // Refresh workshop on sync.\n            this.syncObserver = events[\"b\" /* CoreEvents */].on(workshop_sync[\"b\" /* AddonModWorkshopSyncProvider */].AUTO_SYNCED, (data) => {\n                // Update just when all database is synced.\n                if (this.workshopId === data.workshopId) {\n                    this.loaded = false;\n                    this.refreshAllData();\n                }\n            }, this.siteId);\n        }\n        /**\n         * Component being initialized.\n         */\n        ngOnInit() {\n            try {\n                this.assessment = services_navigator[\"a\" /* CoreNavigator */].getRequiredRouteParam('assessment');\n                this.submission = services_navigator[\"a\" /* CoreNavigator */].getRequiredRouteParam('submission');\n                this.profile = services_navigator[\"a\" /* CoreNavigator */].getRouteParam('profile');\n                this.courseId = services_navigator[\"a\" /* CoreNavigator */].getRequiredRouteNumberParam('courseId');\n            }\n            catch (error) {\n                dom[\"a\" /* CoreDomUtils */].showErrorModal(error);\n                services_navigator[\"a\" /* CoreNavigator */].back();\n                return;\n            }\n            this.assessmentId = this.assessment.id;\n            this.workshopId = this.submission.workshopid;\n            this.fetchAssessmentData();\n        }\n        /**\n         * Check if we can leave the page or not.\n         *\n         * @return Resolved if we can leave it, rejected if not.\n         */\n        canLeave() {\n            return Object(tslib_es6[\"a\" /* __awaiter */])(this, void 0, void 0, function* () {\n                if (this.forceLeave || !this.evaluating) {\n                    return true;\n                }\n                if (!this.hasEvaluationChanged()) {\n                    return true;\n                }\n                // Show confirmation if some data has been modified.\n                yield dom[\"a\" /* CoreDomUtils */].showConfirm(singletons[\"J\" /* Translate */].instant('core.confirmcanceledit'));\n                singletons_form[\"a\" /* CoreForms */].triggerFormCancelledEvent(this.formElement, this.siteId);\n                return true;\n            });\n        }\n        /**\n         * Fetch the assessment data.\n         *\n         * @return Resolved when done.\n         */\n        fetchAssessmentData() {\n            var _a, _b;\n            return Object(tslib_es6[\"a\" /* __awaiter */])(this, void 0, void 0, function* () {\n                try {\n                    this.workshop = yield workshop[\"a\" /* AddonModWorkshop */].getWorkshopById(this.courseId, this.workshopId);\n                    this.title = this.workshop.name;\n                    this.strategy = this.workshop.strategy;\n                    const gradeInfo = yield course[\"a\" /* CoreCourse */].getModuleBasicGradeInfo(this.workshop.coursemodule);\n                    this.maxGrade = gradeInfo === null || gradeInfo === void 0 ? void 0 : gradeInfo.grade;\n                    this.access = yield workshop[\"a\" /* AddonModWorkshop */].getWorkshopAccessInformation(this.workshopId, { cmId: this.workshop.coursemodule });\n                    // Load Weights selector.\n                    if (this.assessmentId && (this.access.canallocate || this.access.canoverridegrades)) {\n                        if (!this.isDestroyed) {\n                            // Block the workshop.\n                            sync[\"a\" /* CoreSync */].blockOperation(workshop[\"f\" /* AddonModWorkshopProvider */].COMPONENT, this.workshopId);\n                        }\n                        this.evaluating = true;\n                    }\n                    else {\n                        this.evaluating = false;\n                    }\n                    if (!this.evaluating && this.workshop.phase != workshop[\"e\" /* AddonModWorkshopPhase */].PHASE_CLOSED) {\n                        return;\n                    }\n                    // Get all info of the assessment.\n                    const assessment = yield workshop_helper[\"a\" /* AddonModWorkshopHelper */].getReviewerAssessmentById(this.workshopId, this.assessmentId, {\n                        userId: (_a = this.profile) === null || _a === void 0 ? void 0 : _a.id,\n                        cmId: this.workshop.coursemodule,\n                    });\n                    this.assessment = workshop_helper[\"a\" /* AddonModWorkshopHelper */].realGradeValue(this.workshop, assessment);\n                    this.evaluate.text = this.assessment.feedbackreviewer || '';\n                    this.evaluate.weight = this.assessment.weight;\n                    this.gradingGrade = (_b = this.assessment.gradinggrade) !== null && _b !== void 0 ? _b : '-';\n                    if (this.evaluating) {\n                        if (this.access.canallocate) {\n                            this.weights = [];\n                            for (let i = 16; i >= 0; i--) {\n                                this.weights[i] = i;\n                            }\n                        }\n                        if (this.access.canoverridegrades) {\n                            const defaultGrade = singletons[\"J\" /* Translate */].instant('addon.mod_workshop.notoverridden');\n                            this.evaluationGrades =\n                                yield grades_helper[\"a\" /* CoreGradesHelper */].makeGradesMenu(this.workshop.gradinggrade, undefined, defaultGrade, -1);\n                        }\n                        try {\n                            const offlineAssess = yield workshop_offline[\"a\" /* AddonModWorkshopOffline */].getEvaluateAssessment(this.workshopId, this.assessmentId);\n                            this.hasOffline = true;\n                            this.evaluate.weight = offlineAssess.weight;\n                            if (this.access.canoverridegrades) {\n                                this.evaluate.text = offlineAssess.feedbacktext || '';\n                                this.evaluate.grade = parseInt(offlineAssess.gradinggradeover, 10) || -1;\n                            }\n                        }\n                        catch (_c) {\n                            this.hasOffline = false;\n                            // No offline, load online.\n                            if (this.access.canoverridegrades) {\n                                this.evaluate.text = this.assessment.feedbackreviewer || '';\n                                this.evaluate.grade = parseInt(String(this.assessment.gradinggradeover), 10) || -1;\n                            }\n                        }\n                        finally {\n                            this.originalEvaluation.weight = this.evaluate.weight;\n                            if (this.access.canoverridegrades) {\n                                this.originalEvaluation.text = this.evaluate.text;\n                                this.originalEvaluation.grade = this.evaluate.grade;\n                            }\n                            this.evaluateForm.controls['weight'].setValue(this.evaluate.weight);\n                            if (this.access.canoverridegrades) {\n                                this.evaluateForm.controls['grade'].setValue(this.evaluate.grade);\n                                this.evaluateForm.controls['text'].setValue(this.evaluate.text);\n                            }\n                        }\n                    }\n                    else if (this.workshop.phase == workshop[\"e\" /* AddonModWorkshopPhase */].PHASE_CLOSED && this.assessment.gradinggradeoverby) {\n                        this.evaluateByProfile = yield user[\"a\" /* CoreUser */].getProfile(this.assessment.gradinggradeoverby, this.courseId, true);\n                    }\n                }\n                catch (error) {\n                    dom[\"a\" /* CoreDomUtils */].showErrorModalDefault(error, 'mm.course.errorgetmodule', true);\n                }\n                finally {\n                    this.loaded = true;\n                }\n            });\n        }\n        /**\n         * Force leaving the page, without checking for changes.\n         */\n        forceLeavePage() {\n            this.forceLeave = true;\n            services_navigator[\"a\" /* CoreNavigator */].back();\n        }\n        /**\n         * Check if data has changed.\n         *\n         * @return True if changed, false otherwise.\n         */\n        hasEvaluationChanged() {\n            if (!this.loaded || !this.evaluating) {\n                return false;\n            }\n            const inputData = this.evaluateForm.value;\n            if (this.originalEvaluation.weight != inputData.weight) {\n                return true;\n            }\n            if (this.access && this.access.canoverridegrades) {\n                if (this.originalEvaluation.text != inputData.text) {\n                    return true;\n                }\n                if (this.originalEvaluation.grade != inputData.grade) {\n                    return true;\n                }\n            }\n            return false;\n        }\n        /**\n         * Convenience function to refresh all the data.\n         *\n         * @return Resolved when done.\n         */\n        refreshAllData() {\n            return Object(tslib_es6[\"a\" /* __awaiter */])(this, void 0, void 0, function* () {\n                const promises = [];\n                promises.push(workshop[\"a\" /* AddonModWorkshop */].invalidateWorkshopData(this.courseId));\n                promises.push(workshop[\"a\" /* AddonModWorkshop */].invalidateWorkshopAccessInformationData(this.workshopId));\n                promises.push(workshop[\"a\" /* AddonModWorkshop */].invalidateReviewerAssesmentsData(this.workshopId));\n                if (this.assessmentId) {\n                    promises.push(workshop[\"a\" /* AddonModWorkshop */].invalidateAssessmentFormData(this.workshopId, this.assessmentId));\n                    promises.push(workshop[\"a\" /* AddonModWorkshop */].invalidateAssessmentData(this.workshopId, this.assessmentId));\n                }\n                try {\n                    yield Promise.all(promises);\n                }\n                finally {\n                    events[\"b\" /* CoreEvents */].trigger(workshop[\"f\" /* AddonModWorkshopProvider */].ASSESSMENT_INVALIDATED, null, this.siteId);\n                    yield this.fetchAssessmentData();\n                }\n            });\n        }\n        /**\n         * Pull to refresh.\n         *\n         * @param refresher Refresher.\n         */\n        refreshAssessment(refresher) {\n            if (this.loaded) {\n                this.refreshAllData().finally(() => {\n                    refresher === null || refresher === void 0 ? void 0 : refresher.complete();\n                });\n            }\n        }\n        /**\n         * Save the assessment evaluation.\n         */\n        saveEvaluation() {\n            return Object(tslib_es6[\"a\" /* __awaiter */])(this, void 0, void 0, function* () {\n                // Check if data has changed.\n                if (this.hasEvaluationChanged()) {\n                    yield this.sendEvaluation();\n                }\n                // Go back.\n                this.forceLeavePage();\n            });\n        }\n        /**\n         * Sends the evaluation to be saved on the server.\n         *\n         * @return Resolved when done.\n         */\n        sendEvaluation() {\n            return Object(tslib_es6[\"a\" /* __awaiter */])(this, void 0, void 0, function* () {\n                const modal = yield dom[\"a\" /* CoreDomUtils */].showModalLoading('core.sending', true);\n                const inputData = this.evaluateForm.value;\n                const grade = inputData.grade >= 0 ? String(inputData.grade) : '';\n                // Add some HTML to the message if needed.\n                const text = utils_text[\"a\" /* CoreTextUtils */].formatHtmlLines(inputData.text);\n                try {\n                    // Try to send it to server.\n                    const result = yield workshop[\"a\" /* AddonModWorkshop */].evaluateAssessment(this.workshopId, this.assessmentId, this.courseId, text, inputData.weight, grade);\n                    singletons_form[\"a\" /* CoreForms */].triggerFormSubmittedEvent(this.formElement, !!result, this.siteId);\n                    const data = {\n                        workshopId: this.workshopId,\n                        assessmentId: this.assessmentId,\n                        userId: this.currentUserId,\n                    };\n                    return workshop[\"a\" /* AddonModWorkshop */].invalidateAssessmentData(this.workshopId, this.assessmentId).finally(() => {\n                        events[\"b\" /* CoreEvents */].trigger(workshop[\"f\" /* AddonModWorkshopProvider */].ASSESSMENT_SAVED, data, this.siteId);\n                    });\n                }\n                catch (error) {\n                    dom[\"a\" /* CoreDomUtils */].showErrorModalDefault(error, 'Cannot save assessment evaluation');\n                }\n                finally {\n                    modal.dismiss();\n                }\n            });\n        }\n        /**\n         * Component being destroyed.\n         */\n        ngOnDestroy() {\n            var _a;\n            this.isDestroyed = true;\n            (_a = this.syncObserver) === null || _a === void 0 ? void 0 : _a.off();\n            // Restore original back functions.\n            sync[\"a\" /* CoreSync */].unblockOperation(workshop[\"f\" /* AddonModWorkshopProvider */].COMPONENT, this.workshopId);\n        }\n    }\n    AddonModWorkshopAssessmentPage.ɵfac = function AddonModWorkshopAssessmentPage_Factory(t) { return new (t || AddonModWorkshopAssessmentPage)(core[\"yc\" /* ɵɵdirectiveInject */](fesm2015_forms[\"f\" /* FormBuilder */])); };\n    AddonModWorkshopAssessmentPage.ɵcmp = core[\"sc\" /* ɵɵdefineComponent */]({ type: AddonModWorkshopAssessmentPage, selectors: [[\"page-addon-mod-workshop-assessment-page\"]], viewQuery: function AddonModWorkshopAssessmentPage_Query(rf, ctx) {\n            if (rf & 1) {\n                core[\"ud\" /* ɵɵviewQuery */](_c0, true);\n            }\n            if (rf & 2) {\n                var _t;\n                core[\"dd\" /* ɵɵqueryRefresh */](_t = core[\"Nc\" /* ɵɵloadQuery */]()) && (ctx.formElement = _t.first);\n            }\n        }, decls: 27, vars: 22, consts: [[\"slot\", \"start\"], [3, \"text\"], [\"contextLevel\", \"module\", 3, \"text\", \"contextInstanceId\", \"courseId\"], [\"slot\", \"end\", 3, \"hidden\"], [\"fill\", \"clear\", 3, \"click\"], [\"slot\", \"fixed\", 3, \"disabled\", \"ionRefresh\", 4, \"ngIf\"], [3, \"hideUntil\"], [1, \"ion-text-wrap\"], [\"slot\", \"start\", 3, \"user\", \"courseId\", \"userId\", 4, \"ngIf\"], [4, \"ngIf\"], [3, \"core-has-overriden-grade\", 4, \"ngIf\"], [\"class\", \"core-overriden-grade\", 4, \"ngIf\"], [\"color\", \"danger\", 4, \"ngIf\"], [3, \"workshop\", \"access\", \"assessmentId\", \"userId\", \"strategy\", 4, \"ngIf\"], [3, \"formGroup\", 4, \"ngIf\"], [\"slot\", \"fixed\", 3, \"disabled\", \"ionRefresh\"], [3, \"pullingText\"], [\"slot\", \"start\", 3, \"user\", \"courseId\", \"userId\"], [1, \"core-overriden-grade\"], [\"color\", \"danger\"], [3, \"workshop\", \"access\", \"assessmentId\", \"userId\", \"strategy\"], [3, \"formGroup\"], [\"evaluateFormEl\", \"\"], [\"class\", \"ion-text-wrap\", 4, \"ngIf\"], [\"position\", \"stacked\"], [\"core-mark-required\", \"true\"], [\"formControlName\", \"weight\", \"required\", \"true\", \"interface\", \"action-sheet\", 3, \"interfaceOptions\"], [3, \"value\", 4, \"ngFor\", \"ngForOf\"], [3, \"value\"], [\"formControlName\", \"grade\", \"interface\", \"action-sheet\", 3, \"interfaceOptions\"], [\"name\", \"text\", \"contextLevel\", \"module\", \"elementId\", \"feedbackreviewer_editor\", 3, \"control\", \"autoSave\", \"contextInstanceId\", \"draftExtraParams\"]], template: function AddonModWorkshopAssessmentPage_Template(rf, ctx) {\n            if (rf & 1) {\n                core[\"Ec\" /* ɵɵelementStart */](0, \"ion-header\");\n                core[\"Ec\" /* ɵɵelementStart */](1, \"ion-toolbar\");\n                core[\"Ec\" /* ɵɵelementStart */](2, \"ion-buttons\", 0);\n                core[\"zc\" /* ɵɵelement */](3, \"ion-back-button\", 1);\n                core[\"Pc\" /* ɵɵpipe */](4, \"translate\");\n                core[\"Dc\" /* ɵɵelementEnd */]();\n                core[\"Ec\" /* ɵɵelementStart */](5, \"ion-title\");\n                core[\"Ec\" /* ɵɵelementStart */](6, \"h1\");\n                core[\"zc\" /* ɵɵelement */](7, \"core-format-text\", 2);\n                core[\"Dc\" /* ɵɵelementEnd */]();\n                core[\"Dc\" /* ɵɵelementEnd */]();\n                core[\"Ec\" /* ɵɵelementStart */](8, \"ion-buttons\", 3);\n                core[\"Ec\" /* ɵɵelementStart */](9, \"ion-button\", 4);\n                core[\"Mc\" /* ɵɵlistener */](\"click\", function AddonModWorkshopAssessmentPage_Template_ion_button_click_9_listener() { return ctx.saveEvaluation(); });\n                core[\"pd\" /* ɵɵtext */](10);\n                core[\"Pc\" /* ɵɵpipe */](11, \"translate\");\n                core[\"Dc\" /* ɵɵelementEnd */]();\n                core[\"Dc\" /* ɵɵelementEnd */]();\n                core[\"Dc\" /* ɵɵelementEnd */]();\n                core[\"Dc\" /* ɵɵelementEnd */]();\n                core[\"Ec\" /* ɵɵelementStart */](12, \"ion-content\");\n                core[\"nd\" /* ɵɵtemplate */](13, AddonModWorkshopAssessmentPage_ion_refresher_13_Template, 3, 4, \"ion-refresher\", 5);\n                core[\"Ec\" /* ɵɵelementStart */](14, \"core-loading\", 6);\n                core[\"Ec\" /* ɵɵelementStart */](15, \"ion-item\", 7);\n                core[\"nd\" /* ɵɵtemplate */](16, AddonModWorkshopAssessmentPage_core_user_avatar_16_Template, 1, 3, \"core-user-avatar\", 8);\n                core[\"Ec\" /* ɵɵelementStart */](17, \"ion-label\");\n                core[\"nd\" /* ɵɵtemplate */](18, AddonModWorkshopAssessmentPage_h2_18_Template, 2, 1, \"h2\", 9);\n                core[\"nd\" /* ɵɵtemplate */](19, AddonModWorkshopAssessmentPage_p_19_Template, 3, 7, \"p\", 9);\n                core[\"nd\" /* ɵɵtemplate */](20, AddonModWorkshopAssessmentPage_p_20_Template, 3, 9, \"p\", 10);\n                core[\"nd\" /* ɵɵtemplate */](21, AddonModWorkshopAssessmentPage_p_21_Template, 3, 4, \"p\", 11);\n                core[\"nd\" /* ɵɵtemplate */](22, AddonModWorkshopAssessmentPage_p_22_Template, 3, 6, \"p\", 9);\n                core[\"nd\" /* ɵɵtemplate */](23, AddonModWorkshopAssessmentPage_ion_badge_23_Template, 3, 3, \"ion-badge\", 12);\n                core[\"Dc\" /* ɵɵelementEnd */]();\n                core[\"Dc\" /* ɵɵelementEnd */]();\n                core[\"nd\" /* ɵɵtemplate */](24, AddonModWorkshopAssessmentPage_addon_mod_workshop_assessment_strategy_24_Template, 1, 5, \"addon-mod-workshop-assessment-strategy\", 13);\n                core[\"nd\" /* ɵɵtemplate */](25, AddonModWorkshopAssessmentPage_form_25_Template, 17, 11, \"form\", 14);\n                core[\"nd\" /* ɵɵtemplate */](26, AddonModWorkshopAssessmentPage_ion_list_26_Template, 6, 5, \"ion-list\", 9);\n                core[\"Dc\" /* ɵɵelementEnd */]();\n                core[\"Dc\" /* ɵɵelementEnd */]();\n            }\n            if (rf & 2) {\n                core[\"lc\" /* ɵɵadvance */](3);\n                core[\"Vc\" /* ɵɵproperty */](\"text\", core[\"Qc\" /* ɵɵpipeBind1 */](4, 18, \"core.back\"));\n                core[\"lc\" /* ɵɵadvance */](4);\n                core[\"Vc\" /* ɵɵproperty */](\"text\", ctx.title)(\"contextInstanceId\", ctx.workshop && ctx.workshop.coursemodule)(\"courseId\", ctx.courseId);\n                core[\"lc\" /* ɵɵadvance */](1);\n                core[\"Vc\" /* ɵɵproperty */](\"hidden\", !ctx.evaluating);\n                core[\"lc\" /* ɵɵadvance */](2);\n                core[\"rd\" /* ɵɵtextInterpolate1 */](\" \", core[\"Qc\" /* ɵɵpipeBind1 */](11, 20, \"core.save\"), \" \");\n                core[\"lc\" /* ɵɵadvance */](3);\n                core[\"Vc\" /* ɵɵproperty */](\"ngIf\", !ctx.evaluating);\n                core[\"lc\" /* ɵɵadvance */](1);\n                core[\"Vc\" /* ɵɵproperty */](\"hideUntil\", ctx.loaded);\n                core[\"lc\" /* ɵɵadvance */](2);\n                core[\"Vc\" /* ɵɵproperty */](\"ngIf\", ctx.profile);\n                core[\"lc\" /* ɵɵadvance */](2);\n                core[\"Vc\" /* ɵɵproperty */](\"ngIf\", ctx.profile && ctx.profile.fullname);\n                core[\"lc\" /* ɵɵadvance */](1);\n                core[\"Vc\" /* ɵɵproperty */](\"ngIf\", ctx.workshop && ctx.assessment && ctx.showGrade(ctx.assessment.grade));\n                core[\"lc\" /* ɵɵadvance */](1);\n                core[\"Vc\" /* ɵɵproperty */](\"ngIf\", ctx.workshop && ctx.access && ctx.access.canviewallsubmissions && ctx.assessment && ctx.showGrade(ctx.assessment.gradinggrade));\n                core[\"lc\" /* ɵɵadvance */](1);\n                core[\"Vc\" /* ɵɵproperty */](\"ngIf\", ctx.access && ctx.access.canviewallsubmissions && ctx.assessment && ctx.showGrade(ctx.assessment.gradinggradeover));\n                core[\"lc\" /* ɵɵadvance */](1);\n                core[\"Vc\" /* ɵɵproperty */](\"ngIf\", ctx.assessment && ctx.assessment.weight && ctx.assessment.weight != 1);\n                core[\"lc\" /* ɵɵadvance */](1);\n                core[\"Vc\" /* ɵɵproperty */](\"ngIf\", !ctx.assessment || !ctx.showGrade(ctx.assessment.grade));\n                core[\"lc\" /* ɵɵadvance */](1);\n                core[\"Vc\" /* ɵɵproperty */](\"ngIf\", ctx.assessment && ctx.assessmentId && ctx.showGrade(ctx.assessment.grade) && ctx.workshop && ctx.access);\n                core[\"lc\" /* ɵɵadvance */](1);\n                core[\"Vc\" /* ɵɵproperty */](\"ngIf\", ctx.evaluating);\n                core[\"lc\" /* ɵɵadvance */](1);\n                core[\"Vc\" /* ɵɵproperty */](\"ngIf\", !ctx.evaluating && ctx.evaluate && ctx.evaluate.text);\n            }\n        }, directives: [ionic_angular[\"C\" /* IonHeader */], ionic_angular[\"Ab\" /* IonToolbar */], ionic_angular[\"m\" /* IonButtons */], ionic_angular[\"h\" /* IonBackButton */], ionic_angular[\"i\" /* IonBackButtonDelegate */], ionic_angular[\"yb\" /* IonTitle */], format_text[\"a\" /* CoreFormatTextDirective */], update_non_reactive_attributes[\"a\" /* CoreUpdateNonReactiveAttributesDirective */], ionic_angular[\"l\" /* IonButton */], content[\"a\" /* CoreContentDirective */], ionic_angular[\"v\" /* IonContent */], common[\"t\" /* NgIf */], loading[\"a\" /* CoreLoadingComponent */], ionic_angular[\"I\" /* IonItem */], ionic_angular[\"O\" /* IonLabel */], ionic_angular[\"bb\" /* IonRefresher */], ionic_angular[\"cb\" /* IonRefresherContent */], user_avatar[\"a\" /* CoreUserAvatarComponent */], ionic_angular[\"k\" /* IonBadge */], assessment_strategy[\"a\" /* AddonModWorkshopAssessmentStrategyComponent */], fesm2015_forms[\"H\" /* ɵangular_packages_forms_forms_y */], fesm2015_forms[\"s\" /* NgControlStatusGroup */], fesm2015_forms[\"k\" /* FormGroupDirective */], mark_required[\"a\" /* CoreMarkRequiredComponent */], ionic_angular[\"lb\" /* IonSelect */], ionic_angular[\"Ob\" /* SelectValueAccessor */], fesm2015_forms[\"r\" /* NgControlStatus */], fesm2015_forms[\"i\" /* FormControlName */], fesm2015_forms[\"C\" /* RequiredValidator */], common[\"s\" /* NgForOf */], ionic_angular[\"mb\" /* IonSelectOption */], rich_text_editor[\"a\" /* CoreEditorRichTextEditorComponent */], ionic_angular[\"P\" /* IonList */]], pipes: [ngx_translate_core[\"d\" /* TranslatePipe */]], encapsulation: 2 });\n    return AddonModWorkshopAssessmentPage;\n})();\n\n// EXTERNAL MODULE: ./src/core/classes/errors/error.ts\nvar errors_error = __webpack_require__(\"93ts\");\n\n// EXTERNAL MODULE: ./src/core/features/fileuploader/services/fileuploader.ts\nvar fileuploader = __webpack_require__(\"hSQQ\");\n\n// EXTERNAL MODULE: ./src/core/services/file.ts\nvar services_file = __webpack_require__(\"EmGO\");\n\n// EXTERNAL MODULE: ./src/core/services/file-helper.ts\nvar file_helper = __webpack_require__(\"L2dF\");\n\n// EXTERNAL MODULE: ./src/core/services/utils/utils.ts\nvar utils = __webpack_require__(\"bFG1\");\n\n// EXTERNAL MODULE: ./src/core/components/attachments/attachments.ts\nvar attachments = __webpack_require__(\"M9y5\");\n\n// CONCATENATED MODULE: ./src/addons/mod/workshop/pages/edit-submission/edit-submission.ts\n\n// (C) Copyright 2015 Moodle Pty Ltd.\n//\n// Licensed under the Apache License, Version 2.0 (the \"License\");\n// you may not use this file except in compliance with the License.\n// You may obtain a copy of the License at\n//\n//     http://www.apache.org/licenses/LICENSE-2.0\n//\n// Unless required by applicable law or agreed to in writing, software\n// distributed under the License is distributed on an \"AS IS\" BASIS,\n// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n// See the License for the specific language governing permissions and\n// limitations under the License.\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nconst edit_submission_c0 = [\"editFormEl\"];\nfunction AddonModWorkshopEditSubmissionPage_form_16_ion_item_9_Template(rf, ctx) {\n    if (rf & 1) {\n        core[\"Ec\" /* ɵɵelementStart */](0, \"ion-item\");\n        core[\"Ec\" /* ɵɵelementStart */](1, \"ion-label\", 9);\n        core[\"Ec\" /* ɵɵelementStart */](2, \"span\", 14);\n        core[\"pd\" /* ɵɵtext */](3);\n        core[\"Pc\" /* ɵɵpipe */](4, \"translate\");\n        core[\"Dc\" /* ɵɵelementEnd */]();\n        core[\"Dc\" /* ɵɵelementEnd */]();\n        core[\"zc\" /* ɵɵelement */](5, \"core-rich-text-editor\", 15);\n        core[\"Pc\" /* ɵɵpipe */](6, \"translate\");\n        core[\"Dc\" /* ɵɵelementEnd */]();\n    }\n    if (rf & 2) {\n        const ctx_r2 = core[\"Oc\" /* ɵɵnextContext */](2);\n        core[\"lc\" /* ɵɵadvance */](2);\n        core[\"Vc\" /* ɵɵproperty */](\"core-mark-required\", ctx_r2.textRequired);\n        core[\"lc\" /* ɵɵadvance */](1);\n        core[\"rd\" /* ɵɵtextInterpolate1 */](\" \", core[\"Qc\" /* ɵɵpipeBind1 */](4, 9, \"addon.mod_workshop.submissioncontent\"), \" \");\n        core[\"lc\" /* ɵɵadvance */](2);\n        core[\"Vc\" /* ɵɵproperty */](\"control\", ctx_r2.editForm.controls[\"content\"])(\"placeholder\", core[\"Qc\" /* ɵɵpipeBind1 */](6, 11, \"addon.mod_workshop.submissioncontent\"))(\"component\", ctx_r2.component)(\"componentId\", ctx_r2.componentId)(\"autoSave\", true)(\"contextInstanceId\", ctx_r2.module.id)(\"draftExtraParams\", ctx_r2.editorExtraParams);\n    }\n}\nfunction AddonModWorkshopEditSubmissionPage_form_16_core_attachments_10_Template(rf, ctx) {\n    if (rf & 1) {\n        core[\"zc\" /* ɵɵelement */](0, \"core-attachments\", 16);\n    }\n    if (rf & 2) {\n        const ctx_r3 = core[\"Oc\" /* ɵɵnextContext */](2);\n        core[\"Vc\" /* ɵɵproperty */](\"files\", ctx_r3.attachments)(\"maxSize\", ctx_r3.workshop.maxbytes)(\"maxSubmissions\", ctx_r3.workshop.nattachments)(\"component\", ctx_r3.component)(\"componentId\", ctx_r3.workshop.coursemodule)(\"acceptedTypes\", ctx_r3.workshop.submissionfiletypes)(\"required\", ctx_r3.fileRequired)(\"courseId\", ctx_r3.workshop.course);\n    }\n}\nfunction AddonModWorkshopEditSubmissionPage_form_16_Template(rf, ctx) {\n    if (rf & 1) {\n        core[\"Ec\" /* ɵɵelementStart */](0, \"form\", 6, 7);\n        core[\"Ec\" /* ɵɵelementStart */](2, \"ion-item\", 8);\n        core[\"Ec\" /* ɵɵelementStart */](3, \"ion-label\", 9);\n        core[\"Ec\" /* ɵɵelementStart */](4, \"span\", 10);\n        core[\"pd\" /* ɵɵtext */](5);\n        core[\"Pc\" /* ɵɵpipe */](6, \"translate\");\n        core[\"Dc\" /* ɵɵelementEnd */]();\n        core[\"Dc\" /* ɵɵelementEnd */]();\n        core[\"zc\" /* ɵɵelement */](7, \"ion-input\", 11);\n        core[\"Pc\" /* ɵɵpipe */](8, \"translate\");\n        core[\"Dc\" /* ɵɵelementEnd */]();\n        core[\"nd\" /* ɵɵtemplate */](9, AddonModWorkshopEditSubmissionPage_form_16_ion_item_9_Template, 7, 13, \"ion-item\", 12);\n        core[\"nd\" /* ɵɵtemplate */](10, AddonModWorkshopEditSubmissionPage_form_16_core_attachments_10_Template, 1, 8, \"core-attachments\", 13);\n        core[\"Dc\" /* ɵɵelementEnd */]();\n    }\n    if (rf & 2) {\n        const ctx_r0 = core[\"Oc\" /* ɵɵnextContext */]();\n        core[\"Vc\" /* ɵɵproperty */](\"formGroup\", ctx_r0.editForm);\n        core[\"lc\" /* ɵɵadvance */](5);\n        core[\"rd\" /* ɵɵtextInterpolate1 */](\" \", core[\"Qc\" /* ɵɵpipeBind1 */](6, 5, \"addon.mod_workshop.submissiontitle\"), \" \");\n        core[\"lc\" /* ɵɵadvance */](2);\n        core[\"Vc\" /* ɵɵproperty */](\"placeholder\", core[\"Qc\" /* ɵɵpipeBind1 */](8, 7, \"addon.mod_workshop.submissiontitle\"));\n        core[\"lc\" /* ɵɵadvance */](2);\n        core[\"Vc\" /* ɵɵproperty */](\"ngIf\", ctx_r0.textAvailable);\n        core[\"lc\" /* ɵɵadvance */](1);\n        core[\"Vc\" /* ɵɵproperty */](\"ngIf\", ctx_r0.fileAvailable);\n    }\n}\n/**\n * Page that displays the workshop edit submission.\n */\nlet edit_submission_AddonModWorkshopEditSubmissionPage = /*@__PURE__*/ (() => {\n    class AddonModWorkshopEditSubmissionPage {\n        constructor(fb) {\n            this.fb = fb;\n            this.loaded = false;\n            this.component = workshop[\"f\" /* AddonModWorkshopProvider */].COMPONENT;\n            this.editorExtraParams = {}; // Extra params to identify the draft.\n            this.textAvailable = false;\n            this.textRequired = false;\n            this.fileAvailable = false;\n            this.fileRequired = false;\n            this.attachments = [];\n            this.submissionId = 0;\n            this.originalData = {\n                title: '',\n                content: '',\n                attachmentfiles: [],\n            };\n            this.hasOffline = false;\n            this.editing = false;\n            this.forceLeave = false;\n            this.isDestroyed = false;\n            this.userId = sites[\"b\" /* CoreSites */].getCurrentSiteUserId();\n            this.siteId = sites[\"b\" /* CoreSites */].getCurrentSiteId();\n            this.editForm = new fesm2015_forms[\"j\" /* FormGroup */]({});\n            this.editForm.addControl('title', this.fb.control('', fesm2015_forms[\"F\" /* Validators */].required));\n            this.editForm.addControl('content', this.fb.control(''));\n        }\n        /**\n         * Component being initialized.\n         */\n        ngOnInit() {\n            try {\n                this.module = services_navigator[\"a\" /* CoreNavigator */].getRequiredRouteParam('module');\n                this.courseId = services_navigator[\"a\" /* CoreNavigator */].getRequiredRouteNumberParam('courseId');\n                this.access = services_navigator[\"a\" /* CoreNavigator */].getRequiredRouteParam('access');\n                this.submissionId = services_navigator[\"a\" /* CoreNavigator */].getRouteNumberParam('submissionId') || 0;\n            }\n            catch (error) {\n                dom[\"a\" /* CoreDomUtils */].showErrorModal(error);\n                services_navigator[\"a\" /* CoreNavigator */].back();\n                return;\n            }\n            if (this.submissionId > 0) {\n                this.editorExtraParams.id = this.submissionId;\n            }\n            this.workshopId = this.module.instance;\n            this.componentId = this.module.id;\n            if (!this.isDestroyed) {\n                // Block the workshop.\n                sync[\"a\" /* CoreSync */].blockOperation(this.component, this.workshopId);\n            }\n            this.fetchSubmissionData();\n        }\n        /**\n         * Check if we can leave the page or not.\n         *\n         * @return Resolved if we can leave it, rejected if not.\n         */\n        canLeave() {\n            var _a;\n            return Object(tslib_es6[\"a\" /* __awaiter */])(this, void 0, void 0, function* () {\n                if (this.forceLeave) {\n                    return true;\n                }\n                // Check if data has changed.\n                if (this.hasDataChanged()) {\n                    // Show confirmation if some data has been modified.\n                    yield dom[\"a\" /* CoreDomUtils */].showConfirm(singletons[\"J\" /* Translate */].instant('core.confirmcanceledit'));\n                }\n                if ((_a = this.submission) === null || _a === void 0 ? void 0 : _a.attachmentfiles) {\n                    // Delete the local files from the tmp folder.\n                    fileuploader[\"a\" /* CoreFileUploader */].clearTmpFiles(this.submission.attachmentfiles);\n                }\n                singletons_form[\"a\" /* CoreForms */].triggerFormCancelledEvent(this.formElement, this.siteId);\n                return true;\n            });\n        }\n        /**\n         * Fetch the submission data.\n         *\n         * @return Resolved when done.\n         */\n        fetchSubmissionData() {\n            return Object(tslib_es6[\"a\" /* __awaiter */])(this, void 0, void 0, function* () {\n                try {\n                    this.workshop = yield workshop[\"a\" /* AddonModWorkshop */].getWorkshop(this.courseId, this.module.id);\n                    this.textAvailable = (this.workshop.submissiontypetext != workshop[\"g\" /* AddonModWorkshopSubmissionType */].SUBMISSION_TYPE_DISABLED);\n                    this.textRequired = (this.workshop.submissiontypetext == workshop[\"g\" /* AddonModWorkshopSubmissionType */].SUBMISSION_TYPE_REQUIRED);\n                    this.fileAvailable = (this.workshop.submissiontypefile != workshop[\"g\" /* AddonModWorkshopSubmissionType */].SUBMISSION_TYPE_DISABLED);\n                    this.fileRequired = (this.workshop.submissiontypefile == workshop[\"g\" /* AddonModWorkshopSubmissionType */].SUBMISSION_TYPE_REQUIRED);\n                    this.editForm.controls.content.setValidators(this.textRequired ? fesm2015_forms[\"F\" /* Validators */].required : null);\n                    if (this.submissionId > 0) {\n                        this.editing = true;\n                        this.submission =\n                            yield workshop_helper[\"a\" /* AddonModWorkshopHelper */].getSubmissionById(this.workshopId, this.submissionId, { cmId: this.module.id });\n                        const canEdit = this.userId == this.submission.authorid &&\n                            this.access.cansubmit &&\n                            this.access.modifyingsubmissionallowed;\n                        if (!canEdit) {\n                            // Should not happen, but go back if does.\n                            this.forceLeavePage();\n                            return;\n                        }\n                    }\n                    else if (!this.access.cansubmit || !this.access.creatingsubmissionallowed) {\n                        // Should not happen, but go back if does.\n                        this.forceLeavePage();\n                        return;\n                    }\n                    const submissionsActions = yield workshop_offline[\"a\" /* AddonModWorkshopOffline */].getSubmissions(this.workshopId);\n                    if (submissionsActions && submissionsActions.length) {\n                        this.hasOffline = true;\n                        this.submission = yield workshop_helper[\"a\" /* AddonModWorkshopHelper */].applyOfflineData(this.submission, submissionsActions);\n                    }\n                    else {\n                        this.hasOffline = false;\n                    }\n                    if (this.submission) {\n                        this.originalData.title = this.submission.title || '';\n                        this.originalData.content = this.submission.content || '';\n                        this.originalData.attachmentfiles = [];\n                        (this.submission.attachmentfiles || []).forEach((file) => {\n                            let filename = services_file[\"a\" /* CoreFile */].getFileName(file);\n                            if (!filename) {\n                                // We don't have filename, extract it from the path.\n                                filename = file_helper[\"a\" /* CoreFileHelper */].getFilenameFromPath(file) || '';\n                            }\n                            this.originalData.attachmentfiles.push({\n                                filename,\n                                fileurl: 'fileurl' in file ? file.fileurl : '',\n                            });\n                        });\n                        this.editForm.controls['title'].setValue(this.submission.title);\n                        this.editForm.controls['content'].setValue(this.submission.content);\n                        this.attachments = this.submission.attachmentfiles || [];\n                    }\n                    this.loaded = true;\n                }\n                catch (error) {\n                    this.loaded = false;\n                    dom[\"a\" /* CoreDomUtils */].showErrorModalDefault(error, 'core.course.errorgetmodule', true);\n                    this.forceLeavePage();\n                }\n            });\n        }\n        /**\n         * Force leaving the page, without checking for changes.\n         */\n        forceLeavePage() {\n            this.forceLeave = true;\n            services_navigator[\"a\" /* CoreNavigator */].back();\n        }\n        /**\n         * Get the form input data.\n         *\n         * @return Object with all the info.\n         */\n        getInputData() {\n            const values = {\n                title: this.editForm.value.title,\n                content: '',\n                attachmentfiles: [],\n            };\n            if (this.textAvailable) {\n                values.content = this.editForm.value.content || '';\n            }\n            if (this.fileAvailable) {\n                values.attachmentfiles = this.attachments;\n            }\n            return values;\n        }\n        /**\n         * Check if data has changed.\n         *\n         * @return True if changed or false if not.\n         */\n        hasDataChanged() {\n            if (!this.loaded) {\n                return false;\n            }\n            const inputData = this.getInputData();\n            if (this.originalData.title != inputData.title || this.textAvailable && this.originalData.content != inputData.content) {\n                return true;\n            }\n            if (this.fileAvailable) {\n                return fileuploader[\"a\" /* CoreFileUploader */].areFileListDifferent(inputData.attachmentfiles, this.originalData.attachmentfiles);\n            }\n            return false;\n        }\n        /**\n         * Save the submission.\n         */\n        save() {\n            return Object(tslib_es6[\"a\" /* __awaiter */])(this, void 0, void 0, function* () {\n                // Check if data has changed.\n                if (this.hasDataChanged()) {\n                    try {\n                        yield this.saveSubmission();\n                        // Go back to entry list.\n                        this.forceLeavePage();\n                    }\n                    catch (_a) {\n                        // Nothing to do.\n                    }\n                }\n                else {\n                    // Nothing to save, just go back.\n                    this.forceLeavePage();\n                }\n            });\n        }\n        /**\n         * Send submission and save.\n         *\n         * @return Resolved when done.\n         */\n        saveSubmission() {\n            var _a;\n            return Object(tslib_es6[\"a\" /* __awaiter */])(this, void 0, void 0, function* () {\n                const inputData = this.getInputData();\n                if (!inputData.title) {\n                    dom[\"a\" /* CoreDomUtils */].showAlertTranslated('core.notice', 'addon.mod_workshop.submissionrequiredtitle');\n                    throw new errors_error[\"a\" /* CoreError */](singletons[\"J\" /* Translate */].instant('addon.mod_workshop.submissionrequiredtitle'));\n                }\n                const noText = utils_text[\"a\" /* CoreTextUtils */].htmlIsBlank(inputData.content);\n                const noFiles = !inputData.attachmentfiles.length;\n                if ((this.textRequired && noText) || (this.fileRequired && noFiles) || (noText && noFiles)) {\n                    dom[\"a\" /* CoreDomUtils */].showAlertTranslated('core.notice', 'addon.mod_workshop.submissionrequiredcontent');\n                    throw new errors_error[\"a\" /* CoreError */](singletons[\"J\" /* Translate */].instant('addon.mod_workshop.submissionrequiredcontent'));\n                }\n                let saveOffline = false;\n                const modal = yield dom[\"a\" /* CoreDomUtils */].showModalLoading('core.sending', true);\n                const submissionId = (_a = this.submission) === null || _a === void 0 ? void 0 : _a.id;\n                // Add some HTML to the message if needed.\n                if (this.textAvailable) {\n                    inputData.content = utils_text[\"a\" /* CoreTextUtils */].formatHtmlLines(inputData.content);\n                }\n                // Upload attachments first if any.\n                let allowOffline = !inputData.attachmentfiles.length;\n                try {\n                    let attachmentsId;\n                    let storeFilesResult;\n                    try {\n                        attachmentsId = yield workshop_helper[\"a\" /* AddonModWorkshopHelper */].uploadOrStoreSubmissionFiles(this.workshopId, inputData.attachmentfiles, false);\n                    }\n                    catch (error) {\n                        if (utils[\"a\" /* CoreUtils */].isWebServiceError(error)) {\n                            throw error;\n                        }\n                        // Cannot upload them in online, save them in offline.\n                        saveOffline = true;\n                        allowOffline = true;\n                        storeFilesResult = yield workshop_helper[\"a\" /* AddonModWorkshopHelper */].uploadOrStoreSubmissionFiles(this.workshopId, inputData.attachmentfiles, true);\n                    }\n                    if (!saveOffline && !this.fileAvailable) {\n                        attachmentsId = undefined;\n                    }\n                    let newSubmissionId;\n                    if (this.editing) {\n                        if (saveOffline) {\n                            // Save submission in offline.\n                            yield workshop_offline[\"a\" /* AddonModWorkshopOffline */].saveSubmission(this.workshopId, this.courseId, inputData.title, inputData.content, storeFilesResult, submissionId, workshop[\"b\" /* AddonModWorkshopAction */].UPDATE);\n                            newSubmissionId = false;\n                        }\n                        else {\n                            // Try to send it to server.\n                            // Don't allow offline if there are attachments since they were uploaded fine.\n                            newSubmissionId = yield workshop[\"a\" /* AddonModWorkshop */].updateSubmission(this.workshopId, submissionId, this.courseId, inputData.title, inputData.content, attachmentsId, undefined, allowOffline);\n                        }\n                    }\n                    else {\n                        if (saveOffline) {\n                            // Save submission in offline.\n                            yield workshop_offline[\"a\" /* AddonModWorkshopOffline */].saveSubmission(this.workshopId, this.courseId, inputData.title, inputData.content, storeFilesResult, undefined, workshop[\"b\" /* AddonModWorkshopAction */].ADD);\n                            newSubmissionId = false;\n                        }\n                        else {\n                            // Try to send it to server.\n                            // Don't allow offline if there are attachments since they were uploaded fine.\n                            newSubmissionId = yield workshop[\"a\" /* AddonModWorkshop */].addSubmission(this.workshopId, this.courseId, inputData.title, inputData.content, attachmentsId, undefined, allowOffline);\n                        }\n                    }\n                    singletons_form[\"a\" /* CoreForms */].triggerFormSubmittedEvent(this.formElement, !!newSubmissionId, this.siteId);\n                    const data = {\n                        workshopId: this.workshopId,\n                    };\n                    if (newSubmissionId) {\n                        // Data sent to server, delete stored files (if any).\n                        workshop_offline[\"a\" /* AddonModWorkshopOffline */].deleteSubmissionAction(this.workshopId, this.editing ? workshop[\"b\" /* AddonModWorkshopAction */].UPDATE : workshop[\"b\" /* AddonModWorkshopAction */].ADD);\n                        workshop_helper[\"a\" /* AddonModWorkshopHelper */].deleteSubmissionStoredFiles(this.workshopId, this.siteId);\n                        data.submissionId = newSubmissionId;\n                    }\n                    events[\"b\" /* CoreEvents */].trigger(events[\"b\" /* CoreEvents */].ACTIVITY_DATA_SENT, { module: 'workshop' });\n                    const promise = newSubmissionId ? workshop[\"a\" /* AddonModWorkshop */].invalidateSubmissionData(this.workshopId, newSubmissionId) :\n                        Promise.resolve();\n                    yield promise.finally(() => {\n                        events[\"b\" /* CoreEvents */].trigger(workshop[\"f\" /* AddonModWorkshopProvider */].SUBMISSION_CHANGED, data, this.siteId);\n                        // Delete the local files from the tmp folder.\n                        fileuploader[\"a\" /* CoreFileUploader */].clearTmpFiles(inputData.attachmentfiles);\n                    });\n                }\n                catch (error) {\n                    dom[\"a\" /* CoreDomUtils */].showErrorModalDefault(error, 'Cannot save submission');\n                }\n                finally {\n                    modal.dismiss();\n                }\n            });\n        }\n        getFilesComponentId() {\n            const id = this.submissionId > 0\n                ? this.submissionId\n                : 'newsub';\n            return this.workshopId + '_' + id;\n        }\n        /**\n         * Component being destroyed.\n         */\n        ngOnDestroy() {\n            this.isDestroyed = true;\n            sync[\"a\" /* CoreSync */].unblockOperation(this.component, this.workshopId);\n        }\n    }\n    AddonModWorkshopEditSubmissionPage.ɵfac = function AddonModWorkshopEditSubmissionPage_Factory(t) { return new (t || AddonModWorkshopEditSubmissionPage)(core[\"yc\" /* ɵɵdirectiveInject */](fesm2015_forms[\"f\" /* FormBuilder */])); };\n    AddonModWorkshopEditSubmissionPage.ɵcmp = core[\"sc\" /* ɵɵdefineComponent */]({ type: AddonModWorkshopEditSubmissionPage, selectors: [[\"page-addon-mod-workshop-edit-submission\"]], viewQuery: function AddonModWorkshopEditSubmissionPage_Query(rf, ctx) {\n            if (rf & 1) {\n                core[\"ud\" /* ɵɵviewQuery */](edit_submission_c0, true);\n            }\n            if (rf & 2) {\n                var _t;\n                core[\"dd\" /* ɵɵqueryRefresh */](_t = core[\"Nc\" /* ɵɵloadQuery */]()) && (ctx.formElement = _t.first);\n            }\n        }, decls: 17, vars: 14, consts: [[\"slot\", \"start\"], [3, \"text\"], [\"slot\", \"end\"], [\"fill\", \"clear\", 3, \"click\"], [3, \"hideUntil\"], [3, \"formGroup\", 4, \"ngIf\"], [3, \"formGroup\"], [\"editFormEl\", \"\"], [1, \"ion-text-wrap\"], [\"position\", \"stacked\"], [\"core-mark-required\", \"true\"], [\"name\", \"title\", \"type\", \"text\", \"formControlName\", \"title\", 3, \"placeholder\"], [4, \"ngIf\"], [\"allowOffline\", \"true\", 3, \"files\", \"maxSize\", \"maxSubmissions\", \"component\", \"componentId\", \"acceptedTypes\", \"required\", \"courseId\", 4, \"ngIf\"], [3, \"core-mark-required\"], [\"name\", \"content\", \"contextLevel\", \"module\", \"elementId\", \"content_editor\", 3, \"control\", \"placeholder\", \"component\", \"componentId\", \"autoSave\", \"contextInstanceId\", \"draftExtraParams\"], [\"allowOffline\", \"true\", 3, \"files\", \"maxSize\", \"maxSubmissions\", \"component\", \"componentId\", \"acceptedTypes\", \"required\", \"courseId\"]], template: function AddonModWorkshopEditSubmissionPage_Template(rf, ctx) {\n            if (rf & 1) {\n                core[\"Ec\" /* ɵɵelementStart */](0, \"ion-header\");\n                core[\"Ec\" /* ɵɵelementStart */](1, \"ion-toolbar\");\n                core[\"Ec\" /* ɵɵelementStart */](2, \"ion-buttons\", 0);\n                core[\"zc\" /* ɵɵelement */](3, \"ion-back-button\", 1);\n                core[\"Pc\" /* ɵɵpipe */](4, \"translate\");\n                core[\"Dc\" /* ɵɵelementEnd */]();\n                core[\"Ec\" /* ɵɵelementStart */](5, \"ion-title\");\n                core[\"Ec\" /* ɵɵelementStart */](6, \"h1\");\n                core[\"pd\" /* ɵɵtext */](7);\n                core[\"Pc\" /* ɵɵpipe */](8, \"translate\");\n                core[\"Dc\" /* ɵɵelementEnd */]();\n                core[\"Dc\" /* ɵɵelementEnd */]();\n                core[\"Ec\" /* ɵɵelementStart */](9, \"ion-buttons\", 2);\n                core[\"Ec\" /* ɵɵelementStart */](10, \"ion-button\", 3);\n                core[\"Mc\" /* ɵɵlistener */](\"click\", function AddonModWorkshopEditSubmissionPage_Template_ion_button_click_10_listener() { return ctx.save(); });\n                core[\"Pc\" /* ɵɵpipe */](11, \"translate\");\n                core[\"pd\" /* ɵɵtext */](12);\n                core[\"Pc\" /* ɵɵpipe */](13, \"translate\");\n                core[\"Dc\" /* ɵɵelementEnd */]();\n                core[\"Dc\" /* ɵɵelementEnd */]();\n                core[\"Dc\" /* ɵɵelementEnd */]();\n                core[\"Dc\" /* ɵɵelementEnd */]();\n                core[\"Ec\" /* ɵɵelementStart */](14, \"ion-content\");\n                core[\"Ec\" /* ɵɵelementStart */](15, \"core-loading\", 4);\n                core[\"nd\" /* ɵɵtemplate */](16, AddonModWorkshopEditSubmissionPage_form_16_Template, 11, 9, \"form\", 5);\n                core[\"Dc\" /* ɵɵelementEnd */]();\n                core[\"Dc\" /* ɵɵelementEnd */]();\n            }\n            if (rf & 2) {\n                core[\"lc\" /* ɵɵadvance */](3);\n                core[\"Vc\" /* ɵɵproperty */](\"text\", core[\"Qc\" /* ɵɵpipeBind1 */](4, 6, \"core.back\"));\n                core[\"lc\" /* ɵɵadvance */](4);\n                core[\"qd\" /* ɵɵtextInterpolate */](core[\"Qc\" /* ɵɵpipeBind1 */](8, 8, \"addon.mod_workshop.editsubmission\"));\n                core[\"lc\" /* ɵɵadvance */](3);\n                core[\"mc\" /* ɵɵattribute */](\"aria-label\", core[\"Qc\" /* ɵɵpipeBind1 */](11, 10, \"core.save\"));\n                core[\"lc\" /* ɵɵadvance */](2);\n                core[\"rd\" /* ɵɵtextInterpolate1 */](\" \", core[\"Qc\" /* ɵɵpipeBind1 */](13, 12, \"core.save\"), \" \");\n                core[\"lc\" /* ɵɵadvance */](3);\n                core[\"Vc\" /* ɵɵproperty */](\"hideUntil\", ctx.loaded);\n                core[\"lc\" /* ɵɵadvance */](1);\n                core[\"Vc\" /* ɵɵproperty */](\"ngIf\", ctx.workshop);\n            }\n        }, directives: [ionic_angular[\"C\" /* IonHeader */], ionic_angular[\"Ab\" /* IonToolbar */], ionic_angular[\"m\" /* IonButtons */], ionic_angular[\"h\" /* IonBackButton */], ionic_angular[\"i\" /* IonBackButtonDelegate */], ionic_angular[\"yb\" /* IonTitle */], update_non_reactive_attributes[\"a\" /* CoreUpdateNonReactiveAttributesDirective */], ionic_angular[\"l\" /* IonButton */], content[\"a\" /* CoreContentDirective */], ionic_angular[\"v\" /* IonContent */], loading[\"a\" /* CoreLoadingComponent */], common[\"t\" /* NgIf */], fesm2015_forms[\"H\" /* ɵangular_packages_forms_forms_y */], fesm2015_forms[\"s\" /* NgControlStatusGroup */], fesm2015_forms[\"k\" /* FormGroupDirective */], ionic_angular[\"I\" /* IonItem */], ionic_angular[\"O\" /* IonLabel */], mark_required[\"a\" /* CoreMarkRequiredComponent */], ionic_angular[\"H\" /* IonInput */], ionic_angular[\"Pb\" /* TextValueAccessor */], fesm2015_forms[\"r\" /* NgControlStatus */], fesm2015_forms[\"i\" /* FormControlName */], rich_text_editor[\"a\" /* CoreEditorRichTextEditorComponent */], attachments[\"a\" /* CoreAttachmentsComponent */]], pipes: [ngx_translate_core[\"d\" /* TranslatePipe */]], encapsulation: 2 });\n    return AddonModWorkshopEditSubmissionPage;\n})();\n\n// EXTERNAL MODULE: ./src/core/components/bs-tooltip/bs-tooltip.ts\nvar bs_tooltip = __webpack_require__(\"aEIl\");\n\n// EXTERNAL MODULE: ./src/core/components/button-with-spinner/button-with-spinner.ts\nvar button_with_spinner = __webpack_require__(\"3zv0\");\n\n// EXTERNAL MODULE: ./src/core/components/chart/chart.ts\nvar chart = __webpack_require__(\"Lmwl\");\n\n// EXTERNAL MODULE: ./src/core/components/chrono/chrono.ts\nvar chrono = __webpack_require__(\"4qNr\");\n\n// EXTERNAL MODULE: ./src/core/components/context-menu/context-menu.ts + 4 modules\nvar context_menu = __webpack_require__(\"fQ68\");\n\n// EXTERNAL MODULE: ./src/core/components/context-menu/context-menu-item.ts\nvar context_menu_item = __webpack_require__(\"8/N+\");\n\n// EXTERNAL MODULE: ./src/core/components/context-menu/context-menu-popover.ts\nvar context_menu_popover = __webpack_require__(\"0QZc\");\n\n// EXTERNAL MODULE: ./src/core/components/download-refresh/download-refresh.ts\nvar download_refresh = __webpack_require__(\"uHIS\");\n\n// EXTERNAL MODULE: ./src/core/components/dynamic-component/dynamic-component.ts\nvar dynamic_component = __webpack_require__(\"w+Pn\");\n\n// EXTERNAL MODULE: ./src/core/components/empty-box/empty-box.ts\nvar empty_box = __webpack_require__(\"r8G5\");\n\n// EXTERNAL MODULE: ./src/core/components/file/file.ts\nvar file_file = __webpack_require__(\"5450\");\n\n// EXTERNAL MODULE: ./src/core/components/files/files.ts\nvar files = __webpack_require__(\"W5pS\");\n\n// EXTERNAL MODULE: ./src/core/components/group-selector/group-selector.ts\nvar group_selector = __webpack_require__(\"WPIK\");\n\n// EXTERNAL MODULE: ./src/core/components/icon/icon.ts\nvar icon = __webpack_require__(\"p+Qc\");\n\n// EXTERNAL MODULE: ./src/core/components/iframe/iframe.ts\nvar iframe = __webpack_require__(\"qNqN\");\n\n// EXTERNAL MODULE: ./src/core/components/infinite-loading/infinite-loading.ts\nvar infinite_loading = __webpack_require__(\"xpMl\");\n\n// EXTERNAL MODULE: ./src/core/components/input-errors/input-errors.ts\nvar input_errors = __webpack_require__(\"FTxb\");\n\n// EXTERNAL MODULE: ./src/core/components/local-file/local-file.ts\nvar local_file = __webpack_require__(\"/K1O\");\n\n// EXTERNAL MODULE: ./src/core/components/message/message.ts\nvar message = __webpack_require__(\"9pYf\");\n\n// EXTERNAL MODULE: ./src/core/components/mod-icon/mod-icon.ts\nvar mod_icon = __webpack_require__(\"eAud\");\n\n// EXTERNAL MODULE: ./src/core/components/navbar-buttons/navbar-buttons.ts\nvar navbar_buttons = __webpack_require__(\"ACV2\");\n\n// EXTERNAL MODULE: ./src/core/components/navigation-bar/navigation-bar.ts\nvar navigation_bar = __webpack_require__(\"/BoF\");\n\n// EXTERNAL MODULE: ./src/core/components/progress-bar/progress-bar.ts\nvar progress_bar = __webpack_require__(\"TKc2\");\n\n// EXTERNAL MODULE: ./src/core/components/recaptcha/recaptcha.ts\nvar recaptcha = __webpack_require__(\"whRm\");\n\n// EXTERNAL MODULE: ./src/core/components/send-message-form/send-message-form.ts\nvar send_message_form = __webpack_require__(\"O4u7\");\n\n// EXTERNAL MODULE: ./src/core/components/show-password/show-password.ts\nvar show_password = __webpack_require__(\"lqoc\");\n\n// EXTERNAL MODULE: ./src/core/components/site-picker/site-picker.ts\nvar site_picker = __webpack_require__(\"3lz8\");\n\n// EXTERNAL MODULE: ./src/core/components/split-view/split-view.ts\nvar split_view = __webpack_require__(\"46ml\");\n\n// EXTERNAL MODULE: ./src/core/components/style/style.ts\nvar style = __webpack_require__(\"QQhE\");\n\n// EXTERNAL MODULE: ./src/core/components/swipe-slides/swipe-slides.ts\nvar swipe_slides = __webpack_require__(\"MpCO\");\n\n// EXTERNAL MODULE: ./src/core/components/tabs/tab.ts\nvar tab = __webpack_require__(\"JYLr\");\n\n// EXTERNAL MODULE: ./src/core/components/tabs/tabs.ts\nvar tabs = __webpack_require__(\"vWwc\");\n\n// EXTERNAL MODULE: ./src/core/components/tabs-outlet/tabs-outlet.ts\nvar tabs_outlet = __webpack_require__(\"NhJP\");\n\n// EXTERNAL MODULE: ./src/core/components/timer/timer.ts\nvar timer = __webpack_require__(\"rztj\");\n\n// EXTERNAL MODULE: ./src/core/components/combobox/combobox.ts\nvar combobox = __webpack_require__(\"rf3J\");\n\n// EXTERNAL MODULE: ./src/core/components/spacer/spacer.ts\nvar spacer = __webpack_require__(\"nEkO\");\n\n// EXTERNAL MODULE: ./src/core/components/horizontal-scroll-controls/horizontal-scroll-controls.ts\nvar horizontal_scroll_controls = __webpack_require__(\"TF0o\");\n\n// EXTERNAL MODULE: ./src/core/components/swipe-navigation-tour/swipe-navigation-tour.ts\nvar swipe_navigation_tour = __webpack_require__(\"p5uK\");\n\n// EXTERNAL MODULE: ./src/core/directives/auto-focus.ts\nvar auto_focus = __webpack_require__(\"6uVz\");\n\n// EXTERNAL MODULE: ./src/core/directives/auto-rows.ts\nvar auto_rows = __webpack_require__(\"d0nH\");\n\n// EXTERNAL MODULE: ./src/core/directives/external-content.ts\nvar external_content = __webpack_require__(\"NcPy\");\n\n// EXTERNAL MODULE: ./src/core/directives/fab.ts\nvar fab = __webpack_require__(\"yNDK\");\n\n// EXTERNAL MODULE: ./src/core/directives/fa-icon.ts\nvar fa_icon = __webpack_require__(\"3CSS\");\n\n// EXTERNAL MODULE: ./src/core/directives/link.ts\nvar directives_link = __webpack_require__(\"iSJP\");\n\n// EXTERNAL MODULE: ./src/core/directives/long-press.ts\nvar long_press = __webpack_require__(\"iJls\");\n\n// EXTERNAL MODULE: ./src/core/directives/supress-events.ts\nvar supress_events = __webpack_require__(\"ArDJ\");\n\n// EXTERNAL MODULE: ./src/core/directives/user-link.ts\nvar user_link = __webpack_require__(\"nu3w\");\n\n// EXTERNAL MODULE: ./src/core/directives/aria-button.ts\nvar aria_button = __webpack_require__(\"saTE\");\n\n// EXTERNAL MODULE: ./src/core/directives/on-resize.ts\nvar on_resize = __webpack_require__(\"8PoL\");\n\n// EXTERNAL MODULE: ./src/core/directives/download-file.ts\nvar download_file = __webpack_require__(\"4a38\");\n\n// EXTERNAL MODULE: ./src/core/directives/swipe-navigation.ts\nvar swipe_navigation = __webpack_require__(\"OZH1\");\n\n// EXTERNAL MODULE: ./src/core/directives/collapsible-item.ts\nvar collapsible_item = __webpack_require__(\"edOc\");\n\n// EXTERNAL MODULE: ./src/core/directives/collapsible-footer.ts\nvar collapsible_footer = __webpack_require__(\"3jOR\");\n\n// EXTERNAL MODULE: ./src/core/directives/user-tour.ts\nvar user_tour = __webpack_require__(\"6A9T\");\n\n// EXTERNAL MODULE: ./src/addons/mod/workshop/components/submission/submission.ts\nvar submission_submission = __webpack_require__(\"Uzd6\");\n\n// EXTERNAL MODULE: ./src/addons/mod/workshop/components/phase/phase.ts\nvar phase = __webpack_require__(\"0w4i\");\n\n// EXTERNAL MODULE: ./src/addons/mod/workshop/components/assessment/assessment.ts\nvar assessment_assessment = __webpack_require__(\"G92Y\");\n\n// EXTERNAL MODULE: ./src/core/pipes/bytes-to-size.ts\nvar bytes_to_size = __webpack_require__(\"1iFe\");\n\n// EXTERNAL MODULE: ./src/core/pipes/create-links.ts\nvar create_links = __webpack_require__(\"dne1\");\n\n// EXTERNAL MODULE: ./src/core/pipes/date-day-or-time.ts\nvar date_day_or_time = __webpack_require__(\"Cg42\");\n\n// EXTERNAL MODULE: ./src/core/pipes/duration.ts\nvar duration = __webpack_require__(\"llyR\");\n\n// EXTERNAL MODULE: ./src/core/pipes/format-date.ts\nvar format_date = __webpack_require__(\"uYHD\");\n\n// EXTERNAL MODULE: ./src/core/pipes/no-tags.ts\nvar no_tags = __webpack_require__(\"SspJ\");\n\n// EXTERNAL MODULE: ./src/core/pipes/seconds-to-hms.ts\nvar seconds_to_hms = __webpack_require__(\"U2xU\");\n\n// EXTERNAL MODULE: ./src/core/pipes/time-ago.ts\nvar time_ago = __webpack_require__(\"lAaw\");\n\n// EXTERNAL MODULE: ./src/core/pipes/to-locale-string.ts\nvar to_locale_string = __webpack_require__(\"1ArG\");\n\n// CONCATENATED MODULE: ./src/addons/mod/workshop/workshop-lazy.module.ts\n// (C) Copyright 2015 Moodle Pty Ltd.\n//\n// Licensed under the Apache License, Version 2.0 (the \"License\");\n// you may not use this file except in compliance with the License.\n// You may obtain a copy of the License at\n//\n//     http://www.apache.org/licenses/LICENSE-2.0\n//\n// Unless required by applicable law or agreed to in writing, software\n// distributed under the License is distributed on an \"AS IS\" BASIS,\n// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n// See the License for the specific language governing permissions and\n// limitations under the License.\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nconst routes = [\n    {\n        path: ':courseId/:cmId',\n        component: index_AddonModWorkshopIndexPage,\n    },\n    {\n        path: ':courseId/:cmId/:submissionId',\n        component: submission[\"a\" /* AddonModWorkshopSubmissionPage */],\n        canDeactivate: [can_leave[\"a\" /* CanLeaveGuard */]],\n    },\n    {\n        path: ':courseId/:cmId/:submissionId/edit',\n        component: edit_submission_AddonModWorkshopEditSubmissionPage,\n        canDeactivate: [can_leave[\"a\" /* CanLeaveGuard */]],\n    },\n    {\n        path: ':courseId/:cmId/:submissionId/:assessmentId',\n        component: assessment_AddonModWorkshopAssessmentPage,\n        canDeactivate: [can_leave[\"a\" /* CanLeaveGuard */]],\n    },\n];\nlet workshop_lazy_module_AddonModWorkshopLazyModule = /*@__PURE__*/ (() => {\n    class AddonModWorkshopLazyModule {\n    }\n    AddonModWorkshopLazyModule.ɵmod = core[\"wc\" /* ɵɵdefineNgModule */]({ type: AddonModWorkshopLazyModule });\n    AddonModWorkshopLazyModule.ɵinj = core[\"vc\" /* ɵɵdefineInjector */]({ factory: function AddonModWorkshopLazyModule_Factory(t) { return new (t || AddonModWorkshopLazyModule)(); }, imports: [[\n                router[\"m\" /* RouterModule */].forChild(routes),\n                shared_module[\"a\" /* CoreSharedModule */],\n                components_module[\"a\" /* AddonModWorkshopComponentsModule */],\n                components_components_module[\"a\" /* CoreEditorComponentsModule */],\n            ]] });\n    return AddonModWorkshopLazyModule;\n})();\n(function () {\n    (typeof ngJitMode === \"undefined\" || ngJitMode) && core[\"kd\" /* ɵɵsetNgModuleScope */](workshop_lazy_module_AddonModWorkshopLazyModule, { declarations: [index_AddonModWorkshopIndexPage,\n            submission[\"a\" /* AddonModWorkshopSubmissionPage */],\n            assessment_AddonModWorkshopAssessmentPage,\n            edit_submission_AddonModWorkshopEditSubmissionPage], imports: [router[\"m\" /* RouterModule */], shared_module[\"a\" /* CoreSharedModule */],\n            components_module[\"a\" /* AddonModWorkshopComponentsModule */],\n            components_components_module[\"a\" /* CoreEditorComponentsModule */]] });\n})();\ncore[\"jd\" /* ɵɵsetComponentScope */](submission[\"a\" /* AddonModWorkshopSubmissionPage */], [router[\"n\" /* RouterOutlet */], router[\"j\" /* RouterLink */], router[\"l\" /* RouterLinkWithHref */], router[\"k\" /* RouterLinkActive */], router[\"p\" /* ɵangular_packages_router_router_l */], common[\"q\" /* NgClass */], common[\"r\" /* NgComponentOutlet */], common[\"s\" /* NgForOf */], common[\"t\" /* NgIf */], common[\"A\" /* NgTemplateOutlet */], common[\"w\" /* NgStyle */], common[\"x\" /* NgSwitch */], common[\"y\" /* NgSwitchCase */], common[\"z\" /* NgSwitchDefault */], common[\"u\" /* NgPlural */], common[\"v\" /* NgPluralCase */], attachments[\"a\" /* CoreAttachmentsComponent */], bs_tooltip[\"a\" /* CoreBSTooltipComponent */], button_with_spinner[\"a\" /* CoreButtonWithSpinnerComponent */], chart[\"a\" /* CoreChartComponent */], chrono[\"a\" /* CoreChronoComponent */], context_menu[\"a\" /* CoreContextMenuComponent */], context_menu_item[\"a\" /* CoreContextMenuItemComponent */], context_menu_popover[\"a\" /* CoreContextMenuPopoverComponent */], download_refresh[\"a\" /* CoreDownloadRefreshComponent */], dynamic_component[\"a\" /* CoreDynamicComponent */], empty_box[\"a\" /* CoreEmptyBoxComponent */], file_file[\"a\" /* CoreFileComponent */], files[\"a\" /* CoreFilesComponent */], group_selector[\"a\" /* CoreGroupSelectorComponent */], icon[\"a\" /* CoreIconComponent */], iframe[\"a\" /* CoreIframeComponent */], infinite_loading[\"a\" /* CoreInfiniteLoadingComponent */], input_errors[\"a\" /* CoreInputErrorsComponent */], loading[\"a\" /* CoreLoadingComponent */], local_file[\"a\" /* CoreLocalFileComponent */], mark_required[\"a\" /* CoreMarkRequiredComponent */], message[\"a\" /* CoreMessageComponent */], mod_icon[\"a\" /* CoreModIconComponent */], navbar_buttons[\"a\" /* CoreNavBarButtonsComponent */], navigation_bar[\"a\" /* CoreNavigationBarComponent */], progress_bar[\"a\" /* CoreProgressBarComponent */], recaptcha[\"a\" /* CoreRecaptchaComponent */], send_message_form[\"a\" /* CoreSendMessageFormComponent */], show_password[\"a\" /* CoreShowPasswordComponent */], site_picker[\"a\" /* CoreSitePickerComponent */], split_view[\"a\" /* CoreSplitViewComponent */], style[\"a\" /* CoreStyleComponent */], swipe_slides[\"a\" /* CoreSwipeSlidesComponent */], tab[\"a\" /* CoreTabComponent */], tabs[\"a\" /* CoreTabsComponent */], tabs_outlet[\"a\" /* CoreTabsOutletComponent */], timer[\"a\" /* CoreTimerComponent */], user_avatar[\"a\" /* CoreUserAvatarComponent */], combobox[\"a\" /* CoreComboboxComponent */], spacer[\"a\" /* CoreSpacerComponent */], horizontal_scroll_controls[\"a\" /* CoreHorizontalScrollControlsComponent */], swipe_navigation_tour[\"a\" /* CoreSwipeNavigationTourComponent */], auto_focus[\"a\" /* CoreAutoFocusDirective */], auto_rows[\"a\" /* CoreAutoRowsDirective */], external_content[\"a\" /* CoreExternalContentDirective */], fab[\"a\" /* CoreFabDirective */], fa_icon[\"a\" /* CoreFaIconDirective */], format_text[\"a\" /* CoreFormatTextDirective */], directives_link[\"a\" /* CoreLinkDirective */], long_press[\"a\" /* CoreLongPressDirective */], supress_events[\"a\" /* CoreSupressEventsDirective */], user_link[\"a\" /* CoreUserLinkDirective */], aria_button[\"a\" /* CoreAriaButtonClickDirective */], on_resize[\"a\" /* CoreOnResizeDirective */], download_file[\"a\" /* CoreDownloadFileDirective */], collapsible_header[\"b\" /* CoreCollapsibleHeaderDirective */], swipe_navigation[\"a\" /* CoreSwipeNavigationDirective */], collapsible_item[\"a\" /* CoreCollapsibleItemDirective */], collapsible_footer[\"a\" /* CoreCollapsibleFooterDirective */], content[\"a\" /* CoreContentDirective */], update_non_reactive_attributes[\"a\" /* CoreUpdateNonReactiveAttributesDirective */], user_tour[\"a\" /* CoreUserTourDirective */], fesm2015_forms[\"H\" /* ɵangular_packages_forms_forms_y */], fesm2015_forms[\"w\" /* NgSelectOption */], fesm2015_forms[\"G\" /* ɵangular_packages_forms_forms_x */], fesm2015_forms[\"c\" /* DefaultValueAccessor */], fesm2015_forms[\"x\" /* NumberValueAccessor */], fesm2015_forms[\"A\" /* RangeValueAccessor */], fesm2015_forms[\"a\" /* CheckboxControlValueAccessor */], fesm2015_forms[\"D\" /* SelectControlValueAccessor */], fesm2015_forms[\"E\" /* SelectMultipleControlValueAccessor */], fesm2015_forms[\"z\" /* RadioControlValueAccessor */], fesm2015_forms[\"r\" /* NgControlStatus */], fesm2015_forms[\"s\" /* NgControlStatusGroup */], fesm2015_forms[\"C\" /* RequiredValidator */], fesm2015_forms[\"o\" /* MinLengthValidator */], fesm2015_forms[\"n\" /* MaxLengthValidator */], fesm2015_forms[\"y\" /* PatternValidator */], fesm2015_forms[\"b\" /* CheckboxRequiredValidator */], fesm2015_forms[\"d\" /* EmailValidator */], fesm2015_forms[\"u\" /* NgModel */], fesm2015_forms[\"v\" /* NgModelGroup */], fesm2015_forms[\"t\" /* NgForm */], ionic_angular[\"f\" /* IonApp */], ionic_angular[\"g\" /* IonAvatar */], ionic_angular[\"h\" /* IonBackButton */], ionic_angular[\"j\" /* IonBackdrop */], ionic_angular[\"k\" /* IonBadge */], ionic_angular[\"l\" /* IonButton */], ionic_angular[\"m\" /* IonButtons */], ionic_angular[\"n\" /* IonCard */], ionic_angular[\"o\" /* IonCardContent */], ionic_angular[\"p\" /* IonCardHeader */], ionic_angular[\"q\" /* IonCardSubtitle */], ionic_angular[\"r\" /* IonCardTitle */], ionic_angular[\"s\" /* IonCheckbox */], ionic_angular[\"t\" /* IonChip */], ionic_angular[\"u\" /* IonCol */], ionic_angular[\"v\" /* IonContent */], ionic_angular[\"w\" /* IonDatetime */], ionic_angular[\"x\" /* IonFab */], ionic_angular[\"y\" /* IonFabButton */], ionic_angular[\"z\" /* IonFabList */], ionic_angular[\"A\" /* IonFooter */], ionic_angular[\"B\" /* IonGrid */], ionic_angular[\"C\" /* IonHeader */], ionic_angular[\"D\" /* IonIcon */], ionic_angular[\"E\" /* IonImg */], ionic_angular[\"F\" /* IonInfiniteScroll */], ionic_angular[\"G\" /* IonInfiniteScrollContent */], ionic_angular[\"H\" /* IonInput */], ionic_angular[\"I\" /* IonItem */], ionic_angular[\"J\" /* IonItemDivider */], ionic_angular[\"K\" /* IonItemGroup */], ionic_angular[\"L\" /* IonItemOption */], ionic_angular[\"M\" /* IonItemOptions */], ionic_angular[\"N\" /* IonItemSliding */], ionic_angular[\"O\" /* IonLabel */], ionic_angular[\"P\" /* IonList */], ionic_angular[\"Q\" /* IonListHeader */], ionic_angular[\"R\" /* IonMenu */], ionic_angular[\"S\" /* IonMenuButton */], ionic_angular[\"T\" /* IonMenuToggle */], ionic_angular[\"U\" /* IonNav */], ionic_angular[\"V\" /* IonNavLink */], ionic_angular[\"W\" /* IonNote */], ionic_angular[\"X\" /* IonProgressBar */], ionic_angular[\"Y\" /* IonRadio */], ionic_angular[\"Z\" /* IonRadioGroup */], ionic_angular[\"ab\" /* IonRange */], ionic_angular[\"bb\" /* IonRefresher */], ionic_angular[\"cb\" /* IonRefresherContent */], ionic_angular[\"db\" /* IonReorder */], ionic_angular[\"eb\" /* IonReorderGroup */], ionic_angular[\"fb\" /* IonRippleEffect */], ionic_angular[\"hb\" /* IonRow */], ionic_angular[\"ib\" /* IonSearchbar */], ionic_angular[\"jb\" /* IonSegment */], ionic_angular[\"kb\" /* IonSegmentButton */], ionic_angular[\"lb\" /* IonSelect */], ionic_angular[\"mb\" /* IonSelectOption */], ionic_angular[\"nb\" /* IonSkeletonText */], ionic_angular[\"ob\" /* IonSlide */], ionic_angular[\"pb\" /* IonSlides */], ionic_angular[\"qb\" /* IonSpinner */], ionic_angular[\"rb\" /* IonSplitPane */], ionic_angular[\"sb\" /* IonTabBar */], ionic_angular[\"tb\" /* IonTabButton */], ionic_angular[\"vb\" /* IonText */], ionic_angular[\"wb\" /* IonTextarea */], ionic_angular[\"xb\" /* IonThumbnail */], ionic_angular[\"zb\" /* IonToggle */], ionic_angular[\"Ab\" /* IonToolbar */], ionic_angular[\"yb\" /* IonTitle */], ionic_angular[\"ub\" /* IonTabs */], ionic_angular[\"d\" /* BooleanValueAccessor */], ionic_angular[\"Jb\" /* NumericValueAccessor */], ionic_angular[\"Mb\" /* RadioValueAccessor */], ionic_angular[\"Ob\" /* SelectValueAccessor */], ionic_angular[\"Pb\" /* TextValueAccessor */], ionic_angular[\"gb\" /* IonRouterOutlet */], ionic_angular[\"i\" /* IonBackButtonDelegate */], ionic_angular[\"Hb\" /* NavDelegate */], ionic_angular[\"Nb\" /* RouterLinkDelegate */], ionic_angular[\"Rb\" /* VirtualFooter */], ionic_angular[\"Sb\" /* VirtualHeader */], ionic_angular[\"Tb\" /* VirtualItem */], ionic_angular[\"Bb\" /* IonVirtualScroll */], fesm2015_forms[\"h\" /* FormControlDirective */], fesm2015_forms[\"k\" /* FormGroupDirective */], fesm2015_forms[\"i\" /* FormControlName */], fesm2015_forms[\"l\" /* FormGroupName */], fesm2015_forms[\"e\" /* FormArrayName */], ngx_translate_core[\"a\" /* TranslateDirective */], index[\"a\" /* AddonModWorkshopIndexComponent */], submission_submission[\"a\" /* AddonModWorkshopSubmissionComponent */], phase[\"a\" /* AddonModWorkshopPhaseInfoComponent */], assessment_assessment[\"a\" /* AddonModWorkshopAssessmentComponent */], assessment_strategy[\"a\" /* AddonModWorkshopAssessmentStrategyComponent */], rich_text_editor[\"a\" /* CoreEditorRichTextEditorComponent */], index_AddonModWorkshopIndexPage,\n    submission[\"a\" /* AddonModWorkshopSubmissionPage */],\n    assessment_AddonModWorkshopAssessmentPage,\n    edit_submission_AddonModWorkshopEditSubmissionPage], [common[\"b\" /* AsyncPipe */], common[\"G\" /* UpperCasePipe */], common[\"p\" /* LowerCasePipe */], common[\"k\" /* JsonPipe */], common[\"E\" /* SlicePipe */], common[\"g\" /* DecimalPipe */], common[\"C\" /* PercentPipe */], common[\"F\" /* TitleCasePipe */], common[\"d\" /* CurrencyPipe */], common[\"f\" /* DatePipe */], common[\"i\" /* I18nPluralPipe */], common[\"j\" /* I18nSelectPipe */], common[\"l\" /* KeyValuePipe */], bytes_to_size[\"a\" /* CoreBytesToSizePipe */], create_links[\"a\" /* CoreCreateLinksPipe */], date_day_or_time[\"a\" /* CoreDateDayOrTimePipe */], duration[\"a\" /* CoreDurationPipe */], format_date[\"a\" /* CoreFormatDatePipe */], no_tags[\"a\" /* CoreNoTagsPipe */], seconds_to_hms[\"a\" /* CoreSecondsToHMSPipe */], time_ago[\"a\" /* CoreTimeAgoPipe */], to_locale_string[\"a\" /* CoreToLocaleStringPipe */], ngx_translate_core[\"d\" /* TranslatePipe */]]);\n\n\n/***/ })\n\n}]);","inputSourceMap":null}
{"code":"(window.webpackJsonp=window.webpackJsonp||[]).push([[83],{QeBL:function(e,t,n){\"use strict\";n.r(t),n.d(t,\"AddonNotesLazyModule\",(function(){return S}));var o=n(\"L3Fv\"),c=n(\"tyNb\"),i=n(\"rGK3\"),s=n(\"yQkb\"),a=n(\"mrSG\"),r=n(\"BaYo\"),d=n(\"mYSf\"),l=n(\"yqEV\"),_=n(\"+c6a\"),u=n(\"VS9b\"),f=n(\"MUy3\"),h=n(\"4pns\"),p=n(\"TEn/\"),g=n(\"pHTc\"),m=n(\"9+EE\"),N=n(\"3LXp\"),y=n(\"vuGA\"),I=n(\"bFG1\"),b=n(\"fjkH\"),D=n(\"fXoL\"),L=n(\"ACV2\"),P=n(\"ACYt\"),A=n(\"3CSS\"),O=n(\"fQ68\"),E=n(\"8/N+\"),v=n(\"nt/U\"),T=n(\"PgjG\"),w=n(\"ofXK\"),C=n(\"rf3J\"),x=n(\"FeAf\"),V=n(\"r8G5\"),M=n(\"hMzs\"),k=n(\"yNDK\"),z=n(\"sYmb\"),Q=n(\"Cg42\");function AddonNotesListPage_ion_item_24_Template(e,t){if(1&e&&(D.Ec(0,\"ion-item\",19),D.zc(1,\"core-user-avatar\",20),D.Ec(2,\"ion-label\"),D.Ec(3,\"h2\"),D.pd(4),D.Dc(),D.Dc(),D.Dc()),2&e){const e=D.Oc();D.lc(1),D.Vc(\"user\",e.user)(\"courseId\",e.courseId)(\"linkProfile\",!1),D.lc(3),D.qd(e.user.fullname)}}const _c0=function(e){return{$a:e}};function AddonNotesListPage_ion_card_35_Template(e,t){1&e&&(D.Ec(0,\"ion-card\",21),D.Ec(1,\"ion-item\"),D.zc(2,\"ion-icon\",22),D.Ec(3,\"ion-label\"),D.pd(4),D.Pc(5,\"translate\"),D.Pc(6,\"lowercase\"),D.Pc(7,\"translate\"),D.Dc(),D.Dc(),D.Dc()),2&e&&(D.lc(4),D.rd(\" \",D.Rc(5,1,\"core.thereisdatatosync\",D.ad(8,_c0,D.Qc(6,4,D.Qc(7,6,\"addon.notes.notes\")))),\" \"))}function AddonNotesListPage_core_empty_box_36_Template(e,t){1&e&&(D.zc(0,\"core-empty-box\",23),D.Pc(1,\"translate\")),2&e&&D.Vc(\"message\",D.Qc(1,1,\"addon.notes.nonotes\"))}function AddonNotesListPage_ng_container_37_ion_card_1_core_user_avatar_2_Template(e,t){if(1&e&&D.zc(0,\"core-user-avatar\",30),2&e){const e=D.Oc().$implicit,t=D.Oc(2);D.Vc(\"user\",e)(\"courseId\",t.courseId)}}function AddonNotesListPage_ng_container_37_ion_card_1_p_4_Template(e,t){if(1&e&&(D.Ec(0,\"p\",31),D.pd(1),D.Dc()),2&e){const e=D.Oc().$implicit;D.lc(1),D.qd(e.userfullname)}}function AddonNotesListPage_ng_container_37_ion_card_1_p_5_Template(e,t){if(1&e&&(D.Ec(0,\"p\",2),D.Ec(1,\"span\",19),D.pd(2),D.Pc(3,\"coreDateDayOrTime\"),D.Dc(),D.Dc()),2&e){const e=D.Oc().$implicit;D.lc(2),D.qd(D.Qc(3,1,e.lastmodified))}}function AddonNotesListPage_ng_container_37_ion_card_1_p_6_Template(e,t){1&e&&(D.Ec(0,\"p\",2),D.zc(1,\"ion-icon\",32),D.Ec(2,\"span\",19),D.pd(3),D.Pc(4,\"translate\"),D.Dc(),D.Dc()),2&e&&(D.lc(3),D.rd(\" \",D.Qc(4,1,\"core.notsent\"),\" \"))}function AddonNotesListPage_ng_container_37_ion_card_1_p_7_Template(e,t){1&e&&(D.Ec(0,\"p\",2),D.zc(1,\"ion-icon\",33),D.Ec(2,\"span\",19),D.pd(3),D.Pc(4,\"translate\"),D.Dc(),D.Dc()),2&e&&(D.lc(3),D.rd(\" \",D.Qc(4,1,\"core.deletedoffline\"),\" \"))}function AddonNotesListPage_ng_container_37_ion_card_1_ion_button_8_Template(e,t){if(1&e){const e=D.Fc();D.Ec(0,\"ion-button\",34),D.Mc(\"click\",(function AddonNotesListPage_ng_container_37_ion_card_1_ion_button_8_Template_ion_button_click_0_listener(t){D.fd(e);const n=D.Oc().$implicit;return D.Oc(2).undoDeleteNote(t,n)})),D.Pc(1,\"translate\"),D.zc(2,\"ion-icon\",35),D.Dc()}2&e&&D.mc(\"aria-label\",D.Qc(1,1,\"core.restore\"))}function AddonNotesListPage_ng_container_37_ion_card_1_ion_button_9_Template(e,t){if(1&e){const e=D.Fc();D.Ec(0,\"ion-button\",34),D.Mc(\"click\",(function AddonNotesListPage_ng_container_37_ion_card_1_ion_button_9_Template_ion_button_click_0_listener(t){D.fd(e);const n=D.Oc().$implicit;return D.Oc(2).deleteNote(t,n)})),D.Pc(1,\"translate\"),D.zc(2,\"ion-icon\",36),D.Dc()}2&e&&(D.Vc(\"@coreSlideInOut\",\"fromRight\"),D.mc(\"aria-label\",D.Qc(1,2,\"core.delete\")))}function AddonNotesListPage_ng_container_37_ion_card_1_Template(e,t){if(1&e&&(D.Ec(0,\"ion-card\"),D.Ec(1,\"ion-item\",19),D.nd(2,AddonNotesListPage_ng_container_37_ion_card_1_core_user_avatar_2_Template,1,2,\"core-user-avatar\",25),D.Ec(3,\"ion-label\"),D.nd(4,AddonNotesListPage_ng_container_37_ion_card_1_p_4_Template,2,1,\"p\",26),D.nd(5,AddonNotesListPage_ng_container_37_ion_card_1_p_5_Template,4,3,\"p\",27),D.Dc(),D.nd(6,AddonNotesListPage_ng_container_37_ion_card_1_p_6_Template,5,3,\"p\",27),D.nd(7,AddonNotesListPage_ng_container_37_ion_card_1_p_7_Template,5,3,\"p\",27),D.nd(8,AddonNotesListPage_ng_container_37_ion_card_1_ion_button_8_Template,3,3,\"ion-button\",28),D.nd(9,AddonNotesListPage_ng_container_37_ion_card_1_ion_button_9_Template,3,4,\"ion-button\",28),D.Dc(),D.Ec(10,\"ion-item\",19),D.Ec(11,\"ion-label\"),D.zc(12,\"core-format-text\",29),D.Dc(),D.Dc(),D.Dc()),2&e){const e=t.$implicit,n=D.Oc(2);D.lc(2),D.Vc(\"ngIf\",!n.userId),D.lc(2),D.Vc(\"ngIf\",!n.userId),D.lc(1),D.Vc(\"ngIf\",!e.deleted&&!e.offline),D.lc(1),D.Vc(\"ngIf\",e.offline),D.lc(1),D.Vc(\"ngIf\",e.deleted),D.lc(1),D.Vc(\"ngIf\",e.deleted),D.lc(1),D.Vc(\"ngIf\",n.showDelete&&!e.deleted&&(\"personal\"!=n.type||e.usermodified==n.currentUserId)),D.lc(3),D.Vc(\"text\",e.content)(\"filter\",!1)}}function AddonNotesListPage_ng_container_37_Template(e,t){if(1&e&&(D.Cc(0),D.nd(1,AddonNotesListPage_ng_container_37_ion_card_1_Template,13,9,\"ion-card\",24),D.Bc()),2&e){const e=D.Oc();D.lc(1),D.Vc(\"ngForOf\",e.notes)}}function AddonNotesListPage_ion_fab_38_Template(e,t){if(1&e){const e=D.Fc();D.Ec(0,\"ion-fab\",37),D.Ec(1,\"ion-fab-button\",38),D.Mc(\"click\",(function AddonNotesListPage_ion_fab_38_Template_ion_fab_button_click_1_listener(t){D.fd(e);return D.Oc().addNote(t)})),D.Pc(2,\"translate\"),D.zc(3,\"ion-icon\",39),D.Ec(4,\"span\",40),D.pd(5),D.Pc(6,\"translate\"),D.Dc(),D.Dc(),D.Dc()}2&e&&(D.lc(1),D.mc(\"aria-label\",D.Qc(2,2,\"addon.notes.addnewnote\")),D.lc(4),D.qd(D.Qc(6,4,\"addon.notes.addnewnote\")))}let F=(()=>{class AddonNotesListPage{constructor(){this.type=\"course\",this.refreshIcon=r.a.ICON_LOADING,this.syncIcon=r.a.ICON_LOADING,this.notes=[],this.hasOffline=!1,this.notesLoaded=!1,this.showDelete=!1,this.canDeleteNotes=!1,this.logAfterFetch=!0;try{this.courseId=g.a.getRequiredRouteNumberParam(\"courseId\"),this.userId=g.a.getRouteNumberParam(\"userId\")}catch(e){return N.a.showErrorModal(e),g.a.back(),void 0}this.syncObserver=b.b.on(u.b.AUTO_SYNCED,(e=>{var t;e.courseId==this.courseId&&(this.showSyncWarnings(e.warnings),this.notesLoaded=!1,this.refreshIcon=r.a.ICON_LOADING,this.syncIcon=r.a.ICON_LOADING,null===(t=this.content)||void 0===t||t.scrollToTop(),this.fetchNotes(!1))}),m.b.getCurrentSiteId()),this.currentUserId=m.b.getCurrentSiteUserId()}ngOnInit(){return Object(a.a)(this,void 0,void 0,(function*(){yield this.fetchNotes(!0)}))}fetchNotes(e=!1,t=!1){return Object(a.a)(this,void 0,void 0,(function*(){e&&(yield this.syncNotes(t));try{const e=(yield l.a.getNotes(this.courseId,this.userId))[this.type+\"notes\"]||[];e.forEach((e=>{e.content=y.a.decodeHTML(e.content)})),yield l.a.setOfflineDeletedNotes(e,this.courseId),this.hasOffline=e.some((e=>e.offline||e.deleted)),this.userId?(this.notes=e,this.user=yield h.a.getProfile(this.userId,this.courseId,!0)):this.notes=yield l.a.getNotesUserData(e),this.logAfterFetch&&(this.logAfterFetch=!1,I.a.ignoreErrors(l.a.logView(this.courseId,this.userId)))}catch(e){N.a.showErrorModal(e)}finally{let e=this.notes&&this.notes.length>0;e&&\"personal\"==this.type&&(e=!!this.notes.find((e=>e.usermodified==this.currentUserId))),this.canDeleteNotes=e,this.notesLoaded=!0,this.refreshIcon=r.a.ICON_REFRESH,this.syncIcon=r.a.ICON_SYNC}}))}refreshNotes(e,t){this.refreshIcon=r.a.ICON_LOADING,this.syncIcon=r.a.ICON_LOADING,l.a.invalidateNotes(this.courseId,this.userId).finally((()=>{this.fetchNotes(!0,e).finally((()=>{t&&(null==t?void 0:t.complete())}))}))}typeChanged(e){return Object(a.a)(this,void 0,void 0,(function*(){this.type=e,this.notesLoaded=!1,this.refreshIcon=r.a.ICON_LOADING,this.syncIcon=r.a.ICON_LOADING,this.logAfterFetch=!0,yield this.fetchNotes(!0)}))}addNote(e){return Object(a.a)(this,void 0,void 0,(function*(){e.preventDefault(),e.stopPropagation();const t=yield N.a.openModal({component:d.a,componentProps:{userId:this.userId,courseId:this.courseId,type:this.type}});void 0!==t&&(t.sent&&t.type?(t.type!=this.type&&(this.type=t.type,this.notesLoaded=!1),this.refreshNotes(!1)):t.type&&t.type!=this.type&&this.typeChanged(t.type))}))}deleteNote(e,t){return Object(a.a)(this,void 0,void 0,(function*(){e.preventDefault(),e.stopPropagation();try{yield N.a.showDeleteConfirm(\"addon.notes.deleteconfirm\");try{yield l.a.deleteNote(t,this.courseId),this.showDelete=!1,this.refreshNotes(!1),N.a.showToast(\"addon.notes.eventnotedeleted\",!0,N.c.LONG)}catch(e){N.a.showErrorModalDefault(e,\"Delete note failed.\")}}catch(e){}}))}undoDeleteNote(e,t){return Object(a.a)(this,void 0,void 0,(function*(){e.preventDefault(),e.stopPropagation(),yield _.a.undoDeleteNote(t.id),this.refreshNotes(!0)}))}toggleDelete(){this.showDelete=!this.showDelete}syncNotes(e){return Object(a.a)(this,void 0,void 0,(function*(){try{const e=yield u.a.syncNotes(this.courseId);this.showSyncWarnings(e.warnings)}catch(t){e&&N.a.showErrorModalDefault(t,\"core.errorsync\",!0)}}))}showSyncWarnings(e){const t=y.a.buildMessage(e);t&&N.a.showErrorModal(t)}ngOnDestroy(){this.syncObserver&&this.syncObserver.off()}}return AddonNotesListPage.ɵfac=function AddonNotesListPage_Factory(e){return new(e||AddonNotesListPage)},AddonNotesListPage.ɵcmp=D.sc({type:AddonNotesListPage,selectors:[[\"page-addon-notes-list-page\"]],viewQuery:function AddonNotesListPage_Query(e,t){var n;(1&e&&D.ud(p.v,!0),2&e)&&(D.dd(n=D.Nc())&&(t.content=n.first))},decls:39,vars:44,consts:[[\"slot\",\"start\"],[3,\"text\"],[\"slot\",\"end\"],[\"slot\",\"end\",\"fill\",\"clear\",3,\"hidden\",\"click\"],[\"name\",\"fas-pen\",\"slot\",\"icon-only\",\"aria-hidden\",\"true\"],[3,\"hidden\",\"priority\",\"content\",\"iconAction\",\"closeOnClick\",\"action\"],[1,\"limited-width\"],[\"slot\",\"fixed\",3,\"disabled\",\"ionRefresh\"],[3,\"pullingText\"],[3,\"hideUntil\"],[\"class\",\"ion-text-wrap\",4,\"ngIf\"],[3,\"selection\",\"onChange\"],[\"value\",\"site\",1,\"ion-text-wrap\"],[\"value\",\"course\",1,\"ion-text-wrap\"],[\"value\",\"personal\",1,\"ion-text-wrap\"],[\"class\",\"core-warning-card\",4,\"ngIf\"],[\"icon\",\"fas-receipt\",3,\"message\",4,\"ngIf\"],[4,\"ngIf\"],[\"slot\",\"fixed\",\"core-fab\",\"\",\"vertical\",\"bottom\",\"horizontal\",\"end\",4,\"ngIf\"],[1,\"ion-text-wrap\"],[\"slot\",\"start\",3,\"user\",\"courseId\",\"linkProfile\"],[1,\"core-warning-card\"],[\"name\",\"fas-exclamation-triangle\",\"slot\",\"start\",\"aria-hidden\",\"true\"],[\"icon\",\"fas-receipt\",3,\"message\"],[4,\"ngFor\",\"ngForOf\"],[\"slot\",\"start\",3,\"user\",\"courseId\",4,\"ngIf\"],[\"class\",\"item-heading\",4,\"ngIf\"],[\"slot\",\"end\",4,\"ngIf\"],[\"slot\",\"end\",\"fill\",\"clear\",\"color\",\"danger\",3,\"click\",4,\"ngIf\"],[3,\"text\",\"filter\"],[\"slot\",\"start\",3,\"user\",\"courseId\"],[1,\"item-heading\"],[\"name\",\"fas-clock\",\"aria-hidden\",\"true\"],[\"name\",\"fas-trash\",\"aria-hidden\",\"true\"],[\"slot\",\"end\",\"fill\",\"clear\",\"color\",\"danger\",3,\"click\"],[\"name\",\"fas-undo-alt\",\"slot\",\"icon-only\",\"aria-hidden\",\"true\"],[\"name\",\"fas-trash\",\"slot\",\"icon-only\",\"aria-hidden\",\"true\"],[\"slot\",\"fixed\",\"core-fab\",\"\",\"vertical\",\"bottom\",\"horizontal\",\"end\"],[3,\"click\"],[\"name\",\"fas-plus\",\"aria-hidden\",\"true\"],[1,\"sr-only\"]],template:function AddonNotesListPage_Template(e,t){1&e&&(D.Ec(0,\"ion-header\"),D.Ec(1,\"ion-toolbar\"),D.Ec(2,\"ion-buttons\",0),D.zc(3,\"ion-back-button\",1),D.Pc(4,\"translate\"),D.Dc(),D.Ec(5,\"ion-title\"),D.Ec(6,\"h1\"),D.pd(7),D.Pc(8,\"translate\"),D.Dc(),D.Dc(),D.zc(9,\"ion-buttons\",2),D.Dc(),D.Dc(),D.Ec(10,\"core-navbar-buttons\",2),D.Ec(11,\"ion-button\",3),D.Mc(\"click\",(function AddonNotesListPage_Template_ion_button_click_11_listener(){return t.toggleDelete()})),D.Pc(12,\"translate\"),D.zc(13,\"ion-icon\",4),D.Dc(),D.Ec(14,\"core-context-menu\"),D.Ec(15,\"core-context-menu-item\",5),D.Mc(\"action\",(function AddonNotesListPage_Template_core_context_menu_item_action_15_listener(){return t.refreshNotes(!1)})),D.Pc(16,\"translate\"),D.Dc(),D.Ec(17,\"core-context-menu-item\",5),D.Mc(\"action\",(function AddonNotesListPage_Template_core_context_menu_item_action_17_listener(){return t.refreshNotes(!0)})),D.Pc(18,\"translate\"),D.Dc(),D.Dc(),D.Dc(),D.Ec(19,\"ion-content\",6),D.Ec(20,\"ion-refresher\",7),D.Mc(\"ionRefresh\",(function AddonNotesListPage_Template_ion_refresher_ionRefresh_20_listener(e){return t.refreshNotes(!1,e.target)})),D.zc(21,\"ion-refresher-content\",8),D.Pc(22,\"translate\"),D.Dc(),D.Ec(23,\"core-loading\",9),D.nd(24,AddonNotesListPage_ion_item_24_Template,5,4,\"ion-item\",10),D.Ec(25,\"core-combobox\",11),D.Mc(\"onChange\",(function AddonNotesListPage_Template_core_combobox_onChange_25_listener(e){return t.typeChanged(e)})),D.Ec(26,\"ion-select-option\",12),D.pd(27),D.Pc(28,\"translate\"),D.Dc(),D.Ec(29,\"ion-select-option\",13),D.pd(30),D.Pc(31,\"translate\"),D.Dc(),D.Ec(32,\"ion-select-option\",14),D.pd(33),D.Pc(34,\"translate\"),D.Dc(),D.Dc(),D.nd(35,AddonNotesListPage_ion_card_35_Template,8,10,\"ion-card\",15),D.nd(36,AddonNotesListPage_core_empty_box_36_Template,2,3,\"core-empty-box\",16),D.nd(37,AddonNotesListPage_ng_container_37_Template,2,1,\"ng-container\",17),D.Dc(),D.nd(38,AddonNotesListPage_ion_fab_38_Template,7,6,\"ion-fab\",18),D.Dc()),2&e&&(D.lc(3),D.Vc(\"text\",D.Qc(4,26,\"core.back\")),D.lc(4),D.qd(D.Qc(8,28,\"addon.notes.notes\")),D.lc(4),D.Vc(\"hidden\",!t.canDeleteNotes),D.mc(\"aria-label\",D.Qc(12,30,\"core.toggledelete\")),D.lc(4),D.Vc(\"hidden\",!(t.notesLoaded&&!t.hasOffline))(\"priority\",100)(\"content\",D.Qc(16,32,\"core.refresh\"))(\"iconAction\",t.refreshIcon)(\"closeOnClick\",!0),D.lc(2),D.Vc(\"hidden\",!(t.notesLoaded&&t.hasOffline))(\"priority\",100)(\"content\",D.Qc(18,34,\"core.settings.synchronizenow\"))(\"iconAction\",t.syncIcon)(\"closeOnClick\",!1),D.lc(3),D.Vc(\"disabled\",!t.notesLoaded),D.lc(1),D.Wc(\"pullingText\",D.Qc(22,36,\"core.pulltorefresh\")),D.lc(2),D.Vc(\"hideUntil\",t.notesLoaded),D.lc(1),D.Vc(\"ngIf\",t.user),D.lc(1),D.Vc(\"selection\",t.type),D.lc(2),D.rd(\" \",D.Qc(28,38,\"addon.notes.sitenotes\"),\" \"),D.lc(3),D.rd(\" \",D.Qc(31,40,\"addon.notes.coursenotes\"),\" \"),D.lc(3),D.rd(\" \",D.Qc(34,42,\"addon.notes.personalnotes\"),\" \"),D.lc(2),D.Vc(\"ngIf\",t.hasOffline),D.lc(1),D.Vc(\"ngIf\",t.notes&&0==t.notes.length),D.lc(1),D.Vc(\"ngIf\",t.notes&&t.notes.length>0),D.lc(1),D.Vc(\"ngIf\",t.userId&&t.notesLoaded))},directives:[p.C,p.Ab,p.m,p.h,p.i,p.yb,L.a,P.a,p.l,p.D,A.a,O.a,E.a,v.a,p.v,p.bb,p.cb,T.a,w.t,C.a,p.mb,p.I,x.a,p.O,p.n,V.a,w.s,M.a,p.x,k.a,p.y],pipes:[z.d,w.p,Q.a],encapsulation:2,data:{animation:[f.a.SLIDE_IN_OUT]}}),AddonNotesListPage})();const G=[{path:\"\",component:F}];let S=(()=>{class AddonNotesLazyModule{}return AddonNotesLazyModule.ɵmod=D.wc({type:AddonNotesLazyModule}),AddonNotesLazyModule.ɵinj=D.vc({factory:function AddonNotesLazyModule_Factory(e){return new(e||AddonNotesLazyModule)},imports:[[c.m.forChild(G),o.a,i.a,s.a],c.m]}),AddonNotesLazyModule})();void((\"undefined\"==typeof ngJitMode||ngJitMode)&&D.kd(S,{declarations:[F],imports:[c.m,o.a,i.a,s.a],exports:[c.m]}))}}]);","name":"83.94fb8711f66d285948ba.js","input":"(window[\"webpackJsonp\"] = window[\"webpackJsonp\"] || []).push([[83],{\n\n/***/ \"QeBL\":\n/***/ (function(module, __webpack_exports__, __webpack_require__) {\n\n\"use strict\";\n// ESM COMPAT FLAG\n__webpack_require__.r(__webpack_exports__);\n\n// EXPORTS\n__webpack_require__.d(__webpack_exports__, \"AddonNotesLazyModule\", function() { return /* binding */ notes_lazy_module_AddonNotesLazyModule; });\n\n// EXTERNAL MODULE: ./src/core/shared.module.ts + 3 modules\nvar shared_module = __webpack_require__(\"L3Fv\");\n\n// EXTERNAL MODULE: ./node_modules/@angular/router/__ivy_ngcc__/fesm2015/router.js + 10 modules\nvar router = __webpack_require__(\"tyNb\");\n\n// EXTERNAL MODULE: ./src/core/features/comments/components/components.module.ts\nvar components_module = __webpack_require__(\"rGK3\");\n\n// EXTERNAL MODULE: ./src/core/features/tag/components/components.module.ts\nvar components_components_module = __webpack_require__(\"yQkb\");\n\n// EXTERNAL MODULE: ./node_modules/tslib/tslib.es6.js\nvar tslib_es6 = __webpack_require__(\"mrSG\");\n\n// EXTERNAL MODULE: ./src/core/constants.ts\nvar constants = __webpack_require__(\"BaYo\");\n\n// EXTERNAL MODULE: ./src/addons/notes/components/add/add-modal.ts\nvar add_modal = __webpack_require__(\"mYSf\");\n\n// EXTERNAL MODULE: ./src/addons/notes/services/notes.ts\nvar notes = __webpack_require__(\"yqEV\");\n\n// EXTERNAL MODULE: ./src/addons/notes/services/notes-offline.ts\nvar notes_offline = __webpack_require__(\"+c6a\");\n\n// EXTERNAL MODULE: ./src/addons/notes/services/notes-sync.ts\nvar notes_sync = __webpack_require__(\"VS9b\");\n\n// EXTERNAL MODULE: ./src/core/components/animations.ts\nvar animations = __webpack_require__(\"MUy3\");\n\n// EXTERNAL MODULE: ./src/core/features/user/services/user.ts\nvar user = __webpack_require__(\"4pns\");\n\n// EXTERNAL MODULE: ./node_modules/@ionic/angular/__ivy_ngcc__/fesm2015/ionic-angular.js + 5 modules\nvar ionic_angular = __webpack_require__(\"TEn/\");\n\n// EXTERNAL MODULE: ./src/core/services/navigator.ts\nvar services_navigator = __webpack_require__(\"pHTc\");\n\n// EXTERNAL MODULE: ./src/core/services/sites.ts\nvar sites = __webpack_require__(\"9+EE\");\n\n// EXTERNAL MODULE: ./src/core/services/utils/dom.ts + 2 modules\nvar dom = __webpack_require__(\"3LXp\");\n\n// EXTERNAL MODULE: ./src/core/services/utils/text.ts + 1 modules\nvar utils_text = __webpack_require__(\"vuGA\");\n\n// EXTERNAL MODULE: ./src/core/services/utils/utils.ts\nvar utils = __webpack_require__(\"bFG1\");\n\n// EXTERNAL MODULE: ./src/core/singletons/events.ts\nvar events = __webpack_require__(\"fjkH\");\n\n// EXTERNAL MODULE: ./node_modules/@angular/core/__ivy_ngcc__/fesm2015/core.js\nvar core = __webpack_require__(\"fXoL\");\n\n// EXTERNAL MODULE: ./src/core/components/navbar-buttons/navbar-buttons.ts\nvar navbar_buttons = __webpack_require__(\"ACV2\");\n\n// EXTERNAL MODULE: ./src/core/directives/update-non-reactive-attributes.ts\nvar update_non_reactive_attributes = __webpack_require__(\"ACYt\");\n\n// EXTERNAL MODULE: ./src/core/directives/fa-icon.ts\nvar fa_icon = __webpack_require__(\"3CSS\");\n\n// EXTERNAL MODULE: ./src/core/components/context-menu/context-menu.ts + 4 modules\nvar context_menu = __webpack_require__(\"fQ68\");\n\n// EXTERNAL MODULE: ./src/core/components/context-menu/context-menu-item.ts\nvar context_menu_item = __webpack_require__(\"8/N+\");\n\n// EXTERNAL MODULE: ./src/core/directives/content.ts\nvar content = __webpack_require__(\"nt/U\");\n\n// EXTERNAL MODULE: ./src/core/components/loading/loading.ts\nvar loading = __webpack_require__(\"PgjG\");\n\n// EXTERNAL MODULE: ./node_modules/@angular/common/__ivy_ngcc__/fesm2015/common.js\nvar common = __webpack_require__(\"ofXK\");\n\n// EXTERNAL MODULE: ./src/core/components/combobox/combobox.ts\nvar combobox = __webpack_require__(\"rf3J\");\n\n// EXTERNAL MODULE: ./src/core/components/user-avatar/user-avatar.ts\nvar user_avatar = __webpack_require__(\"FeAf\");\n\n// EXTERNAL MODULE: ./src/core/components/empty-box/empty-box.ts\nvar empty_box = __webpack_require__(\"r8G5\");\n\n// EXTERNAL MODULE: ./src/core/directives/format-text.ts\nvar format_text = __webpack_require__(\"hMzs\");\n\n// EXTERNAL MODULE: ./src/core/directives/fab.ts\nvar fab = __webpack_require__(\"yNDK\");\n\n// EXTERNAL MODULE: ./node_modules/@ngx-translate/core/__ivy_ngcc__/fesm2015/ngx-translate-core.js + 8 modules\nvar ngx_translate_core = __webpack_require__(\"sYmb\");\n\n// EXTERNAL MODULE: ./src/core/pipes/date-day-or-time.ts\nvar date_day_or_time = __webpack_require__(\"Cg42\");\n\n// CONCATENATED MODULE: ./src/addons/notes/pages/list/list.page.ts\n\n// (C) Copyright 2015 Moodle Pty Ltd.\n//\n// Licensed under the Apache License, Version 2.0 (the \"License\");\n// you may not use this file except in compliance with the License.\n// You may obtain a copy of the License at\n//\n//     http://www.apache.org/licenses/LICENSE-2.0\n//\n// Unless required by applicable law or agreed to in writing, software\n// distributed under the License is distributed on an \"AS IS\" BASIS,\n// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n// See the License for the specific language governing permissions and\n// limitations under the License.\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nfunction AddonNotesListPage_ion_item_24_Template(rf, ctx) {\n    if (rf & 1) {\n        core[\"Ec\" /* ɵɵelementStart */](0, \"ion-item\", 19);\n        core[\"zc\" /* ɵɵelement */](1, \"core-user-avatar\", 20);\n        core[\"Ec\" /* ɵɵelementStart */](2, \"ion-label\");\n        core[\"Ec\" /* ɵɵelementStart */](3, \"h2\");\n        core[\"pd\" /* ɵɵtext */](4);\n        core[\"Dc\" /* ɵɵelementEnd */]();\n        core[\"Dc\" /* ɵɵelementEnd */]();\n        core[\"Dc\" /* ɵɵelementEnd */]();\n    }\n    if (rf & 2) {\n        const ctx_r0 = core[\"Oc\" /* ɵɵnextContext */]();\n        core[\"lc\" /* ɵɵadvance */](1);\n        core[\"Vc\" /* ɵɵproperty */](\"user\", ctx_r0.user)(\"courseId\", ctx_r0.courseId)(\"linkProfile\", false);\n        core[\"lc\" /* ɵɵadvance */](3);\n        core[\"qd\" /* ɵɵtextInterpolate */](ctx_r0.user.fullname);\n    }\n}\nconst _c0 = function (a0) { return { $a: a0 }; };\nfunction AddonNotesListPage_ion_card_35_Template(rf, ctx) {\n    if (rf & 1) {\n        core[\"Ec\" /* ɵɵelementStart */](0, \"ion-card\", 21);\n        core[\"Ec\" /* ɵɵelementStart */](1, \"ion-item\");\n        core[\"zc\" /* ɵɵelement */](2, \"ion-icon\", 22);\n        core[\"Ec\" /* ɵɵelementStart */](3, \"ion-label\");\n        core[\"pd\" /* ɵɵtext */](4);\n        core[\"Pc\" /* ɵɵpipe */](5, \"translate\");\n        core[\"Pc\" /* ɵɵpipe */](6, \"lowercase\");\n        core[\"Pc\" /* ɵɵpipe */](7, \"translate\");\n        core[\"Dc\" /* ɵɵelementEnd */]();\n        core[\"Dc\" /* ɵɵelementEnd */]();\n        core[\"Dc\" /* ɵɵelementEnd */]();\n    }\n    if (rf & 2) {\n        core[\"lc\" /* ɵɵadvance */](4);\n        core[\"rd\" /* ɵɵtextInterpolate1 */](\" \", core[\"Rc\" /* ɵɵpipeBind2 */](5, 1, \"core.thereisdatatosync\", core[\"ad\" /* ɵɵpureFunction1 */](8, _c0, core[\"Qc\" /* ɵɵpipeBind1 */](6, 4, core[\"Qc\" /* ɵɵpipeBind1 */](7, 6, \"addon.notes.notes\")))), \" \");\n    }\n}\nfunction AddonNotesListPage_core_empty_box_36_Template(rf, ctx) {\n    if (rf & 1) {\n        core[\"zc\" /* ɵɵelement */](0, \"core-empty-box\", 23);\n        core[\"Pc\" /* ɵɵpipe */](1, \"translate\");\n    }\n    if (rf & 2) {\n        core[\"Vc\" /* ɵɵproperty */](\"message\", core[\"Qc\" /* ɵɵpipeBind1 */](1, 1, \"addon.notes.nonotes\"));\n    }\n}\nfunction AddonNotesListPage_ng_container_37_ion_card_1_core_user_avatar_2_Template(rf, ctx) {\n    if (rf & 1) {\n        core[\"zc\" /* ɵɵelement */](0, \"core-user-avatar\", 30);\n    }\n    if (rf & 2) {\n        const note_r6 = core[\"Oc\" /* ɵɵnextContext */]().$implicit;\n        const ctx_r7 = core[\"Oc\" /* ɵɵnextContext */](2);\n        core[\"Vc\" /* ɵɵproperty */](\"user\", note_r6)(\"courseId\", ctx_r7.courseId);\n    }\n}\nfunction AddonNotesListPage_ng_container_37_ion_card_1_p_4_Template(rf, ctx) {\n    if (rf & 1) {\n        core[\"Ec\" /* ɵɵelementStart */](0, \"p\", 31);\n        core[\"pd\" /* ɵɵtext */](1);\n        core[\"Dc\" /* ɵɵelementEnd */]();\n    }\n    if (rf & 2) {\n        const note_r6 = core[\"Oc\" /* ɵɵnextContext */]().$implicit;\n        core[\"lc\" /* ɵɵadvance */](1);\n        core[\"qd\" /* ɵɵtextInterpolate */](note_r6.userfullname);\n    }\n}\nfunction AddonNotesListPage_ng_container_37_ion_card_1_p_5_Template(rf, ctx) {\n    if (rf & 1) {\n        core[\"Ec\" /* ɵɵelementStart */](0, \"p\", 2);\n        core[\"Ec\" /* ɵɵelementStart */](1, \"span\", 19);\n        core[\"pd\" /* ɵɵtext */](2);\n        core[\"Pc\" /* ɵɵpipe */](3, \"coreDateDayOrTime\");\n        core[\"Dc\" /* ɵɵelementEnd */]();\n        core[\"Dc\" /* ɵɵelementEnd */]();\n    }\n    if (rf & 2) {\n        const note_r6 = core[\"Oc\" /* ɵɵnextContext */]().$implicit;\n        core[\"lc\" /* ɵɵadvance */](2);\n        core[\"qd\" /* ɵɵtextInterpolate */](core[\"Qc\" /* ɵɵpipeBind1 */](3, 1, note_r6.lastmodified));\n    }\n}\nfunction AddonNotesListPage_ng_container_37_ion_card_1_p_6_Template(rf, ctx) {\n    if (rf & 1) {\n        core[\"Ec\" /* ɵɵelementStart */](0, \"p\", 2);\n        core[\"zc\" /* ɵɵelement */](1, \"ion-icon\", 32);\n        core[\"Ec\" /* ɵɵelementStart */](2, \"span\", 19);\n        core[\"pd\" /* ɵɵtext */](3);\n        core[\"Pc\" /* ɵɵpipe */](4, \"translate\");\n        core[\"Dc\" /* ɵɵelementEnd */]();\n        core[\"Dc\" /* ɵɵelementEnd */]();\n    }\n    if (rf & 2) {\n        core[\"lc\" /* ɵɵadvance */](3);\n        core[\"rd\" /* ɵɵtextInterpolate1 */](\" \", core[\"Qc\" /* ɵɵpipeBind1 */](4, 1, \"core.notsent\"), \" \");\n    }\n}\nfunction AddonNotesListPage_ng_container_37_ion_card_1_p_7_Template(rf, ctx) {\n    if (rf & 1) {\n        core[\"Ec\" /* ɵɵelementStart */](0, \"p\", 2);\n        core[\"zc\" /* ɵɵelement */](1, \"ion-icon\", 33);\n        core[\"Ec\" /* ɵɵelementStart */](2, \"span\", 19);\n        core[\"pd\" /* ɵɵtext */](3);\n        core[\"Pc\" /* ɵɵpipe */](4, \"translate\");\n        core[\"Dc\" /* ɵɵelementEnd */]();\n        core[\"Dc\" /* ɵɵelementEnd */]();\n    }\n    if (rf & 2) {\n        core[\"lc\" /* ɵɵadvance */](3);\n        core[\"rd\" /* ɵɵtextInterpolate1 */](\" \", core[\"Qc\" /* ɵɵpipeBind1 */](4, 1, \"core.deletedoffline\"), \" \");\n    }\n}\nfunction AddonNotesListPage_ng_container_37_ion_card_1_ion_button_8_Template(rf, ctx) {\n    if (rf & 1) {\n        const _r18 = core[\"Fc\" /* ɵɵgetCurrentView */]();\n        core[\"Ec\" /* ɵɵelementStart */](0, \"ion-button\", 34);\n        core[\"Mc\" /* ɵɵlistener */](\"click\", function AddonNotesListPage_ng_container_37_ion_card_1_ion_button_8_Template_ion_button_click_0_listener($event) { core[\"fd\" /* ɵɵrestoreView */](_r18); const note_r6 = core[\"Oc\" /* ɵɵnextContext */]().$implicit; const ctx_r17 = core[\"Oc\" /* ɵɵnextContext */](2); return ctx_r17.undoDeleteNote($event, note_r6); });\n        core[\"Pc\" /* ɵɵpipe */](1, \"translate\");\n        core[\"zc\" /* ɵɵelement */](2, \"ion-icon\", 35);\n        core[\"Dc\" /* ɵɵelementEnd */]();\n    }\n    if (rf & 2) {\n        core[\"mc\" /* ɵɵattribute */](\"aria-label\", core[\"Qc\" /* ɵɵpipeBind1 */](1, 1, \"core.restore\"));\n    }\n}\nfunction AddonNotesListPage_ng_container_37_ion_card_1_ion_button_9_Template(rf, ctx) {\n    if (rf & 1) {\n        const _r21 = core[\"Fc\" /* ɵɵgetCurrentView */]();\n        core[\"Ec\" /* ɵɵelementStart */](0, \"ion-button\", 34);\n        core[\"Mc\" /* ɵɵlistener */](\"click\", function AddonNotesListPage_ng_container_37_ion_card_1_ion_button_9_Template_ion_button_click_0_listener($event) { core[\"fd\" /* ɵɵrestoreView */](_r21); const note_r6 = core[\"Oc\" /* ɵɵnextContext */]().$implicit; const ctx_r20 = core[\"Oc\" /* ɵɵnextContext */](2); return ctx_r20.deleteNote($event, note_r6); });\n        core[\"Pc\" /* ɵɵpipe */](1, \"translate\");\n        core[\"zc\" /* ɵɵelement */](2, \"ion-icon\", 36);\n        core[\"Dc\" /* ɵɵelementEnd */]();\n    }\n    if (rf & 2) {\n        core[\"Vc\" /* ɵɵproperty */](\"@coreSlideInOut\", \"fromRight\");\n        core[\"mc\" /* ɵɵattribute */](\"aria-label\", core[\"Qc\" /* ɵɵpipeBind1 */](1, 2, \"core.delete\"));\n    }\n}\nfunction AddonNotesListPage_ng_container_37_ion_card_1_Template(rf, ctx) {\n    if (rf & 1) {\n        core[\"Ec\" /* ɵɵelementStart */](0, \"ion-card\");\n        core[\"Ec\" /* ɵɵelementStart */](1, \"ion-item\", 19);\n        core[\"nd\" /* ɵɵtemplate */](2, AddonNotesListPage_ng_container_37_ion_card_1_core_user_avatar_2_Template, 1, 2, \"core-user-avatar\", 25);\n        core[\"Ec\" /* ɵɵelementStart */](3, \"ion-label\");\n        core[\"nd\" /* ɵɵtemplate */](4, AddonNotesListPage_ng_container_37_ion_card_1_p_4_Template, 2, 1, \"p\", 26);\n        core[\"nd\" /* ɵɵtemplate */](5, AddonNotesListPage_ng_container_37_ion_card_1_p_5_Template, 4, 3, \"p\", 27);\n        core[\"Dc\" /* ɵɵelementEnd */]();\n        core[\"nd\" /* ɵɵtemplate */](6, AddonNotesListPage_ng_container_37_ion_card_1_p_6_Template, 5, 3, \"p\", 27);\n        core[\"nd\" /* ɵɵtemplate */](7, AddonNotesListPage_ng_container_37_ion_card_1_p_7_Template, 5, 3, \"p\", 27);\n        core[\"nd\" /* ɵɵtemplate */](8, AddonNotesListPage_ng_container_37_ion_card_1_ion_button_8_Template, 3, 3, \"ion-button\", 28);\n        core[\"nd\" /* ɵɵtemplate */](9, AddonNotesListPage_ng_container_37_ion_card_1_ion_button_9_Template, 3, 4, \"ion-button\", 28);\n        core[\"Dc\" /* ɵɵelementEnd */]();\n        core[\"Ec\" /* ɵɵelementStart */](10, \"ion-item\", 19);\n        core[\"Ec\" /* ɵɵelementStart */](11, \"ion-label\");\n        core[\"zc\" /* ɵɵelement */](12, \"core-format-text\", 29);\n        core[\"Dc\" /* ɵɵelementEnd */]();\n        core[\"Dc\" /* ɵɵelementEnd */]();\n        core[\"Dc\" /* ɵɵelementEnd */]();\n    }\n    if (rf & 2) {\n        const note_r6 = ctx.$implicit;\n        const ctx_r5 = core[\"Oc\" /* ɵɵnextContext */](2);\n        core[\"lc\" /* ɵɵadvance */](2);\n        core[\"Vc\" /* ɵɵproperty */](\"ngIf\", !ctx_r5.userId);\n        core[\"lc\" /* ɵɵadvance */](2);\n        core[\"Vc\" /* ɵɵproperty */](\"ngIf\", !ctx_r5.userId);\n        core[\"lc\" /* ɵɵadvance */](1);\n        core[\"Vc\" /* ɵɵproperty */](\"ngIf\", !note_r6.deleted && !note_r6.offline);\n        core[\"lc\" /* ɵɵadvance */](1);\n        core[\"Vc\" /* ɵɵproperty */](\"ngIf\", note_r6.offline);\n        core[\"lc\" /* ɵɵadvance */](1);\n        core[\"Vc\" /* ɵɵproperty */](\"ngIf\", note_r6.deleted);\n        core[\"lc\" /* ɵɵadvance */](1);\n        core[\"Vc\" /* ɵɵproperty */](\"ngIf\", note_r6.deleted);\n        core[\"lc\" /* ɵɵadvance */](1);\n        core[\"Vc\" /* ɵɵproperty */](\"ngIf\", ctx_r5.showDelete && !note_r6.deleted && (ctx_r5.type != \"personal\" || note_r6.usermodified == ctx_r5.currentUserId));\n        core[\"lc\" /* ɵɵadvance */](3);\n        core[\"Vc\" /* ɵɵproperty */](\"text\", note_r6.content)(\"filter\", false);\n    }\n}\nfunction AddonNotesListPage_ng_container_37_Template(rf, ctx) {\n    if (rf & 1) {\n        core[\"Cc\" /* ɵɵelementContainerStart */](0);\n        core[\"nd\" /* ɵɵtemplate */](1, AddonNotesListPage_ng_container_37_ion_card_1_Template, 13, 9, \"ion-card\", 24);\n        core[\"Bc\" /* ɵɵelementContainerEnd */]();\n    }\n    if (rf & 2) {\n        const ctx_r3 = core[\"Oc\" /* ɵɵnextContext */]();\n        core[\"lc\" /* ɵɵadvance */](1);\n        core[\"Vc\" /* ɵɵproperty */](\"ngForOf\", ctx_r3.notes);\n    }\n}\nfunction AddonNotesListPage_ion_fab_38_Template(rf, ctx) {\n    if (rf & 1) {\n        const _r24 = core[\"Fc\" /* ɵɵgetCurrentView */]();\n        core[\"Ec\" /* ɵɵelementStart */](0, \"ion-fab\", 37);\n        core[\"Ec\" /* ɵɵelementStart */](1, \"ion-fab-button\", 38);\n        core[\"Mc\" /* ɵɵlistener */](\"click\", function AddonNotesListPage_ion_fab_38_Template_ion_fab_button_click_1_listener($event) { core[\"fd\" /* ɵɵrestoreView */](_r24); const ctx_r23 = core[\"Oc\" /* ɵɵnextContext */](); return ctx_r23.addNote($event); });\n        core[\"Pc\" /* ɵɵpipe */](2, \"translate\");\n        core[\"zc\" /* ɵɵelement */](3, \"ion-icon\", 39);\n        core[\"Ec\" /* ɵɵelementStart */](4, \"span\", 40);\n        core[\"pd\" /* ɵɵtext */](5);\n        core[\"Pc\" /* ɵɵpipe */](6, \"translate\");\n        core[\"Dc\" /* ɵɵelementEnd */]();\n        core[\"Dc\" /* ɵɵelementEnd */]();\n        core[\"Dc\" /* ɵɵelementEnd */]();\n    }\n    if (rf & 2) {\n        core[\"lc\" /* ɵɵadvance */](1);\n        core[\"mc\" /* ɵɵattribute */](\"aria-label\", core[\"Qc\" /* ɵɵpipeBind1 */](2, 2, \"addon.notes.addnewnote\"));\n        core[\"lc\" /* ɵɵadvance */](4);\n        core[\"qd\" /* ɵɵtextInterpolate */](core[\"Qc\" /* ɵɵpipeBind1 */](6, 4, \"addon.notes.addnewnote\"));\n    }\n}\n/**\n * Page that displays a list of notes.\n */\nlet list_page_AddonNotesListPage = /*@__PURE__*/ (() => {\n    class AddonNotesListPage {\n        constructor() {\n            this.type = 'course';\n            this.refreshIcon = constants[\"a\" /* CoreConstants */].ICON_LOADING;\n            this.syncIcon = constants[\"a\" /* CoreConstants */].ICON_LOADING;\n            this.notes = [];\n            this.hasOffline = false;\n            this.notesLoaded = false;\n            this.showDelete = false;\n            this.canDeleteNotes = false;\n            this.logAfterFetch = true;\n            try {\n                this.courseId = services_navigator[\"a\" /* CoreNavigator */].getRequiredRouteNumberParam('courseId');\n                this.userId = services_navigator[\"a\" /* CoreNavigator */].getRouteNumberParam('userId');\n            }\n            catch (error) {\n                dom[\"a\" /* CoreDomUtils */].showErrorModal(error);\n                services_navigator[\"a\" /* CoreNavigator */].back();\n                return;\n            }\n            // Refresh data if notes are synchronized automatically.\n            this.syncObserver = events[\"b\" /* CoreEvents */].on(notes_sync[\"b\" /* AddonNotesSyncProvider */].AUTO_SYNCED, (data) => {\n                var _a;\n                if (data.courseId == this.courseId) {\n                    // Show the sync warnings.\n                    this.showSyncWarnings(data.warnings);\n                    // Refresh the data.\n                    this.notesLoaded = false;\n                    this.refreshIcon = constants[\"a\" /* CoreConstants */].ICON_LOADING;\n                    this.syncIcon = constants[\"a\" /* CoreConstants */].ICON_LOADING;\n                    (_a = this.content) === null || _a === void 0 ? void 0 : _a.scrollToTop();\n                    this.fetchNotes(false);\n                }\n            }, sites[\"b\" /* CoreSites */].getCurrentSiteId());\n            this.currentUserId = sites[\"b\" /* CoreSites */].getCurrentSiteUserId();\n        }\n        /**\n         * Component being initialized.\n         */\n        ngOnInit() {\n            return Object(tslib_es6[\"a\" /* __awaiter */])(this, void 0, void 0, function* () {\n                yield this.fetchNotes(true);\n            });\n        }\n        /**\n         * Fetch notes.\n         *\n         * @param sync When to resync notes.\n         * @param showErrors When to display errors or not.\n         * @return Promise with the notes.\n         */\n        fetchNotes(sync = false, showErrors = false) {\n            return Object(tslib_es6[\"a\" /* __awaiter */])(this, void 0, void 0, function* () {\n                if (sync) {\n                    yield this.syncNotes(showErrors);\n                }\n                try {\n                    const allNotes = yield notes[\"a\" /* AddonNotes */].getNotes(this.courseId, this.userId);\n                    const notesList = allNotes[this.type + 'notes'] || [];\n                    notesList.forEach((note) => {\n                        note.content = utils_text[\"a\" /* CoreTextUtils */].decodeHTML(note.content);\n                    });\n                    yield notes[\"a\" /* AddonNotes */].setOfflineDeletedNotes(notesList, this.courseId);\n                    this.hasOffline = notesList.some((note) => note.offline || note.deleted);\n                    if (this.userId) {\n                        this.notes = notesList;\n                        // Get the user profile to retrieve the user image.\n                        this.user = yield user[\"a\" /* CoreUser */].getProfile(this.userId, this.courseId, true);\n                    }\n                    else {\n                        this.notes = yield notes[\"a\" /* AddonNotes */].getNotesUserData(notesList);\n                    }\n                    if (this.logAfterFetch) {\n                        this.logAfterFetch = false;\n                        utils[\"a\" /* CoreUtils */].ignoreErrors(notes[\"a\" /* AddonNotes */].logView(this.courseId, this.userId));\n                    }\n                }\n                catch (error) {\n                    dom[\"a\" /* CoreDomUtils */].showErrorModal(error);\n                }\n                finally {\n                    let canDelete = this.notes && this.notes.length > 0;\n                    if (canDelete && this.type == 'personal') {\n                        canDelete = !!this.notes.find((note) => note.usermodified == this.currentUserId);\n                    }\n                    this.canDeleteNotes = canDelete;\n                    this.notesLoaded = true;\n                    this.refreshIcon = constants[\"a\" /* CoreConstants */].ICON_REFRESH;\n                    this.syncIcon = constants[\"a\" /* CoreConstants */].ICON_SYNC;\n                }\n            });\n        }\n        /**\n         * Refresh notes on PTR.\n         *\n         * @param showErrors Whether to display errors or not.\n         * @param refresher Refresher instance.\n         */\n        refreshNotes(showErrors, refresher) {\n            this.refreshIcon = constants[\"a\" /* CoreConstants */].ICON_LOADING;\n            this.syncIcon = constants[\"a\" /* CoreConstants */].ICON_LOADING;\n            notes[\"a\" /* AddonNotes */].invalidateNotes(this.courseId, this.userId).finally(() => {\n                this.fetchNotes(true, showErrors).finally(() => {\n                    if (refresher) {\n                        refresher === null || refresher === void 0 ? void 0 : refresher.complete();\n                    }\n                });\n            });\n        }\n        /**\n         * Function called when the type has changed.\n         *\n         * @param type New type.\n         */\n        typeChanged(type) {\n            return Object(tslib_es6[\"a\" /* __awaiter */])(this, void 0, void 0, function* () {\n                this.type = type;\n                this.notesLoaded = false;\n                this.refreshIcon = constants[\"a\" /* CoreConstants */].ICON_LOADING;\n                this.syncIcon = constants[\"a\" /* CoreConstants */].ICON_LOADING;\n                this.logAfterFetch = true;\n                yield this.fetchNotes(true);\n            });\n        }\n        /**\n         * Add a new Note to user and course.\n         *\n         * @param e Event.\n         */\n        addNote(e) {\n            return Object(tslib_es6[\"a\" /* __awaiter */])(this, void 0, void 0, function* () {\n                e.preventDefault();\n                e.stopPropagation();\n                const modalData = yield dom[\"a\" /* CoreDomUtils */].openModal({\n                    component: add_modal[\"a\" /* AddonNotesAddComponent */],\n                    componentProps: {\n                        userId: this.userId,\n                        courseId: this.courseId,\n                        type: this.type,\n                    },\n                });\n                if (modalData !== undefined) {\n                    if (modalData.sent && modalData.type) {\n                        if (modalData.type != this.type) {\n                            this.type = modalData.type;\n                            this.notesLoaded = false;\n                        }\n                        this.refreshNotes(false);\n                    }\n                    else if (modalData.type && modalData.type != this.type) {\n                        this.typeChanged(modalData.type);\n                    }\n                }\n            });\n        }\n        /**\n         * Delete a note.\n         *\n         * @param e Click event.\n         * @param note Note to delete.\n         */\n        deleteNote(e, note) {\n            return Object(tslib_es6[\"a\" /* __awaiter */])(this, void 0, void 0, function* () {\n                e.preventDefault();\n                e.stopPropagation();\n                try {\n                    yield dom[\"a\" /* CoreDomUtils */].showDeleteConfirm('addon.notes.deleteconfirm');\n                    try {\n                        yield notes[\"a\" /* AddonNotes */].deleteNote(note, this.courseId);\n                        this.showDelete = false;\n                        this.refreshNotes(false);\n                        dom[\"a\" /* CoreDomUtils */].showToast('addon.notes.eventnotedeleted', true, dom[\"c\" /* ToastDuration */].LONG);\n                    }\n                    catch (error) {\n                        dom[\"a\" /* CoreDomUtils */].showErrorModalDefault(error, 'Delete note failed.');\n                    }\n                }\n                catch (_a) {\n                    // User cancelled, nothing to do.\n                }\n            });\n        }\n        /**\n         * Restore a note.\n         *\n         * @param e Click event.\n         * @param note Note to delete.\n         */\n        undoDeleteNote(e, note) {\n            return Object(tslib_es6[\"a\" /* __awaiter */])(this, void 0, void 0, function* () {\n                e.preventDefault();\n                e.stopPropagation();\n                yield notes_offline[\"a\" /* AddonNotesOffline */].undoDeleteNote(note.id);\n                this.refreshNotes(true);\n            });\n        }\n        /**\n         * Toggle delete.\n         */\n        toggleDelete() {\n            this.showDelete = !this.showDelete;\n        }\n        /**\n         * Tries to synchronize course notes.\n         *\n         * @param showErrors Whether to display errors or not.\n         * @return Promise resolved when done.\n         */\n        syncNotes(showErrors) {\n            return Object(tslib_es6[\"a\" /* __awaiter */])(this, void 0, void 0, function* () {\n                try {\n                    const result = yield notes_sync[\"a\" /* AddonNotesSync */].syncNotes(this.courseId);\n                    this.showSyncWarnings(result.warnings);\n                }\n                catch (error) {\n                    if (showErrors) {\n                        dom[\"a\" /* CoreDomUtils */].showErrorModalDefault(error, 'core.errorsync', true);\n                    }\n                }\n            });\n        }\n        /**\n         * Show sync warnings if any.\n         *\n         * @param warnings the warnings\n         */\n        showSyncWarnings(warnings) {\n            const message = utils_text[\"a\" /* CoreTextUtils */].buildMessage(warnings);\n            if (message) {\n                dom[\"a\" /* CoreDomUtils */].showErrorModal(message);\n            }\n        }\n        /**\n         * Page destroyed.\n         */\n        ngOnDestroy() {\n            this.syncObserver && this.syncObserver.off();\n        }\n    }\n    AddonNotesListPage.ɵfac = function AddonNotesListPage_Factory(t) { return new (t || AddonNotesListPage)(); };\n    AddonNotesListPage.ɵcmp = core[\"sc\" /* ɵɵdefineComponent */]({ type: AddonNotesListPage, selectors: [[\"page-addon-notes-list-page\"]], viewQuery: function AddonNotesListPage_Query(rf, ctx) {\n            if (rf & 1) {\n                core[\"ud\" /* ɵɵviewQuery */](ionic_angular[\"v\" /* IonContent */], true);\n            }\n            if (rf & 2) {\n                var _t;\n                core[\"dd\" /* ɵɵqueryRefresh */](_t = core[\"Nc\" /* ɵɵloadQuery */]()) && (ctx.content = _t.first);\n            }\n        }, decls: 39, vars: 44, consts: [[\"slot\", \"start\"], [3, \"text\"], [\"slot\", \"end\"], [\"slot\", \"end\", \"fill\", \"clear\", 3, \"hidden\", \"click\"], [\"name\", \"fas-pen\", \"slot\", \"icon-only\", \"aria-hidden\", \"true\"], [3, \"hidden\", \"priority\", \"content\", \"iconAction\", \"closeOnClick\", \"action\"], [1, \"limited-width\"], [\"slot\", \"fixed\", 3, \"disabled\", \"ionRefresh\"], [3, \"pullingText\"], [3, \"hideUntil\"], [\"class\", \"ion-text-wrap\", 4, \"ngIf\"], [3, \"selection\", \"onChange\"], [\"value\", \"site\", 1, \"ion-text-wrap\"], [\"value\", \"course\", 1, \"ion-text-wrap\"], [\"value\", \"personal\", 1, \"ion-text-wrap\"], [\"class\", \"core-warning-card\", 4, \"ngIf\"], [\"icon\", \"fas-receipt\", 3, \"message\", 4, \"ngIf\"], [4, \"ngIf\"], [\"slot\", \"fixed\", \"core-fab\", \"\", \"vertical\", \"bottom\", \"horizontal\", \"end\", 4, \"ngIf\"], [1, \"ion-text-wrap\"], [\"slot\", \"start\", 3, \"user\", \"courseId\", \"linkProfile\"], [1, \"core-warning-card\"], [\"name\", \"fas-exclamation-triangle\", \"slot\", \"start\", \"aria-hidden\", \"true\"], [\"icon\", \"fas-receipt\", 3, \"message\"], [4, \"ngFor\", \"ngForOf\"], [\"slot\", \"start\", 3, \"user\", \"courseId\", 4, \"ngIf\"], [\"class\", \"item-heading\", 4, \"ngIf\"], [\"slot\", \"end\", 4, \"ngIf\"], [\"slot\", \"end\", \"fill\", \"clear\", \"color\", \"danger\", 3, \"click\", 4, \"ngIf\"], [3, \"text\", \"filter\"], [\"slot\", \"start\", 3, \"user\", \"courseId\"], [1, \"item-heading\"], [\"name\", \"fas-clock\", \"aria-hidden\", \"true\"], [\"name\", \"fas-trash\", \"aria-hidden\", \"true\"], [\"slot\", \"end\", \"fill\", \"clear\", \"color\", \"danger\", 3, \"click\"], [\"name\", \"fas-undo-alt\", \"slot\", \"icon-only\", \"aria-hidden\", \"true\"], [\"name\", \"fas-trash\", \"slot\", \"icon-only\", \"aria-hidden\", \"true\"], [\"slot\", \"fixed\", \"core-fab\", \"\", \"vertical\", \"bottom\", \"horizontal\", \"end\"], [3, \"click\"], [\"name\", \"fas-plus\", \"aria-hidden\", \"true\"], [1, \"sr-only\"]], template: function AddonNotesListPage_Template(rf, ctx) {\n            if (rf & 1) {\n                core[\"Ec\" /* ɵɵelementStart */](0, \"ion-header\");\n                core[\"Ec\" /* ɵɵelementStart */](1, \"ion-toolbar\");\n                core[\"Ec\" /* ɵɵelementStart */](2, \"ion-buttons\", 0);\n                core[\"zc\" /* ɵɵelement */](3, \"ion-back-button\", 1);\n                core[\"Pc\" /* ɵɵpipe */](4, \"translate\");\n                core[\"Dc\" /* ɵɵelementEnd */]();\n                core[\"Ec\" /* ɵɵelementStart */](5, \"ion-title\");\n                core[\"Ec\" /* ɵɵelementStart */](6, \"h1\");\n                core[\"pd\" /* ɵɵtext */](7);\n                core[\"Pc\" /* ɵɵpipe */](8, \"translate\");\n                core[\"Dc\" /* ɵɵelementEnd */]();\n                core[\"Dc\" /* ɵɵelementEnd */]();\n                core[\"zc\" /* ɵɵelement */](9, \"ion-buttons\", 2);\n                core[\"Dc\" /* ɵɵelementEnd */]();\n                core[\"Dc\" /* ɵɵelementEnd */]();\n                core[\"Ec\" /* ɵɵelementStart */](10, \"core-navbar-buttons\", 2);\n                core[\"Ec\" /* ɵɵelementStart */](11, \"ion-button\", 3);\n                core[\"Mc\" /* ɵɵlistener */](\"click\", function AddonNotesListPage_Template_ion_button_click_11_listener() { return ctx.toggleDelete(); });\n                core[\"Pc\" /* ɵɵpipe */](12, \"translate\");\n                core[\"zc\" /* ɵɵelement */](13, \"ion-icon\", 4);\n                core[\"Dc\" /* ɵɵelementEnd */]();\n                core[\"Ec\" /* ɵɵelementStart */](14, \"core-context-menu\");\n                core[\"Ec\" /* ɵɵelementStart */](15, \"core-context-menu-item\", 5);\n                core[\"Mc\" /* ɵɵlistener */](\"action\", function AddonNotesListPage_Template_core_context_menu_item_action_15_listener() { return ctx.refreshNotes(false); });\n                core[\"Pc\" /* ɵɵpipe */](16, \"translate\");\n                core[\"Dc\" /* ɵɵelementEnd */]();\n                core[\"Ec\" /* ɵɵelementStart */](17, \"core-context-menu-item\", 5);\n                core[\"Mc\" /* ɵɵlistener */](\"action\", function AddonNotesListPage_Template_core_context_menu_item_action_17_listener() { return ctx.refreshNotes(true); });\n                core[\"Pc\" /* ɵɵpipe */](18, \"translate\");\n                core[\"Dc\" /* ɵɵelementEnd */]();\n                core[\"Dc\" /* ɵɵelementEnd */]();\n                core[\"Dc\" /* ɵɵelementEnd */]();\n                core[\"Ec\" /* ɵɵelementStart */](19, \"ion-content\", 6);\n                core[\"Ec\" /* ɵɵelementStart */](20, \"ion-refresher\", 7);\n                core[\"Mc\" /* ɵɵlistener */](\"ionRefresh\", function AddonNotesListPage_Template_ion_refresher_ionRefresh_20_listener($event) { return ctx.refreshNotes(false, $event.target); });\n                core[\"zc\" /* ɵɵelement */](21, \"ion-refresher-content\", 8);\n                core[\"Pc\" /* ɵɵpipe */](22, \"translate\");\n                core[\"Dc\" /* ɵɵelementEnd */]();\n                core[\"Ec\" /* ɵɵelementStart */](23, \"core-loading\", 9);\n                core[\"nd\" /* ɵɵtemplate */](24, AddonNotesListPage_ion_item_24_Template, 5, 4, \"ion-item\", 10);\n                core[\"Ec\" /* ɵɵelementStart */](25, \"core-combobox\", 11);\n                core[\"Mc\" /* ɵɵlistener */](\"onChange\", function AddonNotesListPage_Template_core_combobox_onChange_25_listener($event) { return ctx.typeChanged($event); });\n                core[\"Ec\" /* ɵɵelementStart */](26, \"ion-select-option\", 12);\n                core[\"pd\" /* ɵɵtext */](27);\n                core[\"Pc\" /* ɵɵpipe */](28, \"translate\");\n                core[\"Dc\" /* ɵɵelementEnd */]();\n                core[\"Ec\" /* ɵɵelementStart */](29, \"ion-select-option\", 13);\n                core[\"pd\" /* ɵɵtext */](30);\n                core[\"Pc\" /* ɵɵpipe */](31, \"translate\");\n                core[\"Dc\" /* ɵɵelementEnd */]();\n                core[\"Ec\" /* ɵɵelementStart */](32, \"ion-select-option\", 14);\n                core[\"pd\" /* ɵɵtext */](33);\n                core[\"Pc\" /* ɵɵpipe */](34, \"translate\");\n                core[\"Dc\" /* ɵɵelementEnd */]();\n                core[\"Dc\" /* ɵɵelementEnd */]();\n                core[\"nd\" /* ɵɵtemplate */](35, AddonNotesListPage_ion_card_35_Template, 8, 10, \"ion-card\", 15);\n                core[\"nd\" /* ɵɵtemplate */](36, AddonNotesListPage_core_empty_box_36_Template, 2, 3, \"core-empty-box\", 16);\n                core[\"nd\" /* ɵɵtemplate */](37, AddonNotesListPage_ng_container_37_Template, 2, 1, \"ng-container\", 17);\n                core[\"Dc\" /* ɵɵelementEnd */]();\n                core[\"nd\" /* ɵɵtemplate */](38, AddonNotesListPage_ion_fab_38_Template, 7, 6, \"ion-fab\", 18);\n                core[\"Dc\" /* ɵɵelementEnd */]();\n            }\n            if (rf & 2) {\n                core[\"lc\" /* ɵɵadvance */](3);\n                core[\"Vc\" /* ɵɵproperty */](\"text\", core[\"Qc\" /* ɵɵpipeBind1 */](4, 26, \"core.back\"));\n                core[\"lc\" /* ɵɵadvance */](4);\n                core[\"qd\" /* ɵɵtextInterpolate */](core[\"Qc\" /* ɵɵpipeBind1 */](8, 28, \"addon.notes.notes\"));\n                core[\"lc\" /* ɵɵadvance */](4);\n                core[\"Vc\" /* ɵɵproperty */](\"hidden\", !ctx.canDeleteNotes);\n                core[\"mc\" /* ɵɵattribute */](\"aria-label\", core[\"Qc\" /* ɵɵpipeBind1 */](12, 30, \"core.toggledelete\"));\n                core[\"lc\" /* ɵɵadvance */](4);\n                core[\"Vc\" /* ɵɵproperty */](\"hidden\", !(ctx.notesLoaded && !ctx.hasOffline))(\"priority\", 100)(\"content\", core[\"Qc\" /* ɵɵpipeBind1 */](16, 32, \"core.refresh\"))(\"iconAction\", ctx.refreshIcon)(\"closeOnClick\", true);\n                core[\"lc\" /* ɵɵadvance */](2);\n                core[\"Vc\" /* ɵɵproperty */](\"hidden\", !(ctx.notesLoaded && ctx.hasOffline))(\"priority\", 100)(\"content\", core[\"Qc\" /* ɵɵpipeBind1 */](18, 34, \"core.settings.synchronizenow\"))(\"iconAction\", ctx.syncIcon)(\"closeOnClick\", false);\n                core[\"lc\" /* ɵɵadvance */](3);\n                core[\"Vc\" /* ɵɵproperty */](\"disabled\", !ctx.notesLoaded);\n                core[\"lc\" /* ɵɵadvance */](1);\n                core[\"Wc\" /* ɵɵpropertyInterpolate */](\"pullingText\", core[\"Qc\" /* ɵɵpipeBind1 */](22, 36, \"core.pulltorefresh\"));\n                core[\"lc\" /* ɵɵadvance */](2);\n                core[\"Vc\" /* ɵɵproperty */](\"hideUntil\", ctx.notesLoaded);\n                core[\"lc\" /* ɵɵadvance */](1);\n                core[\"Vc\" /* ɵɵproperty */](\"ngIf\", ctx.user);\n                core[\"lc\" /* ɵɵadvance */](1);\n                core[\"Vc\" /* ɵɵproperty */](\"selection\", ctx.type);\n                core[\"lc\" /* ɵɵadvance */](2);\n                core[\"rd\" /* ɵɵtextInterpolate1 */](\" \", core[\"Qc\" /* ɵɵpipeBind1 */](28, 38, \"addon.notes.sitenotes\"), \" \");\n                core[\"lc\" /* ɵɵadvance */](3);\n                core[\"rd\" /* ɵɵtextInterpolate1 */](\" \", core[\"Qc\" /* ɵɵpipeBind1 */](31, 40, \"addon.notes.coursenotes\"), \" \");\n                core[\"lc\" /* ɵɵadvance */](3);\n                core[\"rd\" /* ɵɵtextInterpolate1 */](\" \", core[\"Qc\" /* ɵɵpipeBind1 */](34, 42, \"addon.notes.personalnotes\"), \" \");\n                core[\"lc\" /* ɵɵadvance */](2);\n                core[\"Vc\" /* ɵɵproperty */](\"ngIf\", ctx.hasOffline);\n                core[\"lc\" /* ɵɵadvance */](1);\n                core[\"Vc\" /* ɵɵproperty */](\"ngIf\", ctx.notes && ctx.notes.length == 0);\n                core[\"lc\" /* ɵɵadvance */](1);\n                core[\"Vc\" /* ɵɵproperty */](\"ngIf\", ctx.notes && ctx.notes.length > 0);\n                core[\"lc\" /* ɵɵadvance */](1);\n                core[\"Vc\" /* ɵɵproperty */](\"ngIf\", ctx.userId && ctx.notesLoaded);\n            }\n        }, directives: [ionic_angular[\"C\" /* IonHeader */], ionic_angular[\"Ab\" /* IonToolbar */], ionic_angular[\"m\" /* IonButtons */], ionic_angular[\"h\" /* IonBackButton */], ionic_angular[\"i\" /* IonBackButtonDelegate */], ionic_angular[\"yb\" /* IonTitle */], navbar_buttons[\"a\" /* CoreNavBarButtonsComponent */], update_non_reactive_attributes[\"a\" /* CoreUpdateNonReactiveAttributesDirective */], ionic_angular[\"l\" /* IonButton */], ionic_angular[\"D\" /* IonIcon */], fa_icon[\"a\" /* CoreFaIconDirective */], context_menu[\"a\" /* CoreContextMenuComponent */], context_menu_item[\"a\" /* CoreContextMenuItemComponent */], content[\"a\" /* CoreContentDirective */], ionic_angular[\"v\" /* IonContent */], ionic_angular[\"bb\" /* IonRefresher */], ionic_angular[\"cb\" /* IonRefresherContent */], loading[\"a\" /* CoreLoadingComponent */], common[\"t\" /* NgIf */], combobox[\"a\" /* CoreComboboxComponent */], ionic_angular[\"mb\" /* IonSelectOption */], ionic_angular[\"I\" /* IonItem */], user_avatar[\"a\" /* CoreUserAvatarComponent */], ionic_angular[\"O\" /* IonLabel */], ionic_angular[\"n\" /* IonCard */], empty_box[\"a\" /* CoreEmptyBoxComponent */], common[\"s\" /* NgForOf */], format_text[\"a\" /* CoreFormatTextDirective */], ionic_angular[\"x\" /* IonFab */], fab[\"a\" /* CoreFabDirective */], ionic_angular[\"y\" /* IonFabButton */]], pipes: [ngx_translate_core[\"d\" /* TranslatePipe */], common[\"p\" /* LowerCasePipe */], date_day_or_time[\"a\" /* CoreDateDayOrTimePipe */]], encapsulation: 2, data: { animation: [animations[\"a\" /* CoreAnimations */].SLIDE_IN_OUT] } });\n    return AddonNotesListPage;\n})();\n\n// CONCATENATED MODULE: ./src/addons/notes/notes-lazy.module.ts\n// (C) Copyright 2015 Moodle Pty Ltd.\n//\n// Licensed under the Apache License, Version 2.0 (the \"License\");\n// you may not use this file except in compliance with the License.\n// You may obtain a copy of the License at\n//\n//     http://www.apache.org/licenses/LICENSE-2.0\n//\n// Unless required by applicable law or agreed to in writing, software\n// distributed under the License is distributed on an \"AS IS\" BASIS,\n// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n// See the License for the specific language governing permissions and\n// limitations under the License.\n\n\n\n\n\n\n\n\nconst routes = [\n    {\n        path: '',\n        component: list_page_AddonNotesListPage,\n    },\n];\nlet notes_lazy_module_AddonNotesLazyModule = /*@__PURE__*/ (() => {\n    class AddonNotesLazyModule {\n    }\n    AddonNotesLazyModule.ɵmod = core[\"wc\" /* ɵɵdefineNgModule */]({ type: AddonNotesLazyModule });\n    AddonNotesLazyModule.ɵinj = core[\"vc\" /* ɵɵdefineInjector */]({ factory: function AddonNotesLazyModule_Factory(t) { return new (t || AddonNotesLazyModule)(); }, imports: [[\n                router[\"m\" /* RouterModule */].forChild(routes),\n                shared_module[\"a\" /* CoreSharedModule */],\n                components_module[\"a\" /* CoreCommentsComponentsModule */],\n                components_components_module[\"a\" /* CoreTagComponentsModule */],\n            ], router[\"m\" /* RouterModule */]] });\n    return AddonNotesLazyModule;\n})();\n(function () {\n    (typeof ngJitMode === \"undefined\" || ngJitMode) && core[\"kd\" /* ɵɵsetNgModuleScope */](notes_lazy_module_AddonNotesLazyModule, { declarations: [list_page_AddonNotesListPage], imports: [router[\"m\" /* RouterModule */], shared_module[\"a\" /* CoreSharedModule */],\n            components_module[\"a\" /* CoreCommentsComponentsModule */],\n            components_components_module[\"a\" /* CoreTagComponentsModule */]], exports: [router[\"m\" /* RouterModule */]] });\n})();\n\n\n/***/ })\n\n}]);","inputSourceMap":null}
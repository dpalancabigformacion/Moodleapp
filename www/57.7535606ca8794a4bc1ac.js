(window.webpackJsonp=window.webpackJsonp||[]).push([[57],{HFvr:function(e,n,o){"use strict";o.r(n),o.d(n,"AddonModFeedbackFormPageModule",(function(){return N}));var t=o("L3Fv"),c=o("tyNb"),a=o("MLi9"),i=o("mrSG"),d=o("vnm2"),_=o("ULAo"),r=o("TEn/"),l=o("GGba"),g=o("pHTc"),s=o("9+EE"),m=o("3LXp"),p=o("bFG1"),f=o("j3ag"),u=o("fjkH"),b=o("MNPK"),h=o("96hm"),F=o("Uh05"),k=o("0Gvy"),M=o("fXoL"),P=o("hMzs"),I=o("nt/U"),v=o("PgjG"),A=o("ofXK"),T=o("nEkO"),x=o("FasJ"),y=o("3Pt+"),O=o("whRm"),E=o("3CSS"),w=o("ACYt"),D=o("3jOR"),V=o("sYmb");function AddonModFeedbackFormPage_ng_container_10_p_7_Template(e,n){1&e&&(M.Ec(0,"p"),M.pd(1),M.Pc(2,"translate"),M.Dc()),2&e&&(M.lc(1),M.qd(M.Qc(2,1,"addon.mod_feedback.anonymous")))}function AddonModFeedbackFormPage_ng_container_10_p_8_Template(e,n){1&e&&(M.Ec(0,"p"),M.pd(1),M.Pc(2,"translate"),M.Dc()),2&e&&(M.lc(1),M.qd(M.Qc(2,1,"addon.mod_feedback.non_anonymous")))}function AddonModFeedbackFormPage_ng_container_10_ng_container_9_core_spacer_1_Template(e,n){1&e&&M.zc(0,"core-spacer")}function AddonModFeedbackFormPage_ng_container_10_ng_container_9_ng_container_2_p_3_span_1_Template(e,n){if(1&e&&(M.Ec(0,"span"),M.pd(1),M.Dc()),2&e){const e=M.Oc(3).$implicit;M.lc(1),M.rd("",e.itemnumber,". ")}}function AddonModFeedbackFormPage_ng_container_10_ng_container_9_ng_container_2_p_3_span_3_Template(e,n){if(1&e&&(M.Ec(0,"span",22),M.pd(1),M.Dc()),2&e){const e=M.Oc(3).$implicit;M.lc(1),M.qd(e.postfix)}}function AddonModFeedbackFormPage_ng_container_10_ng_container_9_ng_container_2_p_3_Template(e,n){if(1&e&&(M.Ec(0,"p",19),M.nd(1,AddonModFeedbackFormPage_ng_container_10_ng_container_9_ng_container_2_p_3_span_1_Template,2,1,"span",5),M.zc(2,"core-format-text",20),M.nd(3,AddonModFeedbackFormPage_ng_container_10_ng_container_9_ng_container_2_p_3_span_3_Template,2,1,"span",21),M.Dc()),2&e){const e=M.Oc(2).$implicit,n=M.Oc(2);M.Vc("core-mark-required",e.required),M.lc(1),M.Vc("ngIf",n.feedback.autonumbering&&e.itemnumber),M.lc(1),M.Vc("component",n.component)("componentId",n.cmId)("text",e.name)("contextInstanceId",n.cmId)("courseId",n.courseId)("wsNotFiltered",!0),M.lc(1),M.Vc("ngIf",e.postfix)}}function AddonModFeedbackFormPage_ng_container_10_ng_container_9_ng_container_2_p_4_Template(e,n){if(1&e&&(M.Ec(0,"p"),M.zc(1,"core-format-text",23),M.Dc()),2&e){const e=M.Oc(2).$implicit,n=M.Oc(2);M.lc(1),M.Vc("component",n.component)("componentId",n.cmId)("text",e.presentation)("contextInstanceId",n.cmId)("wsNotFiltered",!0)("courseId",n.courseId)}}function AddonModFeedbackFormPage_ng_container_10_ng_container_9_ng_container_2_ion_input_5_Template(e,n){if(1&e){const e=M.Fc();M.Ec(0,"ion-input",24),M.Mc("ngModelChange",(function AddonModFeedbackFormPage_ng_container_10_ng_container_9_ng_container_2_ion_input_5_Template_ion_input_ngModelChange_0_listener(n){M.fd(e);return M.Oc(2).$implicit.value=n})),M.Dc()}if(2&e){const e=M.Oc(2).$implicit;M.Yc("name","",e.typ,"_",e.id,""),M.Wc("maxlength",e.length),M.Vc("ngModel",e.value)("required",e.required)}}function AddonModFeedbackFormPage_ng_container_10_ng_container_9_ng_container_2_ng_container_6_ion_text_2_span_3_Template(e,n){1&e&&(M.Ec(0,"span"),M.pd(1,", "),M.Dc())}function AddonModFeedbackFormPage_ng_container_10_ng_container_9_ng_container_2_ng_container_6_ion_text_2_Template(e,n){if(1&e&&(M.Ec(0,"ion-text",27),M.pd(1),M.Pc(2,"translate"),M.nd(3,AddonModFeedbackFormPage_ng_container_10_ng_container_9_ng_container_2_ng_container_6_ion_text_2_span_3_Template,2,0,"span",5),M.pd(4),M.Dc()),2&e){const e=M.Oc(3).$implicit;M.lc(1),M.sd(" ",M.Qc(2,4,"addon.mod_feedback.numberoutofrange")," [",e.rangefrom," "),M.lc(2),M.Vc("ngIf",e.rangefrom&&e.rangeto),M.lc(1),M.rd("",e.rangeto,"] ")}}function AddonModFeedbackFormPage_ng_container_10_ng_container_9_ng_container_2_ng_container_6_Template(e,n){if(1&e){const e=M.Fc();M.Cc(0),M.Ec(1,"ion-input",25),M.Mc("ngModelChange",(function AddonModFeedbackFormPage_ng_container_10_ng_container_9_ng_container_2_ng_container_6_Template_ion_input_ngModelChange_1_listener(n){M.fd(e);return M.Oc(2).$implicit.value=n})),M.Dc(),M.nd(2,AddonModFeedbackFormPage_ng_container_10_ng_container_9_ng_container_2_ng_container_6_ion_text_2_Template,5,6,"ion-text",26),M.Bc()}if(2&e){const e=M.Oc(2).$implicit;M.lc(1),M.Yc("name","",e.typ,"_",e.id,""),M.Vc("ngModel",e.value)("required",e.required),M.lc(1),M.Vc("ngIf",e.hasError)}}function AddonModFeedbackFormPage_ng_container_10_ng_container_9_ng_container_2_ion_textarea_7_Template(e,n){if(1&e){const e=M.Fc();M.Ec(0,"ion-textarea",28),M.Mc("ngModelChange",(function AddonModFeedbackFormPage_ng_container_10_ng_container_9_ng_container_2_ion_textarea_7_Template_ion_textarea_ngModelChange_0_listener(n){M.fd(e);return M.Oc(2).$implicit.value=n})),M.Dc()}if(2&e){const e=M.Oc(2).$implicit;M.Yc("name","",e.typ,"_",e.id,""),M.Vc("required",e.required)("ngModel",e.value)}}function AddonModFeedbackFormPage_ng_container_10_ng_container_9_ng_container_2_ion_select_8_ion_select_option_1_Template(e,n){if(1&e&&(M.Ec(0,"ion-select-option",31),M.zc(1,"core-format-text",23),M.Dc()),2&e){const e=n.$implicit,o=M.Oc(5);M.Vc("value",e.value),M.lc(1),M.Vc("component",o.component)("componentId",o.cmId)("text",e.label)("contextInstanceId",o.cmId)("wsNotFiltered",!0)("courseId",o.courseId)}}const _c0=function(e){return{header:e}};function AddonModFeedbackFormPage_ng_container_10_ng_container_9_ng_container_2_ion_select_8_Template(e,n){if(1&e){const e=M.Fc();M.Ec(0,"ion-select",29),M.Mc("ngModelChange",(function AddonModFeedbackFormPage_ng_container_10_ng_container_9_ng_container_2_ion_select_8_Template_ion_select_ngModelChange_0_listener(n){M.fd(e);return M.Oc(2).$implicit.value=n})),M.nd(1,AddonModFeedbackFormPage_ng_container_10_ng_container_9_ng_container_2_ion_select_8_ion_select_option_1_Template,2,7,"ion-select-option",30),M.Dc()}if(2&e){const e=M.Oc(2).$implicit;M.Yc("name","",e.typ,"_",e.id,""),M.Vc("required",e.required)("ngModel",e.value)("interfaceOptions",M.ad(6,_c0,e.name)),M.lc(1),M.Vc("ngForOf",e.choices)}}function AddonModFeedbackFormPage_ng_container_10_ng_container_9_ng_container_2_ion_radio_group_9_ion_item_1_Template(e,n){if(1&e&&(M.Ec(0,"ion-item"),M.Ec(1,"ion-label"),M.zc(2,"core-format-text",23),M.Dc(),M.zc(3,"ion-radio",33),M.Dc()),2&e){const e=n.$implicit,o=M.Oc(5);M.lc(2),M.Vc("component",o.component)("componentId",o.cmId)("text",e.label)("contextInstanceId",o.cmId)("wsNotFiltered",!0)("courseId",o.courseId),M.lc(1),M.Vc("value",e.value)}}function AddonModFeedbackFormPage_ng_container_10_ng_container_9_ng_container_2_ion_radio_group_9_Template(e,n){if(1&e){const e=M.Fc();M.Ec(0,"ion-radio-group",32),M.Mc("ngModelChange",(function AddonModFeedbackFormPage_ng_container_10_ng_container_9_ng_container_2_ion_radio_group_9_Template_ion_radio_group_ngModelChange_0_listener(n){M.fd(e);return M.Oc(2).$implicit.value=n})),M.nd(1,AddonModFeedbackFormPage_ng_container_10_ng_container_9_ng_container_2_ion_radio_group_9_ion_item_1_Template,4,7,"ion-item",10),M.Dc()}if(2&e){const e=M.Oc(2).$implicit;M.Yc("name","",e.typ,"_",e.id,""),M.Vc("ngModel",e.value)("required",e.required),M.lc(1),M.Vc("ngForOf",e.choices)}}function AddonModFeedbackFormPage_ng_container_10_ng_container_9_ng_container_2_ng_container_10_ion_item_1_Template(e,n){if(1&e){const e=M.Fc();M.Ec(0,"ion-item"),M.Ec(1,"ion-label"),M.zc(2,"core-format-text",23),M.Dc(),M.Ec(3,"ion-checkbox",34),M.Mc("ngModelChange",(function AddonModFeedbackFormPage_ng_container_10_ng_container_9_ng_container_2_ng_container_10_ion_item_1_Template_ion_checkbox_ngModelChange_3_listener(o){M.fd(e);return n.$implicit.checked=o})),M.Dc(),M.Dc()}if(2&e){const e=n.$implicit,o=M.Oc(3).$implicit,t=M.Oc(2);M.lc(2),M.Vc("component",t.component)("componentId",t.cmId)("text",e.label)("contextInstanceId",t.cmId)("wsNotFiltered",!0)("courseId",t.courseId),M.lc(1),M.Yc("name","",o.typ,"_",o.id,""),M.Vc("required",o.required)("ngModel",e.checked)}}function AddonModFeedbackFormPage_ng_container_10_ng_container_9_ng_container_2_ng_container_10_Template(e,n){if(1&e&&(M.Cc(0),M.nd(1,AddonModFeedbackFormPage_ng_container_10_ng_container_9_ng_container_2_ng_container_10_ion_item_1_Template,4,10,"ion-item",10),M.Bc()),2&e){const e=M.Oc(2).$implicit;M.lc(1),M.Vc("ngForOf",e.choices)}}function AddonModFeedbackFormPage_ng_container_10_ng_container_9_ng_container_2_ng_container_11_core_recaptcha_1_Template(e,n){if(1&e&&M.zc(0,"core-recaptcha",37),2&e){const e=M.Oc(3).$implicit;M.Vc("publicKey",e.captcha.recaptchapublickey)("model",e)}}function AddonModFeedbackFormPage_ng_container_10_ng_container_9_ng_container_2_ng_container_11_div_2_Template(e,n){1&e&&(M.Ec(0,"div",38),M.Ec(1,"ion-item"),M.zc(2,"ion-icon",39),M.Ec(3,"ion-label"),M.pd(4),M.Pc(5,"translate"),M.Dc(),M.Dc(),M.Dc()),2&e&&(M.lc(4),M.qd(M.Qc(5,1,"addon.mod_feedback.captchaofflinewarning")))}function AddonModFeedbackFormPage_ng_container_10_ng_container_9_ng_container_2_ng_container_11_Template(e,n){if(1&e&&(M.Cc(0),M.nd(1,AddonModFeedbackFormPage_ng_container_10_ng_container_9_ng_container_2_ng_container_11_core_recaptcha_1_Template,1,2,"core-recaptcha",35),M.nd(2,AddonModFeedbackFormPage_ng_container_10_ng_container_9_ng_container_2_ng_container_11_div_2_Template,6,3,"div",36),M.Bc()),2&e){const e=M.Oc(2).$implicit,n=M.Oc(2);M.lc(1),M.Vc("ngIf",!n.preview&&!n.offline),M.lc(1),M.Vc("ngIf",!n.preview&&(!e.captcha||n.offline))}}function AddonModFeedbackFormPage_ng_container_10_ng_container_9_ng_container_2_Template(e,n){if(1&e&&(M.Cc(0),M.Ec(1,"ion-item",12),M.Ec(2,"ion-label",13),M.nd(3,AddonModFeedbackFormPage_ng_container_10_ng_container_9_ng_container_2_p_3_Template,4,9,"p",14),M.nd(4,AddonModFeedbackFormPage_ng_container_10_ng_container_9_ng_container_2_p_4_Template,2,6,"p",5),M.Dc(),M.nd(5,AddonModFeedbackFormPage_ng_container_10_ng_container_9_ng_container_2_ion_input_5_Template,1,5,"ion-input",15),M.nd(6,AddonModFeedbackFormPage_ng_container_10_ng_container_9_ng_container_2_ng_container_6_Template,3,5,"ng-container",5),M.nd(7,AddonModFeedbackFormPage_ng_container_10_ng_container_9_ng_container_2_ion_textarea_7_Template,1,4,"ion-textarea",16),M.nd(8,AddonModFeedbackFormPage_ng_container_10_ng_container_9_ng_container_2_ion_select_8_Template,2,8,"ion-select",17),M.Dc(),M.nd(9,AddonModFeedbackFormPage_ng_container_10_ng_container_9_ng_container_2_ion_radio_group_9_Template,2,5,"ion-radio-group",18),M.nd(10,AddonModFeedbackFormPage_ng_container_10_ng_container_9_ng_container_2_ng_container_10_Template,2,1,"ng-container",5),M.nd(11,AddonModFeedbackFormPage_ng_container_10_ng_container_9_ng_container_2_ng_container_11_Template,3,2,"ng-container",5),M.Bc()),2&e){const e=M.Oc().$implicit;M.lc(1),M.qc("core-danger-item",e.isEmpty||e.hasError),M.Vc("color",e.dependitem>0?"light":""),M.lc(1),M.Vc("position",e.hasTextInput?"stacked":void 0),M.lc(1),M.Vc("ngIf",e.name),M.lc(1),M.Vc("ngIf","label"==e.templateName),M.lc(1),M.Vc("ngIf","textfield"==e.templateName),M.lc(1),M.Vc("ngIf","numeric"==e.templateName),M.lc(1),M.Vc("ngIf","textarea"==e.templateName),M.lc(1),M.Vc("ngIf","multichoice-d"==e.templateName),M.lc(1),M.Vc("ngIf","multichoice-r"==e.templateName),M.lc(1),M.Vc("ngIf","multichoice-c"==e.templateName),M.lc(1),M.Vc("ngIf","captcha"==e.templateName)}}function AddonModFeedbackFormPage_ng_container_10_ng_container_9_Template(e,n){if(1&e&&(M.Cc(0),M.nd(1,AddonModFeedbackFormPage_ng_container_10_ng_container_9_core_spacer_1_Template,1,0,"core-spacer",5),M.nd(2,AddonModFeedbackFormPage_ng_container_10_ng_container_9_ng_container_2_Template,12,13,"ng-container",5),M.Bc()),2&e){const e=n.$implicit;M.lc(1),M.Vc("ngIf","pagebreak"==e.typ),M.lc(1),M.Vc("ngIf","pagebreak"!=e.typ)}}function AddonModFeedbackFormPage_ng_container_10_ion_row_10_ion_col_1_Template(e,n){if(1&e){const e=M.Fc();M.Ec(0,"ion-col"),M.Ec(1,"ion-button",41),M.Mc("click",(function AddonModFeedbackFormPage_ng_container_10_ion_row_10_ion_col_1_Template_ion_button_click_1_listener(){M.fd(e);return M.Oc(3).gotoPage(!0)})),M.zc(2,"ion-icon",42),M.pd(3),M.Pc(4,"translate"),M.Dc(),M.Dc()}2&e&&(M.lc(3),M.rd(" ",M.Qc(4,1,"core.previous")," "))}function AddonModFeedbackFormPage_ng_container_10_ion_row_10_ion_col_2_Template(e,n){if(1&e){const e=M.Fc();M.Ec(0,"ion-col"),M.Ec(1,"ion-button",43),M.Mc("click",(function AddonModFeedbackFormPage_ng_container_10_ion_row_10_ion_col_2_Template_ion_button_click_1_listener(){M.fd(e);return M.Oc(3).gotoPage(!1)})),M.pd(2),M.Pc(3,"translate"),M.zc(4,"ion-icon",44),M.Dc(),M.Dc()}2&e&&(M.lc(2),M.rd(" ",M.Qc(3,1,"core.next")," "))}function AddonModFeedbackFormPage_ng_container_10_ion_row_10_ion_col_3_Template(e,n){if(1&e){const e=M.Fc();M.Ec(0,"ion-col"),M.Ec(1,"ion-button",43),M.Mc("click",(function AddonModFeedbackFormPage_ng_container_10_ion_row_10_ion_col_3_Template_ion_button_click_1_listener(){M.fd(e);return M.Oc(3).gotoPage(!1)})),M.pd(2),M.Pc(3,"translate"),M.Dc(),M.Dc()}2&e&&(M.lc(2),M.rd(" ",M.Qc(3,1,"core.submit")," "))}function AddonModFeedbackFormPage_ng_container_10_ion_row_10_Template(e,n){if(1&e&&(M.Ec(0,"ion-row",40),M.nd(1,AddonModFeedbackFormPage_ng_container_10_ion_row_10_ion_col_1_Template,5,3,"ion-col",5),M.nd(2,AddonModFeedbackFormPage_ng_container_10_ion_row_10_ion_col_2_Template,5,3,"ion-col",5),M.nd(3,AddonModFeedbackFormPage_ng_container_10_ion_row_10_ion_col_3_Template,4,3,"ion-col",5),M.Dc()),2&e){const e=M.Oc(2);M.lc(1),M.Vc("ngIf",e.hasPrevPage),M.lc(1),M.Vc("ngIf",e.hasNextPage),M.lc(1),M.Vc("ngIf",!e.hasNextPage)}}function AddonModFeedbackFormPage_ng_container_10_Template(e,n){if(1&e&&(M.Cc(0),M.Ec(1,"ion-list",8),M.Ec(2,"ion-item",9),M.Ec(3,"ion-label"),M.Ec(4,"h2"),M.pd(5),M.Pc(6,"translate"),M.Dc(),M.nd(7,AddonModFeedbackFormPage_ng_container_10_p_7_Template,3,3,"p",5),M.nd(8,AddonModFeedbackFormPage_ng_container_10_p_8_Template,3,3,"p",5),M.Dc(),M.Dc(),M.nd(9,AddonModFeedbackFormPage_ng_container_10_ng_container_9_Template,3,2,"ng-container",10),M.nd(10,AddonModFeedbackFormPage_ng_container_10_ion_row_10_Template,4,3,"ion-row",11),M.Dc(),M.Bc()),2&e){const e=M.Oc();M.lc(5),M.qd(M.Qc(6,5,"addon.mod_feedback.mode")),M.lc(2),M.Vc("ngIf",e.access.isanonymous),M.lc(1),M.Vc("ngIf",!e.access.isanonymous),M.lc(1),M.Vc("ngForOf",e.items),M.lc(1),M.Vc("ngIf",!e.preview)}}function AddonModFeedbackFormPage_ion_card_11_p_4_Template(e,n){1&e&&(M.Ec(0,"p"),M.pd(1),M.Pc(2,"translate"),M.Dc()),2&e&&(M.lc(1),M.rd(" ",M.Qc(2,1,"addon.mod_feedback.this_feedback_is_already_submitted")," "))}function AddonModFeedbackFormPage_ion_card_11_p_5_Template(e,n){1&e&&(M.Ec(0,"p"),M.pd(1),M.Pc(2,"translate"),M.Dc()),2&e&&(M.lc(1),M.rd(" ",M.Qc(2,1,"addon.mod_feedback.feedback_submitted_offline")," "))}function AddonModFeedbackFormPage_ion_card_11_core_format_text_6_Template(e,n){if(1&e&&M.zc(0,"core-format-text",48),2&e){const e=M.Oc(2);M.Vc("component",e.component)("text",e.completionPageContents)("contextInstanceId",e.cmId)("courseId",e.courseId)}}function AddonModFeedbackFormPage_ion_card_11_Template(e,n){if(1&e&&(M.Ec(0,"ion-card",45),M.Ec(1,"ion-item",9),M.zc(2,"ion-icon",46),M.Ec(3,"ion-label"),M.nd(4,AddonModFeedbackFormPage_ion_card_11_p_4_Template,3,3,"p",5),M.nd(5,AddonModFeedbackFormPage_ion_card_11_p_5_Template,3,3,"p",5),M.nd(6,AddonModFeedbackFormPage_ion_card_11_core_format_text_6_Template,1,4,"core-format-text",47),M.Dc(),M.Dc(),M.Dc()),2&e){const e=M.Oc();M.lc(4),M.Vc("ngIf",!e.completionPageContents&&!e.completedOffline),M.lc(1),M.Vc("ngIf",!e.completionPageContents&&e.completedOffline),M.lc(1),M.Vc("ngIf",e.completionPageContents)}}function AddonModFeedbackFormPage_div_12_ion_button_2_Template(e,n){if(1&e){const e=M.Fc();M.Ec(0,"ion-button",53),M.Mc("click",(function AddonModFeedbackFormPage_div_12_ion_button_2_Template_ion_button_click_0_listener(){M.fd(e);return M.Oc(2).showAnalysis()})),M.zc(1,"ion-icon",54),M.pd(2),M.Pc(3,"translate"),M.Dc()}2&e&&(M.lc(2),M.rd(" ",M.Qc(3,1,"addon.mod_feedback.completed_feedbacks")," "))}function AddonModFeedbackFormPage_div_12_ng_container_4_Template(e,n){1&e&&(M.Cc(0),M.pd(1),M.Pc(2,"translate"),M.Bc()),2&e&&(M.lc(1),M.qd(M.Qc(2,1,"core.continue")))}function AddonModFeedbackFormPage_div_12_ng_container_5_Template(e,n){1&e&&(M.Cc(0),M.pd(1),M.Pc(2,"translate"),M.Bc()),2&e&&(M.lc(1),M.qd(M.Qc(2,1,"core.course.nextactivity")))}function AddonModFeedbackFormPage_div_12_Template(e,n){if(1&e){const e=M.Fc();M.Ec(0,"div",49),M.Ec(1,"div",50),M.nd(2,AddonModFeedbackFormPage_div_12_ion_button_2_Template,4,3,"ion-button",51),M.Ec(3,"ion-button",52),M.Mc("click",(function AddonModFeedbackFormPage_div_12_Template_ion_button_click_3_listener(){M.fd(e);return M.Oc().continue()})),M.nd(4,AddonModFeedbackFormPage_div_12_ng_container_4_Template,3,3,"ng-container",5),M.nd(5,AddonModFeedbackFormPage_div_12_ng_container_5_Template,3,3,"ng-container",5),M.Dc(),M.Dc(),M.Dc()}if(2&e){const e=M.Oc();M.lc(2),M.Vc("ngIf",e.access.canviewanalysis),M.lc(2),M.Vc("ngIf",!e.siteAfterSubmit),M.lc(1),M.Vc("ngIf",e.siteAfterSubmit)}}let C=(()=>{class AddonModFeedbackFormPage{constructor(){this.forceLeave=!1,this.preview=!1,this.fromIndex=!1,this.component=b.b.COMPONENT,this.offline=!1,this.feedbackLoaded=!1,this.items=[],this.hasPrevPage=!1,this.hasNextPage=!1,this.completed=!1,this.completedOffline=!1,this.currentSite=s.b.getRequiredCurrentSite(),this.onlineObserver=l.a.onChange().subscribe((()=>{f.A.run((()=>{this.offline=!l.a.isOnline()}))}))}ngOnInit(){return Object(i.a)(this,void 0,void 0,(function*(){try{this.cmId=g.a.getRequiredRouteNumberParam("cmId"),this.courseId=g.a.getRequiredRouteNumberParam("courseId"),this.currentPage=g.a.getRouteNumberParam("page"),this.title=g.a.getRouteParam("title"),this.preview=!!g.a.getRouteBooleanParam("preview"),this.fromIndex=!!g.a.getRouteBooleanParam("fromIndex")}catch(e){return m.a.showErrorModal(e),g.a.back(),void 0}if(yield this.fetchData(),this.feedback)try{yield b.a.logView(this.feedback.id,this.feedback.name,!0),_.a.checkModuleCompletion(this.courseId,this.module.completiondata)}catch(e){}}))}ionViewDidEnter(){this.forceLeave=!1}canLeave(){return Object(i.a)(this,void 0,void 0,(function*(){if(this.forceLeave)return!0;if(!this.preview){const e=h.a.getPageItemsResponses(this.items);this.items&&!this.completed&&this.originalData&&(p.a.basicLeftCompare(e,this.originalData,3)||(yield m.a.showConfirm(f.J.instant("core.confirmcanceledit"))))}return!0}))}fetchData(){var e;return Object(i.a)(this,void 0,void 0,(function*(){try{this.module=yield _.a.getModule(this.cmId,this.courseId,void 0,!0,!1,this.currentSite.getId()),this.offline=!l.a.isOnline();const n={cmId:this.cmId,readingStrategy:this.offline?1:2,siteId:this.currentSite.getId()};this.feedback=yield b.a.getFeedback(this.courseId,this.cmId),this.title=this.feedback.name||this.title,yield this.fetchAccessData(n);let o=0;this.preview||!this.access.cansubmit||this.access.isempty?this.preview=!0:o=null!==(e=this.currentPage)&&void 0!==e?e:yield this.fetchResumePage(n),yield this.fetchFeedbackPageData(o)}catch(e){m.a.showErrorModalDefault(e,"core.course.errorgetmodule",!0),this.forceLeave=!0,g.a.back()}finally{this.feedbackLoaded=!0}}))}fetchAccessData(e){return Object(i.a)(this,void 0,void 0,(function*(){try{this.access=yield b.a.getFeedbackAccessInformation(this.feedback.id,e)}catch(n){if(this.offline||p.a.isWebServiceError(n))throw n;this.offline=!0,e.readingStrategy=1,this.access=yield b.a.getFeedbackAccessInformation(this.feedback.id,e)}}))}fetchResumePage(e){return Object(i.a)(this,void 0,void 0,(function*(){try{return yield b.a.getResumePage(this.feedback.id,e)}catch(n){if(this.offline||p.a.isWebServiceError(n))throw n;return this.offline=!0,e.readingStrategy=1,b.a.getResumePage(this.feedback.id,e)}}))}fetchFeedbackPageData(e=0){return Object(i.a)(this,void 0,void 0,(function*(){this.items=[];const n=yield this.fetchPageItems(e);if(this.items=n.items.map((e=>h.a.getItemForm(e,this.preview))).filter((e=>e)),!this.preview){const e=p.a.clone(this.items);this.originalData=h.a.getPageItemsResponses(e)}}))}fetchPageItems(e){return Object(i.a)(this,void 0,void 0,(function*(){const n={cmId:this.cmId,readingStrategy:this.offline?1:2,siteId:this.currentSite.getId()};if(this.preview){const e=yield b.a.getItems(this.feedback.id,n);return{items:e.items,warnings:e.warnings,hasnextpage:!1,hasprevpage:!1}}let o;this.currentPage=e;try{o=yield b.a.getPageItemsWithValues(this.feedback.id,e,n)}catch(t){if(this.offline||p.a.isWebServiceError(t))throw t;this.offline=!0,n.readingStrategy=1,o=yield b.a.getPageItemsWithValues(this.feedback.id,e,n)}return this.hasPrevPage=!!o.hasprevpage,this.hasNextPage=!!o.hasnextpage,o}))}gotoPage(e){var n;return Object(i.a)(this,void 0,void 0,(function*(){null===(n=this.content)||void 0===n?void 0:n.scrollToTop(),this.feedbackLoaded=!1;const o=h.a.getPageItemsResponses(this.items),t=this.items.some((e=>e.isEmpty||e.hasError));try{yield p.a.ignoreErrors(F.a.syncFeedback(this.feedback.id));const n=yield b.a.processPage(this.feedback.id,this.currentPage,o,{goPrevious:e,formHasErrors:t,courseId:this.courseId,cmId:this.cmId});n.completed?(this.items=[],this.completed=!0,this.completedOffline=!!n.offline,this.completionPageContents=n.completionpagecontents,this.siteAfterSubmit=n.siteaftersubmit,u.b.trigger(u.b.ACTIVITY_DATA_SENT,{module:"feedback"}),yield Promise.all([b.a.invalidateFeedbackAccessInformationData(this.feedback.id),b.a.invalidateResumePageData(this.feedback.id)]),u.b.trigger(b.b.FORM_SUBMITTED,{feedbackId:this.feedback.id,tab:"overview",offline:this.completedOffline}),yield this.fetchAccessData({cmId:this.cmId,readingStrategy:this.offline?1:2,siteId:this.currentSite.getId()})):"number"!=typeof n.jumpto||n.jumpto==this.currentPage||(yield b.a.invalidateResumePageData(this.feedback.id),u.b.trigger(b.b.FORM_SUBMITTED,{feedbackId:this.feedback.id,tab:"overview",offline:this.completedOffline}),yield this.fetchFeedbackPageData(n.jumpto))}catch(e){m.a.showErrorModalDefault(e,"core.course.errorgetmodule",!0)}finally{this.feedbackLoaded=!0}}))}showAnalysis(){if(this.fromIndex)return u.b.trigger(b.b.FORM_SUBMITTED,{feedbackId:this.feedback.id,tab:"analysis",offline:this.completedOffline}),g.a.back(),void 0;g.a.navigateToSitePath(k.b.PAGE_NAME+`/${this.courseId}/${this.cmId}`,{params:{module:this.module,tab:"analysis"}})}continue(){return Object(i.a)(this,void 0,void 0,(function*(){if(!this.siteAfterSubmit)return g.a.back();const e=yield m.a.showModalLoading();try{(yield d.a.handleLink(this.siteAfterSubmit))||(yield this.currentSite.openInBrowserWithAutoLogin(this.siteAfterSubmit))}finally{e.dismiss()}}))}ngOnDestroy(){this.onlineObserver.unsubscribe()}}return AddonModFeedbackFormPage.ɵfac=function AddonModFeedbackFormPage_Factory(e){return new(e||AddonModFeedbackFormPage)},AddonModFeedbackFormPage.ɵcmp=M.sc({type:AddonModFeedbackFormPage,selectors:[["page-addon-mod-feedback-form"]],viewQuery:function AddonModFeedbackFormPage_Query(e,n){var o;(1&e&&M.ud(r.v,!0),2&e)&&(M.dd(o=M.Nc())&&(n.content=o.first))},decls:13,vars:10,consts:[["slot","start"],[3,"text"],["contextLevel","module",3,"text","contextInstanceId","courseId"],[1,"limited-width"],[1,"has-spacer",3,"hideUntil"],[4,"ngIf"],["class","core-success-card",4,"ngIf"],["collapsible-footer","","slot","fixed","appearOnBottom","",4,"ngIf"],[1,"ion-no-margin","has-spacer"],[1,"ion-text-wrap"],[4,"ngFor","ngForOf"],["class","ion-align-items-center spacer-top",4,"ngIf"],[1,"ion-text-wrap","addon-mod_feedback-item",3,"color"],[3,"position"],[3,"core-mark-required",4,"ngIf"],["type","text","autocorrect","off",3,"ngModel","name","maxlength","required","ngModelChange",4,"ngIf"],[3,"required","name","ngModel","ngModelChange",4,"ngIf"],["interface","action-sheet",3,"required","name","ngModel","interfaceOptions","ngModelChange",4,"ngIf"],[3,"ngModel","required","name","ngModelChange",4,"ngIf"],[3,"core-mark-required"],["contextLevel","module",3,"component","componentId","text","contextInstanceId","courseId","wsNotFiltered"],["class","addon-mod_feedback-postfix",4,"ngIf"],[1,"addon-mod_feedback-postfix"],["contextLevel","module",3,"component","componentId","text","contextInstanceId","wsNotFiltered","courseId"],["type","text","autocorrect","off",3,"ngModel","name","maxlength","required","ngModelChange"],["type","number",3,"ngModel","name","required","ngModelChange"],["color","danger","class","addon-mod_feedback-item-error",4,"ngIf"],["color","danger",1,"addon-mod_feedback-item-error"],[3,"required","name","ngModel","ngModelChange"],["interface","action-sheet",3,"required","name","ngModel","interfaceOptions","ngModelChange"],[3,"value",4,"ngFor","ngForOf"],[3,"value"],[3,"ngModel","required","name","ngModelChange"],["slot","start",3,"value"],["value","option.value",3,"required","name","ngModel","ngModelChange"],["modelValueName","value",3,"publicKey","model",4,"ngIf"],["class","core-warning-card",4,"ngIf"],["modelValueName","value",3,"publicKey","model"],[1,"core-warning-card"],["name","fas-exclamation-triangle","slot","start","aria-hidden","true"],[1,"ion-align-items-center","spacer-top"],["expand","block","fill","outline",1,"ion-text-wrap",3,"click"],["name","fas-chevron-left","slot","start","aria-hidden","true"],["expand","block",1,"ion-text-wrap",3,"click"],["name","fas-chevron-right","slot","end","aria-hidden","true"],[1,"core-success-card"],["name","fas-check","slot","start","aria-hidden","true"],["componentId","componentId","contextLevel","module",3,"component","text","contextInstanceId","courseId",4,"ngIf"],["componentId","componentId","contextLevel","module",3,"component","text","contextInstanceId","courseId"],["collapsible-footer","","slot","fixed","appearOnBottom",""],[1,"list-item-limited-width","adaptable-buttons-row"],["expand","block","fill","outline","class","ion-text-wrap ion-margin",3,"click",4,"ngIf"],["expand","block",1,"ion-text-wrap","ion-margin",3,"click"],["expand","block","fill","outline",1,"ion-text-wrap","ion-margin",3,"click"],["name","fas-chart-bar","slot","start","aria-hidden","true"]],template:function AddonModFeedbackFormPage_Template(e,n){1&e&&(M.Ec(0,"ion-header"),M.Ec(1,"ion-toolbar"),M.Ec(2,"ion-buttons",0),M.zc(3,"ion-back-button",1),M.Pc(4,"translate"),M.Dc(),M.Ec(5,"ion-title"),M.Ec(6,"h1"),M.zc(7,"core-format-text",2),M.Dc(),M.Dc(),M.Dc(),M.Dc(),M.Ec(8,"ion-content",3),M.Ec(9,"core-loading",4),M.nd(10,AddonModFeedbackFormPage_ng_container_10_Template,11,7,"ng-container",5),M.nd(11,AddonModFeedbackFormPage_ion_card_11_Template,7,3,"ion-card",6),M.nd(12,AddonModFeedbackFormPage_div_12_Template,6,3,"div",7),M.Dc(),M.Dc()),2&e&&(M.lc(3),M.Vc("text",M.Qc(4,8,"core.back")),M.lc(4),M.Vc("text",n.title)("contextInstanceId",n.cmId)("courseId",n.courseId),M.lc(2),M.Vc("hideUntil",n.feedbackLoaded),M.lc(1),M.Vc("ngIf",n.items&&n.items.length),M.lc(1),M.Vc("ngIf",n.completed),M.lc(1),M.Vc("ngIf",n.feedbackLoaded&&n.completed))},directives:[r.C,r.Ab,r.m,r.h,r.i,r.yb,P.a,I.a,r.v,v.a,A.t,r.P,r.I,r.O,A.s,T.a,x.a,r.H,r.Pb,y.r,y.u,y.n,y.C,r.Jb,r.vb,r.wb,r.lb,r.Ob,r.mb,r.Z,r.Y,r.Mb,r.s,r.d,O.a,r.D,E.a,r.hb,r.u,w.a,r.l,r.n,D.a],pipes:[V.d],styles:["[_nghost-%COMP%]   .addon-mod_feedback-item[_ngcontent-%COMP%]   ion-label.label-stacked[_ngcontent-%COMP%]{margin:11px 0 10px;transform:none}[_nghost-%COMP%]   .addon-mod_feedback-item-error[_ngcontent-%COMP%]{padding-top:5px;padding-bottom:8px}"]}),AddonModFeedbackFormPage})();const q=[{path:"",component:C,canDeactivate:[a.a]}];let N=(()=>{class AddonModFeedbackFormPageModule{}return AddonModFeedbackFormPageModule.ɵmod=M.wc({type:AddonModFeedbackFormPageModule}),AddonModFeedbackFormPageModule.ɵinj=M.vc({factory:function AddonModFeedbackFormPageModule_Factory(e){return new(e||AddonModFeedbackFormPageModule)},imports:[[c.m.forChild(q),t.a],c.m]}),AddonModFeedbackFormPageModule})();void(("undefined"==typeof ngJitMode||ngJitMode)&&M.kd(N,{declarations:[C],imports:[c.m,t.a],exports:[c.m]}))}}]);
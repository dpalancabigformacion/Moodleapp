(window.webpackJsonp=window.webpackJsonp||[]).push([[106],{HBmr:function(i,e,t){"use strict";t.r(e),t.d(e,"CoreLoginSitePolicyPageModule",(function(){return L}));var o=t("tyNb"),c=t("L3Fv"),n=t("mrSG"),l=t("9+EE"),r=t("3LXp"),a=t("bFG1"),s=t("vbeB"),g=t("mv9v"),d=t("pHTc"),P=t("fjkH"),y=t("fXoL"),h=t("TEn/"),p=t("nt/U"),_=t("PgjG"),u=t("ofXK"),f=t("iSJP"),m=t("ACYt"),C=t("qNqN"),S=t("sYmb");function CoreLoginSitePolicyPage_ion_list_11_ion_card_12_Template(i,e){if(1&i&&(y.Ec(0,"ion-card",9),y.zc(1,"core-iframe",10),y.Dc()),2&i){const i=y.Oc(2);y.lc(1),y.Vc("src",i.sitePolicy)}}function CoreLoginSitePolicyPage_ion_list_11_Template(i,e){if(1&i){const i=y.Fc();y.Ec(0,"ion-list"),y.Ec(1,"ion-item",4),y.Ec(2,"ion-label"),y.Ec(3,"p"),y.pd(4),y.Pc(5,"translate"),y.Dc(),y.Dc(),y.Dc(),y.Ec(6,"ion-item",4),y.Ec(7,"ion-label"),y.Ec(8,"p"),y.Ec(9,"a",5),y.pd(10),y.Pc(11,"translate"),y.Dc(),y.Dc(),y.Dc(),y.Dc(),y.nd(12,CoreLoginSitePolicyPage_ion_list_11_ion_card_12_Template,2,1,"ion-card",6),y.Ec(13,"ion-button",7),y.Mc("click",(function CoreLoginSitePolicyPage_ion_list_11_Template_ion_button_click_13_listener(){y.fd(i);return y.Oc().accept()})),y.pd(14),y.Pc(15,"translate"),y.Dc(),y.Ec(16,"ion-button",8),y.Mc("click",(function CoreLoginSitePolicyPage_ion_list_11_Template_ion_button_click_16_listener(){y.fd(i);return y.Oc().cancel()})),y.pd(17),y.Pc(18,"translate"),y.Dc(),y.Dc()}if(2&i){const i=y.Oc();y.lc(4),y.qd(y.Qc(5,7,"core.login.policyagree")),y.lc(5),y.Vc("href",i.sitePolicy,y.id)("capture",!1),y.lc(1),y.qd(y.Qc(11,9,"core.login.policyagreementclick")),y.lc(2),y.Vc("ngIf",i.showInline),y.lc(2),y.rd(" ",y.Qc(15,11,"core.login.policyacceptmandatory")," "),y.lc(3),y.rd(" ",y.Qc(18,13,"core.login.cancel")," ")}}let E=(()=>{class CoreLoginSitePolicyPage{ngOnInit(){this.siteId=d.a.getRouteParam("siteId");try{this.currentSite=l.b.getRequiredCurrentSite()}catch(i){return this.cancel(),void 0}const i=this.currentSite.id;if(this.siteId=this.siteId||i,this.siteId!=i)return this.cancel(),void 0;this.fetchSitePolicy()}fetchSitePolicy(){return Object(n.a)(this,void 0,void 0,(function*(){try{this.sitePolicy=yield g.a.getSitePolicy(this.siteId)}catch(i){return r.a.showErrorModalDefault(i,"Error getting site policy."),this.cancel(),void 0}try{const i=yield a.a.getMimeTypeFromUrl(this.sitePolicy),e=s.a.getExtension(i,this.sitePolicy);this.showInline="html"==e||"htm"==e}catch(i){this.showInline=!1}finally{this.policyLoaded=!0}}))}cancel(){return Object(n.a)(this,void 0,void 0,(function*(){yield a.a.ignoreErrors(l.b.logout()),yield d.a.navigate("/login/sites",{reset:!0})}))}accept(){return Object(n.a)(this,void 0,void 0,(function*(){const i=yield r.a.showModalLoading("core.sending",!0);try{yield g.a.acceptSitePolicy(this.siteId),yield a.a.ignoreErrors(this.currentSite.invalidateWsCache()),P.b.trigger(P.b.SITE_POLICY_AGREED,{},this.siteId),yield d.a.navigateToSiteHome()}catch(i){r.a.showErrorModalDefault(i,"Error accepting site policy.")}finally{i.dismiss()}}))}}return CoreLoginSitePolicyPage.ɵfac=function CoreLoginSitePolicyPage_Factory(i){return new(i||CoreLoginSitePolicyPage)},CoreLoginSitePolicyPage.ɵcmp=y.sc({type:CoreLoginSitePolicyPage,selectors:[["page-core-login-site-policy"]],decls:12,vars:8,consts:[["slot","start"],[3,"text"],[3,"hideUntil"],[4,"ngIf"],[1,"ion-text-wrap"],["core-link","",3,"href","capture"],["class","core-site-policy-iframe-container",4,"ngIf"],["expand","block",1,"ion-text-wrap","ion-margin-horizontal",3,"click"],["expand","block","fill","outline",1,"ion-text-wrap","ion-margin-horizontal","ion-margin-bottom",3,"click"],[1,"core-site-policy-iframe-container"],[3,"src"]],template:function CoreLoginSitePolicyPage_Template(i,e){1&i&&(y.Ec(0,"ion-header"),y.Ec(1,"ion-toolbar"),y.Ec(2,"ion-buttons",0),y.zc(3,"ion-back-button",1),y.Pc(4,"translate"),y.Dc(),y.Ec(5,"ion-title"),y.Ec(6,"h1"),y.pd(7),y.Pc(8,"translate"),y.Dc(),y.Dc(),y.Dc(),y.Dc(),y.Ec(9,"ion-content"),y.Ec(10,"core-loading",2),y.nd(11,CoreLoginSitePolicyPage_ion_list_11_Template,19,15,"ion-list",3),y.Dc(),y.Dc()),2&i&&(y.lc(3),y.Vc("text",y.Qc(4,4,"core.back")),y.lc(4),y.qd(y.Qc(8,6,"core.login.policyagreement")),y.lc(3),y.Vc("hideUntil",e.policyLoaded),y.lc(1),y.Vc("ngIf",e.sitePolicy))},directives:[h.C,h.Ab,h.m,h.h,h.i,h.yb,p.a,h.v,_.a,u.t,h.P,h.I,h.O,f.a,m.a,h.l,h.n,C.a],pipes:[S.d],styles:["[_nghost-%COMP%]   ion-list[_ngcontent-%COMP%]{display:flex;flex-direction:column;height:100%}[_nghost-%COMP%]   ion-list[_ngcontent-%COMP%]   ion-item[_ngcontent-%COMP%]{flex-shrink:0}[_nghost-%COMP%]   ion-list[_ngcontent-%COMP%]   .core-site-policy-iframe-container[_ngcontent-%COMP%]{height:100%}[_nghost-%COMP%]   ion-list[_ngcontent-%COMP%]   .core-site-policy-iframe-container[_ngcontent-%COMP%]   core-iframe[_ngcontent-%COMP%]{height:100%;width:100%}"]}),CoreLoginSitePolicyPage})();const b=[{path:"",component:E}];let L=(()=>{class CoreLoginSitePolicyPageModule{}return CoreLoginSitePolicyPageModule.ɵmod=y.wc({type:CoreLoginSitePolicyPageModule}),CoreLoginSitePolicyPageModule.ɵinj=y.vc({factory:function CoreLoginSitePolicyPageModule_Factory(i){return new(i||CoreLoginSitePolicyPageModule)},imports:[[o.m.forChild(b),c.a],o.m]}),CoreLoginSitePolicyPageModule})();void(("undefined"==typeof ngJitMode||ngJitMode)&&y.kd(L,{declarations:[E],imports:[o.m,c.a],exports:[o.m]}))}}]);
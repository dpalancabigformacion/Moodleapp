{"code":"(window.webpackJsonp=window.webpackJsonp||[]).push([[15],{\"7MVA\":function(e,n,t){\"use strict\";t.r(n),t.d(n,\"AddonMessagesSettingsPageModule\",(function(){return T}));var a=t(\"tyNb\"),c=t(\"L3Fv\"),_=t(\"mrSG\"),i=t(\"KMk0\"),o=t(\"4pns\"),s=t(\"BBqZ\"),g=t(\"fjkH\"),r=t(\"9+EE\"),d=t(\"3LXp\"),l=t(\"BaYo\"),p=t(\"r2Z7\"),m=t(\"fXoL\"),f=t(\"TEn/\"),u=t(\"nt/U\"),M=t(\"PgjG\"),h=t(\"ofXK\"),P=t(\"3Pt+\"),E=t(\"3zv0\"),b=t(\"sYmb\");function AddonMessagesSettingsPage_ion_item_15_Template(e,n){if(1&e){const e=m.Fc();m.Ec(0,\"ion-item\"),m.Ec(1,\"ion-label\"),m.pd(2),m.Pc(3,\"translate\"),m.Dc(),m.Ec(4,\"ion-toggle\",12),m.Mc(\"ngModelChange\",(function AddonMessagesSettingsPage_ion_item_15_Template_ion_toggle_ngModelChange_4_listener(n){m.fd(e);return m.Oc().contactablePrivacy=n}))(\"ngModelChange\",(function AddonMessagesSettingsPage_ion_item_15_Template_ion_toggle_ngModelChange_4_listener(){m.fd(e);const n=m.Oc();return n.saveContactablePrivacy(n.contactablePrivacy)})),m.Dc(),m.Dc()}if(2&e){const e=m.Oc();m.lc(2),m.qd(m.Qc(3,2,\"addon.messages.blocknoncontacts\")),m.lc(2),m.Vc(\"ngModel\",e.contactablePrivacy)}}function AddonMessagesSettingsPage_ion_list_16_ion_item_17_Template(e,n){if(1&e&&(m.Ec(0,\"ion-item\"),m.Ec(1,\"ion-label\"),m.pd(2),m.Pc(3,\"translate\"),m.Dc(),m.zc(4,\"ion-radio\",14),m.Dc()),2&e){const e=m.Oc(2);m.lc(2),m.qd(m.Qc(3,2,\"addon.messages.contactableprivacy_site\")),m.lc(2),m.Vc(\"value\",e.siteValue)}}function AddonMessagesSettingsPage_ion_list_16_Template(e,n){if(1&e){const e=m.Fc();m.Ec(0,\"ion-list\",7),m.Ec(1,\"ion-radio-group\",13),m.Mc(\"ngModelChange\",(function AddonMessagesSettingsPage_ion_list_16_Template_ion_radio_group_ngModelChange_1_listener(n){m.fd(e);return m.Oc().contactablePrivacy=n}))(\"ionChange\",(function AddonMessagesSettingsPage_ion_list_16_Template_ion_radio_group_ionChange_1_listener(){m.fd(e);const n=m.Oc();return n.saveContactablePrivacy(n.contactablePrivacy)})),m.Ec(2,\"ion-item-divider\"),m.Ec(3,\"ion-label\"),m.Ec(4,\"h2\"),m.pd(5),m.Pc(6,\"translate\"),m.Dc(),m.Dc(),m.Dc(),m.Ec(7,\"ion-item\"),m.Ec(8,\"ion-label\"),m.pd(9),m.Pc(10,\"translate\"),m.Dc(),m.zc(11,\"ion-radio\",14),m.Dc(),m.Ec(12,\"ion-item\"),m.Ec(13,\"ion-label\"),m.pd(14),m.Pc(15,\"translate\"),m.Dc(),m.zc(16,\"ion-radio\",14),m.Dc(),m.nd(17,AddonMessagesSettingsPage_ion_list_16_ion_item_17_Template,5,4,\"ion-item\",5),m.Dc(),m.Dc()}if(2&e){const e=m.Oc();m.lc(1),m.Vc(\"ngModel\",e.contactablePrivacy),m.lc(4),m.qd(m.Qc(6,7,\"addon.messages.contactableprivacy\")),m.lc(4),m.qd(m.Qc(10,9,\"addon.messages.contactableprivacy_onlycontacts\")),m.lc(2),m.Vc(\"value\",e.onlyContactsValue),m.lc(3),m.qd(m.Qc(15,11,\"addon.messages.contactableprivacy_coursemember\")),m.lc(2),m.Vc(\"value\",e.courseMemberValue),m.lc(1),m.Vc(\"ngIf\",e.allowSiteMessaging)}}function AddonMessagesSettingsPage_ng_container_17_ng_container_1_ng_container_1_Template(e,n){1&e&&m.Ac(0)}const _c0=function(e){return{preferences:e}};function AddonMessagesSettingsPage_ng_container_17_ng_container_1_Template(e,n){if(1&e&&(m.Cc(0),m.nd(1,AddonMessagesSettingsPage_ng_container_17_ng_container_1_ng_container_1_Template,1,0,\"ng-container\",15),m.Bc()),2&e){const e=m.Oc(2),n=m.ed(32);m.lc(1),m.Vc(\"ngTemplateOutlet\",n)(\"ngTemplateOutletContext\",m.ad(2,_c0,e.preferences))}}function AddonMessagesSettingsPage_ng_container_17_ng_container_2_ng_container_1_Template(e,n){1&e&&m.Ac(0)}function AddonMessagesSettingsPage_ng_container_17_ng_container_2_Template(e,n){if(1&e&&(m.Cc(0),m.nd(1,AddonMessagesSettingsPage_ng_container_17_ng_container_2_ng_container_1_Template,1,0,\"ng-container\",15),m.Bc()),2&e){const e=m.Oc(2),n=m.ed(34);m.lc(1),m.Vc(\"ngTemplateOutlet\",n)(\"ngTemplateOutletContext\",m.ad(2,_c0,e.preferences))}}function AddonMessagesSettingsPage_ng_container_17_Template(e,n){if(1&e&&(m.Cc(0),m.nd(1,AddonMessagesSettingsPage_ng_container_17_ng_container_1_Template,2,4,\"ng-container\",5),m.nd(2,AddonMessagesSettingsPage_ng_container_17_ng_container_2_Template,2,4,\"ng-container\",5),m.Bc()),2&e){const e=m.Oc();m.lc(1),m.Vc(\"ngIf\",!e.groupMessagingEnabled),m.lc(1),m.Vc(\"ngIf\",e.groupMessagingEnabled)}}function AddonMessagesSettingsPage_ng_template_31_ng_container_0_ion_card_1_ng_container_7_ion_item_5_ng_container_4_core_button_with_spinner_1_Template(e,n){if(1&e){const e=m.Fc();m.Ec(0,\"core-button-with-spinner\",21),m.Ec(1,\"ion-toggle\",12),m.Mc(\"ngModelChange\",(function AddonMessagesSettingsPage_ng_template_31_ng_container_0_ion_card_1_ng_container_7_ion_item_5_ng_container_4_core_button_with_spinner_1_Template_ion_toggle_ngModelChange_1_listener(n){m.fd(e);const t=m.Oc(2).$implicit;return m.Oc().$implicit[t].checked=n}))(\"ngModelChange\",(function AddonMessagesSettingsPage_ng_template_31_ng_container_0_ion_card_1_ng_container_7_ion_item_5_ng_container_4_core_button_with_spinner_1_Template_ion_toggle_ngModelChange_1_listener(){m.fd(e);const n=m.Oc(2).$implicit,t=m.Oc().$implicit,a=m.Oc().$implicit;return m.Oc(3).changePreferenceLegacy(a,t,n)})),m.Dc(),m.Dc()}if(2&e){const e=m.Oc(2).$implicit,n=m.Oc().$implicit,t=m.Oc().$implicit;m.Vc(\"loading\",t[\"updating\"+e]),m.lc(1),m.Vc(\"ngModel\",n[e].checked)}}function AddonMessagesSettingsPage_ng_template_31_ng_container_0_ion_card_1_ng_container_7_ion_item_5_ng_container_4_span_2_Template(e,n){1&e&&(m.Ec(0,\"span\",22),m.pd(1),m.Pc(2,\"translate\"),m.Dc()),2&e&&(m.lc(1),m.rd(\" \",m.Qc(2,1,\"core.settings.forced\"),\" \"))}function AddonMessagesSettingsPage_ng_template_31_ng_container_0_ion_card_1_ng_container_7_ion_item_5_ng_container_4_span_3_Template(e,n){1&e&&(m.Ec(0,\"span\",22),m.pd(1),m.Pc(2,\"translate\"),m.Dc()),2&e&&(m.lc(1),m.rd(\" \",m.Qc(2,1,\"core.settings.disallowed\"),\" \"))}function AddonMessagesSettingsPage_ng_template_31_ng_container_0_ion_card_1_ng_container_7_ion_item_5_ng_container_4_Template(e,n){if(1&e&&(m.Cc(0),m.nd(1,AddonMessagesSettingsPage_ng_template_31_ng_container_0_ion_card_1_ng_container_7_ion_item_5_ng_container_4_core_button_with_spinner_1_Template,2,2,\"core-button-with-spinner\",19),m.nd(2,AddonMessagesSettingsPage_ng_template_31_ng_container_0_ion_card_1_ng_container_7_ion_item_5_ng_container_4_span_2_Template,3,3,\"span\",20),m.nd(3,AddonMessagesSettingsPage_ng_template_31_ng_container_0_ion_card_1_ng_container_7_ion_item_5_ng_container_4_span_3_Template,3,3,\"span\",20),m.Bc()),2&e){const e=m.Oc().$implicit,n=m.Oc().$implicit;m.lc(1),m.Vc(\"ngIf\",!n.locked),m.lc(1),m.Vc(\"ngIf\",n.locked&&n[e].checked),m.lc(1),m.Vc(\"ngIf\",n.locked&&!n[e].checked)}}function AddonMessagesSettingsPage_ng_template_31_ng_container_0_ion_card_1_ng_container_7_ion_item_5_span_5_Template(e,n){1&e&&(m.Ec(0,\"span\"),m.pd(1),m.Pc(2,\"translate\"),m.Dc()),2&e&&(m.lc(1),m.qd(m.Qc(2,1,\"core.settings.disabled\")))}function AddonMessagesSettingsPage_ng_template_31_ng_container_0_ion_card_1_ng_container_7_ion_item_5_Template(e,n){if(1&e&&(m.Ec(0,\"ion-item\",7),m.Ec(1,\"ion-label\"),m.pd(2),m.Pc(3,\"translate\"),m.Dc(),m.nd(4,AddonMessagesSettingsPage_ng_template_31_ng_container_0_ion_card_1_ng_container_7_ion_item_5_ng_container_4_Template,4,3,\"ng-container\",5),m.nd(5,AddonMessagesSettingsPage_ng_template_31_ng_container_0_ion_card_1_ng_container_7_ion_item_5_span_5_Template,3,3,\"span\",5),m.Dc()),2&e){const e=n.$implicit,t=m.Oc(4).preferences;m.lc(2),m.qd(m.Qc(3,3,\"core.settings.\"+e)),m.lc(2),m.Vc(\"ngIf\",!t.disableall),m.lc(1),m.Vc(\"ngIf\",t.disableall)}}const _c1=function(){return[\"loggedin\",\"loggedoff\"]};function AddonMessagesSettingsPage_ng_template_31_ng_container_0_ion_card_1_ng_container_7_Template(e,n){if(1&e&&(m.Cc(0),m.Ec(1,\"ion-item-divider\",7),m.Ec(2,\"ion-label\"),m.Ec(3,\"p\",8),m.pd(4),m.Dc(),m.Dc(),m.Dc(),m.nd(5,AddonMessagesSettingsPage_ng_template_31_ng_container_0_ion_card_1_ng_container_7_ion_item_5_Template,6,5,\"ion-item\",18),m.Bc()),2&e){const e=n.$implicit;m.lc(4),m.qd(e.displayname),m.lc(1),m.Vc(\"ngForOf\",m.Zc(2,_c1))}}function AddonMessagesSettingsPage_ng_template_31_ng_container_0_ion_card_1_Template(e,n){if(1&e&&(m.Ec(0,\"ion-card\"),m.Ec(1,\"ion-card-header\",17),m.Ec(2,\"ion-item\",7),m.Ec(3,\"ion-label\"),m.Ec(4,\"h2\"),m.pd(5),m.Dc(),m.Dc(),m.Dc(),m.Dc(),m.Ec(6,\"ion-card-content\",17),m.nd(7,AddonMessagesSettingsPage_ng_template_31_ng_container_0_ion_card_1_ng_container_7_Template,6,3,\"ng-container\",16),m.Dc(),m.Dc()),2&e){const e=n.$implicit;m.lc(5),m.qd(e.displayname),m.lc(2),m.Vc(\"ngForOf\",e.processors)}}function AddonMessagesSettingsPage_ng_template_31_ng_container_0_Template(e,n){if(1&e&&(m.Cc(0),m.nd(1,AddonMessagesSettingsPage_ng_template_31_ng_container_0_ion_card_1_Template,8,2,\"ion-card\",16),m.Bc()),2&e){const e=n.$implicit;m.lc(1),m.Vc(\"ngForOf\",e.notifications)}}function AddonMessagesSettingsPage_ng_template_31_Template(e,n){if(1&e&&m.nd(0,AddonMessagesSettingsPage_ng_template_31_ng_container_0_Template,2,1,\"ng-container\",16),2&e){m.Vc(\"ngForOf\",n.preferences.components)}}function AddonMessagesSettingsPage_ng_template_33_ng_container_0_ion_card_1_ng_container_6_ng_container_4_core_button_with_spinner_1_Template(e,n){if(1&e){const e=m.Fc();m.Ec(0,\"core-button-with-spinner\",21),m.Ec(1,\"ion-toggle\",12),m.Mc(\"ngModelChange\",(function AddonMessagesSettingsPage_ng_template_33_ng_container_0_ion_card_1_ng_container_6_ng_container_4_core_button_with_spinner_1_Template_ion_toggle_ngModelChange_1_listener(n){m.fd(e);return m.Oc(2).$implicit.enabled=n}))(\"ngModelChange\",(function AddonMessagesSettingsPage_ng_template_33_ng_container_0_ion_card_1_ng_container_6_ng_container_4_core_button_with_spinner_1_Template_ion_toggle_ngModelChange_1_listener(){m.fd(e);const n=m.Oc(2).$implicit,t=m.Oc().$implicit;return m.Oc(3).changePreference(t,n)})),m.Dc(),m.Dc()}if(2&e){const e=m.Oc(2).$implicit,n=m.Oc().$implicit;m.Vc(\"loading\",n.updating),m.lc(1),m.Vc(\"ngModel\",e.enabled)}}function AddonMessagesSettingsPage_ng_template_33_ng_container_0_ion_card_1_ng_container_6_ng_container_4_span_2_Template(e,n){if(1&e&&(m.Ec(0,\"span\",22),m.pd(1),m.Dc()),2&e){const e=m.Oc(2).$implicit;m.lc(1),m.rd(\" \",e.lockedmessage,\" \")}}function AddonMessagesSettingsPage_ng_template_33_ng_container_0_ion_card_1_ng_container_6_ng_container_4_Template(e,n){if(1&e&&(m.Cc(0),m.nd(1,AddonMessagesSettingsPage_ng_template_33_ng_container_0_ion_card_1_ng_container_6_ng_container_4_core_button_with_spinner_1_Template,2,2,\"core-button-with-spinner\",19),m.nd(2,AddonMessagesSettingsPage_ng_template_33_ng_container_0_ion_card_1_ng_container_6_ng_container_4_span_2_Template,2,1,\"span\",20),m.Bc()),2&e){const e=m.Oc().$implicit;m.lc(1),m.Vc(\"ngIf\",!e.locked),m.lc(1),m.Vc(\"ngIf\",e.locked)}}function AddonMessagesSettingsPage_ng_template_33_ng_container_0_ion_card_1_ng_container_6_span_5_Template(e,n){1&e&&(m.Ec(0,\"span\",22),m.pd(1),m.Pc(2,\"translate\"),m.Dc()),2&e&&(m.lc(1),m.qd(m.Qc(2,1,\"core.settings.disabled\")))}function AddonMessagesSettingsPage_ng_template_33_ng_container_0_ion_card_1_ng_container_6_Template(e,n){if(1&e&&(m.Cc(0),m.Ec(1,\"ion-item\",7),m.Ec(2,\"ion-label\"),m.pd(3),m.Dc(),m.nd(4,AddonMessagesSettingsPage_ng_template_33_ng_container_0_ion_card_1_ng_container_6_ng_container_4_Template,3,2,\"ng-container\",5),m.nd(5,AddonMessagesSettingsPage_ng_template_33_ng_container_0_ion_card_1_ng_container_6_span_5_Template,3,3,\"span\",20),m.Dc(),m.Bc()),2&e){const e=n.$implicit,t=m.Oc(3).preferences;m.lc(3),m.qd(e.displayname),m.lc(1),m.Vc(\"ngIf\",!t.disableall),m.lc(1),m.Vc(\"ngIf\",t.disableall)}}function AddonMessagesSettingsPage_ng_template_33_ng_container_0_ion_card_1_Template(e,n){if(1&e&&(m.Ec(0,\"ion-card\"),m.Ec(1,\"ion-item-divider\",7),m.Ec(2,\"ion-label\"),m.Ec(3,\"h2\"),m.pd(4),m.Pc(5,\"translate\"),m.Dc(),m.Dc(),m.Dc(),m.nd(6,AddonMessagesSettingsPage_ng_template_33_ng_container_0_ion_card_1_ng_container_6_Template,6,3,\"ng-container\",16),m.Dc()),2&e){const e=n.$implicit;m.lc(4),m.qd(m.Qc(5,2,\"addon.notifications.notificationpreferences\")),m.lc(2),m.Vc(\"ngForOf\",e.processors)}}function AddonMessagesSettingsPage_ng_template_33_ng_container_0_Template(e,n){if(1&e&&(m.Cc(0),m.nd(1,AddonMessagesSettingsPage_ng_template_33_ng_container_0_ion_card_1_Template,7,4,\"ion-card\",16),m.Bc()),2&e){const e=n.$implicit;m.lc(1),m.Vc(\"ngForOf\",e.notifications)}}function AddonMessagesSettingsPage_ng_template_33_Template(e,n){if(1&e&&m.nd(0,AddonMessagesSettingsPage_ng_template_33_ng_container_0_Template,2,1,\"ng-container\",16),2&e){m.Vc(\"ngForOf\",n.preferences.components)}}let S=(()=>{class AddonMessagesSettingsPage{constructor(){this.preferencesLoaded=!1,this.advancedContactable=!1,this.allowSiteMessaging=!1,this.onlyContactsValue=i.b.MESSAGE_PRIVACY_ONLYCONTACTS,this.courseMemberValue=i.b.MESSAGE_PRIVACY_COURSEMEMBER,this.siteValue=i.b.MESSAGE_PRIVACY_SITE,this.groupMessagingEnabled=!1,this.sendOnEnter=!1,this.loggedInOffLegacyMode=!1;const e=r.b.getRequiredCurrentSite();this.advancedContactable=!!e.isVersionGreaterEqualThan(\"3.6\"),this.allowSiteMessaging=!!e.canUseAdvancedFeature(\"messagingallusers\"),this.groupMessagingEnabled=i.a.isGroupMessagingEnabled(),this.loggedInOffLegacyMode=!e.isVersionGreaterEqualThan(\"4.0\"),this.asyncInit()}asyncInit(){return Object(_.a)(this,void 0,void 0,(function*(){this.sendOnEnter=!!(yield s.a.get(l.a.SETTINGS_SEND_ON_ENTER,!p.a.isMobile()))}))}ngOnInit(){this.fetchPreferences()}fetchPreferences(){return Object(_.a)(this,void 0,void 0,(function*(){try{const e=yield i.a.getMessagePreferences();if(this.groupMessagingEnabled)for(const n of e.components)n.notifications=n.notifications.filter((e=>e.preferencekey==i.b.NOTIFICATION_PREFERENCES_KEY)),this.loggedInOffLegacyMode&&n.notifications.forEach((e=>{e.processors.forEach((e=>{e.enabled=e.loggedin.checked||e.loggedoff.checked}))}));this.preferences=e,this.contactablePrivacy=e.blocknoncontacts,this.previousContactableValue=this.contactablePrivacy}catch(e){d.a.showErrorModal(e)}finally{this.preferencesLoaded=!0}}))}updatePreferences(){i.a.invalidateMessagePreferences().finally((()=>{this.fetchPreferences()}))}updatePreferencesAfterDelay(){clearTimeout(this.updateTimeout),this.updateTimeout=window.setTimeout((()=>{this.updateTimeout=void 0,this.updatePreferences()}),5e3)}saveContactablePrivacy(e){return Object(_.a)(this,void 0,void 0,(function*(){if(this.contactablePrivacy==this.previousContactableValue)return;const n=yield d.a.showModalLoading(\"core.sending\",!0);this.advancedContactable||(e=e?1:0);try{yield o.a.updateUserPreference(\"message_blocknoncontacts\",String(e)),this.updatePreferencesAfterDelay(),this.previousContactableValue=this.contactablePrivacy}catch(e){d.a.showErrorModal(e),this.contactablePrivacy=this.previousContactableValue}finally{n.dismiss()}}))}changePreference(e,n){return Object(_.a)(this,void 0,void 0,(function*(){let t=e.processors.filter((e=>e.enabled)).map((e=>e.name)).join(\",\");\"\"==t&&(t=\"none\"),e.updating=!0;const a=[];this.loggedInOffLegacyMode?(a.push(o.a.updateUserPreference(e.preferencekey+\"_loggedin\",t)),a.push(o.a.updateUserPreference(e.preferencekey+\"_loggedoff\",t))):a.push(o.a.updateUserPreference(e.preferencekey+\"_enabled\",t));try{yield Promise.all(a),this.updatePreferencesAfterDelay()}catch(e){d.a.showErrorModal(e),n.enabled=!n.enabled}finally{e.updating=!1}}))}changePreferenceLegacy(e,n,t){return Object(_.a)(this,void 0,void 0,(function*(){const a=n[t],c=e.preferencekey+\"_\"+a.name,_=e.processors.filter((e=>e[t].checked)).map((e=>e.name)).join(\",\");e[\"updating\"+t]=!0;try{yield o.a.updateUserPreference(c,_),this.updatePreferencesAfterDelay()}catch(e){d.a.showErrorModal(e),a.checked=!a.checked}finally{e[\"updating\"+t]=!1}}))}refreshPreferences(e){i.a.invalidateMessagePreferences().finally((()=>{this.fetchPreferences().finally((()=>{null==e?void 0:e.complete()}))}))}sendOnEnterChanged(){s.a.set(l.a.SETTINGS_SEND_ON_ENTER,this.sendOnEnter?1:0),g.b.trigger(g.b.SEND_ON_ENTER_CHANGED,{sendOnEnter:!!this.sendOnEnter},r.b.getCurrentSiteId())}ngOnDestroy(){this.updateTimeout&&(clearTimeout(this.updateTimeout),this.updatePreferences())}}return AddonMessagesSettingsPage.ɵfac=function AddonMessagesSettingsPage_Factory(e){return new(e||AddonMessagesSettingsPage)},AddonMessagesSettingsPage.ɵcmp=m.sc({type:AddonMessagesSettingsPage,selectors:[[\"page-addon-messages-settings\"]],decls:35,vars:21,consts:[[\"slot\",\"start\"],[3,\"text\"],[\"slot\",\"fixed\",3,\"disabled\",\"ionRefresh\"],[3,\"pullingText\"],[3,\"hideUntil\"],[4,\"ngIf\"],[\"class\",\"ion-text-wrap\",4,\"ngIf\"],[1,\"ion-text-wrap\"],[1,\"item-heading\"],[\"slot\",\"end\",3,\"ngModel\",\"ngModelChange\"],[\"legacySettings\",\"\"],[\"settings\",\"\"],[3,\"ngModel\",\"ngModelChange\"],[3,\"ngModel\",\"ngModelChange\",\"ionChange\"],[\"slot\",\"start\",3,\"value\"],[4,\"ngTemplateOutlet\",\"ngTemplateOutletContext\"],[4,\"ngFor\",\"ngForOf\"],[1,\"ion-no-padding\"],[\"class\",\"ion-text-wrap\",4,\"ngFor\",\"ngForOf\"],[3,\"loading\",4,\"ngIf\"],[\"class\",\"text-gray\",4,\"ngIf\"],[3,\"loading\"],[1,\"text-gray\"]],template:function AddonMessagesSettingsPage_Template(e,n){1&e&&(m.Ec(0,\"ion-header\"),m.Ec(1,\"ion-toolbar\"),m.Ec(2,\"ion-buttons\",0),m.zc(3,\"ion-back-button\",1),m.Pc(4,\"translate\"),m.Dc(),m.Ec(5,\"ion-title\"),m.Ec(6,\"h1\"),m.pd(7),m.Pc(8,\"translate\"),m.Dc(),m.Dc(),m.Dc(),m.Dc(),m.Ec(9,\"ion-content\"),m.Ec(10,\"ion-refresher\",2),m.Mc(\"ionRefresh\",(function AddonMessagesSettingsPage_Template_ion_refresher_ionRefresh_10_listener(e){return n.refreshPreferences(e.target)})),m.zc(11,\"ion-refresher-content\",3),m.Pc(12,\"translate\"),m.Dc(),m.Ec(13,\"core-loading\",4),m.Ec(14,\"ion-card\"),m.nd(15,AddonMessagesSettingsPage_ion_item_15_Template,5,4,\"ion-item\",5),m.nd(16,AddonMessagesSettingsPage_ion_list_16_Template,18,13,\"ion-list\",6),m.Dc(),m.nd(17,AddonMessagesSettingsPage_ng_container_17_Template,3,2,\"ng-container\",5),m.Ec(18,\"ion-card\"),m.Ec(19,\"ion-list\",7),m.Ec(20,\"ion-item-divider\"),m.Ec(21,\"ion-label\"),m.Ec(22,\"h2\"),m.pd(23),m.Pc(24,\"translate\"),m.Dc(),m.Dc(),m.Dc(),m.Ec(25,\"ion-item\",7),m.Ec(26,\"ion-label\"),m.Ec(27,\"p\",8),m.pd(28),m.Pc(29,\"translate\"),m.Dc(),m.Dc(),m.Ec(30,\"ion-toggle\",9),m.Mc(\"ngModelChange\",(function AddonMessagesSettingsPage_Template_ion_toggle_ngModelChange_30_listener(e){return n.sendOnEnter=e}))(\"ngModelChange\",(function AddonMessagesSettingsPage_Template_ion_toggle_ngModelChange_30_listener(){return n.sendOnEnterChanged()})),m.Dc(),m.Dc(),m.Dc(),m.Dc(),m.Dc(),m.Dc(),m.nd(31,AddonMessagesSettingsPage_ng_template_31_Template,1,1,\"ng-template\",null,10,m.od),m.nd(33,AddonMessagesSettingsPage_ng_template_33_Template,1,1,\"ng-template\",null,11,m.od)),2&e&&(m.lc(3),m.Vc(\"text\",m.Qc(4,11,\"core.back\")),m.lc(4),m.qd(m.Qc(8,13,\"addon.messages.messages\")),m.lc(3),m.Vc(\"disabled\",!n.preferencesLoaded),m.lc(1),m.Wc(\"pullingText\",m.Qc(12,15,\"core.pulltorefresh\")),m.lc(2),m.Vc(\"hideUntil\",n.preferencesLoaded),m.lc(2),m.Vc(\"ngIf\",!n.advancedContactable),m.lc(1),m.Vc(\"ngIf\",n.advancedContactable),m.lc(1),m.Vc(\"ngIf\",n.preferences),m.lc(6),m.qd(m.Qc(24,17,\"core.settings.general\")),m.lc(5),m.qd(m.Qc(29,19,\"addon.messages.useentertosend\")),m.lc(2),m.Vc(\"ngModel\",n.sendOnEnter))},directives:[f.C,f.Ab,f.m,f.h,f.i,f.yb,u.a,f.v,f.bb,f.cb,M.a,f.n,h.t,f.P,f.J,f.O,f.I,f.zb,f.d,P.r,P.u,f.Z,f.Ob,f.Y,f.Mb,h.A,h.s,f.p,f.o,E.a],pipes:[b.d],encapsulation:2}),AddonMessagesSettingsPage})();const A=[{path:\"\",component:S}];let T=(()=>{class AddonMessagesSettingsPageModule{}return AddonMessagesSettingsPageModule.ɵmod=m.wc({type:AddonMessagesSettingsPageModule}),AddonMessagesSettingsPageModule.ɵinj=m.vc({factory:function AddonMessagesSettingsPageModule_Factory(e){return new(e||AddonMessagesSettingsPageModule)},imports:[[a.m.forChild(A),c.a],a.m]}),AddonMessagesSettingsPageModule})();void((\"undefined\"==typeof ngJitMode||ngJitMode)&&m.kd(T,{declarations:[S],imports:[a.m,c.a],exports:[a.m]}))}}]);","name":"15.780e0bca33b066de3911.js","input":"(window[\"webpackJsonp\"] = window[\"webpackJsonp\"] || []).push([[15],{\n\n/***/ \"7MVA\":\n/***/ (function(module, __webpack_exports__, __webpack_require__) {\n\n\"use strict\";\n// ESM COMPAT FLAG\n__webpack_require__.r(__webpack_exports__);\n\n// EXPORTS\n__webpack_require__.d(__webpack_exports__, \"AddonMessagesSettingsPageModule\", function() { return /* binding */ settings_module_AddonMessagesSettingsPageModule; });\n\n// EXTERNAL MODULE: ./node_modules/@angular/router/__ivy_ngcc__/fesm2015/router.js + 10 modules\nvar router = __webpack_require__(\"tyNb\");\n\n// EXTERNAL MODULE: ./src/core/shared.module.ts + 3 modules\nvar shared_module = __webpack_require__(\"L3Fv\");\n\n// EXTERNAL MODULE: ./node_modules/tslib/tslib.es6.js\nvar tslib_es6 = __webpack_require__(\"mrSG\");\n\n// EXTERNAL MODULE: ./src/addons/messages/services/messages.ts\nvar messages = __webpack_require__(\"KMk0\");\n\n// EXTERNAL MODULE: ./src/core/features/user/services/user.ts\nvar user = __webpack_require__(\"4pns\");\n\n// EXTERNAL MODULE: ./src/core/services/config.ts + 1 modules\nvar config = __webpack_require__(\"BBqZ\");\n\n// EXTERNAL MODULE: ./src/core/singletons/events.ts\nvar events = __webpack_require__(\"fjkH\");\n\n// EXTERNAL MODULE: ./src/core/services/sites.ts\nvar sites = __webpack_require__(\"9+EE\");\n\n// EXTERNAL MODULE: ./src/core/services/utils/dom.ts + 2 modules\nvar dom = __webpack_require__(\"3LXp\");\n\n// EXTERNAL MODULE: ./src/core/constants.ts\nvar constants = __webpack_require__(\"BaYo\");\n\n// EXTERNAL MODULE: ./src/core/services/platform.ts\nvar platform = __webpack_require__(\"r2Z7\");\n\n// EXTERNAL MODULE: ./node_modules/@angular/core/__ivy_ngcc__/fesm2015/core.js\nvar core = __webpack_require__(\"fXoL\");\n\n// EXTERNAL MODULE: ./node_modules/@ionic/angular/__ivy_ngcc__/fesm2015/ionic-angular.js + 5 modules\nvar ionic_angular = __webpack_require__(\"TEn/\");\n\n// EXTERNAL MODULE: ./src/core/directives/content.ts\nvar content = __webpack_require__(\"nt/U\");\n\n// EXTERNAL MODULE: ./src/core/components/loading/loading.ts\nvar loading = __webpack_require__(\"PgjG\");\n\n// EXTERNAL MODULE: ./node_modules/@angular/common/__ivy_ngcc__/fesm2015/common.js\nvar common = __webpack_require__(\"ofXK\");\n\n// EXTERNAL MODULE: ./node_modules/@angular/forms/__ivy_ngcc__/fesm2015/forms.js\nvar fesm2015_forms = __webpack_require__(\"3Pt+\");\n\n// EXTERNAL MODULE: ./src/core/components/button-with-spinner/button-with-spinner.ts\nvar button_with_spinner = __webpack_require__(\"3zv0\");\n\n// EXTERNAL MODULE: ./node_modules/@ngx-translate/core/__ivy_ngcc__/fesm2015/ngx-translate-core.js + 8 modules\nvar ngx_translate_core = __webpack_require__(\"sYmb\");\n\n// CONCATENATED MODULE: ./src/addons/messages/pages/settings/settings.page.ts\n\n// (C) Copyright 2015 Moodle Pty Ltd.\n//\n// Licensed under the Apache License, Version 2.0 (the \"License\");\n// you may not use this file except in compliance with the License.\n// You may obtain a copy of the License at\n//\n//     http://www.apache.org/licenses/LICENSE-2.0\n//\n// Unless required by applicable law or agreed to in writing, software\n// distributed under the License is distributed on an \"AS IS\" BASIS,\n// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n// See the License for the specific language governing permissions and\n// limitations under the License.\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nfunction AddonMessagesSettingsPage_ion_item_15_Template(rf, ctx) {\n    if (rf & 1) {\n        const _r8 = core[\"Fc\" /* ɵɵgetCurrentView */]();\n        core[\"Ec\" /* ɵɵelementStart */](0, \"ion-item\");\n        core[\"Ec\" /* ɵɵelementStart */](1, \"ion-label\");\n        core[\"pd\" /* ɵɵtext */](2);\n        core[\"Pc\" /* ɵɵpipe */](3, \"translate\");\n        core[\"Dc\" /* ɵɵelementEnd */]();\n        core[\"Ec\" /* ɵɵelementStart */](4, \"ion-toggle\", 12);\n        core[\"Mc\" /* ɵɵlistener */](\"ngModelChange\", function AddonMessagesSettingsPage_ion_item_15_Template_ion_toggle_ngModelChange_4_listener($event) { core[\"fd\" /* ɵɵrestoreView */](_r8); const ctx_r7 = core[\"Oc\" /* ɵɵnextContext */](); return ctx_r7.contactablePrivacy = $event; })(\"ngModelChange\", function AddonMessagesSettingsPage_ion_item_15_Template_ion_toggle_ngModelChange_4_listener() { core[\"fd\" /* ɵɵrestoreView */](_r8); const ctx_r9 = core[\"Oc\" /* ɵɵnextContext */](); return ctx_r9.saveContactablePrivacy(ctx_r9.contactablePrivacy); });\n        core[\"Dc\" /* ɵɵelementEnd */]();\n        core[\"Dc\" /* ɵɵelementEnd */]();\n    }\n    if (rf & 2) {\n        const ctx_r0 = core[\"Oc\" /* ɵɵnextContext */]();\n        core[\"lc\" /* ɵɵadvance */](2);\n        core[\"qd\" /* ɵɵtextInterpolate */](core[\"Qc\" /* ɵɵpipeBind1 */](3, 2, \"addon.messages.blocknoncontacts\"));\n        core[\"lc\" /* ɵɵadvance */](2);\n        core[\"Vc\" /* ɵɵproperty */](\"ngModel\", ctx_r0.contactablePrivacy);\n    }\n}\nfunction AddonMessagesSettingsPage_ion_list_16_ion_item_17_Template(rf, ctx) {\n    if (rf & 1) {\n        core[\"Ec\" /* ɵɵelementStart */](0, \"ion-item\");\n        core[\"Ec\" /* ɵɵelementStart */](1, \"ion-label\");\n        core[\"pd\" /* ɵɵtext */](2);\n        core[\"Pc\" /* ɵɵpipe */](3, \"translate\");\n        core[\"Dc\" /* ɵɵelementEnd */]();\n        core[\"zc\" /* ɵɵelement */](4, \"ion-radio\", 14);\n        core[\"Dc\" /* ɵɵelementEnd */]();\n    }\n    if (rf & 2) {\n        const ctx_r10 = core[\"Oc\" /* ɵɵnextContext */](2);\n        core[\"lc\" /* ɵɵadvance */](2);\n        core[\"qd\" /* ɵɵtextInterpolate */](core[\"Qc\" /* ɵɵpipeBind1 */](3, 2, \"addon.messages.contactableprivacy_site\"));\n        core[\"lc\" /* ɵɵadvance */](2);\n        core[\"Vc\" /* ɵɵproperty */](\"value\", ctx_r10.siteValue);\n    }\n}\nfunction AddonMessagesSettingsPage_ion_list_16_Template(rf, ctx) {\n    if (rf & 1) {\n        const _r12 = core[\"Fc\" /* ɵɵgetCurrentView */]();\n        core[\"Ec\" /* ɵɵelementStart */](0, \"ion-list\", 7);\n        core[\"Ec\" /* ɵɵelementStart */](1, \"ion-radio-group\", 13);\n        core[\"Mc\" /* ɵɵlistener */](\"ngModelChange\", function AddonMessagesSettingsPage_ion_list_16_Template_ion_radio_group_ngModelChange_1_listener($event) { core[\"fd\" /* ɵɵrestoreView */](_r12); const ctx_r11 = core[\"Oc\" /* ɵɵnextContext */](); return ctx_r11.contactablePrivacy = $event; })(\"ionChange\", function AddonMessagesSettingsPage_ion_list_16_Template_ion_radio_group_ionChange_1_listener() { core[\"fd\" /* ɵɵrestoreView */](_r12); const ctx_r13 = core[\"Oc\" /* ɵɵnextContext */](); return ctx_r13.saveContactablePrivacy(ctx_r13.contactablePrivacy); });\n        core[\"Ec\" /* ɵɵelementStart */](2, \"ion-item-divider\");\n        core[\"Ec\" /* ɵɵelementStart */](3, \"ion-label\");\n        core[\"Ec\" /* ɵɵelementStart */](4, \"h2\");\n        core[\"pd\" /* ɵɵtext */](5);\n        core[\"Pc\" /* ɵɵpipe */](6, \"translate\");\n        core[\"Dc\" /* ɵɵelementEnd */]();\n        core[\"Dc\" /* ɵɵelementEnd */]();\n        core[\"Dc\" /* ɵɵelementEnd */]();\n        core[\"Ec\" /* ɵɵelementStart */](7, \"ion-item\");\n        core[\"Ec\" /* ɵɵelementStart */](8, \"ion-label\");\n        core[\"pd\" /* ɵɵtext */](9);\n        core[\"Pc\" /* ɵɵpipe */](10, \"translate\");\n        core[\"Dc\" /* ɵɵelementEnd */]();\n        core[\"zc\" /* ɵɵelement */](11, \"ion-radio\", 14);\n        core[\"Dc\" /* ɵɵelementEnd */]();\n        core[\"Ec\" /* ɵɵelementStart */](12, \"ion-item\");\n        core[\"Ec\" /* ɵɵelementStart */](13, \"ion-label\");\n        core[\"pd\" /* ɵɵtext */](14);\n        core[\"Pc\" /* ɵɵpipe */](15, \"translate\");\n        core[\"Dc\" /* ɵɵelementEnd */]();\n        core[\"zc\" /* ɵɵelement */](16, \"ion-radio\", 14);\n        core[\"Dc\" /* ɵɵelementEnd */]();\n        core[\"nd\" /* ɵɵtemplate */](17, AddonMessagesSettingsPage_ion_list_16_ion_item_17_Template, 5, 4, \"ion-item\", 5);\n        core[\"Dc\" /* ɵɵelementEnd */]();\n        core[\"Dc\" /* ɵɵelementEnd */]();\n    }\n    if (rf & 2) {\n        const ctx_r1 = core[\"Oc\" /* ɵɵnextContext */]();\n        core[\"lc\" /* ɵɵadvance */](1);\n        core[\"Vc\" /* ɵɵproperty */](\"ngModel\", ctx_r1.contactablePrivacy);\n        core[\"lc\" /* ɵɵadvance */](4);\n        core[\"qd\" /* ɵɵtextInterpolate */](core[\"Qc\" /* ɵɵpipeBind1 */](6, 7, \"addon.messages.contactableprivacy\"));\n        core[\"lc\" /* ɵɵadvance */](4);\n        core[\"qd\" /* ɵɵtextInterpolate */](core[\"Qc\" /* ɵɵpipeBind1 */](10, 9, \"addon.messages.contactableprivacy_onlycontacts\"));\n        core[\"lc\" /* ɵɵadvance */](2);\n        core[\"Vc\" /* ɵɵproperty */](\"value\", ctx_r1.onlyContactsValue);\n        core[\"lc\" /* ɵɵadvance */](3);\n        core[\"qd\" /* ɵɵtextInterpolate */](core[\"Qc\" /* ɵɵpipeBind1 */](15, 11, \"addon.messages.contactableprivacy_coursemember\"));\n        core[\"lc\" /* ɵɵadvance */](2);\n        core[\"Vc\" /* ɵɵproperty */](\"value\", ctx_r1.courseMemberValue);\n        core[\"lc\" /* ɵɵadvance */](1);\n        core[\"Vc\" /* ɵɵproperty */](\"ngIf\", ctx_r1.allowSiteMessaging);\n    }\n}\nfunction AddonMessagesSettingsPage_ng_container_17_ng_container_1_ng_container_1_Template(rf, ctx) {\n    if (rf & 1) {\n        core[\"Ac\" /* ɵɵelementContainer */](0);\n    }\n}\nconst _c0 = function (a0) { return { preferences: a0 }; };\nfunction AddonMessagesSettingsPage_ng_container_17_ng_container_1_Template(rf, ctx) {\n    if (rf & 1) {\n        core[\"Cc\" /* ɵɵelementContainerStart */](0);\n        core[\"nd\" /* ɵɵtemplate */](1, AddonMessagesSettingsPage_ng_container_17_ng_container_1_ng_container_1_Template, 1, 0, \"ng-container\", 15);\n        core[\"Bc\" /* ɵɵelementContainerEnd */]();\n    }\n    if (rf & 2) {\n        const ctx_r14 = core[\"Oc\" /* ɵɵnextContext */](2);\n        const _r3 = core[\"ed\" /* ɵɵreference */](32);\n        core[\"lc\" /* ɵɵadvance */](1);\n        core[\"Vc\" /* ɵɵproperty */](\"ngTemplateOutlet\", _r3)(\"ngTemplateOutletContext\", core[\"ad\" /* ɵɵpureFunction1 */](2, _c0, ctx_r14.preferences));\n    }\n}\nfunction AddonMessagesSettingsPage_ng_container_17_ng_container_2_ng_container_1_Template(rf, ctx) {\n    if (rf & 1) {\n        core[\"Ac\" /* ɵɵelementContainer */](0);\n    }\n}\nfunction AddonMessagesSettingsPage_ng_container_17_ng_container_2_Template(rf, ctx) {\n    if (rf & 1) {\n        core[\"Cc\" /* ɵɵelementContainerStart */](0);\n        core[\"nd\" /* ɵɵtemplate */](1, AddonMessagesSettingsPage_ng_container_17_ng_container_2_ng_container_1_Template, 1, 0, \"ng-container\", 15);\n        core[\"Bc\" /* ɵɵelementContainerEnd */]();\n    }\n    if (rf & 2) {\n        const ctx_r15 = core[\"Oc\" /* ɵɵnextContext */](2);\n        const _r5 = core[\"ed\" /* ɵɵreference */](34);\n        core[\"lc\" /* ɵɵadvance */](1);\n        core[\"Vc\" /* ɵɵproperty */](\"ngTemplateOutlet\", _r5)(\"ngTemplateOutletContext\", core[\"ad\" /* ɵɵpureFunction1 */](2, _c0, ctx_r15.preferences));\n    }\n}\nfunction AddonMessagesSettingsPage_ng_container_17_Template(rf, ctx) {\n    if (rf & 1) {\n        core[\"Cc\" /* ɵɵelementContainerStart */](0);\n        core[\"nd\" /* ɵɵtemplate */](1, AddonMessagesSettingsPage_ng_container_17_ng_container_1_Template, 2, 4, \"ng-container\", 5);\n        core[\"nd\" /* ɵɵtemplate */](2, AddonMessagesSettingsPage_ng_container_17_ng_container_2_Template, 2, 4, \"ng-container\", 5);\n        core[\"Bc\" /* ɵɵelementContainerEnd */]();\n    }\n    if (rf & 2) {\n        const ctx_r2 = core[\"Oc\" /* ɵɵnextContext */]();\n        core[\"lc\" /* ɵɵadvance */](1);\n        core[\"Vc\" /* ɵɵproperty */](\"ngIf\", !ctx_r2.groupMessagingEnabled);\n        core[\"lc\" /* ɵɵadvance */](1);\n        core[\"Vc\" /* ɵɵproperty */](\"ngIf\", ctx_r2.groupMessagingEnabled);\n    }\n}\nfunction AddonMessagesSettingsPage_ng_template_31_ng_container_0_ion_card_1_ng_container_7_ion_item_5_ng_container_4_core_button_with_spinner_1_Template(rf, ctx) {\n    if (rf & 1) {\n        const _r34 = core[\"Fc\" /* ɵɵgetCurrentView */]();\n        core[\"Ec\" /* ɵɵelementStart */](0, \"core-button-with-spinner\", 21);\n        core[\"Ec\" /* ɵɵelementStart */](1, \"ion-toggle\", 12);\n        core[\"Mc\" /* ɵɵlistener */](\"ngModelChange\", function AddonMessagesSettingsPage_ng_template_31_ng_container_0_ion_card_1_ng_container_7_ion_item_5_ng_container_4_core_button_with_spinner_1_Template_ion_toggle_ngModelChange_1_listener($event) { core[\"fd\" /* ɵɵrestoreView */](_r34); const state_r26 = core[\"Oc\" /* ɵɵnextContext */](2).$implicit; const processor_r24 = core[\"Oc\" /* ɵɵnextContext */]().$implicit; return processor_r24[state_r26].checked = $event; })(\"ngModelChange\", function AddonMessagesSettingsPage_ng_template_31_ng_container_0_ion_card_1_ng_container_7_ion_item_5_ng_container_4_core_button_with_spinner_1_Template_ion_toggle_ngModelChange_1_listener() { core[\"fd\" /* ɵɵrestoreView */](_r34); const state_r26 = core[\"Oc\" /* ɵɵnextContext */](2).$implicit; const processor_r24 = core[\"Oc\" /* ɵɵnextContext */]().$implicit; const notification_r22 = core[\"Oc\" /* ɵɵnextContext */]().$implicit; const ctx_r36 = core[\"Oc\" /* ɵɵnextContext */](3); return ctx_r36.changePreferenceLegacy(notification_r22, processor_r24, state_r26); });\n        core[\"Dc\" /* ɵɵelementEnd */]();\n        core[\"Dc\" /* ɵɵelementEnd */]();\n    }\n    if (rf & 2) {\n        const state_r26 = core[\"Oc\" /* ɵɵnextContext */](2).$implicit;\n        const processor_r24 = core[\"Oc\" /* ɵɵnextContext */]().$implicit;\n        const notification_r22 = core[\"Oc\" /* ɵɵnextContext */]().$implicit;\n        core[\"Vc\" /* ɵɵproperty */](\"loading\", notification_r22[\"updating\" + state_r26]);\n        core[\"lc\" /* ɵɵadvance */](1);\n        core[\"Vc\" /* ɵɵproperty */](\"ngModel\", processor_r24[state_r26].checked);\n    }\n}\nfunction AddonMessagesSettingsPage_ng_template_31_ng_container_0_ion_card_1_ng_container_7_ion_item_5_ng_container_4_span_2_Template(rf, ctx) {\n    if (rf & 1) {\n        core[\"Ec\" /* ɵɵelementStart */](0, \"span\", 22);\n        core[\"pd\" /* ɵɵtext */](1);\n        core[\"Pc\" /* ɵɵpipe */](2, \"translate\");\n        core[\"Dc\" /* ɵɵelementEnd */]();\n    }\n    if (rf & 2) {\n        core[\"lc\" /* ɵɵadvance */](1);\n        core[\"rd\" /* ɵɵtextInterpolate1 */](\" \", core[\"Qc\" /* ɵɵpipeBind1 */](2, 1, \"core.settings.forced\"), \" \");\n    }\n}\nfunction AddonMessagesSettingsPage_ng_template_31_ng_container_0_ion_card_1_ng_container_7_ion_item_5_ng_container_4_span_3_Template(rf, ctx) {\n    if (rf & 1) {\n        core[\"Ec\" /* ɵɵelementStart */](0, \"span\", 22);\n        core[\"pd\" /* ɵɵtext */](1);\n        core[\"Pc\" /* ɵɵpipe */](2, \"translate\");\n        core[\"Dc\" /* ɵɵelementEnd */]();\n    }\n    if (rf & 2) {\n        core[\"lc\" /* ɵɵadvance */](1);\n        core[\"rd\" /* ɵɵtextInterpolate1 */](\" \", core[\"Qc\" /* ɵɵpipeBind1 */](2, 1, \"core.settings.disallowed\"), \" \");\n    }\n}\nfunction AddonMessagesSettingsPage_ng_template_31_ng_container_0_ion_card_1_ng_container_7_ion_item_5_ng_container_4_Template(rf, ctx) {\n    if (rf & 1) {\n        core[\"Cc\" /* ɵɵelementContainerStart */](0);\n        core[\"nd\" /* ɵɵtemplate */](1, AddonMessagesSettingsPage_ng_template_31_ng_container_0_ion_card_1_ng_container_7_ion_item_5_ng_container_4_core_button_with_spinner_1_Template, 2, 2, \"core-button-with-spinner\", 19);\n        core[\"nd\" /* ɵɵtemplate */](2, AddonMessagesSettingsPage_ng_template_31_ng_container_0_ion_card_1_ng_container_7_ion_item_5_ng_container_4_span_2_Template, 3, 3, \"span\", 20);\n        core[\"nd\" /* ɵɵtemplate */](3, AddonMessagesSettingsPage_ng_template_31_ng_container_0_ion_card_1_ng_container_7_ion_item_5_ng_container_4_span_3_Template, 3, 3, \"span\", 20);\n        core[\"Bc\" /* ɵɵelementContainerEnd */]();\n    }\n    if (rf & 2) {\n        const state_r26 = core[\"Oc\" /* ɵɵnextContext */]().$implicit;\n        const processor_r24 = core[\"Oc\" /* ɵɵnextContext */]().$implicit;\n        core[\"lc\" /* ɵɵadvance */](1);\n        core[\"Vc\" /* ɵɵproperty */](\"ngIf\", !processor_r24.locked);\n        core[\"lc\" /* ɵɵadvance */](1);\n        core[\"Vc\" /* ɵɵproperty */](\"ngIf\", processor_r24.locked && processor_r24[state_r26].checked);\n        core[\"lc\" /* ɵɵadvance */](1);\n        core[\"Vc\" /* ɵɵproperty */](\"ngIf\", processor_r24.locked && !processor_r24[state_r26].checked);\n    }\n}\nfunction AddonMessagesSettingsPage_ng_template_31_ng_container_0_ion_card_1_ng_container_7_ion_item_5_span_5_Template(rf, ctx) {\n    if (rf & 1) {\n        core[\"Ec\" /* ɵɵelementStart */](0, \"span\");\n        core[\"pd\" /* ɵɵtext */](1);\n        core[\"Pc\" /* ɵɵpipe */](2, \"translate\");\n        core[\"Dc\" /* ɵɵelementEnd */]();\n    }\n    if (rf & 2) {\n        core[\"lc\" /* ɵɵadvance */](1);\n        core[\"qd\" /* ɵɵtextInterpolate */](core[\"Qc\" /* ɵɵpipeBind1 */](2, 1, \"core.settings.disabled\"));\n    }\n}\nfunction AddonMessagesSettingsPage_ng_template_31_ng_container_0_ion_card_1_ng_container_7_ion_item_5_Template(rf, ctx) {\n    if (rf & 1) {\n        core[\"Ec\" /* ɵɵelementStart */](0, \"ion-item\", 7);\n        core[\"Ec\" /* ɵɵelementStart */](1, \"ion-label\");\n        core[\"pd\" /* ɵɵtext */](2);\n        core[\"Pc\" /* ɵɵpipe */](3, \"translate\");\n        core[\"Dc\" /* ɵɵelementEnd */]();\n        core[\"nd\" /* ɵɵtemplate */](4, AddonMessagesSettingsPage_ng_template_31_ng_container_0_ion_card_1_ng_container_7_ion_item_5_ng_container_4_Template, 4, 3, \"ng-container\", 5);\n        core[\"nd\" /* ɵɵtemplate */](5, AddonMessagesSettingsPage_ng_template_31_ng_container_0_ion_card_1_ng_container_7_ion_item_5_span_5_Template, 3, 3, \"span\", 5);\n        core[\"Dc\" /* ɵɵelementEnd */]();\n    }\n    if (rf & 2) {\n        const state_r26 = ctx.$implicit;\n        const preferences_r18 = core[\"Oc\" /* ɵɵnextContext */](4).preferences;\n        core[\"lc\" /* ɵɵadvance */](2);\n        core[\"qd\" /* ɵɵtextInterpolate */](core[\"Qc\" /* ɵɵpipeBind1 */](3, 3, \"core.settings.\" + state_r26));\n        core[\"lc\" /* ɵɵadvance */](2);\n        core[\"Vc\" /* ɵɵproperty */](\"ngIf\", !preferences_r18.disableall);\n        core[\"lc\" /* ɵɵadvance */](1);\n        core[\"Vc\" /* ɵɵproperty */](\"ngIf\", preferences_r18.disableall);\n    }\n}\nconst _c1 = function () { return [\"loggedin\", \"loggedoff\"]; };\nfunction AddonMessagesSettingsPage_ng_template_31_ng_container_0_ion_card_1_ng_container_7_Template(rf, ctx) {\n    if (rf & 1) {\n        core[\"Cc\" /* ɵɵelementContainerStart */](0);\n        core[\"Ec\" /* ɵɵelementStart */](1, \"ion-item-divider\", 7);\n        core[\"Ec\" /* ɵɵelementStart */](2, \"ion-label\");\n        core[\"Ec\" /* ɵɵelementStart */](3, \"p\", 8);\n        core[\"pd\" /* ɵɵtext */](4);\n        core[\"Dc\" /* ɵɵelementEnd */]();\n        core[\"Dc\" /* ɵɵelementEnd */]();\n        core[\"Dc\" /* ɵɵelementEnd */]();\n        core[\"nd\" /* ɵɵtemplate */](5, AddonMessagesSettingsPage_ng_template_31_ng_container_0_ion_card_1_ng_container_7_ion_item_5_Template, 6, 5, \"ion-item\", 18);\n        core[\"Bc\" /* ɵɵelementContainerEnd */]();\n    }\n    if (rf & 2) {\n        const processor_r24 = ctx.$implicit;\n        core[\"lc\" /* ɵɵadvance */](4);\n        core[\"qd\" /* ɵɵtextInterpolate */](processor_r24.displayname);\n        core[\"lc\" /* ɵɵadvance */](1);\n        core[\"Vc\" /* ɵɵproperty */](\"ngForOf\", core[\"Zc\" /* ɵɵpureFunction0 */](2, _c1));\n    }\n}\nfunction AddonMessagesSettingsPage_ng_template_31_ng_container_0_ion_card_1_Template(rf, ctx) {\n    if (rf & 1) {\n        core[\"Ec\" /* ɵɵelementStart */](0, \"ion-card\");\n        core[\"Ec\" /* ɵɵelementStart */](1, \"ion-card-header\", 17);\n        core[\"Ec\" /* ɵɵelementStart */](2, \"ion-item\", 7);\n        core[\"Ec\" /* ɵɵelementStart */](3, \"ion-label\");\n        core[\"Ec\" /* ɵɵelementStart */](4, \"h2\");\n        core[\"pd\" /* ɵɵtext */](5);\n        core[\"Dc\" /* ɵɵelementEnd */]();\n        core[\"Dc\" /* ɵɵelementEnd */]();\n        core[\"Dc\" /* ɵɵelementEnd */]();\n        core[\"Dc\" /* ɵɵelementEnd */]();\n        core[\"Ec\" /* ɵɵelementStart */](6, \"ion-card-content\", 17);\n        core[\"nd\" /* ɵɵtemplate */](7, AddonMessagesSettingsPage_ng_template_31_ng_container_0_ion_card_1_ng_container_7_Template, 6, 3, \"ng-container\", 16);\n        core[\"Dc\" /* ɵɵelementEnd */]();\n        core[\"Dc\" /* ɵɵelementEnd */]();\n    }\n    if (rf & 2) {\n        const notification_r22 = ctx.$implicit;\n        core[\"lc\" /* ɵɵadvance */](5);\n        core[\"qd\" /* ɵɵtextInterpolate */](notification_r22.displayname);\n        core[\"lc\" /* ɵɵadvance */](2);\n        core[\"Vc\" /* ɵɵproperty */](\"ngForOf\", notification_r22.processors);\n    }\n}\nfunction AddonMessagesSettingsPage_ng_template_31_ng_container_0_Template(rf, ctx) {\n    if (rf & 1) {\n        core[\"Cc\" /* ɵɵelementContainerStart */](0);\n        core[\"nd\" /* ɵɵtemplate */](1, AddonMessagesSettingsPage_ng_template_31_ng_container_0_ion_card_1_Template, 8, 2, \"ion-card\", 16);\n        core[\"Bc\" /* ɵɵelementContainerEnd */]();\n    }\n    if (rf & 2) {\n        const component_r20 = ctx.$implicit;\n        core[\"lc\" /* ɵɵadvance */](1);\n        core[\"Vc\" /* ɵɵproperty */](\"ngForOf\", component_r20.notifications);\n    }\n}\nfunction AddonMessagesSettingsPage_ng_template_31_Template(rf, ctx) {\n    if (rf & 1) {\n        core[\"nd\" /* ɵɵtemplate */](0, AddonMessagesSettingsPage_ng_template_31_ng_container_0_Template, 2, 1, \"ng-container\", 16);\n    }\n    if (rf & 2) {\n        const preferences_r18 = ctx.preferences;\n        core[\"Vc\" /* ɵɵproperty */](\"ngForOf\", preferences_r18.components);\n    }\n}\nfunction AddonMessagesSettingsPage_ng_template_33_ng_container_0_ion_card_1_ng_container_6_ng_container_4_core_button_with_spinner_1_Template(rf, ctx) {\n    if (rf & 1) {\n        const _r59 = core[\"Fc\" /* ɵɵgetCurrentView */]();\n        core[\"Ec\" /* ɵɵelementStart */](0, \"core-button-with-spinner\", 21);\n        core[\"Ec\" /* ɵɵelementStart */](1, \"ion-toggle\", 12);\n        core[\"Mc\" /* ɵɵlistener */](\"ngModelChange\", function AddonMessagesSettingsPage_ng_template_33_ng_container_0_ion_card_1_ng_container_6_ng_container_4_core_button_with_spinner_1_Template_ion_toggle_ngModelChange_1_listener($event) { core[\"fd\" /* ɵɵrestoreView */](_r59); const processor_r52 = core[\"Oc\" /* ɵɵnextContext */](2).$implicit; return processor_r52.enabled = $event; })(\"ngModelChange\", function AddonMessagesSettingsPage_ng_template_33_ng_container_0_ion_card_1_ng_container_6_ng_container_4_core_button_with_spinner_1_Template_ion_toggle_ngModelChange_1_listener() { core[\"fd\" /* ɵɵrestoreView */](_r59); const processor_r52 = core[\"Oc\" /* ɵɵnextContext */](2).$implicit; const notification_r50 = core[\"Oc\" /* ɵɵnextContext */]().$implicit; const ctx_r60 = core[\"Oc\" /* ɵɵnextContext */](3); return ctx_r60.changePreference(notification_r50, processor_r52); });\n        core[\"Dc\" /* ɵɵelementEnd */]();\n        core[\"Dc\" /* ɵɵelementEnd */]();\n    }\n    if (rf & 2) {\n        const processor_r52 = core[\"Oc\" /* ɵɵnextContext */](2).$implicit;\n        const notification_r50 = core[\"Oc\" /* ɵɵnextContext */]().$implicit;\n        core[\"Vc\" /* ɵɵproperty */](\"loading\", notification_r50.updating);\n        core[\"lc\" /* ɵɵadvance */](1);\n        core[\"Vc\" /* ɵɵproperty */](\"ngModel\", processor_r52.enabled);\n    }\n}\nfunction AddonMessagesSettingsPage_ng_template_33_ng_container_0_ion_card_1_ng_container_6_ng_container_4_span_2_Template(rf, ctx) {\n    if (rf & 1) {\n        core[\"Ec\" /* ɵɵelementStart */](0, \"span\", 22);\n        core[\"pd\" /* ɵɵtext */](1);\n        core[\"Dc\" /* ɵɵelementEnd */]();\n    }\n    if (rf & 2) {\n        const processor_r52 = core[\"Oc\" /* ɵɵnextContext */](2).$implicit;\n        core[\"lc\" /* ɵɵadvance */](1);\n        core[\"rd\" /* ɵɵtextInterpolate1 */](\" \", processor_r52.lockedmessage, \" \");\n    }\n}\nfunction AddonMessagesSettingsPage_ng_template_33_ng_container_0_ion_card_1_ng_container_6_ng_container_4_Template(rf, ctx) {\n    if (rf & 1) {\n        core[\"Cc\" /* ɵɵelementContainerStart */](0);\n        core[\"nd\" /* ɵɵtemplate */](1, AddonMessagesSettingsPage_ng_template_33_ng_container_0_ion_card_1_ng_container_6_ng_container_4_core_button_with_spinner_1_Template, 2, 2, \"core-button-with-spinner\", 19);\n        core[\"nd\" /* ɵɵtemplate */](2, AddonMessagesSettingsPage_ng_template_33_ng_container_0_ion_card_1_ng_container_6_ng_container_4_span_2_Template, 2, 1, \"span\", 20);\n        core[\"Bc\" /* ɵɵelementContainerEnd */]();\n    }\n    if (rf & 2) {\n        const processor_r52 = core[\"Oc\" /* ɵɵnextContext */]().$implicit;\n        core[\"lc\" /* ɵɵadvance */](1);\n        core[\"Vc\" /* ɵɵproperty */](\"ngIf\", !processor_r52.locked);\n        core[\"lc\" /* ɵɵadvance */](1);\n        core[\"Vc\" /* ɵɵproperty */](\"ngIf\", processor_r52.locked);\n    }\n}\nfunction AddonMessagesSettingsPage_ng_template_33_ng_container_0_ion_card_1_ng_container_6_span_5_Template(rf, ctx) {\n    if (rf & 1) {\n        core[\"Ec\" /* ɵɵelementStart */](0, \"span\", 22);\n        core[\"pd\" /* ɵɵtext */](1);\n        core[\"Pc\" /* ɵɵpipe */](2, \"translate\");\n        core[\"Dc\" /* ɵɵelementEnd */]();\n    }\n    if (rf & 2) {\n        core[\"lc\" /* ɵɵadvance */](1);\n        core[\"qd\" /* ɵɵtextInterpolate */](core[\"Qc\" /* ɵɵpipeBind1 */](2, 1, \"core.settings.disabled\"));\n    }\n}\nfunction AddonMessagesSettingsPage_ng_template_33_ng_container_0_ion_card_1_ng_container_6_Template(rf, ctx) {\n    if (rf & 1) {\n        core[\"Cc\" /* ɵɵelementContainerStart */](0);\n        core[\"Ec\" /* ɵɵelementStart */](1, \"ion-item\", 7);\n        core[\"Ec\" /* ɵɵelementStart */](2, \"ion-label\");\n        core[\"pd\" /* ɵɵtext */](3);\n        core[\"Dc\" /* ɵɵelementEnd */]();\n        core[\"nd\" /* ɵɵtemplate */](4, AddonMessagesSettingsPage_ng_template_33_ng_container_0_ion_card_1_ng_container_6_ng_container_4_Template, 3, 2, \"ng-container\", 5);\n        core[\"nd\" /* ɵɵtemplate */](5, AddonMessagesSettingsPage_ng_template_33_ng_container_0_ion_card_1_ng_container_6_span_5_Template, 3, 3, \"span\", 20);\n        core[\"Dc\" /* ɵɵelementEnd */]();\n        core[\"Bc\" /* ɵɵelementContainerEnd */]();\n    }\n    if (rf & 2) {\n        const processor_r52 = ctx.$implicit;\n        const preferences_r46 = core[\"Oc\" /* ɵɵnextContext */](3).preferences;\n        core[\"lc\" /* ɵɵadvance */](3);\n        core[\"qd\" /* ɵɵtextInterpolate */](processor_r52.displayname);\n        core[\"lc\" /* ɵɵadvance */](1);\n        core[\"Vc\" /* ɵɵproperty */](\"ngIf\", !preferences_r46.disableall);\n        core[\"lc\" /* ɵɵadvance */](1);\n        core[\"Vc\" /* ɵɵproperty */](\"ngIf\", preferences_r46.disableall);\n    }\n}\nfunction AddonMessagesSettingsPage_ng_template_33_ng_container_0_ion_card_1_Template(rf, ctx) {\n    if (rf & 1) {\n        core[\"Ec\" /* ɵɵelementStart */](0, \"ion-card\");\n        core[\"Ec\" /* ɵɵelementStart */](1, \"ion-item-divider\", 7);\n        core[\"Ec\" /* ɵɵelementStart */](2, \"ion-label\");\n        core[\"Ec\" /* ɵɵelementStart */](3, \"h2\");\n        core[\"pd\" /* ɵɵtext */](4);\n        core[\"Pc\" /* ɵɵpipe */](5, \"translate\");\n        core[\"Dc\" /* ɵɵelementEnd */]();\n        core[\"Dc\" /* ɵɵelementEnd */]();\n        core[\"Dc\" /* ɵɵelementEnd */]();\n        core[\"nd\" /* ɵɵtemplate */](6, AddonMessagesSettingsPage_ng_template_33_ng_container_0_ion_card_1_ng_container_6_Template, 6, 3, \"ng-container\", 16);\n        core[\"Dc\" /* ɵɵelementEnd */]();\n    }\n    if (rf & 2) {\n        const notification_r50 = ctx.$implicit;\n        core[\"lc\" /* ɵɵadvance */](4);\n        core[\"qd\" /* ɵɵtextInterpolate */](core[\"Qc\" /* ɵɵpipeBind1 */](5, 2, \"addon.notifications.notificationpreferences\"));\n        core[\"lc\" /* ɵɵadvance */](2);\n        core[\"Vc\" /* ɵɵproperty */](\"ngForOf\", notification_r50.processors);\n    }\n}\nfunction AddonMessagesSettingsPage_ng_template_33_ng_container_0_Template(rf, ctx) {\n    if (rf & 1) {\n        core[\"Cc\" /* ɵɵelementContainerStart */](0);\n        core[\"nd\" /* ɵɵtemplate */](1, AddonMessagesSettingsPage_ng_template_33_ng_container_0_ion_card_1_Template, 7, 4, \"ion-card\", 16);\n        core[\"Bc\" /* ɵɵelementContainerEnd */]();\n    }\n    if (rf & 2) {\n        const component_r48 = ctx.$implicit;\n        core[\"lc\" /* ɵɵadvance */](1);\n        core[\"Vc\" /* ɵɵproperty */](\"ngForOf\", component_r48.notifications);\n    }\n}\nfunction AddonMessagesSettingsPage_ng_template_33_Template(rf, ctx) {\n    if (rf & 1) {\n        core[\"nd\" /* ɵɵtemplate */](0, AddonMessagesSettingsPage_ng_template_33_ng_container_0_Template, 2, 1, \"ng-container\", 16);\n    }\n    if (rf & 2) {\n        const preferences_r46 = ctx.preferences;\n        core[\"Vc\" /* ɵɵproperty */](\"ngForOf\", preferences_r46.components);\n    }\n}\n/**\n * Page that displays the messages settings page.\n */\nlet settings_page_AddonMessagesSettingsPage = /*@__PURE__*/ (() => {\n    class AddonMessagesSettingsPage {\n        constructor() {\n            this.preferencesLoaded = false;\n            this.advancedContactable = false; // Whether the site supports \"advanced\" contactable privacy.\n            this.allowSiteMessaging = false;\n            this.onlyContactsValue = messages[\"b\" /* AddonMessagesProvider */].MESSAGE_PRIVACY_ONLYCONTACTS;\n            this.courseMemberValue = messages[\"b\" /* AddonMessagesProvider */].MESSAGE_PRIVACY_COURSEMEMBER;\n            this.siteValue = messages[\"b\" /* AddonMessagesProvider */].MESSAGE_PRIVACY_SITE;\n            this.groupMessagingEnabled = false;\n            this.sendOnEnter = false;\n            this.loggedInOffLegacyMode = false;\n            const currentSite = sites[\"b\" /* CoreSites */].getRequiredCurrentSite();\n            this.advancedContactable = !!currentSite.isVersionGreaterEqualThan('3.6');\n            this.allowSiteMessaging = !!currentSite.canUseAdvancedFeature('messagingallusers');\n            this.groupMessagingEnabled = messages[\"a\" /* AddonMessages */].isGroupMessagingEnabled();\n            this.loggedInOffLegacyMode = !currentSite.isVersionGreaterEqualThan('4.0');\n            this.asyncInit();\n        }\n        asyncInit() {\n            return Object(tslib_es6[\"a\" /* __awaiter */])(this, void 0, void 0, function* () {\n                this.sendOnEnter = !!(yield config[\"a\" /* CoreConfig */].get(constants[\"a\" /* CoreConstants */].SETTINGS_SEND_ON_ENTER, !platform[\"a\" /* CorePlatform */].isMobile()));\n            });\n        }\n        /**\n         * Runs when the page has loaded. This event only happens once per page being created.\n         * If a page leaves but is cached, then this event will not fire again on a subsequent viewing.\n         * Setup code for the page.\n         */\n        ngOnInit() {\n            this.fetchPreferences();\n        }\n        /**\n         * Fetches preference data.\n         *\n         * @return Promise resolved when done.\n         */\n        fetchPreferences() {\n            return Object(tslib_es6[\"a\" /* __awaiter */])(this, void 0, void 0, function* () {\n                try {\n                    const preferences = yield messages[\"a\" /* AddonMessages */].getMessagePreferences();\n                    if (this.groupMessagingEnabled) {\n                        // Simplify the preferences.\n                        for (const component of preferences.components) {\n                            // Only display get the notification preferences.\n                            component.notifications = component.notifications.filter((notification) => notification.preferencekey == messages[\"b\" /* AddonMessagesProvider */].NOTIFICATION_PREFERENCES_KEY);\n                            if (this.loggedInOffLegacyMode) {\n                                // Load enabled from loggedin / loggedoff values.\n                                component.notifications.forEach((notification) => {\n                                    notification.processors.forEach((processor) => {\n                                        processor.enabled = processor.loggedin.checked || processor.loggedoff.checked;\n                                    });\n                                });\n                            }\n                        }\n                    }\n                    this.preferences = preferences;\n                    this.contactablePrivacy = preferences.blocknoncontacts;\n                    this.previousContactableValue = this.contactablePrivacy;\n                }\n                catch (error) {\n                    dom[\"a\" /* CoreDomUtils */].showErrorModal(error);\n                }\n                finally {\n                    this.preferencesLoaded = true;\n                }\n            });\n        }\n        /**\n         * Update preferences. The purpose is to store the updated data, it won't be reflected in the view.\n         */\n        updatePreferences() {\n            messages[\"a\" /* AddonMessages */].invalidateMessagePreferences().finally(() => {\n                this.fetchPreferences();\n            });\n        }\n        /**\n         * Update preferences after a certain time. The purpose is to store the updated data, it won't be reflected in the view.\n         */\n        updatePreferencesAfterDelay() {\n            // Cancel pending updates.\n            clearTimeout(this.updateTimeout);\n            this.updateTimeout = window.setTimeout(() => {\n                this.updateTimeout = undefined;\n                this.updatePreferences();\n            }, 5000);\n        }\n        /**\n         * Save the contactable privacy setting..\n         *\n         * @param value The value to set.\n         */\n        saveContactablePrivacy(value) {\n            return Object(tslib_es6[\"a\" /* __awaiter */])(this, void 0, void 0, function* () {\n                if (this.contactablePrivacy == this.previousContactableValue) {\n                    // Value hasn't changed from previous, it probably means that we just fetched the value from the server.\n                    return;\n                }\n                const modal = yield dom[\"a\" /* CoreDomUtils */].showModalLoading('core.sending', true);\n                if (!this.advancedContactable) {\n                    // Convert from boolean to number.\n                    value = value ? 1 : 0;\n                }\n                try {\n                    yield user[\"a\" /* CoreUser */].updateUserPreference('message_blocknoncontacts', String(value));\n                    // Update the preferences since they were modified.\n                    this.updatePreferencesAfterDelay();\n                    this.previousContactableValue = this.contactablePrivacy;\n                }\n                catch (message) {\n                    // Show error and revert change.\n                    dom[\"a\" /* CoreDomUtils */].showErrorModal(message);\n                    this.contactablePrivacy = this.previousContactableValue;\n                }\n                finally {\n                    modal.dismiss();\n                }\n            });\n        }\n        /**\n         * Change the value of a certain preference. Versions 3.6 onwards.\n         *\n         * @param notification Notification object.\n         * @param processor Notification processor.\n         */\n        changePreference(notification, processor) {\n            return Object(tslib_es6[\"a\" /* __awaiter */])(this, void 0, void 0, function* () {\n                // Update both states at the same time.\n                let value = notification.processors\n                    .filter((processor) => processor.enabled)\n                    .map((processor) => processor.name)\n                    .join(',');\n                if (value == '') {\n                    value = 'none';\n                }\n                notification.updating = true;\n                const promises = [];\n                if (this.loggedInOffLegacyMode) {\n                    promises.push(user[\"a\" /* CoreUser */].updateUserPreference(notification.preferencekey + '_loggedin', value));\n                    promises.push(user[\"a\" /* CoreUser */].updateUserPreference(notification.preferencekey + '_loggedoff', value));\n                }\n                else {\n                    promises.push(user[\"a\" /* CoreUser */].updateUserPreference(notification.preferencekey + '_enabled', value));\n                }\n                try {\n                    yield Promise.all(promises);\n                    // Update the preferences since they were modified.\n                    this.updatePreferencesAfterDelay();\n                }\n                catch (error) {\n                    // Show error and revert change.\n                    dom[\"a\" /* CoreDomUtils */].showErrorModal(error);\n                    processor.enabled = !processor.enabled;\n                }\n                finally {\n                    notification.updating = false;\n                }\n            });\n        }\n        /**\n         * Change the value of a certain preference. Only on version 3.5.\n         *\n         * @param notification Notification object.\n         * @param processor Notification processor.\n         * @param state State name, ['loggedin', 'loggedoff'].\n         */\n        changePreferenceLegacy(notification, processor, state) {\n            return Object(tslib_es6[\"a\" /* __awaiter */])(this, void 0, void 0, function* () {\n                // Update only the specified state.\n                const processorState = processor[state];\n                const preferenceName = notification.preferencekey + '_' + processorState.name;\n                const value = notification.processors\n                    .filter((processor) => processor[state].checked)\n                    .map((processor) => processor.name)\n                    .join(',');\n                notification['updating' + state] = true;\n                try {\n                    yield user[\"a\" /* CoreUser */].updateUserPreference(preferenceName, value);\n                    // Update the preferences since they were modified.\n                    this.updatePreferencesAfterDelay();\n                }\n                catch (error) {\n                    // Show error and revert change.\n                    dom[\"a\" /* CoreDomUtils */].showErrorModal(error);\n                    processorState.checked = !processorState.checked;\n                }\n                finally {\n                    notification['updating' + state] = false;\n                }\n            });\n        }\n        /**\n         * Refresh the list of preferences.\n         *\n         * @param refresher Refresher.\n         */\n        refreshPreferences(refresher) {\n            messages[\"a\" /* AddonMessages */].invalidateMessagePreferences().finally(() => {\n                this.fetchPreferences().finally(() => {\n                    refresher === null || refresher === void 0 ? void 0 : refresher.complete();\n                });\n            });\n        }\n        sendOnEnterChanged() {\n            // Save the value.\n            config[\"a\" /* CoreConfig */].set(constants[\"a\" /* CoreConstants */].SETTINGS_SEND_ON_ENTER, this.sendOnEnter ? 1 : 0);\n            // Notify the app.\n            events[\"b\" /* CoreEvents */].trigger(events[\"b\" /* CoreEvents */].SEND_ON_ENTER_CHANGED, { sendOnEnter: !!this.sendOnEnter }, sites[\"b\" /* CoreSites */].getCurrentSiteId());\n        }\n        /**\n         * Page destroyed.\n         */\n        ngOnDestroy() {\n            // If there is a pending action to update preferences, execute it right now.\n            if (this.updateTimeout) {\n                clearTimeout(this.updateTimeout);\n                this.updatePreferences();\n            }\n        }\n    }\n    AddonMessagesSettingsPage.ɵfac = function AddonMessagesSettingsPage_Factory(t) { return new (t || AddonMessagesSettingsPage)(); };\n    AddonMessagesSettingsPage.ɵcmp = core[\"sc\" /* ɵɵdefineComponent */]({ type: AddonMessagesSettingsPage, selectors: [[\"page-addon-messages-settings\"]], decls: 35, vars: 21, consts: [[\"slot\", \"start\"], [3, \"text\"], [\"slot\", \"fixed\", 3, \"disabled\", \"ionRefresh\"], [3, \"pullingText\"], [3, \"hideUntil\"], [4, \"ngIf\"], [\"class\", \"ion-text-wrap\", 4, \"ngIf\"], [1, \"ion-text-wrap\"], [1, \"item-heading\"], [\"slot\", \"end\", 3, \"ngModel\", \"ngModelChange\"], [\"legacySettings\", \"\"], [\"settings\", \"\"], [3, \"ngModel\", \"ngModelChange\"], [3, \"ngModel\", \"ngModelChange\", \"ionChange\"], [\"slot\", \"start\", 3, \"value\"], [4, \"ngTemplateOutlet\", \"ngTemplateOutletContext\"], [4, \"ngFor\", \"ngForOf\"], [1, \"ion-no-padding\"], [\"class\", \"ion-text-wrap\", 4, \"ngFor\", \"ngForOf\"], [3, \"loading\", 4, \"ngIf\"], [\"class\", \"text-gray\", 4, \"ngIf\"], [3, \"loading\"], [1, \"text-gray\"]], template: function AddonMessagesSettingsPage_Template(rf, ctx) {\n            if (rf & 1) {\n                core[\"Ec\" /* ɵɵelementStart */](0, \"ion-header\");\n                core[\"Ec\" /* ɵɵelementStart */](1, \"ion-toolbar\");\n                core[\"Ec\" /* ɵɵelementStart */](2, \"ion-buttons\", 0);\n                core[\"zc\" /* ɵɵelement */](3, \"ion-back-button\", 1);\n                core[\"Pc\" /* ɵɵpipe */](4, \"translate\");\n                core[\"Dc\" /* ɵɵelementEnd */]();\n                core[\"Ec\" /* ɵɵelementStart */](5, \"ion-title\");\n                core[\"Ec\" /* ɵɵelementStart */](6, \"h1\");\n                core[\"pd\" /* ɵɵtext */](7);\n                core[\"Pc\" /* ɵɵpipe */](8, \"translate\");\n                core[\"Dc\" /* ɵɵelementEnd */]();\n                core[\"Dc\" /* ɵɵelementEnd */]();\n                core[\"Dc\" /* ɵɵelementEnd */]();\n                core[\"Dc\" /* ɵɵelementEnd */]();\n                core[\"Ec\" /* ɵɵelementStart */](9, \"ion-content\");\n                core[\"Ec\" /* ɵɵelementStart */](10, \"ion-refresher\", 2);\n                core[\"Mc\" /* ɵɵlistener */](\"ionRefresh\", function AddonMessagesSettingsPage_Template_ion_refresher_ionRefresh_10_listener($event) { return ctx.refreshPreferences($event.target); });\n                core[\"zc\" /* ɵɵelement */](11, \"ion-refresher-content\", 3);\n                core[\"Pc\" /* ɵɵpipe */](12, \"translate\");\n                core[\"Dc\" /* ɵɵelementEnd */]();\n                core[\"Ec\" /* ɵɵelementStart */](13, \"core-loading\", 4);\n                core[\"Ec\" /* ɵɵelementStart */](14, \"ion-card\");\n                core[\"nd\" /* ɵɵtemplate */](15, AddonMessagesSettingsPage_ion_item_15_Template, 5, 4, \"ion-item\", 5);\n                core[\"nd\" /* ɵɵtemplate */](16, AddonMessagesSettingsPage_ion_list_16_Template, 18, 13, \"ion-list\", 6);\n                core[\"Dc\" /* ɵɵelementEnd */]();\n                core[\"nd\" /* ɵɵtemplate */](17, AddonMessagesSettingsPage_ng_container_17_Template, 3, 2, \"ng-container\", 5);\n                core[\"Ec\" /* ɵɵelementStart */](18, \"ion-card\");\n                core[\"Ec\" /* ɵɵelementStart */](19, \"ion-list\", 7);\n                core[\"Ec\" /* ɵɵelementStart */](20, \"ion-item-divider\");\n                core[\"Ec\" /* ɵɵelementStart */](21, \"ion-label\");\n                core[\"Ec\" /* ɵɵelementStart */](22, \"h2\");\n                core[\"pd\" /* ɵɵtext */](23);\n                core[\"Pc\" /* ɵɵpipe */](24, \"translate\");\n                core[\"Dc\" /* ɵɵelementEnd */]();\n                core[\"Dc\" /* ɵɵelementEnd */]();\n                core[\"Dc\" /* ɵɵelementEnd */]();\n                core[\"Ec\" /* ɵɵelementStart */](25, \"ion-item\", 7);\n                core[\"Ec\" /* ɵɵelementStart */](26, \"ion-label\");\n                core[\"Ec\" /* ɵɵelementStart */](27, \"p\", 8);\n                core[\"pd\" /* ɵɵtext */](28);\n                core[\"Pc\" /* ɵɵpipe */](29, \"translate\");\n                core[\"Dc\" /* ɵɵelementEnd */]();\n                core[\"Dc\" /* ɵɵelementEnd */]();\n                core[\"Ec\" /* ɵɵelementStart */](30, \"ion-toggle\", 9);\n                core[\"Mc\" /* ɵɵlistener */](\"ngModelChange\", function AddonMessagesSettingsPage_Template_ion_toggle_ngModelChange_30_listener($event) { return ctx.sendOnEnter = $event; })(\"ngModelChange\", function AddonMessagesSettingsPage_Template_ion_toggle_ngModelChange_30_listener() { return ctx.sendOnEnterChanged(); });\n                core[\"Dc\" /* ɵɵelementEnd */]();\n                core[\"Dc\" /* ɵɵelementEnd */]();\n                core[\"Dc\" /* ɵɵelementEnd */]();\n                core[\"Dc\" /* ɵɵelementEnd */]();\n                core[\"Dc\" /* ɵɵelementEnd */]();\n                core[\"Dc\" /* ɵɵelementEnd */]();\n                core[\"nd\" /* ɵɵtemplate */](31, AddonMessagesSettingsPage_ng_template_31_Template, 1, 1, \"ng-template\", null, 10, core[\"od\" /* ɵɵtemplateRefExtractor */]);\n                core[\"nd\" /* ɵɵtemplate */](33, AddonMessagesSettingsPage_ng_template_33_Template, 1, 1, \"ng-template\", null, 11, core[\"od\" /* ɵɵtemplateRefExtractor */]);\n            }\n            if (rf & 2) {\n                core[\"lc\" /* ɵɵadvance */](3);\n                core[\"Vc\" /* ɵɵproperty */](\"text\", core[\"Qc\" /* ɵɵpipeBind1 */](4, 11, \"core.back\"));\n                core[\"lc\" /* ɵɵadvance */](4);\n                core[\"qd\" /* ɵɵtextInterpolate */](core[\"Qc\" /* ɵɵpipeBind1 */](8, 13, \"addon.messages.messages\"));\n                core[\"lc\" /* ɵɵadvance */](3);\n                core[\"Vc\" /* ɵɵproperty */](\"disabled\", !ctx.preferencesLoaded);\n                core[\"lc\" /* ɵɵadvance */](1);\n                core[\"Wc\" /* ɵɵpropertyInterpolate */](\"pullingText\", core[\"Qc\" /* ɵɵpipeBind1 */](12, 15, \"core.pulltorefresh\"));\n                core[\"lc\" /* ɵɵadvance */](2);\n                core[\"Vc\" /* ɵɵproperty */](\"hideUntil\", ctx.preferencesLoaded);\n                core[\"lc\" /* ɵɵadvance */](2);\n                core[\"Vc\" /* ɵɵproperty */](\"ngIf\", !ctx.advancedContactable);\n                core[\"lc\" /* ɵɵadvance */](1);\n                core[\"Vc\" /* ɵɵproperty */](\"ngIf\", ctx.advancedContactable);\n                core[\"lc\" /* ɵɵadvance */](1);\n                core[\"Vc\" /* ɵɵproperty */](\"ngIf\", ctx.preferences);\n                core[\"lc\" /* ɵɵadvance */](6);\n                core[\"qd\" /* ɵɵtextInterpolate */](core[\"Qc\" /* ɵɵpipeBind1 */](24, 17, \"core.settings.general\"));\n                core[\"lc\" /* ɵɵadvance */](5);\n                core[\"qd\" /* ɵɵtextInterpolate */](core[\"Qc\" /* ɵɵpipeBind1 */](29, 19, \"addon.messages.useentertosend\"));\n                core[\"lc\" /* ɵɵadvance */](2);\n                core[\"Vc\" /* ɵɵproperty */](\"ngModel\", ctx.sendOnEnter);\n            }\n        }, directives: [ionic_angular[\"C\" /* IonHeader */], ionic_angular[\"Ab\" /* IonToolbar */], ionic_angular[\"m\" /* IonButtons */], ionic_angular[\"h\" /* IonBackButton */], ionic_angular[\"i\" /* IonBackButtonDelegate */], ionic_angular[\"yb\" /* IonTitle */], content[\"a\" /* CoreContentDirective */], ionic_angular[\"v\" /* IonContent */], ionic_angular[\"bb\" /* IonRefresher */], ionic_angular[\"cb\" /* IonRefresherContent */], loading[\"a\" /* CoreLoadingComponent */], ionic_angular[\"n\" /* IonCard */], common[\"t\" /* NgIf */], ionic_angular[\"P\" /* IonList */], ionic_angular[\"J\" /* IonItemDivider */], ionic_angular[\"O\" /* IonLabel */], ionic_angular[\"I\" /* IonItem */], ionic_angular[\"zb\" /* IonToggle */], ionic_angular[\"d\" /* BooleanValueAccessor */], fesm2015_forms[\"r\" /* NgControlStatus */], fesm2015_forms[\"u\" /* NgModel */], ionic_angular[\"Z\" /* IonRadioGroup */], ionic_angular[\"Ob\" /* SelectValueAccessor */], ionic_angular[\"Y\" /* IonRadio */], ionic_angular[\"Mb\" /* RadioValueAccessor */], common[\"A\" /* NgTemplateOutlet */], common[\"s\" /* NgForOf */], ionic_angular[\"p\" /* IonCardHeader */], ionic_angular[\"o\" /* IonCardContent */], button_with_spinner[\"a\" /* CoreButtonWithSpinnerComponent */]], pipes: [ngx_translate_core[\"d\" /* TranslatePipe */]], encapsulation: 2 });\n    return AddonMessagesSettingsPage;\n})();\n\n// CONCATENATED MODULE: ./src/addons/messages/pages/settings/settings.module.ts\n// (C) Copyright 2015 Moodle Pty Ltd.\n//\n// Licensed under the Apache License, Version 2.0 (the \"License\");\n// you may not use this file except in compliance with the License.\n// You may obtain a copy of the License at\n//\n//     http://www.apache.org/licenses/LICENSE-2.0\n//\n// Unless required by applicable law or agreed to in writing, software\n// distributed under the License is distributed on an \"AS IS\" BASIS,\n// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n// See the License for the specific language governing permissions and\n// limitations under the License.\n\n\n\n\n\n\nconst routes = [\n    {\n        path: '',\n        component: settings_page_AddonMessagesSettingsPage,\n    },\n];\nlet settings_module_AddonMessagesSettingsPageModule = /*@__PURE__*/ (() => {\n    class AddonMessagesSettingsPageModule {\n    }\n    AddonMessagesSettingsPageModule.ɵmod = core[\"wc\" /* ɵɵdefineNgModule */]({ type: AddonMessagesSettingsPageModule });\n    AddonMessagesSettingsPageModule.ɵinj = core[\"vc\" /* ɵɵdefineInjector */]({ factory: function AddonMessagesSettingsPageModule_Factory(t) { return new (t || AddonMessagesSettingsPageModule)(); }, imports: [[\n                router[\"m\" /* RouterModule */].forChild(routes),\n                shared_module[\"a\" /* CoreSharedModule */],\n            ], router[\"m\" /* RouterModule */]] });\n    return AddonMessagesSettingsPageModule;\n})();\n(function () { (typeof ngJitMode === \"undefined\" || ngJitMode) && core[\"kd\" /* ɵɵsetNgModuleScope */](settings_module_AddonMessagesSettingsPageModule, { declarations: [settings_page_AddonMessagesSettingsPage], imports: [router[\"m\" /* RouterModule */], shared_module[\"a\" /* CoreSharedModule */]], exports: [router[\"m\" /* RouterModule */]] }); })();\n\n\n/***/ })\n\n}]);","inputSourceMap":null}
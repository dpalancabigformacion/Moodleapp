{"code":"(window.webpackJsonp=window.webpackJsonp||[]).push([[90],{\"Yxj/\":function(e,t,n){\"use strict\";n.r(t),n.d(t,\"CoreCommentsViewerPageModule\",(function(){return z}));var o=n(\"tyNb\"),s=n(\"L3Fv\"),i=n(\"mrSG\"),c=n(\"fjkH\"),a=n(\"9+EE\"),r=n(\"5pQw\"),m=n(\"kQNd\"),l=n(\"TEn/\"),d=n(\"BaYo\"),h=n(\"pHTc\"),g=n(\"j3ag\"),f=n(\"bFG1\"),u=n(\"3LXp\"),C=n(\"4pns\"),_=n(\"vuGA\"),p=n(\"93ts\"),w=n(\"rdx0\"),I=n(\"Q98t\"),b=n(\"nvXB\"),D=n(\"GGba\"),v=n(\"f0Wu\"),O=n.n(v),y=n(\"MUy3\"),P=n(\"fXoL\"),x=n(\"hMzs\"),M=n(\"ofXK\"),V=n(\"fQ68\"),L=n(\"8/N+\"),E=n(\"nt/U\"),N=n(\"PgjG\"),T=n(\"xpMl\"),A=n(\"ACYt\"),k=n(\"3CSS\"),S=n(\"r8G5\"),U=n(\"9pYf\"),j=n(\"O4u7\"),R=n(\"sYmb\"),G=n(\"uYHD\");function CoreCommentsViewerPage_ion_button_9_Template(e,t){if(1&e){const e=P.Fc();P.Ec(0,\"ion-button\",16),P.Mc(\"click\",(function CoreCommentsViewerPage_ion_button_9_Template_ion_button_click_0_listener(){P.fd(e);return P.Oc().toggleDelete()})),P.Pc(1,\"translate\"),P.zc(2,\"ion-icon\",17),P.Dc()}2&e&&P.mc(\"aria-label\",P.Qc(1,1,\"core.toggledelete\"))}function CoreCommentsViewerPage_core_empty_box_20_Template(e,t){1&e&&(P.zc(0,\"core-empty-box\",18),P.Pc(1,\"translate\")),2&e&&P.Vc(\"message\",P.Qc(1,1,\"core.comments.nocomments\"))}function CoreCommentsViewerPage_ng_container_23_p_1_Template(e,t){if(1&e&&(P.Ec(0,\"p\",21),P.pd(1),P.Pc(2,\"coreFormatDate\"),P.Dc()),2&e){const e=P.Oc().$implicit;P.lc(1),P.rd(\" \",P.Rc(2,1,1e3*e.timecreated,\"strftimedayshort\"),\" \")}}function CoreCommentsViewerPage_ng_container_23_Template(e,t){if(1&e){const e=P.Fc();P.Cc(0),P.nd(1,CoreCommentsViewerPage_ng_container_23_p_1_Template,3,4,\"p\",19),P.Ec(2,\"core-message\",20),P.Mc(\"onDeleteMessage\",(function CoreCommentsViewerPage_ng_container_23_Template_core_message_onDeleteMessage_2_listener(){P.fd(e);const n=t.$implicit;return P.Oc().deleteComment(n)}))(\"onUndoDeleteMessage\",(function CoreCommentsViewerPage_ng_container_23_Template_core_message_onUndoDeleteMessage_2_listener(){P.fd(e);const n=t.$implicit;return P.Oc().undoDeleteComment(n)})),P.Dc(),P.Bc()}if(2&e){const e=t.$implicit,n=P.Oc();P.lc(1),P.Vc(\"ngIf\",e.showDate),P.lc(1),P.Vc(\"message\",e)(\"text\",e.content)(\"time\",1e3*e.timecreated)(\"user\",e)(\"showDelete\",n.showDelete)(\"contextLevel\",n.contextLevel)(\"instanceId\",n.instanceId)(\"courseId\",n.courseId)}}const _c0=function(e){return{$a:e}};function CoreCommentsViewerPage_ion_badge_24_Template(e,t){1&e&&(P.Ec(0,\"ion-badge\",22),P.zc(1,\"ion-icon\",23),P.pd(2),P.Pc(3,\"translate\"),P.Pc(4,\"lowercase\"),P.Pc(5,\"translate\"),P.Dc()),2&e&&(P.lc(2),P.rd(\" \",P.Rc(3,1,\"core.thereisdatatosync\",P.ad(8,_c0,P.Qc(4,4,P.Qc(5,6,\"core.comments.comments\")))),\" \"))}function CoreCommentsViewerPage_core_message_25_Template(e,t){if(1&e){const e=P.Fc();P.Ec(0,\"core-message\",24),P.Mc(\"onDeleteMessage\",(function CoreCommentsViewerPage_core_message_25_Template_core_message_onDeleteMessage_0_listener(){P.fd(e);const t=P.Oc();return t.deleteComment(t.offlineComment)})),P.Dc()}if(2&e){const e=P.Oc();P.Vc(\"message\",e.offlineComment)(\"text\",e.offlineComment.content)(\"user\",e.offlineComment)(\"showDelete\",e.showDelete)(\"contextLevel\",e.contextLevel)(\"instanceId\",e.instanceId)(\"courseId\",e.courseId)}}function CoreCommentsViewerPage_ion_footer_26_Template(e,t){if(1&e){const e=P.Fc();P.Ec(0,\"ion-footer\",25),P.Ec(1,\"ion-toolbar\",26),P.Ec(2,\"core-send-message-form\",27),P.Mc(\"onSubmit\",(function CoreCommentsViewerPage_ion_footer_26_Template_core_send_message_form_onSubmit_2_listener(t){P.fd(e);return P.Oc().addComment(t)})),P.Pc(3,\"translate\"),P.Dc(),P.Dc(),P.Dc()}if(2&e){const e=P.Oc();P.lc(2),P.Vc(\"sendDisabled\",e.sending)(\"message\",e.newComment)(\"placeholder\",P.Qc(3,3,\"core.comments.addcomment\"))}}let Q=(()=>{class CoreCommentsViewerPage{constructor(e){this.route=e,this.comments=[],this.commentsLoaded=!1,this.itemId=0,this.area=\"\",this.page=0,this.title=\"\",this.canLoadMore=!1,this.loadMoreError=!1,this.canAddComments=!1,this.canDeleteComments=!1,this.showDelete=!1,this.hasOffline=!1,this.refreshIcon=d.a.ICON_LOADING,this.syncIcon=d.a.ICON_LOADING,this.sending=!1,this.newComment=\"\",this.addDeleteCommentsAvailable=!1,this.viewDestroyed=!1,this.currentUserId=a.b.getCurrentSiteUserId(),this.syncObserver=c.b.on(m.b.AUTO_SYNCED,(e=>{e.contextLevel==this.contextLevel&&e.instanceId==this.instanceId&&e.componentName==this.componentName&&e.itemId==this.itemId&&e.area==this.area&&(this.showSyncWarnings(e.warnings),this.commentsLoaded=!1,this.refreshIcon=d.a.ICON_LOADING,this.syncIcon=d.a.ICON_LOADING,this.page=0,this.comments=[],this.fetchComments(!1))}),a.b.getCurrentSiteId()),this.isOnline=D.a.isOnline(),this.onlineObserver=D.a.onChange().subscribe((()=>{g.A.run((()=>{this.isOnline=D.a.isOnline()}))}))}ngOnInit(){return Object(i.a)(this,void 0,void 0,(function*(){try{this.contextLevel=h.a.getRequiredRouteParam(\"contextLevel\"),this.instanceId=h.a.getRequiredRouteNumberParam(\"instanceId\"),this.componentName=h.a.getRequiredRouteParam(\"componentName\"),this.itemId=h.a.getRequiredRouteNumberParam(\"itemId\"),this.area=h.a.getRouteParam(\"area\")||\"\",this.title=h.a.getRouteNumberParam(\"title\")||g.J.instant(\"core.comments.comments\"),this.courseId=h.a.getRouteNumberParam(\"courseId\")}catch(e){return u.a.showErrorModal(e),h.a.back(),void 0}this.addDeleteCommentsAvailable=yield r.a.isAddCommentsAvailable(),this.currentUserId=a.b.getCurrentSiteUserId(),this.commentsLoaded=!1,yield this.fetchComments(!0)}))}fetchComments(e,t=!1){return Object(i.a)(this,void 0,void 0,(function*(){this.loadMoreError=!1,e&&(yield f.a.ignoreErrors(this.syncComments(t)));try{const e=yield r.a.getComments(this.contextLevel,this.instanceId,this.componentName,this.itemId,this.area,this.page);this.canAddComments=this.addDeleteCommentsAvailable&&!!e.canpost;let t=e.comments.sort(((e,t)=>e.timecreated-t.timecreated));this.canLoadMore=void 0!==e.count?this.comments.length+t.length<e.count:e.comments.length>0&&e.comments.length>=r.b.pageSize,t=yield Promise.all(t.map((e=>this.loadCommentProfile(e)))),this.comments=t.concat(this.comments),this.comments.forEach(((e,t)=>{e.showDate=this.showDate(e,this.comments[t-1]),e.showUserData=this.showUserData(e,this.comments[t-1]),e.showTail=this.showTail(e,this.comments[t+1])})),this.canDeleteComments=this.addDeleteCommentsAvailable&&(this.hasOffline||this.comments.some((e=>!!e.delete))),yield this.loadOfflineData()}catch(e){this.loadMoreError=!0,e&&\"assignsubmission_comments\"==this.componentName?u.a.showAlertTranslated(\"core.notice\",\"core.comments.commentsnotworking\"):u.a.showErrorModalDefault(e,g.J.instant(\"core.error\")+\": get_comments\")}finally{this.commentsLoaded=!0,this.refreshIcon=d.a.ICON_REFRESH,this.syncIcon=d.a.ICON_SYNC,0==this.page&&this.scrollToBottom()}}))}loadPrevious(e){return Object(i.a)(this,void 0,void 0,(function*(){this.page++,this.canLoadMore=!1;try{yield this.fetchComments(!0)}finally{e&&e()}}))}refreshComments(e,t){return Object(i.a)(this,void 0,void 0,(function*(){this.commentsLoaded=!1,this.refreshIcon=d.a.ICON_LOADING,this.syncIcon=d.a.ICON_LOADING;try{yield this.invalidateComments()}finally{this.page=0,this.comments=[];try{yield this.fetchComments(!0,e)}finally{null==t?void 0:t.complete()}}}))}showSyncWarnings(e){const t=_.a.buildMessage(e);t&&u.a.showErrorModal(t)}syncComments(e){return Object(i.a)(this,void 0,void 0,(function*(){try{const e=yield m.a.syncComments(this.contextLevel,this.instanceId,this.componentName,this.itemId,this.area);this.showSyncWarnings((null==e?void 0:e.warnings)||[])}catch(t){throw e&&u.a.showErrorModalDefault(t,\"core.errorsync\",!0),new p.a(t)}}))}addComment(e){return Object(i.a)(this,void 0,void 0,(function*(){b.a.closeKeyboard();const t=yield u.a.showModalLoading(\"core.sending\",!0);this.sending=!0;try{const n=yield r.a.addComment(e,this.contextLevel,this.instanceId,this.componentName,this.itemId,this.area);if(u.a.showToast(n?\"core.comments.eventcommentcreated\":\"core.datastoredoffline\",!0,u.c.LONG),n){this.invalidateComments();const e=yield this.loadCommentProfile(n);e.showDate=this.showDate(e,this.comments[this.comments.length-1]),e.showUserData=this.showUserData(e,this.comments[this.comments.length-1]),e.showTail=this.showTail(e,this.comments[this.comments.length+1]),this.comments=this.comments.concat([e]),this.canDeleteComments=this.addDeleteCommentsAvailable,c.b.trigger(r.b.COMMENTS_COUNT_CHANGED_EVENT,{contextLevel:this.contextLevel,instanceId:this.instanceId,component:this.componentName,itemId:this.itemId,area:this.area,countChange:1},a.b.getCurrentSiteId())}else!1===n&&(yield this.loadOfflineData())}catch(e){u.a.showErrorModal(e)}finally{t.dismiss(),this.sending=!1,this.scrollToBottom()}}))}deleteComment(e){return Object(i.a)(this,void 0,void 0,(function*(){const t=I.a.userDate(1e3*(\"lastmodified\"in e?e.lastmodified:e.timecreated),\"core.strftimerecentfull\"),n={contextlevel:this.contextLevel,instanceid:this.instanceId,component:this.componentName,itemid:this.itemId,area:this.area,content:e.content,id:\"id\"in e?e.id:void 0};try{yield u.a.showDeleteConfirm(\"core.comments.deletecommentbyon\",{$a:{user:e.fullname||\"\",time:t}})}catch(e){return}try{const t=yield r.a.deleteComment(n);if(this.showDelete=!1,t&&\"id\"in e){const t=this.comments.findIndex((t=>t.id==e.id));t>=0&&(this.comments.splice(t,1),c.b.trigger(r.b.COMMENTS_COUNT_CHANGED_EVENT,{contextLevel:this.contextLevel,instanceId:this.instanceId,component:this.componentName,itemId:this.itemId,area:this.area,countChange:-1},a.b.getCurrentSiteId()))}else this.loadOfflineData();this.invalidateComments(),u.a.showToast(\"core.comments.eventcommentdeleted\",!0,u.c.LONG)}catch(e){u.a.showErrorModalDefault(e,\"Delete comment failed.\")}}))}invalidateComments(){return r.a.invalidateCommentsData(this.contextLevel,this.instanceId,this.componentName,this.itemId,this.area)}loadCommentProfile(e){return Object(i.a)(this,void 0,void 0,(function*(){try{const t=yield C.a.getProfile(e.userid,void 0,!0);e.profileimageurl=t.profileimageurl,e.fullname=t.fullname}catch(e){}return e}))}showUserData(e,t){return!(e.userid==this.currentUserId||t&&t.userid==e.userid&&!e.showDate)}showTail(e,t){return!t||t.userid!=e.userid||!!t.showDate}showDate(e,t){return!t||!O()(1e3*e.timecreated).isSame(1e3*t.timecreated,\"day\")}loadOfflineData(){return Object(i.a)(this,void 0,void 0,(function*(){const e=[];let t=!1;e.push(w.a.getComment(this.contextLevel,this.instanceId,this.componentName,this.itemId,this.area).then((e=>Object(i.a)(this,void 0,void 0,(function*(){this.offlineComment=e,this.offlineComment&&(\"\"==this.newComment&&(this.newComment=this.offlineComment.content),this.offlineComment.userid=this.currentUserId,this.offlineComment.pending=!0)}))))),e.push(w.a.getDeletedComments(this.contextLevel,this.instanceId,this.componentName,this.itemId,this.area).then((e=>{t=e&&e.length>0,t&&e.forEach((e=>{const t=this.comments.find((t=>t.id==e.commentid));t&&(t.deleted=!!e.deleted)}))}))),yield Promise.all(e),this.hasOffline=!!this.offlineComment||t}))}undoDeleteComment(e){return Object(i.a)(this,void 0,void 0,(function*(){yield w.a.undoDeleteComment(e.id),e.deleted=!1,this.showDelete=!1}))}scrollToBottom(){setTimeout((()=>{var e;this.viewDestroyed||(null===(e=this.content)||void 0===e?void 0:e.scrollToBottom())}),100)}toggleDelete(){this.showDelete=!this.showDelete}ngOnDestroy(){var e;null===(e=this.syncObserver)||void 0===e?void 0:e.off(),this.onlineObserver.unsubscribe(),this.viewDestroyed=!0}}return CoreCommentsViewerPage.ɵfac=function CoreCommentsViewerPage_Factory(e){return new(e||CoreCommentsViewerPage)(P.yc(o.a))},CoreCommentsViewerPage.ɵcmp=P.sc({type:CoreCommentsViewerPage,selectors:[[\"page-core-comments-viewer\"]],viewQuery:function CoreCommentsViewerPage_Query(e,t){var n;(1&e&&P.ud(l.v,!0),2&e)&&(P.dd(n=P.Nc())&&(t.content=n.first))},decls:27,vars:34,consts:[[\"slot\",\"start\"],[3,\"text\"],[3,\"text\",\"contextLevel\",\"contextInstanceId\",\"courseId\"],[\"slot\",\"end\"],[\"slot\",\"end\",\"fill\",\"clear\",3,\"click\",4,\"ngIf\"],[3,\"hidden\",\"priority\",\"content\",\"iconAction\",\"closeOnClick\",\"action\"],[\"slot\",\"fixed\",3,\"disabled\",\"ionRefresh\"],[3,\"pullingText\"],[3,\"hideUntil\"],[\"icon\",\"fas-comments\",3,\"message\",4,\"ngIf\"],[\"position\",\"top\",3,\"enabled\",\"error\",\"action\"],[1,\"addon-messages-discussion-container\"],[4,\"ngFor\",\"ngForOf\"],[\"class\",\"ion-text-wrap\",\"color\",\"info\",4,\"ngIf\"],[3,\"message\",\"text\",\"user\",\"showDelete\",\"contextLevel\",\"instanceId\",\"courseId\",\"onDeleteMessage\",4,\"ngIf\"],[\"class\",\"footer-adjustable\",4,\"ngIf\"],[\"slot\",\"end\",\"fill\",\"clear\",3,\"click\"],[\"name\",\"fas-pen\",\"slot\",\"icon-only\",\"aria-hidden\",\"true\"],[\"icon\",\"fas-comments\",3,\"message\"],[\"class\",\"ion-text-center addon-messages-date\",4,\"ngIf\"],[3,\"message\",\"text\",\"time\",\"user\",\"showDelete\",\"contextLevel\",\"instanceId\",\"courseId\",\"onDeleteMessage\",\"onUndoDeleteMessage\"],[1,\"ion-text-center\",\"addon-messages-date\"],[\"color\",\"info\",1,\"ion-text-wrap\"],[\"name\",\"fas-exclamation-triangle\",\"aria-hidden\",\"true\"],[3,\"message\",\"text\",\"user\",\"showDelete\",\"contextLevel\",\"instanceId\",\"courseId\",\"onDeleteMessage\"],[1,\"footer-adjustable\"],[\"color\",\"contrast\"],[3,\"sendDisabled\",\"message\",\"placeholder\",\"onSubmit\"]],template:function CoreCommentsViewerPage_Template(e,t){1&e&&(P.Ec(0,\"ion-header\"),P.Ec(1,\"ion-toolbar\"),P.Ec(2,\"ion-buttons\",0),P.zc(3,\"ion-back-button\",1),P.Pc(4,\"translate\"),P.Dc(),P.Ec(5,\"ion-title\"),P.Ec(6,\"h1\"),P.zc(7,\"core-format-text\",2),P.Dc(),P.Dc(),P.Ec(8,\"ion-buttons\",3),P.nd(9,CoreCommentsViewerPage_ion_button_9_Template,3,3,\"ion-button\",4),P.Ec(10,\"core-context-menu\"),P.Ec(11,\"core-context-menu-item\",5),P.Mc(\"action\",(function CoreCommentsViewerPage_Template_core_context_menu_item_action_11_listener(){return t.refreshComments(!1)})),P.Pc(12,\"translate\"),P.Dc(),P.Ec(13,\"core-context-menu-item\",5),P.Mc(\"action\",(function CoreCommentsViewerPage_Template_core_context_menu_item_action_13_listener(){return t.refreshComments(!0)})),P.Pc(14,\"translate\"),P.Dc(),P.Dc(),P.Dc(),P.Dc(),P.Dc(),P.Ec(15,\"ion-content\"),P.Ec(16,\"ion-refresher\",6),P.Mc(\"ionRefresh\",(function CoreCommentsViewerPage_Template_ion_refresher_ionRefresh_16_listener(e){return t.refreshComments(!1,e.target)})),P.zc(17,\"ion-refresher-content\",7),P.Pc(18,\"translate\"),P.Dc(),P.Ec(19,\"core-loading\",8),P.nd(20,CoreCommentsViewerPage_core_empty_box_20_Template,2,3,\"core-empty-box\",9),P.Ec(21,\"core-infinite-loading\",10),P.Mc(\"action\",(function CoreCommentsViewerPage_Template_core_infinite_loading_action_21_listener(e){return t.loadPrevious(e)})),P.Dc(),P.Ec(22,\"ion-list\",11),P.nd(23,CoreCommentsViewerPage_ng_container_23_Template,3,9,\"ng-container\",12),P.nd(24,CoreCommentsViewerPage_ion_badge_24_Template,6,10,\"ion-badge\",13),P.nd(25,CoreCommentsViewerPage_core_message_25_Template,1,7,\"core-message\",14),P.Dc(),P.Dc(),P.Dc(),P.nd(26,CoreCommentsViewerPage_ion_footer_26_Template,4,5,\"ion-footer\",15)),2&e&&(P.lc(3),P.Vc(\"text\",P.Qc(4,26,\"core.back\")),P.lc(4),P.Vc(\"text\",t.title)(\"contextLevel\",t.contextLevel)(\"contextInstanceId\",t.instanceId)(\"courseId\",t.courseId),P.lc(2),P.Vc(\"ngIf\",t.canDeleteComments),P.lc(2),P.Vc(\"hidden\",!(t.commentsLoaded&&!t.hasOffline))(\"priority\",100)(\"content\",P.Qc(12,28,\"core.refresh\"))(\"iconAction\",t.refreshIcon)(\"closeOnClick\",!0),P.lc(2),P.Vc(\"hidden\",!(t.commentsLoaded&&t.hasOffline&&t.isOnline))(\"priority\",100)(\"content\",P.Qc(14,30,\"core.settings.synchronizenow\"))(\"iconAction\",t.syncIcon)(\"closeOnClick\",!1),P.lc(3),P.Vc(\"disabled\",!t.commentsLoaded),P.lc(1),P.Wc(\"pullingText\",P.Qc(18,32,\"core.pulltorefresh\")),P.lc(2),P.Vc(\"hideUntil\",t.commentsLoaded),P.lc(1),P.Vc(\"ngIf\",!(null!=t.comments&&t.comments.length||t.offlineComment)),P.lc(1),P.Vc(\"enabled\",t.canLoadMore)(\"error\",t.loadMoreError),P.lc(2),P.Vc(\"ngForOf\",t.comments),P.lc(1),P.Vc(\"ngIf\",t.hasOffline),P.lc(1),P.Vc(\"ngIf\",t.hasOffline&&t.offlineComment),P.lc(1),P.Vc(\"ngIf\",t.commentsLoaded&&t.canAddComments))},directives:[l.C,l.Ab,l.m,l.h,l.i,l.yb,x.a,M.t,V.a,L.a,E.a,l.v,l.bb,l.cb,N.a,T.a,l.P,M.s,A.a,l.l,l.D,k.a,S.a,U.a,l.k,l.A,j.a],pipes:[R.d,G.a,M.p],styles:[\".ios[_nghost-%COMP%]   ion-footer[_ngcontent-%COMP%]   .toolbar[_ngcontent-%COMP%]:last-child, .ios   [_nghost-%COMP%]   ion-footer[_ngcontent-%COMP%]   .toolbar[_ngcontent-%COMP%]:last-child{padding-bottom:4px;min-height:0}ion-content[_ngcontent-%COMP%]{--content-background:var(--background-alternative);--background:var(--content-background)}ion-content[_ngcontent-%COMP%]::part(scroll){padding-bottom:0!important}.addon-messages-discussion-container[_ngcontent-%COMP%]{display:flex;flex-direction:column;padding-bottom:16px!important;background:var(--content-background)}.addon-messages-date[_ngcontent-%COMP%]{font-weight:400;font-size:.9rem}ion-badge[_ngcontent-%COMP%]{margin:8px auto}\"],data:{animation:[y.a.SLIDE_IN_OUT]}}),CoreCommentsViewerPage})();const F=[{path:\"\",component:Q}];let z=(()=>{class CoreCommentsViewerPageModule{}return CoreCommentsViewerPageModule.ɵmod=P.wc({type:CoreCommentsViewerPageModule}),CoreCommentsViewerPageModule.ɵinj=P.vc({factory:function CoreCommentsViewerPageModule_Factory(e){return new(e||CoreCommentsViewerPageModule)},imports:[[o.m.forChild(F),s.a],o.m]}),CoreCommentsViewerPageModule})();void((\"undefined\"==typeof ngJitMode||ngJitMode)&&P.kd(z,{declarations:[Q],imports:[o.m,s.a],exports:[o.m]}))}}]);","name":"90.33d8c1652892aa170f1a.js","input":"(window[\"webpackJsonp\"] = window[\"webpackJsonp\"] || []).push([[90],{\n\n/***/ \"Yxj/\":\n/***/ (function(module, __webpack_exports__, __webpack_require__) {\n\n\"use strict\";\n// ESM COMPAT FLAG\n__webpack_require__.r(__webpack_exports__);\n\n// EXPORTS\n__webpack_require__.d(__webpack_exports__, \"CoreCommentsViewerPageModule\", function() { return /* binding */ viewer_module_CoreCommentsViewerPageModule; });\n\n// EXTERNAL MODULE: ./node_modules/@angular/router/__ivy_ngcc__/fesm2015/router.js + 10 modules\nvar router = __webpack_require__(\"tyNb\");\n\n// EXTERNAL MODULE: ./src/core/shared.module.ts + 3 modules\nvar shared_module = __webpack_require__(\"L3Fv\");\n\n// EXTERNAL MODULE: ./node_modules/tslib/tslib.es6.js\nvar tslib_es6 = __webpack_require__(\"mrSG\");\n\n// EXTERNAL MODULE: ./src/core/singletons/events.ts\nvar events = __webpack_require__(\"fjkH\");\n\n// EXTERNAL MODULE: ./src/core/services/sites.ts\nvar sites = __webpack_require__(\"9+EE\");\n\n// EXTERNAL MODULE: ./src/core/features/comments/services/comments.ts\nvar services_comments = __webpack_require__(\"5pQw\");\n\n// EXTERNAL MODULE: ./src/core/features/comments/services/comments-sync.ts\nvar comments_sync = __webpack_require__(\"kQNd\");\n\n// EXTERNAL MODULE: ./node_modules/@ionic/angular/__ivy_ngcc__/fesm2015/ionic-angular.js + 5 modules\nvar ionic_angular = __webpack_require__(\"TEn/\");\n\n// EXTERNAL MODULE: ./src/core/constants.ts\nvar constants = __webpack_require__(\"BaYo\");\n\n// EXTERNAL MODULE: ./src/core/services/navigator.ts\nvar services_navigator = __webpack_require__(\"pHTc\");\n\n// EXTERNAL MODULE: ./src/core/singletons/index.ts\nvar singletons = __webpack_require__(\"j3ag\");\n\n// EXTERNAL MODULE: ./src/core/services/utils/utils.ts\nvar utils = __webpack_require__(\"bFG1\");\n\n// EXTERNAL MODULE: ./src/core/services/utils/dom.ts + 2 modules\nvar dom = __webpack_require__(\"3LXp\");\n\n// EXTERNAL MODULE: ./src/core/features/user/services/user.ts\nvar services_user = __webpack_require__(\"4pns\");\n\n// EXTERNAL MODULE: ./src/core/services/utils/text.ts + 1 modules\nvar utils_text = __webpack_require__(\"vuGA\");\n\n// EXTERNAL MODULE: ./src/core/classes/errors/error.ts\nvar errors_error = __webpack_require__(\"93ts\");\n\n// EXTERNAL MODULE: ./src/core/features/comments/services/comments-offline.ts\nvar comments_offline = __webpack_require__(\"rdx0\");\n\n// EXTERNAL MODULE: ./src/core/services/utils/time.ts\nvar utils_time = __webpack_require__(\"Q98t\");\n\n// EXTERNAL MODULE: ./src/core/services/app.ts + 1 modules\nvar app = __webpack_require__(\"nvXB\");\n\n// EXTERNAL MODULE: ./src/core/services/network.ts + 2 modules\nvar network = __webpack_require__(\"GGba\");\n\n// EXTERNAL MODULE: ./node_modules/moment-timezone/index.js\nvar moment_timezone = __webpack_require__(\"f0Wu\");\nvar moment_timezone_default = /*#__PURE__*/__webpack_require__.n(moment_timezone);\n\n// EXTERNAL MODULE: ./src/core/components/animations.ts\nvar animations = __webpack_require__(\"MUy3\");\n\n// EXTERNAL MODULE: ./node_modules/@angular/core/__ivy_ngcc__/fesm2015/core.js\nvar core = __webpack_require__(\"fXoL\");\n\n// EXTERNAL MODULE: ./src/core/directives/format-text.ts\nvar format_text = __webpack_require__(\"hMzs\");\n\n// EXTERNAL MODULE: ./node_modules/@angular/common/__ivy_ngcc__/fesm2015/common.js\nvar common = __webpack_require__(\"ofXK\");\n\n// EXTERNAL MODULE: ./src/core/components/context-menu/context-menu.ts + 4 modules\nvar context_menu = __webpack_require__(\"fQ68\");\n\n// EXTERNAL MODULE: ./src/core/components/context-menu/context-menu-item.ts\nvar context_menu_item = __webpack_require__(\"8/N+\");\n\n// EXTERNAL MODULE: ./src/core/directives/content.ts\nvar content = __webpack_require__(\"nt/U\");\n\n// EXTERNAL MODULE: ./src/core/components/loading/loading.ts\nvar loading = __webpack_require__(\"PgjG\");\n\n// EXTERNAL MODULE: ./src/core/components/infinite-loading/infinite-loading.ts\nvar infinite_loading = __webpack_require__(\"xpMl\");\n\n// EXTERNAL MODULE: ./src/core/directives/update-non-reactive-attributes.ts\nvar update_non_reactive_attributes = __webpack_require__(\"ACYt\");\n\n// EXTERNAL MODULE: ./src/core/directives/fa-icon.ts\nvar fa_icon = __webpack_require__(\"3CSS\");\n\n// EXTERNAL MODULE: ./src/core/components/empty-box/empty-box.ts\nvar empty_box = __webpack_require__(\"r8G5\");\n\n// EXTERNAL MODULE: ./src/core/components/message/message.ts\nvar message_message = __webpack_require__(\"9pYf\");\n\n// EXTERNAL MODULE: ./src/core/components/send-message-form/send-message-form.ts\nvar send_message_form = __webpack_require__(\"O4u7\");\n\n// EXTERNAL MODULE: ./node_modules/@ngx-translate/core/__ivy_ngcc__/fesm2015/ngx-translate-core.js + 8 modules\nvar ngx_translate_core = __webpack_require__(\"sYmb\");\n\n// EXTERNAL MODULE: ./src/core/pipes/format-date.ts\nvar format_date = __webpack_require__(\"uYHD\");\n\n// CONCATENATED MODULE: ./src/core/features/comments/pages/viewer/viewer.page.ts\n\n// (C) Copyright 2015 Moodle Pty Ltd.\n//\n// Licensed under the Apache License, Version 2.0 (the \"License\");\n// you may not use this file except in compliance with the License.\n// You may obtain a copy of the License at\n//\n//     http://www.apache.org/licenses/LICENSE-2.0\n//\n// Unless required by applicable law or agreed to in writing, software\n// distributed under the License is distributed on an \"AS IS\" BASIS,\n// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n// See the License for the specific language governing permissions and\n// limitations under the License.\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nfunction CoreCommentsViewerPage_ion_button_9_Template(rf, ctx) {\n    if (rf & 1) {\n        const _r7 = core[\"Fc\" /* ɵɵgetCurrentView */]();\n        core[\"Ec\" /* ɵɵelementStart */](0, \"ion-button\", 16);\n        core[\"Mc\" /* ɵɵlistener */](\"click\", function CoreCommentsViewerPage_ion_button_9_Template_ion_button_click_0_listener() { core[\"fd\" /* ɵɵrestoreView */](_r7); const ctx_r6 = core[\"Oc\" /* ɵɵnextContext */](); return ctx_r6.toggleDelete(); });\n        core[\"Pc\" /* ɵɵpipe */](1, \"translate\");\n        core[\"zc\" /* ɵɵelement */](2, \"ion-icon\", 17);\n        core[\"Dc\" /* ɵɵelementEnd */]();\n    }\n    if (rf & 2) {\n        core[\"mc\" /* ɵɵattribute */](\"aria-label\", core[\"Qc\" /* ɵɵpipeBind1 */](1, 1, \"core.toggledelete\"));\n    }\n}\nfunction CoreCommentsViewerPage_core_empty_box_20_Template(rf, ctx) {\n    if (rf & 1) {\n        core[\"zc\" /* ɵɵelement */](0, \"core-empty-box\", 18);\n        core[\"Pc\" /* ɵɵpipe */](1, \"translate\");\n    }\n    if (rf & 2) {\n        core[\"Vc\" /* ɵɵproperty */](\"message\", core[\"Qc\" /* ɵɵpipeBind1 */](1, 1, \"core.comments.nocomments\"));\n    }\n}\nfunction CoreCommentsViewerPage_ng_container_23_p_1_Template(rf, ctx) {\n    if (rf & 1) {\n        core[\"Ec\" /* ɵɵelementStart */](0, \"p\", 21);\n        core[\"pd\" /* ɵɵtext */](1);\n        core[\"Pc\" /* ɵɵpipe */](2, \"coreFormatDate\");\n        core[\"Dc\" /* ɵɵelementEnd */]();\n    }\n    if (rf & 2) {\n        const comment_r8 = core[\"Oc\" /* ɵɵnextContext */]().$implicit;\n        core[\"lc\" /* ɵɵadvance */](1);\n        core[\"rd\" /* ɵɵtextInterpolate1 */](\" \", core[\"Rc\" /* ɵɵpipeBind2 */](2, 1, comment_r8.timecreated * 1000, \"strftimedayshort\"), \" \");\n    }\n}\nfunction CoreCommentsViewerPage_ng_container_23_Template(rf, ctx) {\n    if (rf & 1) {\n        const _r14 = core[\"Fc\" /* ɵɵgetCurrentView */]();\n        core[\"Cc\" /* ɵɵelementContainerStart */](0);\n        core[\"nd\" /* ɵɵtemplate */](1, CoreCommentsViewerPage_ng_container_23_p_1_Template, 3, 4, \"p\", 19);\n        core[\"Ec\" /* ɵɵelementStart */](2, \"core-message\", 20);\n        core[\"Mc\" /* ɵɵlistener */](\"onDeleteMessage\", function CoreCommentsViewerPage_ng_container_23_Template_core_message_onDeleteMessage_2_listener() { core[\"fd\" /* ɵɵrestoreView */](_r14); const comment_r8 = ctx.$implicit; const ctx_r13 = core[\"Oc\" /* ɵɵnextContext */](); return ctx_r13.deleteComment(comment_r8); })(\"onUndoDeleteMessage\", function CoreCommentsViewerPage_ng_container_23_Template_core_message_onUndoDeleteMessage_2_listener() { core[\"fd\" /* ɵɵrestoreView */](_r14); const comment_r8 = ctx.$implicit; const ctx_r15 = core[\"Oc\" /* ɵɵnextContext */](); return ctx_r15.undoDeleteComment(comment_r8); });\n        core[\"Dc\" /* ɵɵelementEnd */]();\n        core[\"Bc\" /* ɵɵelementContainerEnd */]();\n    }\n    if (rf & 2) {\n        const comment_r8 = ctx.$implicit;\n        const ctx_r2 = core[\"Oc\" /* ɵɵnextContext */]();\n        core[\"lc\" /* ɵɵadvance */](1);\n        core[\"Vc\" /* ɵɵproperty */](\"ngIf\", comment_r8.showDate);\n        core[\"lc\" /* ɵɵadvance */](1);\n        core[\"Vc\" /* ɵɵproperty */](\"message\", comment_r8)(\"text\", comment_r8.content)(\"time\", comment_r8.timecreated * 1000)(\"user\", comment_r8)(\"showDelete\", ctx_r2.showDelete)(\"contextLevel\", ctx_r2.contextLevel)(\"instanceId\", ctx_r2.instanceId)(\"courseId\", ctx_r2.courseId);\n    }\n}\nconst _c0 = function (a0) { return { $a: a0 }; };\nfunction CoreCommentsViewerPage_ion_badge_24_Template(rf, ctx) {\n    if (rf & 1) {\n        core[\"Ec\" /* ɵɵelementStart */](0, \"ion-badge\", 22);\n        core[\"zc\" /* ɵɵelement */](1, \"ion-icon\", 23);\n        core[\"pd\" /* ɵɵtext */](2);\n        core[\"Pc\" /* ɵɵpipe */](3, \"translate\");\n        core[\"Pc\" /* ɵɵpipe */](4, \"lowercase\");\n        core[\"Pc\" /* ɵɵpipe */](5, \"translate\");\n        core[\"Dc\" /* ɵɵelementEnd */]();\n    }\n    if (rf & 2) {\n        core[\"lc\" /* ɵɵadvance */](2);\n        core[\"rd\" /* ɵɵtextInterpolate1 */](\" \", core[\"Rc\" /* ɵɵpipeBind2 */](3, 1, \"core.thereisdatatosync\", core[\"ad\" /* ɵɵpureFunction1 */](8, _c0, core[\"Qc\" /* ɵɵpipeBind1 */](4, 4, core[\"Qc\" /* ɵɵpipeBind1 */](5, 6, \"core.comments.comments\")))), \" \");\n    }\n}\nfunction CoreCommentsViewerPage_core_message_25_Template(rf, ctx) {\n    if (rf & 1) {\n        const _r17 = core[\"Fc\" /* ɵɵgetCurrentView */]();\n        core[\"Ec\" /* ɵɵelementStart */](0, \"core-message\", 24);\n        core[\"Mc\" /* ɵɵlistener */](\"onDeleteMessage\", function CoreCommentsViewerPage_core_message_25_Template_core_message_onDeleteMessage_0_listener() { core[\"fd\" /* ɵɵrestoreView */](_r17); const ctx_r16 = core[\"Oc\" /* ɵɵnextContext */](); return ctx_r16.deleteComment(ctx_r16.offlineComment); });\n        core[\"Dc\" /* ɵɵelementEnd */]();\n    }\n    if (rf & 2) {\n        const ctx_r4 = core[\"Oc\" /* ɵɵnextContext */]();\n        core[\"Vc\" /* ɵɵproperty */](\"message\", ctx_r4.offlineComment)(\"text\", ctx_r4.offlineComment.content)(\"user\", ctx_r4.offlineComment)(\"showDelete\", ctx_r4.showDelete)(\"contextLevel\", ctx_r4.contextLevel)(\"instanceId\", ctx_r4.instanceId)(\"courseId\", ctx_r4.courseId);\n    }\n}\nfunction CoreCommentsViewerPage_ion_footer_26_Template(rf, ctx) {\n    if (rf & 1) {\n        const _r19 = core[\"Fc\" /* ɵɵgetCurrentView */]();\n        core[\"Ec\" /* ɵɵelementStart */](0, \"ion-footer\", 25);\n        core[\"Ec\" /* ɵɵelementStart */](1, \"ion-toolbar\", 26);\n        core[\"Ec\" /* ɵɵelementStart */](2, \"core-send-message-form\", 27);\n        core[\"Mc\" /* ɵɵlistener */](\"onSubmit\", function CoreCommentsViewerPage_ion_footer_26_Template_core_send_message_form_onSubmit_2_listener($event) { core[\"fd\" /* ɵɵrestoreView */](_r19); const ctx_r18 = core[\"Oc\" /* ɵɵnextContext */](); return ctx_r18.addComment($event); });\n        core[\"Pc\" /* ɵɵpipe */](3, \"translate\");\n        core[\"Dc\" /* ɵɵelementEnd */]();\n        core[\"Dc\" /* ɵɵelementEnd */]();\n        core[\"Dc\" /* ɵɵelementEnd */]();\n    }\n    if (rf & 2) {\n        const ctx_r5 = core[\"Oc\" /* ɵɵnextContext */]();\n        core[\"lc\" /* ɵɵadvance */](2);\n        core[\"Vc\" /* ɵɵproperty */](\"sendDisabled\", ctx_r5.sending)(\"message\", ctx_r5.newComment)(\"placeholder\", core[\"Qc\" /* ɵɵpipeBind1 */](3, 3, \"core.comments.addcomment\"));\n    }\n}\n/**\n * Page that displays comments.\n */\nlet viewer_page_CoreCommentsViewerPage = /*@__PURE__*/ (() => {\n    class CoreCommentsViewerPage {\n        constructor(route) {\n            this.route = route;\n            this.comments = [];\n            this.commentsLoaded = false;\n            this.itemId = 0;\n            this.area = '';\n            this.page = 0;\n            this.title = '';\n            this.canLoadMore = false;\n            this.loadMoreError = false;\n            this.canAddComments = false;\n            this.canDeleteComments = false;\n            this.showDelete = false;\n            this.hasOffline = false;\n            this.refreshIcon = constants[\"a\" /* CoreConstants */].ICON_LOADING;\n            this.syncIcon = constants[\"a\" /* CoreConstants */].ICON_LOADING;\n            this.sending = false;\n            this.newComment = '';\n            this.addDeleteCommentsAvailable = false;\n            this.viewDestroyed = false;\n            this.currentUserId = sites[\"b\" /* CoreSites */].getCurrentSiteUserId();\n            // Refresh data if comments are synchronized automatically.\n            this.syncObserver = events[\"b\" /* CoreEvents */].on(comments_sync[\"b\" /* CoreCommentsSyncProvider */].AUTO_SYNCED, (data) => {\n                if (data.contextLevel == this.contextLevel && data.instanceId == this.instanceId &&\n                    data.componentName == this.componentName && data.itemId == this.itemId && data.area == this.area) {\n                    // Show the sync warnings.\n                    this.showSyncWarnings(data.warnings);\n                    // Refresh the data.\n                    this.commentsLoaded = false;\n                    this.refreshIcon = constants[\"a\" /* CoreConstants */].ICON_LOADING;\n                    this.syncIcon = constants[\"a\" /* CoreConstants */].ICON_LOADING;\n                    this.page = 0;\n                    this.comments = [];\n                    this.fetchComments(false);\n                }\n            }, sites[\"b\" /* CoreSites */].getCurrentSiteId());\n            this.isOnline = network[\"a\" /* CoreNetwork */].isOnline();\n            this.onlineObserver = network[\"a\" /* CoreNetwork */].onChange().subscribe(() => {\n                // Execute the callback in the Angular zone, so change detection doesn't stop working.\n                singletons[\"A\" /* NgZone */].run(() => {\n                    this.isOnline = network[\"a\" /* CoreNetwork */].isOnline();\n                });\n            });\n        }\n        /**\n         * View loaded.\n         */\n        ngOnInit() {\n            return Object(tslib_es6[\"a\" /* __awaiter */])(this, void 0, void 0, function* () {\n                try {\n                    this.contextLevel = services_navigator[\"a\" /* CoreNavigator */].getRequiredRouteParam('contextLevel');\n                    this.instanceId = services_navigator[\"a\" /* CoreNavigator */].getRequiredRouteNumberParam('instanceId');\n                    this.componentName = services_navigator[\"a\" /* CoreNavigator */].getRequiredRouteParam('componentName');\n                    this.itemId = services_navigator[\"a\" /* CoreNavigator */].getRequiredRouteNumberParam('itemId');\n                    this.area = services_navigator[\"a\" /* CoreNavigator */].getRouteParam('area') || '';\n                    this.title = services_navigator[\"a\" /* CoreNavigator */].getRouteNumberParam('title') ||\n                        singletons[\"J\" /* Translate */].instant('core.comments.comments');\n                    this.courseId = services_navigator[\"a\" /* CoreNavigator */].getRouteNumberParam('courseId');\n                }\n                catch (error) {\n                    dom[\"a\" /* CoreDomUtils */].showErrorModal(error);\n                    services_navigator[\"a\" /* CoreNavigator */].back();\n                    return;\n                }\n                // Is implicit the user can delete if he can add.\n                this.addDeleteCommentsAvailable = yield services_comments[\"a\" /* CoreComments */].isAddCommentsAvailable();\n                this.currentUserId = sites[\"b\" /* CoreSites */].getCurrentSiteUserId();\n                this.commentsLoaded = false;\n                yield this.fetchComments(true);\n            });\n        }\n        /**\n         * Fetches the comments.\n         *\n         * @param sync When to resync comments.\n         * @param showErrors When to display errors or not.\n         * @return Resolved when done.\n         */\n        fetchComments(sync, showErrors = false) {\n            return Object(tslib_es6[\"a\" /* __awaiter */])(this, void 0, void 0, function* () {\n                this.loadMoreError = false;\n                if (sync) {\n                    yield utils[\"a\" /* CoreUtils */].ignoreErrors(this.syncComments(showErrors));\n                }\n                try {\n                    // Get comments data.\n                    const commentsResponse = yield services_comments[\"a\" /* CoreComments */].getComments(this.contextLevel, this.instanceId, this.componentName, this.itemId, this.area, this.page);\n                    this.canAddComments = this.addDeleteCommentsAvailable && !!commentsResponse.canpost;\n                    let comments = commentsResponse.comments.sort((a, b) => a.timecreated - b.timecreated);\n                    if (commentsResponse.count !== undefined) {\n                        this.canLoadMore = (this.comments.length + comments.length) < commentsResponse.count;\n                    }\n                    else {\n                        // Old style.\n                        this.canLoadMore = commentsResponse.comments.length > 0 &&\n                            commentsResponse.comments.length >= services_comments[\"b\" /* CoreCommentsProvider */].pageSize;\n                    }\n                    comments = yield Promise.all(comments.map((comment) => this.loadCommentProfile(comment)));\n                    this.comments = comments.concat(this.comments);\n                    this.comments.forEach((comment, index) => {\n                        comment.showDate = this.showDate(comment, this.comments[index - 1]);\n                        comment.showUserData = this.showUserData(comment, this.comments[index - 1]);\n                        comment.showTail = this.showTail(comment, this.comments[index + 1]);\n                    });\n                    this.canDeleteComments = this.addDeleteCommentsAvailable &&\n                        (this.hasOffline || this.comments.some((comment) => !!comment.delete));\n                    yield this.loadOfflineData();\n                }\n                catch (error) {\n                    this.loadMoreError = true; // Set to prevent infinite calls with infinite-loading.\n                    if (error && this.componentName == 'assignsubmission_comments') {\n                        dom[\"a\" /* CoreDomUtils */].showAlertTranslated('core.notice', 'core.comments.commentsnotworking');\n                    }\n                    else {\n                        dom[\"a\" /* CoreDomUtils */].showErrorModalDefault(error, singletons[\"J\" /* Translate */].instant('core.error') + ': get_comments');\n                    }\n                }\n                finally {\n                    this.commentsLoaded = true;\n                    this.refreshIcon = constants[\"a\" /* CoreConstants */].ICON_REFRESH;\n                    this.syncIcon = constants[\"a\" /* CoreConstants */].ICON_SYNC;\n                    if (this.page == 0) {\n                        this.scrollToBottom();\n                    }\n                }\n            });\n        }\n        /**\n         * Function to load more commemts.\n         *\n         * @param infiniteComplete Infinite scroll complete function. Only used from core-infinite-loading.\n         * @return Resolved when done.\n         */\n        loadPrevious(infiniteComplete) {\n            return Object(tslib_es6[\"a\" /* __awaiter */])(this, void 0, void 0, function* () {\n                this.page++;\n                this.canLoadMore = false;\n                try {\n                    yield this.fetchComments(true);\n                }\n                finally {\n                    infiniteComplete && infiniteComplete();\n                }\n            });\n        }\n        /**\n         * Refresh the comments.\n         *\n         * @param showErrors Whether to display errors or not.\n         * @param refresher Refresher.\n         * @return Resolved when done.\n         */\n        refreshComments(showErrors, refresher) {\n            return Object(tslib_es6[\"a\" /* __awaiter */])(this, void 0, void 0, function* () {\n                this.commentsLoaded = false;\n                this.refreshIcon = constants[\"a\" /* CoreConstants */].ICON_LOADING;\n                this.syncIcon = constants[\"a\" /* CoreConstants */].ICON_LOADING;\n                try {\n                    yield this.invalidateComments();\n                }\n                finally {\n                    this.page = 0;\n                    this.comments = [];\n                    try {\n                        yield this.fetchComments(true, showErrors);\n                    }\n                    finally {\n                        refresher === null || refresher === void 0 ? void 0 : refresher.complete();\n                    }\n                }\n            });\n        }\n        /**\n         * Show sync warnings if any.\n         *\n         * @param warnings the warnings\n         */\n        showSyncWarnings(warnings) {\n            const message = utils_text[\"a\" /* CoreTextUtils */].buildMessage(warnings);\n            if (message) {\n                dom[\"a\" /* CoreDomUtils */].showErrorModal(message);\n            }\n        }\n        /**\n         * Tries to synchronize comments.\n         *\n         * @param showErrors Whether to display errors or not.\n         * @return Promise resolved if sync is successful, rejected otherwise.\n         */\n        syncComments(showErrors) {\n            return Object(tslib_es6[\"a\" /* __awaiter */])(this, void 0, void 0, function* () {\n                try {\n                    const result = yield comments_sync[\"a\" /* CoreCommentsSync */].syncComments(this.contextLevel, this.instanceId, this.componentName, this.itemId, this.area);\n                    this.showSyncWarnings((result === null || result === void 0 ? void 0 : result.warnings) || []);\n                }\n                catch (error) {\n                    if (showErrors) {\n                        dom[\"a\" /* CoreDomUtils */].showErrorModalDefault(error, 'core.errorsync', true);\n                    }\n                    throw new errors_error[\"a\" /* CoreError */](error);\n                }\n            });\n        }\n        /**\n         * Send the comment or store it offline.\n         *\n         * @param text Comment text to add.\n         */\n        addComment(text) {\n            return Object(tslib_es6[\"a\" /* __awaiter */])(this, void 0, void 0, function* () {\n                app[\"a\" /* CoreApp */].closeKeyboard();\n                const loadingModal = yield dom[\"a\" /* CoreDomUtils */].showModalLoading('core.sending', true);\n                // Freeze the add comment button.\n                this.sending = true;\n                try {\n                    const commentsResponse = yield services_comments[\"a\" /* CoreComments */].addComment(text, this.contextLevel, this.instanceId, this.componentName, this.itemId, this.area);\n                    dom[\"a\" /* CoreDomUtils */].showToast(commentsResponse ? 'core.comments.eventcommentcreated' : 'core.datastoredoffline', true, dom[\"c\" /* ToastDuration */].LONG);\n                    if (commentsResponse) {\n                        this.invalidateComments();\n                        const addedComments = yield this.loadCommentProfile(commentsResponse);\n                        addedComments.showDate = this.showDate(addedComments, this.comments[this.comments.length - 1]);\n                        addedComments.showUserData = this.showUserData(addedComments, this.comments[this.comments.length - 1]);\n                        addedComments.showTail = this.showTail(addedComments, this.comments[this.comments.length + 1]);\n                        // Add the comment to the top.\n                        this.comments = this.comments.concat([addedComments]);\n                        this.canDeleteComments = this.addDeleteCommentsAvailable;\n                        events[\"b\" /* CoreEvents */].trigger(services_comments[\"b\" /* CoreCommentsProvider */].COMMENTS_COUNT_CHANGED_EVENT, {\n                            contextLevel: this.contextLevel,\n                            instanceId: this.instanceId,\n                            component: this.componentName,\n                            itemId: this.itemId,\n                            area: this.area,\n                            countChange: 1,\n                        }, sites[\"b\" /* CoreSites */].getCurrentSiteId());\n                    }\n                    else if (commentsResponse === false) {\n                        // Comments added in offline mode.\n                        yield this.loadOfflineData();\n                    }\n                }\n                catch (error) {\n                    dom[\"a\" /* CoreDomUtils */].showErrorModal(error);\n                }\n                finally {\n                    loadingModal.dismiss();\n                    this.sending = false;\n                    // New comments.\n                    this.scrollToBottom();\n                }\n            });\n        }\n        /**\n         * Delete a comment.\n         *\n         * @param comment Comment to delete.\n         */\n        deleteComment(comment) {\n            return Object(tslib_es6[\"a\" /* __awaiter */])(this, void 0, void 0, function* () {\n                const modified = 'lastmodified' in comment\n                    ? comment.lastmodified\n                    : comment.timecreated;\n                const time = utils_time[\"a\" /* CoreTimeUtils */].userDate(modified * 1000, 'core.strftimerecentfull');\n                const deleteComment = {\n                    contextlevel: this.contextLevel,\n                    instanceid: this.instanceId,\n                    component: this.componentName,\n                    itemid: this.itemId,\n                    area: this.area,\n                    content: comment.content,\n                    id: 'id' in comment ? comment.id : undefined,\n                };\n                try {\n                    yield dom[\"a\" /* CoreDomUtils */].showDeleteConfirm('core.comments.deletecommentbyon', {\n                        $a: { user: comment.fullname || '', time: time },\n                    });\n                }\n                catch (_a) {\n                    // User cancelled, nothing to do.\n                    return;\n                }\n                try {\n                    const deletedOnline = yield services_comments[\"a\" /* CoreComments */].deleteComment(deleteComment);\n                    this.showDelete = false;\n                    if (deletedOnline && 'id' in comment) {\n                        const index = this.comments.findIndex((commentinList) => commentinList.id == comment.id);\n                        if (index >= 0) {\n                            this.comments.splice(index, 1);\n                            events[\"b\" /* CoreEvents */].trigger(services_comments[\"b\" /* CoreCommentsProvider */].COMMENTS_COUNT_CHANGED_EVENT, {\n                                contextLevel: this.contextLevel,\n                                instanceId: this.instanceId,\n                                component: this.componentName,\n                                itemId: this.itemId,\n                                area: this.area,\n                                countChange: -1,\n                            }, sites[\"b\" /* CoreSites */].getCurrentSiteId());\n                        }\n                    }\n                    else {\n                        this.loadOfflineData();\n                    }\n                    this.invalidateComments();\n                    dom[\"a\" /* CoreDomUtils */].showToast('core.comments.eventcommentdeleted', true, dom[\"c\" /* ToastDuration */].LONG);\n                }\n                catch (error) {\n                    dom[\"a\" /* CoreDomUtils */].showErrorModalDefault(error, 'Delete comment failed.');\n                }\n            });\n        }\n        /**\n         * Invalidate comments.\n         *\n         * @return Resolved when done.\n         */\n        invalidateComments() {\n            return services_comments[\"a\" /* CoreComments */].invalidateCommentsData(this.contextLevel, this.instanceId, this.componentName, this.itemId, this.area);\n        }\n        /**\n         * Loads the profile info onto the comment object.\n         *\n         * @param comment Comment object.\n         * @return Promise resolved with modified comment when done.\n         */\n        loadCommentProfile(comment) {\n            return Object(tslib_es6[\"a\" /* __awaiter */])(this, void 0, void 0, function* () {\n                // Get the user profile image.\n                try {\n                    const user = yield services_user[\"a\" /* CoreUser */].getProfile(comment.userid, undefined, true);\n                    comment.profileimageurl = user.profileimageurl;\n                    comment.fullname = user.fullname;\n                }\n                catch (_a) {\n                    // Ignore errors.\n                }\n                return comment;\n            });\n        }\n        /**\n         * Check if the user info should be displayed for the current message.\n         * User data is only displayed if the previous message was from another user.\n         *\n         * @param comment Comment object.\n         * @param prevComment Previous comment object.\n         * @return Whether user data should be shown.\n         */\n        showUserData(comment, prevComment) {\n            return comment.userid != this.currentUserId && (!prevComment || prevComment.userid != comment.userid || !!comment.showDate);\n        }\n        /**\n         * Check if a css tail should be shown.\n         *\n         * @param comment Comment object.\n         * @param nextComment Previous comment object.\n         * @return Whether user data should be shown.\n         */\n        showTail(comment, nextComment) {\n            return !nextComment || nextComment.userid != comment.userid || !!nextComment.showDate;\n        }\n        /**\n         * Check if the date should be displayed between messages (when the day changes at midnight for example).\n         *\n         * @param comment Comment object.\n         * @param prevComment Previous comment object.\n         * @return True if messages are from diferent days, false othetwise.\n         */\n        showDate(comment, prevComment) {\n            if (!prevComment) {\n                return true;\n            }\n            // Check if day has changed.\n            return !moment_timezone_default()(comment.timecreated * 1000).isSame(prevComment.timecreated * 1000, 'day');\n        }\n        /**\n         * Load offline comments.\n         *\n         * @return Promise resolved when done.\n         */\n        loadOfflineData() {\n            return Object(tslib_es6[\"a\" /* __awaiter */])(this, void 0, void 0, function* () {\n                const promises = [];\n                let hasDeletedComments = false;\n                // Load the only offline comment allowed if any.\n                promises.push(comments_offline[\"a\" /* CoreCommentsOffline */].getComment(this.contextLevel, this.instanceId, this.componentName, this.itemId, this.area).then((offlineComment) => Object(tslib_es6[\"a\" /* __awaiter */])(this, void 0, void 0, function* () {\n                    this.offlineComment = offlineComment;\n                    if (!this.offlineComment) {\n                        return;\n                    }\n                    if (this.newComment == '') {\n                        this.newComment = this.offlineComment.content;\n                    }\n                    this.offlineComment.userid = this.currentUserId;\n                    this.offlineComment.pending = true;\n                    return;\n                })));\n                // Load deleted comments offline.\n                promises.push(comments_offline[\"a\" /* CoreCommentsOffline */].getDeletedComments(this.contextLevel, this.instanceId, this.componentName, this.itemId, this.area).then((deletedComments) => {\n                    hasDeletedComments = deletedComments && deletedComments.length > 0;\n                    if (hasDeletedComments) {\n                        deletedComments.forEach((deletedComment) => {\n                            const comment = this.comments.find((comment) => comment.id == deletedComment.commentid);\n                            if (comment) {\n                                comment.deleted = !!deletedComment.deleted;\n                            }\n                        });\n                    }\n                    return;\n                }));\n                yield Promise.all(promises);\n                this.hasOffline = !!this.offlineComment || hasDeletedComments;\n            });\n        }\n        /**\n         * Restore a comment.\n         *\n         * @param comment Comment to delete.\n         */\n        undoDeleteComment(comment) {\n            return Object(tslib_es6[\"a\" /* __awaiter */])(this, void 0, void 0, function* () {\n                yield comments_offline[\"a\" /* CoreCommentsOffline */].undoDeleteComment(comment.id);\n                comment.deleted = false;\n                this.showDelete = false;\n            });\n        }\n        /**\n         * Scroll bottom when render has finished.\n         */\n        scrollToBottom() {\n            // Need a timeout to leave time to the view to be rendered.\n            setTimeout(() => {\n                var _a;\n                if (!this.viewDestroyed) {\n                    (_a = this.content) === null || _a === void 0 ? void 0 : _a.scrollToBottom();\n                }\n            }, 100);\n        }\n        /**\n         * Toggle delete.\n         */\n        toggleDelete() {\n            this.showDelete = !this.showDelete;\n        }\n        /**\n         * Page destroyed.\n         */\n        ngOnDestroy() {\n            var _a;\n            (_a = this.syncObserver) === null || _a === void 0 ? void 0 : _a.off();\n            this.onlineObserver.unsubscribe();\n            this.viewDestroyed = true;\n        }\n    }\n    CoreCommentsViewerPage.ɵfac = function CoreCommentsViewerPage_Factory(t) { return new (t || CoreCommentsViewerPage)(core[\"yc\" /* ɵɵdirectiveInject */](router[\"a\" /* ActivatedRoute */])); };\n    CoreCommentsViewerPage.ɵcmp = core[\"sc\" /* ɵɵdefineComponent */]({ type: CoreCommentsViewerPage, selectors: [[\"page-core-comments-viewer\"]], viewQuery: function CoreCommentsViewerPage_Query(rf, ctx) {\n            if (rf & 1) {\n                core[\"ud\" /* ɵɵviewQuery */](ionic_angular[\"v\" /* IonContent */], true);\n            }\n            if (rf & 2) {\n                var _t;\n                core[\"dd\" /* ɵɵqueryRefresh */](_t = core[\"Nc\" /* ɵɵloadQuery */]()) && (ctx.content = _t.first);\n            }\n        }, decls: 27, vars: 34, consts: [[\"slot\", \"start\"], [3, \"text\"], [3, \"text\", \"contextLevel\", \"contextInstanceId\", \"courseId\"], [\"slot\", \"end\"], [\"slot\", \"end\", \"fill\", \"clear\", 3, \"click\", 4, \"ngIf\"], [3, \"hidden\", \"priority\", \"content\", \"iconAction\", \"closeOnClick\", \"action\"], [\"slot\", \"fixed\", 3, \"disabled\", \"ionRefresh\"], [3, \"pullingText\"], [3, \"hideUntil\"], [\"icon\", \"fas-comments\", 3, \"message\", 4, \"ngIf\"], [\"position\", \"top\", 3, \"enabled\", \"error\", \"action\"], [1, \"addon-messages-discussion-container\"], [4, \"ngFor\", \"ngForOf\"], [\"class\", \"ion-text-wrap\", \"color\", \"info\", 4, \"ngIf\"], [3, \"message\", \"text\", \"user\", \"showDelete\", \"contextLevel\", \"instanceId\", \"courseId\", \"onDeleteMessage\", 4, \"ngIf\"], [\"class\", \"footer-adjustable\", 4, \"ngIf\"], [\"slot\", \"end\", \"fill\", \"clear\", 3, \"click\"], [\"name\", \"fas-pen\", \"slot\", \"icon-only\", \"aria-hidden\", \"true\"], [\"icon\", \"fas-comments\", 3, \"message\"], [\"class\", \"ion-text-center addon-messages-date\", 4, \"ngIf\"], [3, \"message\", \"text\", \"time\", \"user\", \"showDelete\", \"contextLevel\", \"instanceId\", \"courseId\", \"onDeleteMessage\", \"onUndoDeleteMessage\"], [1, \"ion-text-center\", \"addon-messages-date\"], [\"color\", \"info\", 1, \"ion-text-wrap\"], [\"name\", \"fas-exclamation-triangle\", \"aria-hidden\", \"true\"], [3, \"message\", \"text\", \"user\", \"showDelete\", \"contextLevel\", \"instanceId\", \"courseId\", \"onDeleteMessage\"], [1, \"footer-adjustable\"], [\"color\", \"contrast\"], [3, \"sendDisabled\", \"message\", \"placeholder\", \"onSubmit\"]], template: function CoreCommentsViewerPage_Template(rf, ctx) {\n            if (rf & 1) {\n                core[\"Ec\" /* ɵɵelementStart */](0, \"ion-header\");\n                core[\"Ec\" /* ɵɵelementStart */](1, \"ion-toolbar\");\n                core[\"Ec\" /* ɵɵelementStart */](2, \"ion-buttons\", 0);\n                core[\"zc\" /* ɵɵelement */](3, \"ion-back-button\", 1);\n                core[\"Pc\" /* ɵɵpipe */](4, \"translate\");\n                core[\"Dc\" /* ɵɵelementEnd */]();\n                core[\"Ec\" /* ɵɵelementStart */](5, \"ion-title\");\n                core[\"Ec\" /* ɵɵelementStart */](6, \"h1\");\n                core[\"zc\" /* ɵɵelement */](7, \"core-format-text\", 2);\n                core[\"Dc\" /* ɵɵelementEnd */]();\n                core[\"Dc\" /* ɵɵelementEnd */]();\n                core[\"Ec\" /* ɵɵelementStart */](8, \"ion-buttons\", 3);\n                core[\"nd\" /* ɵɵtemplate */](9, CoreCommentsViewerPage_ion_button_9_Template, 3, 3, \"ion-button\", 4);\n                core[\"Ec\" /* ɵɵelementStart */](10, \"core-context-menu\");\n                core[\"Ec\" /* ɵɵelementStart */](11, \"core-context-menu-item\", 5);\n                core[\"Mc\" /* ɵɵlistener */](\"action\", function CoreCommentsViewerPage_Template_core_context_menu_item_action_11_listener() { return ctx.refreshComments(false); });\n                core[\"Pc\" /* ɵɵpipe */](12, \"translate\");\n                core[\"Dc\" /* ɵɵelementEnd */]();\n                core[\"Ec\" /* ɵɵelementStart */](13, \"core-context-menu-item\", 5);\n                core[\"Mc\" /* ɵɵlistener */](\"action\", function CoreCommentsViewerPage_Template_core_context_menu_item_action_13_listener() { return ctx.refreshComments(true); });\n                core[\"Pc\" /* ɵɵpipe */](14, \"translate\");\n                core[\"Dc\" /* ɵɵelementEnd */]();\n                core[\"Dc\" /* ɵɵelementEnd */]();\n                core[\"Dc\" /* ɵɵelementEnd */]();\n                core[\"Dc\" /* ɵɵelementEnd */]();\n                core[\"Dc\" /* ɵɵelementEnd */]();\n                core[\"Ec\" /* ɵɵelementStart */](15, \"ion-content\");\n                core[\"Ec\" /* ɵɵelementStart */](16, \"ion-refresher\", 6);\n                core[\"Mc\" /* ɵɵlistener */](\"ionRefresh\", function CoreCommentsViewerPage_Template_ion_refresher_ionRefresh_16_listener($event) { return ctx.refreshComments(false, $event.target); });\n                core[\"zc\" /* ɵɵelement */](17, \"ion-refresher-content\", 7);\n                core[\"Pc\" /* ɵɵpipe */](18, \"translate\");\n                core[\"Dc\" /* ɵɵelementEnd */]();\n                core[\"Ec\" /* ɵɵelementStart */](19, \"core-loading\", 8);\n                core[\"nd\" /* ɵɵtemplate */](20, CoreCommentsViewerPage_core_empty_box_20_Template, 2, 3, \"core-empty-box\", 9);\n                core[\"Ec\" /* ɵɵelementStart */](21, \"core-infinite-loading\", 10);\n                core[\"Mc\" /* ɵɵlistener */](\"action\", function CoreCommentsViewerPage_Template_core_infinite_loading_action_21_listener($event) { return ctx.loadPrevious($event); });\n                core[\"Dc\" /* ɵɵelementEnd */]();\n                core[\"Ec\" /* ɵɵelementStart */](22, \"ion-list\", 11);\n                core[\"nd\" /* ɵɵtemplate */](23, CoreCommentsViewerPage_ng_container_23_Template, 3, 9, \"ng-container\", 12);\n                core[\"nd\" /* ɵɵtemplate */](24, CoreCommentsViewerPage_ion_badge_24_Template, 6, 10, \"ion-badge\", 13);\n                core[\"nd\" /* ɵɵtemplate */](25, CoreCommentsViewerPage_core_message_25_Template, 1, 7, \"core-message\", 14);\n                core[\"Dc\" /* ɵɵelementEnd */]();\n                core[\"Dc\" /* ɵɵelementEnd */]();\n                core[\"Dc\" /* ɵɵelementEnd */]();\n                core[\"nd\" /* ɵɵtemplate */](26, CoreCommentsViewerPage_ion_footer_26_Template, 4, 5, \"ion-footer\", 15);\n            }\n            if (rf & 2) {\n                core[\"lc\" /* ɵɵadvance */](3);\n                core[\"Vc\" /* ɵɵproperty */](\"text\", core[\"Qc\" /* ɵɵpipeBind1 */](4, 26, \"core.back\"));\n                core[\"lc\" /* ɵɵadvance */](4);\n                core[\"Vc\" /* ɵɵproperty */](\"text\", ctx.title)(\"contextLevel\", ctx.contextLevel)(\"contextInstanceId\", ctx.instanceId)(\"courseId\", ctx.courseId);\n                core[\"lc\" /* ɵɵadvance */](2);\n                core[\"Vc\" /* ɵɵproperty */](\"ngIf\", ctx.canDeleteComments);\n                core[\"lc\" /* ɵɵadvance */](2);\n                core[\"Vc\" /* ɵɵproperty */](\"hidden\", !(ctx.commentsLoaded && !ctx.hasOffline))(\"priority\", 100)(\"content\", core[\"Qc\" /* ɵɵpipeBind1 */](12, 28, \"core.refresh\"))(\"iconAction\", ctx.refreshIcon)(\"closeOnClick\", true);\n                core[\"lc\" /* ɵɵadvance */](2);\n                core[\"Vc\" /* ɵɵproperty */](\"hidden\", !(ctx.commentsLoaded && ctx.hasOffline && ctx.isOnline))(\"priority\", 100)(\"content\", core[\"Qc\" /* ɵɵpipeBind1 */](14, 30, \"core.settings.synchronizenow\"))(\"iconAction\", ctx.syncIcon)(\"closeOnClick\", false);\n                core[\"lc\" /* ɵɵadvance */](3);\n                core[\"Vc\" /* ɵɵproperty */](\"disabled\", !ctx.commentsLoaded);\n                core[\"lc\" /* ɵɵadvance */](1);\n                core[\"Wc\" /* ɵɵpropertyInterpolate */](\"pullingText\", core[\"Qc\" /* ɵɵpipeBind1 */](18, 32, \"core.pulltorefresh\"));\n                core[\"lc\" /* ɵɵadvance */](2);\n                core[\"Vc\" /* ɵɵproperty */](\"hideUntil\", ctx.commentsLoaded);\n                core[\"lc\" /* ɵɵadvance */](1);\n                core[\"Vc\" /* ɵɵproperty */](\"ngIf\", !(ctx.comments == null ? null : ctx.comments.length) && !ctx.offlineComment);\n                core[\"lc\" /* ɵɵadvance */](1);\n                core[\"Vc\" /* ɵɵproperty */](\"enabled\", ctx.canLoadMore)(\"error\", ctx.loadMoreError);\n                core[\"lc\" /* ɵɵadvance */](2);\n                core[\"Vc\" /* ɵɵproperty */](\"ngForOf\", ctx.comments);\n                core[\"lc\" /* ɵɵadvance */](1);\n                core[\"Vc\" /* ɵɵproperty */](\"ngIf\", ctx.hasOffline);\n                core[\"lc\" /* ɵɵadvance */](1);\n                core[\"Vc\" /* ɵɵproperty */](\"ngIf\", ctx.hasOffline && ctx.offlineComment);\n                core[\"lc\" /* ɵɵadvance */](1);\n                core[\"Vc\" /* ɵɵproperty */](\"ngIf\", ctx.commentsLoaded && ctx.canAddComments);\n            }\n        }, directives: [ionic_angular[\"C\" /* IonHeader */], ionic_angular[\"Ab\" /* IonToolbar */], ionic_angular[\"m\" /* IonButtons */], ionic_angular[\"h\" /* IonBackButton */], ionic_angular[\"i\" /* IonBackButtonDelegate */], ionic_angular[\"yb\" /* IonTitle */], format_text[\"a\" /* CoreFormatTextDirective */], common[\"t\" /* NgIf */], context_menu[\"a\" /* CoreContextMenuComponent */], context_menu_item[\"a\" /* CoreContextMenuItemComponent */], content[\"a\" /* CoreContentDirective */], ionic_angular[\"v\" /* IonContent */], ionic_angular[\"bb\" /* IonRefresher */], ionic_angular[\"cb\" /* IonRefresherContent */], loading[\"a\" /* CoreLoadingComponent */], infinite_loading[\"a\" /* CoreInfiniteLoadingComponent */], ionic_angular[\"P\" /* IonList */], common[\"s\" /* NgForOf */], update_non_reactive_attributes[\"a\" /* CoreUpdateNonReactiveAttributesDirective */], ionic_angular[\"l\" /* IonButton */], ionic_angular[\"D\" /* IonIcon */], fa_icon[\"a\" /* CoreFaIconDirective */], empty_box[\"a\" /* CoreEmptyBoxComponent */], message_message[\"a\" /* CoreMessageComponent */], ionic_angular[\"k\" /* IonBadge */], ionic_angular[\"A\" /* IonFooter */], send_message_form[\"a\" /* CoreSendMessageFormComponent */]], pipes: [ngx_translate_core[\"d\" /* TranslatePipe */], format_date[\"a\" /* CoreFormatDatePipe */], common[\"p\" /* LowerCasePipe */]], styles: [\".ios[_nghost-%COMP%]   ion-footer[_ngcontent-%COMP%]   .toolbar[_ngcontent-%COMP%]:last-child, .ios   [_nghost-%COMP%]   ion-footer[_ngcontent-%COMP%]   .toolbar[_ngcontent-%COMP%]:last-child{padding-bottom:4px;min-height:0}ion-content[_ngcontent-%COMP%]{--content-background:var(--background-alternative);--background:var(--content-background)}ion-content[_ngcontent-%COMP%]::part(scroll){padding-bottom:0!important}.addon-messages-discussion-container[_ngcontent-%COMP%]{display:flex;flex-direction:column;padding-bottom:16px!important;background:var(--content-background)}.addon-messages-date[_ngcontent-%COMP%]{font-weight:400;font-size:.9rem}ion-badge[_ngcontent-%COMP%]{margin:8px auto}\"], data: { animation: [animations[\"a\" /* CoreAnimations */].SLIDE_IN_OUT] } });\n    return CoreCommentsViewerPage;\n})();\n\n// CONCATENATED MODULE: ./src/core/features/comments/pages/viewer/viewer.module.ts\n// (C) Copyright 2015 Moodle Pty Ltd.\n//\n// Licensed under the Apache License, Version 2.0 (the \"License\");\n// you may not use this file except in compliance with the License.\n// You may obtain a copy of the License at\n//\n//     http://www.apache.org/licenses/LICENSE-2.0\n//\n// Unless required by applicable law or agreed to in writing, software\n// distributed under the License is distributed on an \"AS IS\" BASIS,\n// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n// See the License for the specific language governing permissions and\n// limitations under the License.\n\n\n\n\n\n\nconst routes = [\n    {\n        path: '',\n        component: viewer_page_CoreCommentsViewerPage,\n    },\n];\nlet viewer_module_CoreCommentsViewerPageModule = /*@__PURE__*/ (() => {\n    class CoreCommentsViewerPageModule {\n    }\n    CoreCommentsViewerPageModule.ɵmod = core[\"wc\" /* ɵɵdefineNgModule */]({ type: CoreCommentsViewerPageModule });\n    CoreCommentsViewerPageModule.ɵinj = core[\"vc\" /* ɵɵdefineInjector */]({ factory: function CoreCommentsViewerPageModule_Factory(t) { return new (t || CoreCommentsViewerPageModule)(); }, imports: [[\n                router[\"m\" /* RouterModule */].forChild(routes),\n                shared_module[\"a\" /* CoreSharedModule */],\n            ], router[\"m\" /* RouterModule */]] });\n    return CoreCommentsViewerPageModule;\n})();\n(function () { (typeof ngJitMode === \"undefined\" || ngJitMode) && core[\"kd\" /* ɵɵsetNgModuleScope */](viewer_module_CoreCommentsViewerPageModule, { declarations: [viewer_page_CoreCommentsViewerPage], imports: [router[\"m\" /* RouterModule */], shared_module[\"a\" /* CoreSharedModule */]], exports: [router[\"m\" /* RouterModule */]] }); })();\n\n\n/***/ })\n\n}]);","inputSourceMap":null}
(window.webpackJsonp=window.webpackJsonp||[]).push([[86],{"5z80":function(e,n,t){"use strict";t.r(n),t.d(n,"AddonNotificationsSettingsPageModule",(function(){return V}));var o=t("tyNb"),i=t("L3Fv"),c=t("mrSG"),_=t("BBqZ"),a=t("ANhT"),r=t("9+EE"),s=t("3LXp"),d=t("bFG1"),g=t("4pns"),l=t("c6ZJ"),p=t("BaYo"),f=t("93ts"),m=t("fjkH"),u=t("yjU1"),P=t("ssuw"),N=t("pHTc"),h=t("fXoL"),S=t("TEn/"),A=t("ACV2"),T=t("fQ68"),b=t("ofXK"),O=t("nt/U"),y=t("PgjG"),E=t("8/N+"),D=t("3Pt+"),v=t("rf3J"),w=t("3zv0"),M=t("sYmb");function AddonNotificationsSettingsPage_core_context_menu_item_12_Template(e,n){if(1&e){const e=h.Fc();h.Ec(0,"core-context-menu-item",12),h.Mc("action",(function AddonNotificationsSettingsPage_core_context_menu_item_12_Template_core_context_menu_item_action_0_listener(){h.fd(e);const t=n.$implicit;return h.Oc().openExtraPreferences(t)})),h.Pc(1,"translate"),h.Dc()}if(2&e){const e=n.$implicit;h.Vc("priority",e.priority)("content",h.Qc(1,3,e.label))("iconAction",e.icon)}}function AddonNotificationsSettingsPage_ion_item_19_Template(e,n){if(1&e){const e=h.Fc();h.Ec(0,"ion-item",13),h.Ec(1,"ion-label"),h.pd(2),h.Pc(3,"translate"),h.Dc(),h.Ec(4,"ion-toggle",14),h.Mc("ngModelChange",(function AddonNotificationsSettingsPage_ion_item_19_Template_ion_toggle_ngModelChange_4_listener(n){h.fd(e);return h.Oc().preferences.enableall=n}))("ngModelChange",(function AddonNotificationsSettingsPage_ion_item_19_Template_ion_toggle_ngModelChange_4_listener(){h.fd(e);const n=h.Oc();return n.enableAll(n.preferences.enableall)})),h.Dc(),h.Dc()}if(2&e){const e=h.Oc();h.lc(2),h.qd(h.Qc(3,2,"addon.notifications.notifications")),h.lc(2),h.Vc("ngModel",e.preferences.enableall)}}function AddonNotificationsSettingsPage_ion_item_20_Template(e,n){if(1&e){const e=h.Fc();h.Ec(0,"ion-item",13),h.Ec(1,"ion-label"),h.pd(2),h.Pc(3,"translate"),h.Dc(),h.Ec(4,"ion-toggle",14),h.Mc("ngModelChange",(function AddonNotificationsSettingsPage_ion_item_20_Template_ion_toggle_ngModelChange_4_listener(n){h.fd(e);return h.Oc().notificationSound=n}))("ngModelChange",(function AddonNotificationsSettingsPage_ion_item_20_Template_ion_toggle_ngModelChange_4_listener(){h.fd(e);const n=h.Oc();return n.changeNotificationSound(n.notificationSound)})),h.Dc(),h.Dc()}if(2&e){const e=h.Oc();h.lc(2),h.qd(h.Qc(3,2,"addon.notifications.playsound")),h.lc(2),h.Vc("ngModel",e.notificationSound)}}function AddonNotificationsSettingsPage_core_combobox_21_ion_select_option_1_Template(e,n){if(1&e&&(h.Ec(0,"ion-select-option",17),h.pd(1),h.Dc()),2&e){const e=n.$implicit;h.Vc("value",e.name),h.lc(1),h.rd(" ",e.displayname," ")}}function AddonNotificationsSettingsPage_core_combobox_21_Template(e,n){if(1&e){const e=h.Fc();h.Ec(0,"core-combobox",15),h.Mc("onChange",(function AddonNotificationsSettingsPage_core_combobox_21_Template_core_combobox_onChange_0_listener(n){h.fd(e);return h.Oc().changeProcessor(n)})),h.nd(1,AddonNotificationsSettingsPage_core_combobox_21_ion_select_option_1_Template,2,2,"ion-select-option",16),h.Dc()}if(2&e){const e=h.Oc();h.Vc("selection",e.currentProcessorName),h.lc(1),h.Vc("ngForOf",e.preferences.processors)}}function AddonNotificationsSettingsPage_ng_container_22_ng_container_1_Template(e,n){1&e&&h.Ac(0)}const _c0=function(e){return{preferences:e}};function AddonNotificationsSettingsPage_ng_container_22_Template(e,n){if(1&e&&(h.Cc(0),h.nd(1,AddonNotificationsSettingsPage_ng_container_22_ng_container_1_Template,1,0,"ng-container",18),h.Bc()),2&e){const e=h.Oc(),n=h.ed(25);h.lc(1),h.Vc("ngTemplateOutlet",n)("ngTemplateOutletContext",h.ad(2,_c0,e.preferences))}}function AddonNotificationsSettingsPage_ng_container_23_ng_container_1_Template(e,n){1&e&&h.Ac(0)}function AddonNotificationsSettingsPage_ng_container_23_Template(e,n){if(1&e&&(h.Cc(0),h.nd(1,AddonNotificationsSettingsPage_ng_container_23_ng_container_1_Template,1,0,"ng-container",18),h.Bc()),2&e){const e=h.Oc(),n=h.ed(27);h.lc(1),h.Vc("ngTemplateOutlet",n)("ngTemplateOutletContext",h.ad(2,_c0,e.preferences))}}function AddonNotificationsSettingsPage_ng_template_24_ion_card_0_ng_container_16_ion_col_7_ng_container_1_core_button_with_spinner_1_Template(e,n){if(1&e){const e=h.Fc();h.Ec(0,"core-button-with-spinner",35),h.Ec(1,"ion-toggle",14),h.Mc("ngModelChange",(function AddonNotificationsSettingsPage_ng_template_24_ion_card_0_ng_container_16_ion_col_7_ng_container_1_core_button_with_spinner_1_Template_ion_toggle_ngModelChange_1_listener(n){h.fd(e);const t=h.Oc(2).$implicit,o=h.Oc().$implicit,i=h.Oc(3);return o.processorsByName[i.currentProcessorName][t].checked=n}))("ngModelChange",(function AddonNotificationsSettingsPage_ng_template_24_ion_card_0_ng_container_16_ion_col_7_ng_container_1_core_button_with_spinner_1_Template_ion_toggle_ngModelChange_1_listener(){h.fd(e);const n=h.Oc(2).$implicit,t=h.Oc().$implicit;return h.Oc(3).changePreferenceLegacy(t,n)})),h.Dc(),h.Dc()}if(2&e){const e=h.Oc(2).$implicit,n=h.Oc().$implicit,t=h.Oc(3);h.Vc("loading",n.processorsByName[t.currentProcessorName][e].updating),h.lc(1),h.Vc("ngModel",n.processorsByName[t.currentProcessorName][e].checked)}}function AddonNotificationsSettingsPage_ng_template_24_ion_card_0_ng_container_16_ion_col_7_ng_container_1_span_2_Template(e,n){1&e&&(h.Ec(0,"span",36),h.pd(1),h.Pc(2,"translate"),h.Dc()),2&e&&(h.lc(1),h.rd(" ",h.Qc(2,1,"core.settings.forced")," "))}function AddonNotificationsSettingsPage_ng_template_24_ion_card_0_ng_container_16_ion_col_7_ng_container_1_span_3_Template(e,n){1&e&&(h.Ec(0,"span",36),h.pd(1),h.Pc(2,"translate"),h.Dc()),2&e&&(h.lc(1),h.rd(" ",h.Qc(2,1,"core.settings.disallowed")," "))}function AddonNotificationsSettingsPage_ng_template_24_ion_card_0_ng_container_16_ion_col_7_ng_container_1_Template(e,n){if(1&e&&(h.Cc(0),h.nd(1,AddonNotificationsSettingsPage_ng_template_24_ion_card_0_ng_container_16_ion_col_7_ng_container_1_core_button_with_spinner_1_Template,2,2,"core-button-with-spinner",34),h.nd(2,AddonNotificationsSettingsPage_ng_template_24_ion_card_0_ng_container_16_ion_col_7_ng_container_1_span_2_Template,3,3,"span",33),h.nd(3,AddonNotificationsSettingsPage_ng_template_24_ion_card_0_ng_container_16_ion_col_7_ng_container_1_span_3_Template,3,3,"span",33),h.Bc()),2&e){const e=h.Oc().$implicit,n=h.Oc().$implicit,t=h.Oc(3);h.lc(1),h.Vc("ngIf",!n.processorsByName[t.currentProcessorName].locked),h.lc(1),h.Vc("ngIf",n.processorsByName[t.currentProcessorName].locked&&n.processorsByName[t.currentProcessorName][e].checked),h.lc(1),h.Vc("ngIf",n.processorsByName[t.currentProcessorName].locked&&!n.processorsByName[t.currentProcessorName][e].checked)}}function AddonNotificationsSettingsPage_ng_template_24_ion_card_0_ng_container_16_ion_col_7_span_2_Template(e,n){1&e&&(h.Ec(0,"span",36),h.pd(1),h.Pc(2,"translate"),h.Dc()),2&e&&(h.lc(1),h.qd(h.Qc(2,1,"core.settings.disabled")))}function AddonNotificationsSettingsPage_ng_template_24_ion_card_0_ng_container_16_ion_col_7_Template(e,n){if(1&e&&(h.Ec(0,"ion-col",32),h.nd(1,AddonNotificationsSettingsPage_ng_template_24_ion_card_0_ng_container_16_ion_col_7_ng_container_1_Template,4,3,"ng-container",9),h.nd(2,AddonNotificationsSettingsPage_ng_template_24_ion_card_0_ng_container_16_ion_col_7_span_2_Template,3,3,"span",33),h.Dc()),2&e){const e=n.$implicit,t=h.Oc().$implicit,o=h.Oc(2).preferences,i=h.Oc();h.lc(1),h.Vc("ngIf",o.enableall&&t.processorsByName[i.currentProcessorName][e]),h.lc(1),h.Vc("ngIf",!o.enableall)}}function AddonNotificationsSettingsPage_ng_template_24_ion_card_0_ng_container_16_ion_item_11_div_5_core_button_with_spinner_1_ion_toggle_1_Template(e,n){if(1&e){const e=h.Fc();h.Ec(0,"ion-toggle",14),h.Mc("ngModelChange",(function AddonNotificationsSettingsPage_ng_template_24_ion_card_0_ng_container_16_ion_item_11_div_5_core_button_with_spinner_1_ion_toggle_1_Template_ion_toggle_ngModelChange_0_listener(n){h.fd(e);const t=h.Oc(3).$implicit,o=h.Oc().$implicit,i=h.Oc(3);return o.processorsByName[i.currentProcessorName][t].checked=n}))("ngModelChange",(function AddonNotificationsSettingsPage_ng_template_24_ion_card_0_ng_container_16_ion_item_11_div_5_core_button_with_spinner_1_ion_toggle_1_Template_ion_toggle_ngModelChange_0_listener(){h.fd(e);const n=h.Oc(3).$implicit,t=h.Oc().$implicit;return h.Oc(3).changePreferenceLegacy(t,n)})),h.Dc()}if(2&e){const e=h.Oc(3).$implicit,n=h.Oc().$implicit,t=h.Oc(3);h.Vc("ngModel",n.processorsByName[t.currentProcessorName][e].checked)}}function AddonNotificationsSettingsPage_ng_template_24_ion_card_0_ng_container_16_ion_item_11_div_5_core_button_with_spinner_1_Template(e,n){if(1&e&&(h.Ec(0,"core-button-with-spinner",35),h.nd(1,AddonNotificationsSettingsPage_ng_template_24_ion_card_0_ng_container_16_ion_item_11_div_5_core_button_with_spinner_1_ion_toggle_1_Template,1,1,"ion-toggle",41),h.Dc()),2&e){const e=h.Oc(2).$implicit,n=h.Oc().$implicit,t=h.Oc(3);h.Vc("loading",n.processorsByName[t.currentProcessorName][e].updating),h.lc(1),h.Vc("ngIf",!n.processorsByName[t.currentProcessorName].locked)}}function AddonNotificationsSettingsPage_ng_template_24_ion_card_0_ng_container_16_ion_item_11_div_5_span_2_Template(e,n){1&e&&(h.Ec(0,"span",36),h.pd(1),h.Pc(2,"translate"),h.Dc()),2&e&&(h.lc(1),h.rd(" ",h.Qc(2,1,"core.settings.forced")," "))}function AddonNotificationsSettingsPage_ng_template_24_ion_card_0_ng_container_16_ion_item_11_div_5_span_3_Template(e,n){1&e&&(h.Ec(0,"span",36),h.pd(1),h.Pc(2,"translate"),h.Dc()),2&e&&(h.lc(1),h.rd(" ",h.Qc(2,1,"core.settings.disallowed")," "))}function AddonNotificationsSettingsPage_ng_template_24_ion_card_0_ng_container_16_ion_item_11_div_5_Template(e,n){if(1&e&&(h.Ec(0,"div",2),h.nd(1,AddonNotificationsSettingsPage_ng_template_24_ion_card_0_ng_container_16_ion_item_11_div_5_core_button_with_spinner_1_Template,2,2,"core-button-with-spinner",34),h.nd(2,AddonNotificationsSettingsPage_ng_template_24_ion_card_0_ng_container_16_ion_item_11_div_5_span_2_Template,3,3,"span",33),h.nd(3,AddonNotificationsSettingsPage_ng_template_24_ion_card_0_ng_container_16_ion_item_11_div_5_span_3_Template,3,3,"span",33),h.Dc()),2&e){const e=h.Oc().$implicit,n=h.Oc().$implicit,t=h.Oc(3);h.lc(1),h.Vc("ngIf",!n.processorsByName[t.currentProcessorName].locked),h.lc(1),h.Vc("ngIf",n.processorsByName[t.currentProcessorName].locked&&n.processorsByName[t.currentProcessorName][e].checked),h.lc(1),h.Vc("ngIf",n.processorsByName[t.currentProcessorName].locked&&!n.processorsByName[t.currentProcessorName][e].checked)}}function AddonNotificationsSettingsPage_ng_template_24_ion_card_0_ng_container_16_ion_item_11_span_6_Template(e,n){1&e&&(h.Ec(0,"span",42),h.pd(1),h.Pc(2,"translate"),h.Dc()),2&e&&(h.lc(1),h.qd(h.Qc(2,1,"core.settings.disabled")))}function AddonNotificationsSettingsPage_ng_template_24_ion_card_0_ng_container_16_ion_item_11_Template(e,n){if(1&e&&(h.Ec(0,"ion-item",37),h.Ec(1,"ion-label",38),h.Ec(2,"p"),h.pd(3),h.Pc(4,"translate"),h.Dc(),h.Dc(),h.nd(5,AddonNotificationsSettingsPage_ng_template_24_ion_card_0_ng_container_16_ion_item_11_div_5_Template,4,3,"div",39),h.nd(6,AddonNotificationsSettingsPage_ng_template_24_ion_card_0_ng_container_16_ion_item_11_span_6_Template,3,3,"span",40),h.Dc()),2&e){const e=n.$implicit,t=h.Oc().$implicit,o=h.Oc(2).preferences,i=h.Oc();h.lc(3),h.qd(h.Qc(4,3,"core.settings."+e)),h.lc(2),h.Vc("ngIf",o.enableall&&t.processorsByName[i.currentProcessorName][e]),h.lc(1),h.Vc("ngIf",!o.enableall)}}const _c1=function(){return["loggedin","loggedoff"]};function AddonNotificationsSettingsPage_ng_template_24_ion_card_0_ng_container_16_Template(e,n){if(1&e&&(h.Cc(0),h.Ec(1,"ion-item",26),h.Ec(2,"ion-label"),h.Ec(3,"ion-row",27),h.Ec(4,"ion-col",28),h.Ec(5,"p",23),h.pd(6),h.Dc(),h.Dc(),h.nd(7,AddonNotificationsSettingsPage_ng_template_24_ion_card_0_ng_container_16_ion_col_7_Template,3,2,"ion-col",29),h.Dc(),h.Dc(),h.Dc(),h.Ec(8,"ion-item",30),h.Ec(9,"p",23),h.pd(10),h.Dc(),h.Dc(),h.nd(11,AddonNotificationsSettingsPage_ng_template_24_ion_card_0_ng_container_16_ion_item_11_Template,7,5,"ion-item",31),h.Bc()),2&e){const e=n.$implicit;h.lc(6),h.qd(e.displayname),h.lc(1),h.Vc("ngForOf",h.Zc(4,_c1)),h.lc(3),h.qd(e.displayname),h.lc(1),h.Vc("ngForOf",h.Zc(5,_c1))}}function AddonNotificationsSettingsPage_ng_template_24_ion_card_0_Template(e,n){if(1&e&&(h.Ec(0,"ion-card",20),h.Ec(1,"ion-card-header",21),h.Ec(2,"ion-item",22),h.Ec(3,"ion-label",13),h.Ec(4,"ion-row",21),h.Ec(5,"ion-col",21),h.Ec(6,"p",23),h.pd(7),h.Dc(),h.Dc(),h.Ec(8,"ion-col",24),h.Ec(9,"p"),h.pd(10),h.Pc(11,"translate"),h.Dc(),h.Dc(),h.Ec(12,"ion-col",24),h.Ec(13,"p"),h.pd(14),h.Pc(15,"translate"),h.Dc(),h.Dc(),h.Dc(),h.Dc(),h.Dc(),h.Dc(),h.nd(16,AddonNotificationsSettingsPage_ng_template_24_ion_card_0_ng_container_16_Template,12,6,"ng-container",25),h.Dc()),2&e){const e=n.$implicit;h.lc(7),h.qd(e.displayname),h.lc(3),h.qd(h.Qc(11,4,"core.settings.loggedin")),h.lc(4),h.qd(h.Qc(15,6,"core.settings.loggedoff")),h.lc(2),h.Vc("ngForOf",e.notifications)}}function AddonNotificationsSettingsPage_ng_template_24_Template(e,n){if(1&e&&h.nd(0,AddonNotificationsSettingsPage_ng_template_24_ion_card_0_Template,17,8,"ion-card",19),2&e){const e=h.Oc();h.Vc("ngForOf",e.components)}}function AddonNotificationsSettingsPage_ng_template_26_ion_card_0_ng_container_5_div_5_core_button_with_spinner_1_ion_toggle_1_Template(e,n){if(1&e){const e=h.Fc();h.Ec(0,"ion-toggle",14),h.Mc("ngModelChange",(function AddonNotificationsSettingsPage_ng_template_26_ion_card_0_ng_container_5_div_5_core_button_with_spinner_1_ion_toggle_1_Template_ion_toggle_ngModelChange_0_listener(n){h.fd(e);const t=h.Oc(3).$implicit,o=h.Oc(3);return t.processorsByName[o.currentProcessorName].enabled=n}))("ngModelChange",(function AddonNotificationsSettingsPage_ng_template_26_ion_card_0_ng_container_5_div_5_core_button_with_spinner_1_ion_toggle_1_Template_ion_toggle_ngModelChange_0_listener(){h.fd(e);const n=h.Oc(3).$implicit;return h.Oc(3).changePreference(n)})),h.Dc()}if(2&e){const e=h.Oc(3).$implicit,n=h.Oc(3);h.Vc("ngModel",e.processorsByName[n.currentProcessorName].enabled)}}function AddonNotificationsSettingsPage_ng_template_26_ion_card_0_ng_container_5_div_5_core_button_with_spinner_1_Template(e,n){if(1&e&&(h.Ec(0,"core-button-with-spinner",35),h.nd(1,AddonNotificationsSettingsPage_ng_template_26_ion_card_0_ng_container_5_div_5_core_button_with_spinner_1_ion_toggle_1_Template,1,1,"ion-toggle",41),h.Dc()),2&e){const e=h.Oc(2).$implicit,n=h.Oc(3);h.Vc("loading",e.processorsByName[n.currentProcessorName].updating),h.lc(1),h.Vc("ngIf",!e.processorsByName[n.currentProcessorName].locked)}}function AddonNotificationsSettingsPage_ng_template_26_ion_card_0_ng_container_5_div_5_span_2_Template(e,n){1&e&&(h.Ec(0,"span",36),h.pd(1),h.Pc(2,"translate"),h.Dc()),2&e&&(h.lc(1),h.rd(" ",h.Qc(2,1,"core.settings.forced")," "))}function AddonNotificationsSettingsPage_ng_template_26_ion_card_0_ng_container_5_div_5_span_3_Template(e,n){1&e&&(h.Ec(0,"span",36),h.pd(1),h.Pc(2,"translate"),h.Dc()),2&e&&(h.lc(1),h.rd(" ",h.Qc(2,1,"core.settings.disallowed")," "))}function AddonNotificationsSettingsPage_ng_template_26_ion_card_0_ng_container_5_div_5_Template(e,n){if(1&e&&(h.Ec(0,"div",2),h.nd(1,AddonNotificationsSettingsPage_ng_template_26_ion_card_0_ng_container_5_div_5_core_button_with_spinner_1_Template,2,2,"core-button-with-spinner",34),h.nd(2,AddonNotificationsSettingsPage_ng_template_26_ion_card_0_ng_container_5_div_5_span_2_Template,3,3,"span",33),h.nd(3,AddonNotificationsSettingsPage_ng_template_26_ion_card_0_ng_container_5_div_5_span_3_Template,3,3,"span",33),h.Dc()),2&e){const e=h.Oc().$implicit,n=h.Oc(3);h.lc(1),h.Vc("ngIf",!e.processorsByName[n.currentProcessorName].locked),h.lc(1),h.Vc("ngIf",e.processorsByName[n.currentProcessorName].locked&&e.processorsByName[n.currentProcessorName].enabled),h.lc(1),h.Vc("ngIf",e.processorsByName[n.currentProcessorName].locked&&!e.processorsByName[n.currentProcessorName].enabled)}}function AddonNotificationsSettingsPage_ng_template_26_ion_card_0_ng_container_5_span_6_Template(e,n){1&e&&(h.Ec(0,"span",42),h.pd(1),h.Pc(2,"translate"),h.Dc()),2&e&&(h.lc(1),h.qd(h.Qc(2,1,"core.settings.disabled")))}function AddonNotificationsSettingsPage_ng_template_26_ion_card_0_ng_container_5_Template(e,n){if(1&e&&(h.Cc(0),h.Ec(1,"ion-item",13),h.Ec(2,"ion-label"),h.Ec(3,"p"),h.pd(4),h.Dc(),h.Dc(),h.nd(5,AddonNotificationsSettingsPage_ng_template_26_ion_card_0_ng_container_5_div_5_Template,4,3,"div",39),h.nd(6,AddonNotificationsSettingsPage_ng_template_26_ion_card_0_ng_container_5_span_6_Template,3,3,"span",40),h.Dc(),h.Bc()),2&e){const e=n.$implicit,t=h.Oc(2).preferences;h.lc(4),h.qd(e.displayname),h.lc(1),h.Vc("ngIf",t.enableall),h.lc(1),h.Vc("ngIf",!t.enableall)}}function AddonNotificationsSettingsPage_ng_template_26_ion_card_0_Template(e,n){if(1&e&&(h.Ec(0,"ion-card",20),h.Ec(1,"ion-item-divider",13),h.Ec(2,"ion-label"),h.Ec(3,"p",23),h.pd(4),h.Dc(),h.Dc(),h.Dc(),h.nd(5,AddonNotificationsSettingsPage_ng_template_26_ion_card_0_ng_container_5_Template,7,3,"ng-container",25),h.Dc()),2&e){const e=n.$implicit;h.lc(4),h.qd(e.displayname),h.lc(1),h.Vc("ngForOf",e.notifications)}}function AddonNotificationsSettingsPage_ng_template_26_Template(e,n){if(1&e&&h.nd(0,AddonNotificationsSettingsPage_ng_template_26_ion_card_0_Template,6,2,"ion-card",19),2&e){const e=h.Oc();h.Vc("ngForOf",e.components)}}let C=(()=>{class AddonNotificationsSettingsPage{constructor(){this.currentProcessorName="airnotifier",this.preferencesLoaded=!1,this.notificationSound=!1,this.processorHandlers=[],this.loggedInOffLegacyMode=!1,this.canChangeSound=a.a.canDisableSound();const e=r.b.getRequiredCurrentSite();this.loggedInOffLegacyMode=!e.isVersionGreaterEqualThan("4.0")}ngOnInit(){return Object(c.a)(this,void 0,void 0,(function*(){this.canChangeSound&&(this.notificationSound=yield _.a.get(p.a.SETTINGS_NOTIFICATION_SOUND,!0)),this.fetchPreferences()}))}fetchPreferences(){return Object(c.a)(this,void 0,void 0,(function*(){try{const e=yield u.a.getNotificationPreferences();let n=e.processors.find((e=>e.name==this.currentProcessorName));if(n||(n=e.processors[0]),!n)throw new f.a("No processor found");e.enableall=!e.disableall,this.preferences=P.a.formatPreferences(e),this.loadProcessor(n)}catch(e){s.a.showErrorModal(e)}finally{this.preferencesLoaded=!0}}))}loadProcessor(e){var n;if(!e)return;if(this.currentProcessorName=e.name,this.processorHandlers=[],this.components=P.a.getProcessorComponents(e.name,(null===(n=this.preferences)||void 0===n?void 0:n.components)||[]),!e.hassettings||!e.supported)return;const t=l.a.getDisplayData(e);t&&this.processorHandlers.push(t)}updatePreferencesAfterDelay(){clearTimeout(this.updateTimeout),this.updateTimeout=window.setTimeout((()=>{this.updateTimeout=void 0,this.updatePreferences()}),5e3)}updatePreferences(){return Object(c.a)(this,void 0,void 0,(function*(){yield d.a.ignoreErrors(u.a.invalidateNotificationPreferences()),yield u.a.getNotificationPreferences()}))}changeProcessor(e){var n;const t=null===(n=this.preferences)||void 0===n?void 0:n.processors.find((n=>n.name==e));t&&this.loadProcessor(t)}refreshPreferences(e){return Object(c.a)(this,void 0,void 0,(function*(){try{yield d.a.ignoreErrors(u.a.invalidateNotificationPreferences()),yield this.fetchPreferences()}finally{null==e?void 0:e.complete()}}))}openExtraPreferences(e){N.a.navigateToSitePath(e.page,{params:e.pageParams})}changePreferenceLegacy(e,n){var t;return Object(c.a)(this,void 0,void 0,(function*(){const o=null===(t=e.processorsByName)||void 0===t?void 0:t[this.currentProcessorName];if(!o)return;const i=o[n],c=e.preferencekey+"_"+i.name;let _=e.processors.filter((e=>e[n].checked)).map((e=>e.name)).join(",");""==_&&(_="none"),i.updating=!0;try{yield g.a.updateUserPreference(c,_),this.updatePreferencesAfterDelay()}catch(e){s.a.showErrorModal(e),o[n].checked=!o[n].checked}finally{i.updating=!1}}))}changePreference(e){var n;return Object(c.a)(this,void 0,void 0,(function*(){const t=null===(n=e.processorsByName)||void 0===n?void 0:n[this.currentProcessorName];if(!t)return;const o=e.preferencekey+"_enabled";let i=e.processors.filter((e=>e.enabled)).map((e=>e.name)).join(",");""==i&&(i="none"),t.updating=!0;try{yield g.a.updateUserPreference(o,i),this.updatePreferencesAfterDelay()}catch(e){s.a.showErrorModal(e),t.enabled=!t.enabled}finally{t.updating=!1}}))}enableAll(e){return Object(c.a)(this,void 0,void 0,(function*(){if(!this.preferences)return;const n=yield s.a.showModalLoading("core.sending",!0);try{g.a.updateUserPreferences([],!e),this.updatePreferencesAfterDelay()}catch(e){s.a.showErrorModal(e),this.preferences.enableall=!this.preferences.enableall}finally{n.dismiss()}}))}changeNotificationSound(e){return Object(c.a)(this,void 0,void 0,(function*(){yield d.a.ignoreErrors(_.a.set(p.a.SETTINGS_NOTIFICATION_SOUND,e?1:0));const n=r.b.getCurrentSiteId();m.b.trigger(m.b.NOTIFICATION_SOUND_CHANGED,{enabled:e},n),a.a.rescheduleAll()}))}ngOnDestroy(){this.updateTimeout&&(clearTimeout(this.updateTimeout),this.updatePreferences())}}return AddonNotificationsSettingsPage.ɵfac=function AddonNotificationsSettingsPage_Factory(e){return new(e||AddonNotificationsSettingsPage)},AddonNotificationsSettingsPage.ɵcmp=h.sc({type:AddonNotificationsSettingsPage,selectors:[["page-addon-notifications-settings"]],decls:28,vars:17,consts:[["slot","start"],[3,"text"],["slot","end"],[3,"priority","content","iconAction","action",4,"ngFor","ngForOf"],["slot","fixed",3,"disabled","ionRefresh"],[3,"pullingText"],[3,"hideUntil"],["class","ion-text-wrap",4,"ngIf"],[3,"selection","onChange",4,"ngIf"],[4,"ngIf"],["legacySettings",""],["settings",""],[3,"priority","content","iconAction","action"],[1,"ion-text-wrap"],[3,"ngModel","ngModelChange"],[3,"selection","onChange"],["class","ion-text-wrap",3,"value",4,"ngFor","ngForOf"],[1,"ion-text-wrap",3,"value"],[4,"ngTemplateOutlet","ngTemplateOutletContext"],["class","ion-margin-top",4,"ngFor","ngForOf"],[1,"ion-margin-top"],[1,"ion-no-padding"],[1,"ion-text-wrap","divider"],[1,"item-heading"],["size","2",1,"ion-text-center","ion-no-padding","ion-hide-md-down"],[4,"ngFor","ngForOf"],[1,"ion-text-wrap","ion-hide-md-down","addon-notifications-table-content","only-links"],[1,"ion-no-padding","ion-align-items-center"],[1,"ion-margin-horizontal","ion-no-padding"],["size","2","class","ion-text-center ion-no-padding",4,"ngFor","ngForOf"],[1,"ion-text-wrap","ion-no-margin","ion-hide-md-up"],["class","ion-text-wrap ion-hide-md-up",4,"ngFor","ngForOf"],["size","2",1,"ion-text-center","ion-no-padding"],["class","text-gray",4,"ngIf"],[3,"loading",4,"ngIf"],[3,"loading"],[1,"text-gray"],[1,"ion-text-wrap","ion-hide-md-up"],[1,"ion-margin-horizontal"],["slot","end",4,"ngIf"],["class","text-gray","slot","end",4,"ngIf"],[3,"ngModel","ngModelChange",4,"ngIf"],["slot","end",1,"text-gray"]],template:function AddonNotificationsSettingsPage_Template(e,n){1&e&&(h.Ec(0,"ion-header"),h.Ec(1,"ion-toolbar"),h.Ec(2,"ion-buttons",0),h.zc(3,"ion-back-button",1),h.Pc(4,"translate"),h.Dc(),h.Ec(5,"ion-title"),h.Ec(6,"h1"),h.pd(7),h.Pc(8,"translate"),h.Dc(),h.Dc(),h.zc(9,"ion-buttons",2),h.Dc(),h.Dc(),h.Ec(10,"core-navbar-buttons",2),h.Ec(11,"core-context-menu"),h.nd(12,AddonNotificationsSettingsPage_core_context_menu_item_12_Template,2,5,"core-context-menu-item",3),h.Dc(),h.Dc(),h.Ec(13,"ion-content"),h.Ec(14,"ion-refresher",4),h.Mc("ionRefresh",(function AddonNotificationsSettingsPage_Template_ion_refresher_ionRefresh_14_listener(e){return n.refreshPreferences(e.target)})),h.zc(15,"ion-refresher-content",5),h.Pc(16,"translate"),h.Dc(),h.Ec(17,"core-loading",6),h.Ec(18,"ion-card"),h.nd(19,AddonNotificationsSettingsPage_ion_item_19_Template,5,4,"ion-item",7),h.nd(20,AddonNotificationsSettingsPage_ion_item_20_Template,5,4,"ion-item",7),h.Dc(),h.nd(21,AddonNotificationsSettingsPage_core_combobox_21_Template,2,2,"core-combobox",8),h.nd(22,AddonNotificationsSettingsPage_ng_container_22_Template,2,4,"ng-container",9),h.nd(23,AddonNotificationsSettingsPage_ng_container_23_Template,2,4,"ng-container",9),h.Dc(),h.Dc(),h.nd(24,AddonNotificationsSettingsPage_ng_template_24_Template,1,1,"ng-template",null,10,h.od),h.nd(26,AddonNotificationsSettingsPage_ng_template_26_Template,1,1,"ng-template",null,11,h.od)),2&e&&(h.lc(3),h.Vc("text",h.Qc(4,11,"core.back")),h.lc(4),h.qd(h.Qc(8,13,"addon.notifications.notifications")),h.lc(5),h.Vc("ngForOf",n.processorHandlers),h.lc(2),h.Vc("disabled",!n.preferencesLoaded),h.lc(1),h.Wc("pullingText",h.Qc(16,15,"core.pulltorefresh")),h.lc(2),h.Vc("hideUntil",n.preferencesLoaded),h.lc(2),h.Vc("ngIf",n.preferences),h.lc(1),h.Vc("ngIf",n.canChangeSound),h.lc(1),h.Vc("ngIf",n.preferences&&n.preferences.processors&&n.preferences.processors.length>0),h.lc(1),h.Vc("ngIf",n.loggedInOffLegacyMode),h.lc(1),h.Vc("ngIf",!n.loggedInOffLegacyMode))},directives:[S.C,S.Ab,S.m,S.h,S.i,S.yb,A.a,T.a,b.s,O.a,S.v,S.bb,S.cb,y.a,S.n,b.t,E.a,S.I,S.O,S.zb,S.d,D.r,D.u,v.a,S.mb,b.A,S.p,S.hb,S.u,w.a,S.J],pipes:[M.d],styles:[".addon-notifications-table-content[_ngcontent-%COMP%]   ion-row[_ngcontent-%COMP%]{min-height:35px}"]}),AddonNotificationsSettingsPage})();const I=[{path:"",component:C}];let V=(()=>{class AddonNotificationsSettingsPageModule{}return AddonNotificationsSettingsPageModule.ɵmod=h.wc({type:AddonNotificationsSettingsPageModule}),AddonNotificationsSettingsPageModule.ɵinj=h.vc({factory:function AddonNotificationsSettingsPageModule_Factory(e){return new(e||AddonNotificationsSettingsPageModule)},imports:[[o.m.forChild(I),i.a],o.m]}),AddonNotificationsSettingsPageModule})();void(("undefined"==typeof ngJitMode||ngJitMode)&&h.kd(V,{declarations:[C],imports:[o.m,i.a],exports:[o.m]}))}}]);
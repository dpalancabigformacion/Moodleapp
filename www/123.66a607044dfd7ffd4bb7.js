(window.webpackJsonp=window.webpackJsonp||[]).push([[123],{"1evO":function(e,t,a){"use strict";a.r(t),a.d(t,"CoreTagIndexAreaPageModule",(function(){return y}));var o=a("tyNb"),r=a("L3Fv"),n=a("mrSG"),i=a("3LXp"),c=a("kWmn"),s=a("J82s"),d=a("j3ag"),l=a("pHTc"),h=a("fXoL"),g=a("TEn/"),m=a("nt/U"),u=a("PgjG"),p=a("w+Pn"),I=a("xpMl"),f=a("sYmb");const _c0=function(e,t){return{tagarea:e,tag:t}},_c1=function(e){return{$a:e}},_c2=function(e){return{items:e}};let x=(()=>{class CoreTagIndexAreaPage{constructor(e){this.route=e,this.tagId=0,this.tagName="",this.collectionId=0,this.areaId=0,this.fromContextId=0,this.contextId=0,this.recursive=!0,this.areaNameKey="",this.loaded=!1,this.items=[],this.nextPage=0,this.canLoadMore=!1,this.loadMoreError=!1}ngOnInit(){return Object(n.a)(this,void 0,void 0,(function*(){this.route.queryParams.subscribe((()=>Object(n.a)(this,void 0,void 0,(function*(){var e;this.loaded=!1,this.tagId=l.a.getRouteNumberParam("tagId")||this.tagId,this.tagName=l.a.getRouteParam("tagName")||this.tagName,this.collectionId=l.a.getRouteNumberParam("collectionId")||this.collectionId,this.areaId=l.a.getRouteNumberParam("areaId")||this.areaId,this.fromContextId=l.a.getRouteNumberParam("fromContextId")||this.fromContextId,this.contextId=l.a.getRouteNumberParam("contextId")||this.contextId,this.recursive=null===(e=l.a.getRouteBooleanParam("recursive"))||void 0===e||e,this.areaNameKey=l.a.getRouteParam("areaNameKey")||"",this.componentName=l.a.getRouteParam("componentName"),this.itemType=l.a.getRouteParam("itemType"),this.items=l.a.getRouteParam("items")||[],this.nextPage=l.a.getRouteNumberParam("nextPage")||0,this.canLoadMore=l.a.getRouteBooleanParam("canLoadMore")||!1;try{this.componentName&&this.itemType&&this.items.length&&0!=this.nextPage||(yield this.fetchData(!0)),this.areaComponent=yield s.a.getComponent(this.componentName,this.itemType)}finally{this.loaded=!0}}))))}))}fetchData(e=!1){return Object(n.a)(this,void 0,void 0,(function*(){this.loadMoreError=!1;const t=e?0:this.nextPage;try{const e=(yield c.a.getTagIndexPerArea(this.tagId,this.tagName,this.collectionId,this.areaId,this.fromContextId,this.contextId,this.recursive,t))[0],a=yield s.a.parseContent(e.component,e.itemtype,e.content);if(!a||!a.length)throw d.J.instant("core.tag.errorareanotsupported");0==t?this.items=a:this.items.push(...a),this.componentName=e.component,this.itemType=e.itemtype,this.areaNameKey=s.a.getDisplayNameKey(e.component,e.itemtype),this.canLoadMore=!!e.nextpageurl,this.nextPage=t+1}catch(e){this.loadMoreError=!0,i.a.showErrorModalDefault(e,"Error loading tag index")}}))}loadMore(e){return Object(n.a)(this,void 0,void 0,(function*(){try{yield this.fetchData()}finally{null==e?void 0:e()}}))}refreshData(e){return Object(n.a)(this,void 0,void 0,(function*(){try{yield c.a.invalidateTagIndexPerArea(this.tagId,this.tagName,this.collectionId,this.areaId,this.fromContextId,this.contextId,this.recursive)}finally{try{yield this.fetchData(!0)}finally{null==e?void 0:e.complete()}}}))}}return CoreTagIndexAreaPage.ɵfac=function CoreTagIndexAreaPage_Factory(e){return new(e||CoreTagIndexAreaPage)(h.yc(o.a))},CoreTagIndexAreaPage.ɵcmp=h.sc({type:CoreTagIndexAreaPage,selectors:[["page-core-tag-index-area"]],decls:17,vars:25,consts:[["slot","start"],[3,"text"],[1,"limited-width"],["slot","fixed",3,"disabled","ionRefresh"],[3,"pullingText"],[3,"hideUntil"],[3,"component","data"],[3,"enabled","error","action"]],template:function CoreTagIndexAreaPage_Template(e,t){1&e&&(h.Ec(0,"ion-header"),h.Ec(1,"ion-toolbar"),h.Ec(2,"ion-buttons",0),h.zc(3,"ion-back-button",1),h.Pc(4,"translate"),h.Dc(),h.Ec(5,"ion-title"),h.Ec(6,"h1"),h.pd(7),h.Pc(8,"translate"),h.Pc(9,"translate"),h.Dc(),h.Dc(),h.Dc(),h.Dc(),h.Ec(10,"ion-content",2),h.Ec(11,"ion-refresher",3),h.Mc("ionRefresh",(function CoreTagIndexAreaPage_Template_ion_refresher_ionRefresh_11_listener(e){return t.refreshData(e.target)})),h.zc(12,"ion-refresher-content",4),h.Pc(13,"translate"),h.Dc(),h.Ec(14,"core-loading",5),h.zc(15,"core-dynamic-component",6),h.Ec(16,"core-infinite-loading",7),h.Mc("action",(function CoreTagIndexAreaPage_Template_core_infinite_loading_action_16_listener(e){return t.loadMore(e)})),h.Dc(),h.Dc(),h.Dc()),2&e&&(h.lc(3),h.Vc("text",h.Qc(4,9,"core.back")),h.lc(4),h.rd(" ",h.Rc(8,11,"core.tag.itemstaggedwith",h.ad(21,_c1,h.bd(18,_c0,h.Qc(9,14,t.areaNameKey),t.tagName)))," "),h.lc(4),h.Vc("disabled",!t.loaded),h.lc(1),h.Wc("pullingText",h.Qc(13,16,"core.pulltorefresh")),h.lc(2),h.Vc("hideUntil",t.loaded),h.lc(1),h.Vc("component",t.areaComponent)("data",h.ad(23,_c2,t.items)),h.lc(1),h.Vc("enabled",t.canLoadMore)("error",t.loadMoreError))},directives:[g.C,g.Ab,g.m,g.h,g.i,g.yb,m.a,g.v,g.bb,g.cb,u.a,p.a,I.a],pipes:[f.d],encapsulation:2}),CoreTagIndexAreaPage})();const P=[{path:"",component:x}];let y=(()=>{class CoreTagIndexAreaPageModule{}return CoreTagIndexAreaPageModule.ɵmod=h.wc({type:CoreTagIndexAreaPageModule}),CoreTagIndexAreaPageModule.ɵinj=h.vc({factory:function CoreTagIndexAreaPageModule_Factory(e){return new(e||CoreTagIndexAreaPageModule)},imports:[[o.m.forChild(P),r.a],o.m]}),CoreTagIndexAreaPageModule})();void(("undefined"==typeof ngJitMode||ngJitMode)&&h.kd(y,{declarations:[x],imports:[o.m,r.a],exports:[o.m]}))}}]);
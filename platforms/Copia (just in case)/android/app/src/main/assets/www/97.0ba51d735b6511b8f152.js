(window.webpackJsonp=window.webpackJsonp||[]).push([[97],{zzwq:function(e,o,s){"use strict";s.r(o),s.d(o,"CoreCoursesDashboardPageModule",(function(){return y}));var a=s("tyNb"),r=s("L3Fv"),n=s("5p9q"),t=s("mrSG"),c=s("Xzvb"),i=s("fjkH"),l=s("9+EE"),d=s("OYIH"),b=s("3LXp"),u=s("mSZx"),h=s("pHTc"),C=s("6akD"),_=s("fXoL"),g=s("ACV2"),f=s("ofXK"),p=s("nt/U"),D=s("TEn/"),m=s("PgjG"),k=s("ACYt"),P=s("3CSS"),v=s("aSim"),I=s("r8G5"),S=s("sYmb");function CoreCoursesDashboardPage_ion_button_1_Template(e,o){if(1&e){const e=_.Fc();_.Ec(0,"ion-button",9),_.Mc("click",(function CoreCoursesDashboardPage_ion_button_1_Template_ion_button_click_0_listener(){_.fd(e);return _.Oc().openSearch()})),_.Pc(1,"translate"),_.zc(2,"ion-icon",10),_.Dc()}2&e&&_.mc("aria-label",_.Qc(1,1,"core.courses.searchcourses"))}function CoreCoursesDashboardPage_ng_container_8_core_block_1_Template(e,o){if(1&e&&_.zc(0,"core-block",12),2&e){const e=_.Oc().$implicit,o=_.Oc();_.Vc("block",e)("instanceId",o.userId)}}function CoreCoursesDashboardPage_ng_container_8_Template(e,o){if(1&e&&(_.Cc(0),_.nd(1,CoreCoursesDashboardPage_ng_container_8_core_block_1_Template,1,2,"core-block",11),_.Bc()),2&e){const e=o.$implicit;_.lc(1),_.Vc("ngIf",e.visible)}}function CoreCoursesDashboardPage_core_block_side_blocks_button_9_Template(e,o){if(1&e&&_.zc(0,"core-block-side-blocks-button",13),2&e){const e=_.Oc();_.Vc("instanceId",e.userId)}}function CoreCoursesDashboardPage_core_empty_box_10_Template(e,o){1&e&&(_.zc(0,"core-empty-box",14),_.Pc(1,"translate")),2&e&&_.Vc("message",_.Qc(1,1,"core.course.nocontentavailable"))}let w=(()=>{class CoreCoursesDashboardPage{constructor(){this.hasSideBlocks=!1,this.searchEnabled=!1,this.downloadCourseEnabled=!1,this.downloadCoursesEnabled=!1,this.blocks=[],this.loaded=!1,this.updateSiteObserver=i.b.on(i.b.SITE_UPDATED,(()=>{this.searchEnabled=!c.a.isSearchCoursesDisabledInSite(),this.downloadCourseEnabled=!c.a.isDownloadCourseDisabledInSite(),this.downloadCoursesEnabled=!c.a.isDownloadCoursesDisabledInSite()}),l.b.getCurrentSiteId())}ngOnInit(){this.searchEnabled=!c.a.isSearchCoursesDisabledInSite(),this.downloadCourseEnabled=!c.a.isDownloadCourseDisabledInSite(),this.downloadCoursesEnabled=!c.a.isDownloadCoursesDisabledInSite(),this.loadContent()}loadContent(){return Object(t.a)(this,void 0,void 0,(function*(){const e=yield d.a.isAvailable(),o=yield d.a.isDisabled();if(e&&!o){this.userId=l.b.getCurrentSiteUserId();try{const e=yield d.a.getDashboardBlocks();this.blocks=e.mainBlocks,this.hasSideBlocks=C.a.hasSupportedBlock(e.sideBlocks)}catch(e){b.a.showErrorModal(e),this.loadFallbackBlocks()}}else e?this.blocks=[]:this.loadFallbackBlocks();this.loaded=!0}))}loadFallbackBlocks(){this.blocks=[{name:"myoverview",visible:!0},{name:"timeline",visible:!0}]}refreshDashboard(e){var o;const s=[];s.push(d.a.invalidateDashboardBlocks()),null===(o=this.blocksComponents)||void 0===o||o.forEach((e=>{s.push(e.invalidate().catch((()=>{})))})),Promise.all(s).finally((()=>{this.loadContent().finally((()=>{null==e?void 0:e.complete()}))}))}openSearch(){return Object(t.a)(this,void 0,void 0,(function*(){h.a.navigateToSitePath("/courses/list",{params:{mode:"search"}})}))}ngOnDestroy(){this.updateSiteObserver.off()}}return CoreCoursesDashboardPage.ɵfac=function CoreCoursesDashboardPage_Factory(e){return new(e||CoreCoursesDashboardPage)},CoreCoursesDashboardPage.ɵcmp=_.sc({type:CoreCoursesDashboardPage,selectors:[["page-core-courses-dashboard"]],viewQuery:function CoreCoursesDashboardPage_Query(e,o){var s;(1&e&&_.ud(u.a,!0),2&e)&&(_.dd(s=_.Nc())&&(o.blocksComponents=s))},decls:11,vars:9,consts:[["slot","end","prepend",""],[3,"click",4,"ngIf"],["slot","fixed",3,"disabled","ionRefresh"],[3,"pullingText"],[3,"hideUntil"],[1,"list-item-limited-width"],[4,"ngFor","ngForOf"],["slot","fixed","contextLevel","user",3,"instanceId",4,"ngIf"],["icon","fas-cubes",3,"message",4,"ngIf"],[3,"click"],["name","fas-search","slot","icon-only","aria-hidden","true"],["contextLevel","user",3,"block","instanceId",4,"ngIf"],["contextLevel","user",3,"block","instanceId"],["slot","fixed","contextLevel","user",3,"instanceId"],["icon","fas-cubes",3,"message"]],template:function CoreCoursesDashboardPage_Template(e,o){1&e&&(_.Ec(0,"core-navbar-buttons",0),_.nd(1,CoreCoursesDashboardPage_ion_button_1_Template,3,3,"ion-button",1),_.Dc(),_.Ec(2,"ion-content"),_.Ec(3,"ion-refresher",2),_.Mc("ionRefresh",(function CoreCoursesDashboardPage_Template_ion_refresher_ionRefresh_3_listener(e){return o.refreshDashboard(e.target)})),_.zc(4,"ion-refresher-content",3),_.Pc(5,"translate"),_.Dc(),_.Ec(6,"core-loading",4),_.Ec(7,"ion-list",5),_.nd(8,CoreCoursesDashboardPage_ng_container_8_Template,2,1,"ng-container",6),_.Dc(),_.nd(9,CoreCoursesDashboardPage_core_block_side_blocks_button_9_Template,1,1,"core-block-side-blocks-button",7),_.nd(10,CoreCoursesDashboardPage_core_empty_box_10_Template,2,3,"core-empty-box",8),_.Dc(),_.Dc()),2&e&&(_.lc(1),_.Vc("ngIf",o.searchEnabled),_.lc(2),_.Vc("disabled",!o.loaded),_.lc(1),_.Wc("pullingText",_.Qc(5,7,"core.pulltorefresh")),_.lc(2),_.Vc("hideUntil",o.loaded),_.lc(2),_.Vc("ngForOf",o.blocks),_.lc(1),_.Vc("ngIf",o.hasSideBlocks),_.lc(1),_.Vc("ngIf",0==o.blocks.length))},directives:[g.a,f.t,p.a,D.v,D.bb,D.cb,m.a,D.P,f.s,k.a,D.l,D.D,P.a,u.a,v.a,I.a],pipes:[S.d],encapsulation:2}),CoreCoursesDashboardPage})();const E=[{path:"",component:w}];let y=(()=>{class CoreCoursesDashboardPageModule{}return CoreCoursesDashboardPageModule.ɵmod=_.wc({type:CoreCoursesDashboardPageModule}),CoreCoursesDashboardPageModule.ɵinj=_.vc({factory:function CoreCoursesDashboardPageModule_Factory(e){return new(e||CoreCoursesDashboardPageModule)},imports:[[a.m.forChild(E),r.a,n.a],a.m]}),CoreCoursesDashboardPageModule})();void(("undefined"==typeof ngJitMode||ngJitMode)&&_.kd(y,{declarations:[w],imports:[a.m,r.a,n.a],exports:[a.m]}))}}]);
{"code":"(window.webpackJsonp=window.webpackJsonp||[]).push([[46],{\"617G\":function(e,t,n){\"use strict\";n.r(t),n.d(t,\"AddonMessagesContactsPageModule\",(function(){return w}));var s=n(\"tyNb\"),o=n(\"vY5A\"),a=n(\"muSn\"),i=n(\"Y+03\"),c=n(\"L3Fv\"),r=n(\"mrSG\"),d=n(\"fjkH\"),g=n(\"9+EE\"),l=n(\"KMk0\"),_=n(\"pHTc\"),m=n(\"3LXp\"),u=n(\"fXoL\"),f=n(\"TEn/\"),h=n(\"ACYt\"),M=n(\"3CSS\"),C=n(\"nt/U\"),P=n(\"46ml\"),p=n(\"vWwc\"),O=n(\"JYLr\"),b=n(\"PgjG\"),v=n(\"ofXK\"),x=n(\"xpMl\"),q=n(\"FeAf\"),A=n(\"hMzs\"),T=n(\"r8G5\"),E=n(\"sYmb\");function AddonMessagesContactsPage_ng_template_18_ion_list_4_ion_item_1_ion_icon_5_Template(e,t){1&e&&(u.zc(0,\"ion-icon\",20),u.Pc(1,\"translate\")),2&e&&u.mc(\"aria-label\",u.Qc(1,1,\"addon.messages.contactblocked\"))}function AddonMessagesContactsPage_ng_template_18_ion_list_4_ion_item_1_Template(e,t){if(1&e){const e=u.Fc();u.Ec(0,\"ion-item\",15),u.Mc(\"click\",(function AddonMessagesContactsPage_ng_template_18_ion_list_4_ion_item_1_Template_ion_item_click_0_listener(){u.fd(e);const n=t.$implicit;return u.Oc(3).selectUser(n.id)})),u.zc(1,\"core-user-avatar\",16),u.Ec(2,\"ion-label\"),u.Ec(3,\"p\",17),u.zc(4,\"core-format-text\",18),u.nd(5,AddonMessagesContactsPage_ng_template_18_ion_list_4_ion_item_1_ion_icon_5_Template,2,3,\"ion-icon\",19),u.Dc(),u.Dc(),u.Dc()}if(2&e){const e=t.$implicit,n=u.Oc(3);u.mc(\"aria-label\",e.fullname)(\"aria-current\",e.id==n.selectedUserId?\"page\":\"false\"),u.lc(1),u.Vc(\"user\",e)(\"checkOnline\",e.showonlinestatus)(\"linkProfile\",!1),u.lc(3),u.Vc(\"text\",e.fullname)(\"contextInstanceId\",0),u.lc(1),u.Vc(\"ngIf\",e.isblocked)}}function AddonMessagesContactsPage_ng_template_18_ion_list_4_Template(e,t){if(1&e&&(u.Ec(0,\"ion-list\",13),u.nd(1,AddonMessagesContactsPage_ng_template_18_ion_list_4_ion_item_1_Template,6,8,\"ion-item\",14),u.Dc()),2&e){const e=u.Oc(2);u.lc(1),u.Vc(\"ngForOf\",e.confirmedContacts)}}function AddonMessagesContactsPage_ng_template_18_core_empty_box_5_Template(e,t){1&e&&(u.zc(0,\"core-empty-box\",21),u.Pc(1,\"translate\")),2&e&&u.Vc(\"message\",u.Qc(1,1,\"addon.messages.nocontactsgetstarted\"))}function AddonMessagesContactsPage_ng_template_18_Template(e,t){if(1&e){const e=u.Fc();u.Ec(0,\"ion-refresher\",8),u.Mc(\"ionRefresh\",(function AddonMessagesContactsPage_ng_template_18_Template_ion_refresher_ionRefresh_0_listener(t){u.fd(e);return u.Oc().refreshData(t.target)})),u.zc(1,\"ion-refresher-content\",9),u.Pc(2,\"translate\"),u.Dc(),u.Ec(3,\"core-loading\",5),u.nd(4,AddonMessagesContactsPage_ng_template_18_ion_list_4_Template,2,1,\"ion-list\",10),u.nd(5,AddonMessagesContactsPage_ng_template_18_core_empty_box_5_Template,2,3,\"core-empty-box\",11),u.Ec(6,\"core-infinite-loading\",12),u.Mc(\"action\",(function AddonMessagesContactsPage_ng_template_18_Template_core_infinite_loading_action_6_listener(t){u.fd(e);return u.Oc().loadMore(t)})),u.Dc(),u.Dc()}if(2&e){const e=u.Oc();u.Vc(\"disabled\",!e.confirmedLoaded),u.lc(1),u.Wc(\"pullingText\",u.Qc(2,7,\"core.pulltorefresh\")),u.lc(2),u.Vc(\"hideUntil\",e.confirmedLoaded),u.lc(1),u.Vc(\"ngIf\",e.confirmedContacts.length),u.lc(1),u.Vc(\"ngIf\",!e.confirmedContacts.length),u.lc(1),u.Vc(\"enabled\",e.confirmedCanLoadMore)(\"error\",e.confirmedLoadMoreError)}}function AddonMessagesContactsPage_ng_template_21_ion_list_4_ion_item_1_p_4_Template(e,t){1&e&&(u.Ec(0,\"p\"),u.pd(1),u.Pc(2,\"translate\"),u.Dc()),2&e&&(u.lc(1),u.rd(\" \",u.Qc(2,1,\"addon.messages.wouldliketocontactyou\"),\" \"))}function AddonMessagesContactsPage_ng_template_21_ion_list_4_ion_item_1_Template(e,t){if(1&e){const e=u.Fc();u.Ec(0,\"ion-item\",15),u.Mc(\"click\",(function AddonMessagesContactsPage_ng_template_21_ion_list_4_ion_item_1_Template_ion_item_click_0_listener(){u.fd(e);const n=t.$implicit;return u.Oc(3).selectUser(n.id)})),u.zc(1,\"core-user-avatar\",22),u.Ec(2,\"ion-label\"),u.zc(3,\"core-format-text\",18),u.nd(4,AddonMessagesContactsPage_ng_template_21_ion_list_4_ion_item_1_p_4_Template,3,3,\"p\",23),u.Dc(),u.Dc()}if(2&e){const e=t.$implicit,n=u.Oc(3);u.mc(\"aria-label\",e.fullname)(\"aria-current\",e.id==n.selectedUserId?\"page\":\"false\"),u.lc(1),u.Vc(\"user\",e)(\"linkProfile\",!1),u.lc(2),u.Vc(\"text\",e.fullname)(\"contextInstanceId\",0),u.lc(1),u.Vc(\"ngIf\",!e.iscontact)}}function AddonMessagesContactsPage_ng_template_21_ion_list_4_Template(e,t){if(1&e&&(u.Ec(0,\"ion-list\",13),u.nd(1,AddonMessagesContactsPage_ng_template_21_ion_list_4_ion_item_1_Template,5,7,\"ion-item\",14),u.Dc()),2&e){const e=u.Oc(2);u.lc(1),u.Vc(\"ngForOf\",e.requests)}}function AddonMessagesContactsPage_ng_template_21_core_empty_box_5_Template(e,t){1&e&&(u.zc(0,\"core-empty-box\",21),u.Pc(1,\"translate\")),2&e&&u.Vc(\"message\",u.Qc(1,1,\"addon.messages.nocontactrequests\"))}function AddonMessagesContactsPage_ng_template_21_Template(e,t){if(1&e){const e=u.Fc();u.Ec(0,\"ion-refresher\",8),u.Mc(\"ionRefresh\",(function AddonMessagesContactsPage_ng_template_21_Template_ion_refresher_ionRefresh_0_listener(t){u.fd(e);return u.Oc().refreshData(t.target)})),u.zc(1,\"ion-refresher-content\",9),u.Pc(2,\"translate\"),u.Dc(),u.Ec(3,\"core-loading\",5),u.nd(4,AddonMessagesContactsPage_ng_template_21_ion_list_4_Template,2,1,\"ion-list\",10),u.nd(5,AddonMessagesContactsPage_ng_template_21_core_empty_box_5_Template,2,3,\"core-empty-box\",11),u.Ec(6,\"core-infinite-loading\",12),u.Mc(\"action\",(function AddonMessagesContactsPage_ng_template_21_Template_core_infinite_loading_action_6_listener(t){u.fd(e);return u.Oc().loadMore(t)})),u.Dc(),u.Dc()}if(2&e){const e=u.Oc();u.Vc(\"disabled\",!e.requestsLoaded),u.lc(1),u.Wc(\"pullingText\",u.Qc(2,7,\"core.pulltorefresh\")),u.lc(2),u.Vc(\"hideUntil\",e.requestsLoaded),u.lc(1),u.Vc(\"ngIf\",e.requests.length),u.lc(1),u.Vc(\"ngIf\",!e.requests.length),u.lc(1),u.Vc(\"enabled\",e.requestsCanLoadMore)(\"error\",e.requestsLoadMoreError)}}let y=(()=>{class AddonMessagesContactsPage{constructor(){this.selected=\"confirmed\",this.requestsBadge=\"\",this.confirmedLoaded=!1,this.confirmedInitialising=!1,this.confirmedCanLoadMore=!1,this.confirmedLoadMoreError=!1,this.confirmedContacts=[],this.requestsLoaded=!1,this.requestsInitialising=!1,this.requestsCanLoadMore=!1,this.requestsLoadMoreError=!1,this.requests=[],this.siteId=g.b.getCurrentSiteId(),this.contactRequestsCountObserver=d.b.on(l.b.CONTACT_REQUESTS_COUNT_EVENT,(e=>{this.requestsBadge=e.count>0?String(e.count):\"\"}),this.siteId),this.memberInfoObserver=d.b.on(l.b.MEMBER_INFO_CHANGED_EVENT,(e=>{if(e.userBlocked||e.userUnblocked){const t=this.confirmedContacts.find((t=>t.id==e.userId));t&&(t.isblocked=!!e.userBlocked)}else if(e.contactRemoved){const t=this.confirmedContacts.findIndex((t=>t.id==e.userId));t>=0&&this.confirmedContacts.splice(t,1)}else e.contactRequestConfirmed&&this.confirmedFetchData(!0);if(e.contactRequestConfirmed||e.contactRequestDeclined){const t=this.requests.findIndex((t=>t.id==e.userId));t>=0&&this.requests.splice(t,1)}}),g.b.getCurrentSiteId())}ngOnInit(){return Object(r.a)(this,void 0,void 0,(function*(){l.a.getContactRequestsCount(this.siteId),\"confirmed\"===this.selected?yield this.initConfirmed():yield this.initRequests()}))}initConfirmed(){return Object(r.a)(this,void 0,void 0,(function*(){if(!this.confirmedInitialising)try{this.confirmedInitialising=!0,yield this.confirmedFetchData(),this.confirmedContacts.length&&i.a.isTablet&&this.selectUser(this.confirmedContacts[0].id,!0)}finally{this.confirmedInitialising=!1,this.confirmedLoaded=!0}}))}initRequests(){return Object(r.a)(this,void 0,void 0,(function*(){if(!this.requestsInitialising)try{this.requestsInitialising=!0,yield this.requestsFetchData(),this.requests.length&&i.a.isTablet&&this.selectUser(this.requests[0].id,!0)}finally{this.requestsInitialising=!1,this.requestsLoaded=!0}}))}confirmedFetchData(e=!1){return Object(r.a)(this,void 0,void 0,(function*(){this.confirmedLoadMoreError=!1;const t=e?0:this.confirmedContacts.length;0===t&&(yield l.a.invalidateUserContacts());try{const n=yield l.a.getUserContacts(t);this.confirmedContacts=e?n.contacts:this.confirmedContacts.concat(n.contacts),this.confirmedCanLoadMore=n.canLoadMore}catch(e){this.confirmedLoadMoreError=!0,m.a.showErrorModalDefault(e,\"addon.messages.errorwhileretrievingcontacts\",!0)}}))}requestsFetchData(e=!1){return Object(r.a)(this,void 0,void 0,(function*(){this.requestsLoadMoreError=!1;const t=e?0:this.requests.length;0===t&&(yield l.a.invalidateContactRequestsCache());try{const n=yield l.a.getContactRequests(t);this.requests=e?n.requests:this.requests.concat(n.requests),this.requestsCanLoadMore=n.canLoadMore}catch(e){this.requestsLoadMoreError=!0,m.a.showErrorModalDefault(e,\"addon.messages.errorwhileretrievingcontacts\",!0)}}))}refreshData(e){return Object(r.a)(this,void 0,void 0,(function*(){try{\"confirmed\"==this.selected?yield this.confirmedFetchData(!0):(l.a.refreshContactRequestsCount(),yield this.requestsFetchData(!0))}finally{null==e?void 0:e.complete()}}))}loadMore(e){return Object(r.a)(this,void 0,void 0,(function*(){try{\"confirmed\"==this.selected?yield this.confirmedFetchData():yield this.requestsFetchData()}finally{e&&e()}}))}gotoSearch(){_.a.navigateToSitePath(\"search\")}selectTab(e){\"confirmed\"!==e&&\"requests\"!==e||(this.selected=e,\"confirmed\"!=this.selected||this.confirmedLoaded||this.initConfirmed(),\"requests\"!=this.selected||this.requestsLoaded||this.initRequests())}selectUser(e,t=!1){if(e==this.selectedUserId&&i.a.isTablet)return;if(t&&i.a.isMobile)return;this.selectedUserId=e;const n=_.a.isCurrentPathInTablet(\"**/messages/contacts/discussion\");_.a.navigate((n?\"../\":\"\")+\"discussion\",{params:{userId:e}})}ngOnDestroy(){var e;null===(e=this.contactRequestsCountObserver)||void 0===e?void 0:e.off()}}return AddonMessagesContactsPage.ɵfac=function AddonMessagesContactsPage_Factory(e){return new(e||AddonMessagesContactsPage)},AddonMessagesContactsPage.ɵcmp=u.sc({type:AddonMessagesContactsPage,selectors:[[\"page-addon-messages-contacts\"]],decls:22,vars:17,consts:[[\"slot\",\"start\"],[3,\"text\"],[\"slot\",\"end\"],[\"fill\",\"clear\",3,\"click\"],[\"name\",\"fas-search\",\"slot\",\"icon-only\",\"aria-hidden\",\"true\"],[3,\"hideUntil\"],[3,\"title\",\"ionSelect\"],[\"badgeA11yText\",\"addon.messages.pendingcontactrequests\",3,\"title\",\"badge\",\"ionSelect\"],[\"slot\",\"fixed\",3,\"disabled\",\"ionRefresh\"],[3,\"pullingText\"],[\"class\",\"ion-no-margin\",4,\"ngIf\"],[\"icon\",\"far-address-book\",3,\"message\",4,\"ngIf\"],[\"position\",\"bottom\",3,\"enabled\",\"error\",\"action\"],[1,\"ion-no-margin\"],[\"class\",\"ion-text-wrap addon-messages-conversation-item\",\"button\",\"\",\"detail\",\"true\",3,\"click\",4,\"ngFor\",\"ngForOf\"],[\"button\",\"\",\"detail\",\"true\",1,\"ion-text-wrap\",\"addon-messages-conversation-item\",3,\"click\"],[\"slot\",\"start\",3,\"user\",\"checkOnline\",\"linkProfile\"],[1,\"item-heading\"],[\"contextLevel\",\"system\",3,\"text\",\"contextInstanceId\"],[\"name\",\"fas-user-slash\",\"slot\",\"end\",4,\"ngIf\"],[\"name\",\"fas-user-slash\",\"slot\",\"end\"],[\"icon\",\"far-address-book\",3,\"message\"],[\"slot\",\"start\",3,\"user\",\"linkProfile\"],[4,\"ngIf\"]],template:function AddonMessagesContactsPage_Template(e,t){1&e&&(u.Ec(0,\"ion-header\"),u.Ec(1,\"ion-toolbar\"),u.Ec(2,\"ion-buttons\",0),u.zc(3,\"ion-back-button\",1),u.Pc(4,\"translate\"),u.Dc(),u.Ec(5,\"ion-title\"),u.Ec(6,\"h1\"),u.pd(7),u.Pc(8,\"translate\"),u.Dc(),u.Dc(),u.Ec(9,\"ion-buttons\",2),u.Ec(10,\"ion-button\",3),u.Mc(\"click\",(function AddonMessagesContactsPage_Template_ion_button_click_10_listener(){return t.gotoSearch()})),u.Pc(11,\"translate\"),u.zc(12,\"ion-icon\",4),u.Dc(),u.Dc(),u.Dc(),u.Dc(),u.Ec(13,\"ion-content\"),u.Ec(14,\"core-split-view\"),u.Ec(15,\"core-tabs\",5),u.Ec(16,\"core-tab\",6),u.Mc(\"ionSelect\",(function AddonMessagesContactsPage_Template_core_tab_ionSelect_16_listener(){return t.selectTab(\"confirmed\")})),u.Pc(17,\"translate\"),u.nd(18,AddonMessagesContactsPage_ng_template_18_Template,7,9,\"ng-template\"),u.Dc(),u.Ec(19,\"core-tab\",7),u.Mc(\"ionSelect\",(function AddonMessagesContactsPage_Template_core_tab_ionSelect_19_listener(){return t.selectTab(\"requests\")})),u.Pc(20,\"translate\"),u.nd(21,AddonMessagesContactsPage_ng_template_21_Template,7,9,\"ng-template\"),u.Dc(),u.Dc(),u.Dc(),u.Dc()),2&e&&(u.lc(3),u.Vc(\"text\",u.Qc(4,7,\"core.back\")),u.lc(4),u.qd(u.Qc(8,9,\"addon.messages.contacts\")),u.lc(3),u.mc(\"aria-label\",u.Qc(11,11,\"addon.messages.searchcombined\")),u.lc(5),u.Vc(\"hideUntil\",!0),u.lc(1),u.Vc(\"title\",u.Qc(17,13,\"addon.messages.contacts\")),u.lc(3),u.Vc(\"title\",u.Qc(20,15,\"addon.messages.requests\"))(\"badge\",t.requestsBadge))},directives:[f.C,f.Ab,f.m,f.h,f.i,f.yb,h.a,f.l,f.D,M.a,C.a,f.v,P.a,p.a,O.a,f.bb,f.cb,b.a,v.t,x.a,f.P,v.s,f.I,q.a,f.O,A.a,T.a],pipes:[E.d],styles:[\"[_nghost-%COMP%]   .addon-message-discussion[_ngcontent-%COMP%]   ion-label[_ngcontent-%COMP%], [_nghost-%COMP%]   .addon-messages-conversation-item[_ngcontent-%COMP%]   ion-label[_ngcontent-%COMP%]{margin-right:0;margin-left:0}[_nghost-%COMP%]   .addon-message-discussion[_ngcontent-%COMP%]   .item-heading[_ngcontent-%COMP%]   core-format-text[_ngcontent-%COMP%], [_nghost-%COMP%]   .addon-messages-conversation-item[_ngcontent-%COMP%]   .item-heading[_ngcontent-%COMP%]   core-format-text[_ngcontent-%COMP%]{font-weight:700}[_nghost-%COMP%]   .addon-message-discussion[_ngcontent-%COMP%]   .item-heading[_ngcontent-%COMP%]   ion-icon[_ngcontent-%COMP%], [_nghost-%COMP%]   .addon-messages-conversation-item[_ngcontent-%COMP%]   .item-heading[_ngcontent-%COMP%]   ion-icon[_ngcontent-%COMP%]{margin-left:2px}@supports ((-webkit-margin-start:0) or (margin-inline-start:0)) or (-webkit-margin-start:0){[_nghost-%COMP%]   .addon-message-discussion[_ngcontent-%COMP%]   .item-heading[_ngcontent-%COMP%]   ion-icon[_ngcontent-%COMP%], [_nghost-%COMP%]   .addon-messages-conversation-item[_ngcontent-%COMP%]   .item-heading[_ngcontent-%COMP%]   ion-icon[_ngcontent-%COMP%]{margin-left:unset;-webkit-margin-start:2px;margin-inline-start:2px}}[_nghost-%COMP%]   .addon-message-discussion[_ngcontent-%COMP%]   ion-note[_ngcontent-%COMP%], [_nghost-%COMP%]   .addon-messages-conversation-item[_ngcontent-%COMP%]   ion-note[_ngcontent-%COMP%]{display:flex;flex-direction:column;align-self:flex-start;margin-left:2px}@supports ((-webkit-margin-start:0) or (margin-inline-start:0)) or (-webkit-margin-start:0){[_nghost-%COMP%]   .addon-message-discussion[_ngcontent-%COMP%]   ion-note[_ngcontent-%COMP%], [_nghost-%COMP%]   .addon-messages-conversation-item[_ngcontent-%COMP%]   ion-note[_ngcontent-%COMP%]{margin-left:unset;-webkit-margin-start:2px;margin-inline-start:2px}}[_nghost-%COMP%]   .addon-message-discussion[_ngcontent-%COMP%]   ion-note[_ngcontent-%COMP%]   ion-badge[_ngcontent-%COMP%], [_nghost-%COMP%]   .addon-message-discussion[_ngcontent-%COMP%]   ion-note[_ngcontent-%COMP%]   ion-icon[_ngcontent-%COMP%], [_nghost-%COMP%]   .addon-messages-conversation-item[_ngcontent-%COMP%]   ion-note[_ngcontent-%COMP%]   ion-badge[_ngcontent-%COMP%], [_nghost-%COMP%]   .addon-messages-conversation-item[_ngcontent-%COMP%]   ion-note[_ngcontent-%COMP%]   ion-icon[_ngcontent-%COMP%]{margin-top:3px;align-self:flex-end}[_nghost-%COMP%]   .addon-message-discussion[_ngcontent-%COMP%]   ion-note[_ngcontent-%COMP%]   .addon-message-last-message-date[_ngcontent-%COMP%], [_nghost-%COMP%]   .addon-messages-conversation-item[_ngcontent-%COMP%]   ion-note[_ngcontent-%COMP%]   .addon-message-last-message-date[_ngcontent-%COMP%]{white-space:nowrap;font-size:11px}[_nghost-%COMP%]   .addon-message-discussion[_ngcontent-%COMP%]   .addon-message-last-message[_ngcontent-%COMP%], [_nghost-%COMP%]   .addon-messages-conversation-item[_ngcontent-%COMP%]   .addon-message-last-message[_ngcontent-%COMP%]{display:flex;justify-content:flex-start}[_nghost-%COMP%]   .addon-message-discussion[_ngcontent-%COMP%]   .addon-message-last-message-user[_ngcontent-%COMP%], [_nghost-%COMP%]   .addon-messages-conversation-item[_ngcontent-%COMP%]   .addon-message-last-message-user[_ngcontent-%COMP%]{white-space:nowrap;color:var(--ion-text-color);margin-right:2px}@supports ((-webkit-margin-start:0) or (margin-inline-start:0)) or (-webkit-margin-start:0){[_nghost-%COMP%]   .addon-message-discussion[_ngcontent-%COMP%]   .addon-message-last-message-user[_ngcontent-%COMP%], [_nghost-%COMP%]   .addon-messages-conversation-item[_ngcontent-%COMP%]   .addon-message-last-message-user[_ngcontent-%COMP%]{margin-right:unset;-webkit-margin-end:2px;margin-inline-end:2px}}[_nghost-%COMP%]   .addon-message-discussion[_ngcontent-%COMP%]   .addon-message-last-message-text[_ngcontent-%COMP%], [_nghost-%COMP%]   .addon-messages-conversation-item[_ngcontent-%COMP%]   .addon-message-last-message-text[_ngcontent-%COMP%]{overflow:hidden;text-overflow:ellipsis;white-space:nowrap;flex-shrink:1}[_nghost-%COMP%]   .addon-message-discussion[_ngcontent-%COMP%]   .item-heading[_ngcontent-%COMP%]{margin-top:10px}[_nghost-%COMP%]   ion-item-divider[_ngcontent-%COMP%]   ion-badge[_ngcontent-%COMP%]{margin-left:16px;margin-right:16px}\"]}),AddonMessagesContactsPage})();const D=[{path:\"\",component:y},a.AddonMessagesDiscussionRoute],I=[{path:\"\",component:y,children:[a.AddonMessagesDiscussionRoute]}],k=[...Object(o.c)(D,(()=>i.a.isMobile)),...Object(o.c)(I,(()=>i.a.isTablet))];let w=(()=>{class AddonMessagesContactsPageModule{}return AddonMessagesContactsPageModule.ɵmod=u.wc({type:AddonMessagesContactsPageModule}),AddonMessagesContactsPageModule.ɵinj=u.vc({factory:function AddonMessagesContactsPageModule_Factory(e){return new(e||AddonMessagesContactsPageModule)},imports:[[s.m.forChild(k),c.a],s.m]}),AddonMessagesContactsPageModule})();void((\"undefined\"==typeof ngJitMode||ngJitMode)&&u.kd(w,{declarations:[y],imports:[s.m,c.a],exports:[s.m]}))}}]);","name":"46.eb4b8714a24fc5a29254.js","input":"(window[\"webpackJsonp\"] = window[\"webpackJsonp\"] || []).push([[46],{\n\n/***/ \"617G\":\n/***/ (function(module, __webpack_exports__, __webpack_require__) {\n\n\"use strict\";\n// ESM COMPAT FLAG\n__webpack_require__.r(__webpack_exports__);\n\n// EXPORTS\n__webpack_require__.d(__webpack_exports__, \"AddonMessagesContactsPageModule\", function() { return /* binding */ contacts_module_AddonMessagesContactsPageModule; });\n\n// EXTERNAL MODULE: ./node_modules/@angular/router/__ivy_ngcc__/fesm2015/router.js + 10 modules\nvar router = __webpack_require__(\"tyNb\");\n\n// EXTERNAL MODULE: ./src/app/app-routing.module.ts\nvar app_routing_module = __webpack_require__(\"vY5A\");\n\n// EXTERNAL MODULE: ./src/addons/messages/messages-lazy.module.ts + 1 modules\nvar messages_lazy_module = __webpack_require__(\"muSn\");\n\n// EXTERNAL MODULE: ./src/core/services/screen.ts\nvar screen = __webpack_require__(\"Y+03\");\n\n// EXTERNAL MODULE: ./src/core/shared.module.ts + 3 modules\nvar shared_module = __webpack_require__(\"L3Fv\");\n\n// EXTERNAL MODULE: ./node_modules/tslib/tslib.es6.js\nvar tslib_es6 = __webpack_require__(\"mrSG\");\n\n// EXTERNAL MODULE: ./src/core/singletons/events.ts\nvar events = __webpack_require__(\"fjkH\");\n\n// EXTERNAL MODULE: ./src/core/services/sites.ts\nvar sites = __webpack_require__(\"9+EE\");\n\n// EXTERNAL MODULE: ./src/addons/messages/services/messages.ts\nvar messages = __webpack_require__(\"KMk0\");\n\n// EXTERNAL MODULE: ./src/core/services/navigator.ts\nvar services_navigator = __webpack_require__(\"pHTc\");\n\n// EXTERNAL MODULE: ./src/core/services/utils/dom.ts + 2 modules\nvar dom = __webpack_require__(\"3LXp\");\n\n// EXTERNAL MODULE: ./node_modules/@angular/core/__ivy_ngcc__/fesm2015/core.js\nvar core = __webpack_require__(\"fXoL\");\n\n// EXTERNAL MODULE: ./node_modules/@ionic/angular/__ivy_ngcc__/fesm2015/ionic-angular.js + 5 modules\nvar ionic_angular = __webpack_require__(\"TEn/\");\n\n// EXTERNAL MODULE: ./src/core/directives/update-non-reactive-attributes.ts\nvar update_non_reactive_attributes = __webpack_require__(\"ACYt\");\n\n// EXTERNAL MODULE: ./src/core/directives/fa-icon.ts\nvar fa_icon = __webpack_require__(\"3CSS\");\n\n// EXTERNAL MODULE: ./src/core/directives/content.ts\nvar content = __webpack_require__(\"nt/U\");\n\n// EXTERNAL MODULE: ./src/core/components/split-view/split-view.ts\nvar split_view = __webpack_require__(\"46ml\");\n\n// EXTERNAL MODULE: ./src/core/components/tabs/tabs.ts\nvar tabs = __webpack_require__(\"vWwc\");\n\n// EXTERNAL MODULE: ./src/core/components/tabs/tab.ts\nvar tab = __webpack_require__(\"JYLr\");\n\n// EXTERNAL MODULE: ./src/core/components/loading/loading.ts\nvar loading = __webpack_require__(\"PgjG\");\n\n// EXTERNAL MODULE: ./node_modules/@angular/common/__ivy_ngcc__/fesm2015/common.js\nvar common = __webpack_require__(\"ofXK\");\n\n// EXTERNAL MODULE: ./src/core/components/infinite-loading/infinite-loading.ts\nvar infinite_loading = __webpack_require__(\"xpMl\");\n\n// EXTERNAL MODULE: ./src/core/components/user-avatar/user-avatar.ts\nvar user_avatar = __webpack_require__(\"FeAf\");\n\n// EXTERNAL MODULE: ./src/core/directives/format-text.ts\nvar format_text = __webpack_require__(\"hMzs\");\n\n// EXTERNAL MODULE: ./src/core/components/empty-box/empty-box.ts\nvar empty_box = __webpack_require__(\"r8G5\");\n\n// EXTERNAL MODULE: ./node_modules/@ngx-translate/core/__ivy_ngcc__/fesm2015/ngx-translate-core.js + 8 modules\nvar ngx_translate_core = __webpack_require__(\"sYmb\");\n\n// CONCATENATED MODULE: ./src/addons/messages/pages/contacts/contacts.page.ts\n\n// (C) Copyright 2015 Moodle Pty Ltd.\n//\n// Licensed under the Apache License, Version 2.0 (the \"License\");\n// you may not use this file except in compliance with the License.\n// You may obtain a copy of the License at\n//\n//     http://www.apache.org/licenses/LICENSE-2.0\n//\n// Unless required by applicable law or agreed to in writing, software\n// distributed under the License is distributed on an \"AS IS\" BASIS,\n// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n// See the License for the specific language governing permissions and\n// limitations under the License.\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nfunction AddonMessagesContactsPage_ng_template_18_ion_list_4_ion_item_1_ion_icon_5_Template(rf, ctx) {\n    if (rf & 1) {\n        core[\"zc\" /* ɵɵelement */](0, \"ion-icon\", 20);\n        core[\"Pc\" /* ɵɵpipe */](1, \"translate\");\n    }\n    if (rf & 2) {\n        core[\"mc\" /* ɵɵattribute */](\"aria-label\", core[\"Qc\" /* ɵɵpipeBind1 */](1, 1, \"addon.messages.contactblocked\"));\n    }\n}\nfunction AddonMessagesContactsPage_ng_template_18_ion_list_4_ion_item_1_Template(rf, ctx) {\n    if (rf & 1) {\n        const _r8 = core[\"Fc\" /* ɵɵgetCurrentView */]();\n        core[\"Ec\" /* ɵɵelementStart */](0, \"ion-item\", 15);\n        core[\"Mc\" /* ɵɵlistener */](\"click\", function AddonMessagesContactsPage_ng_template_18_ion_list_4_ion_item_1_Template_ion_item_click_0_listener() { core[\"fd\" /* ɵɵrestoreView */](_r8); const contact_r5 = ctx.$implicit; const ctx_r7 = core[\"Oc\" /* ɵɵnextContext */](3); return ctx_r7.selectUser(contact_r5.id); });\n        core[\"zc\" /* ɵɵelement */](1, \"core-user-avatar\", 16);\n        core[\"Ec\" /* ɵɵelementStart */](2, \"ion-label\");\n        core[\"Ec\" /* ɵɵelementStart */](3, \"p\", 17);\n        core[\"zc\" /* ɵɵelement */](4, \"core-format-text\", 18);\n        core[\"nd\" /* ɵɵtemplate */](5, AddonMessagesContactsPage_ng_template_18_ion_list_4_ion_item_1_ion_icon_5_Template, 2, 3, \"ion-icon\", 19);\n        core[\"Dc\" /* ɵɵelementEnd */]();\n        core[\"Dc\" /* ɵɵelementEnd */]();\n        core[\"Dc\" /* ɵɵelementEnd */]();\n    }\n    if (rf & 2) {\n        const contact_r5 = ctx.$implicit;\n        const ctx_r4 = core[\"Oc\" /* ɵɵnextContext */](3);\n        core[\"mc\" /* ɵɵattribute */](\"aria-label\", contact_r5.fullname)(\"aria-current\", contact_r5.id == ctx_r4.selectedUserId ? \"page\" : \"false\");\n        core[\"lc\" /* ɵɵadvance */](1);\n        core[\"Vc\" /* ɵɵproperty */](\"user\", contact_r5)(\"checkOnline\", contact_r5.showonlinestatus)(\"linkProfile\", false);\n        core[\"lc\" /* ɵɵadvance */](3);\n        core[\"Vc\" /* ɵɵproperty */](\"text\", contact_r5.fullname)(\"contextInstanceId\", 0);\n        core[\"lc\" /* ɵɵadvance */](1);\n        core[\"Vc\" /* ɵɵproperty */](\"ngIf\", contact_r5.isblocked);\n    }\n}\nfunction AddonMessagesContactsPage_ng_template_18_ion_list_4_Template(rf, ctx) {\n    if (rf & 1) {\n        core[\"Ec\" /* ɵɵelementStart */](0, \"ion-list\", 13);\n        core[\"nd\" /* ɵɵtemplate */](1, AddonMessagesContactsPage_ng_template_18_ion_list_4_ion_item_1_Template, 6, 8, \"ion-item\", 14);\n        core[\"Dc\" /* ɵɵelementEnd */]();\n    }\n    if (rf & 2) {\n        const ctx_r2 = core[\"Oc\" /* ɵɵnextContext */](2);\n        core[\"lc\" /* ɵɵadvance */](1);\n        core[\"Vc\" /* ɵɵproperty */](\"ngForOf\", ctx_r2.confirmedContacts);\n    }\n}\nfunction AddonMessagesContactsPage_ng_template_18_core_empty_box_5_Template(rf, ctx) {\n    if (rf & 1) {\n        core[\"zc\" /* ɵɵelement */](0, \"core-empty-box\", 21);\n        core[\"Pc\" /* ɵɵpipe */](1, \"translate\");\n    }\n    if (rf & 2) {\n        core[\"Vc\" /* ɵɵproperty */](\"message\", core[\"Qc\" /* ɵɵpipeBind1 */](1, 1, \"addon.messages.nocontactsgetstarted\"));\n    }\n}\nfunction AddonMessagesContactsPage_ng_template_18_Template(rf, ctx) {\n    if (rf & 1) {\n        const _r10 = core[\"Fc\" /* ɵɵgetCurrentView */]();\n        core[\"Ec\" /* ɵɵelementStart */](0, \"ion-refresher\", 8);\n        core[\"Mc\" /* ɵɵlistener */](\"ionRefresh\", function AddonMessagesContactsPage_ng_template_18_Template_ion_refresher_ionRefresh_0_listener($event) { core[\"fd\" /* ɵɵrestoreView */](_r10); const ctx_r9 = core[\"Oc\" /* ɵɵnextContext */](); return ctx_r9.refreshData($event.target); });\n        core[\"zc\" /* ɵɵelement */](1, \"ion-refresher-content\", 9);\n        core[\"Pc\" /* ɵɵpipe */](2, \"translate\");\n        core[\"Dc\" /* ɵɵelementEnd */]();\n        core[\"Ec\" /* ɵɵelementStart */](3, \"core-loading\", 5);\n        core[\"nd\" /* ɵɵtemplate */](4, AddonMessagesContactsPage_ng_template_18_ion_list_4_Template, 2, 1, \"ion-list\", 10);\n        core[\"nd\" /* ɵɵtemplate */](5, AddonMessagesContactsPage_ng_template_18_core_empty_box_5_Template, 2, 3, \"core-empty-box\", 11);\n        core[\"Ec\" /* ɵɵelementStart */](6, \"core-infinite-loading\", 12);\n        core[\"Mc\" /* ɵɵlistener */](\"action\", function AddonMessagesContactsPage_ng_template_18_Template_core_infinite_loading_action_6_listener($event) { core[\"fd\" /* ɵɵrestoreView */](_r10); const ctx_r11 = core[\"Oc\" /* ɵɵnextContext */](); return ctx_r11.loadMore($event); });\n        core[\"Dc\" /* ɵɵelementEnd */]();\n        core[\"Dc\" /* ɵɵelementEnd */]();\n    }\n    if (rf & 2) {\n        const ctx_r0 = core[\"Oc\" /* ɵɵnextContext */]();\n        core[\"Vc\" /* ɵɵproperty */](\"disabled\", !ctx_r0.confirmedLoaded);\n        core[\"lc\" /* ɵɵadvance */](1);\n        core[\"Wc\" /* ɵɵpropertyInterpolate */](\"pullingText\", core[\"Qc\" /* ɵɵpipeBind1 */](2, 7, \"core.pulltorefresh\"));\n        core[\"lc\" /* ɵɵadvance */](2);\n        core[\"Vc\" /* ɵɵproperty */](\"hideUntil\", ctx_r0.confirmedLoaded);\n        core[\"lc\" /* ɵɵadvance */](1);\n        core[\"Vc\" /* ɵɵproperty */](\"ngIf\", ctx_r0.confirmedContacts.length);\n        core[\"lc\" /* ɵɵadvance */](1);\n        core[\"Vc\" /* ɵɵproperty */](\"ngIf\", !ctx_r0.confirmedContacts.length);\n        core[\"lc\" /* ɵɵadvance */](1);\n        core[\"Vc\" /* ɵɵproperty */](\"enabled\", ctx_r0.confirmedCanLoadMore)(\"error\", ctx_r0.confirmedLoadMoreError);\n    }\n}\nfunction AddonMessagesContactsPage_ng_template_21_ion_list_4_ion_item_1_p_4_Template(rf, ctx) {\n    if (rf & 1) {\n        core[\"Ec\" /* ɵɵelementStart */](0, \"p\");\n        core[\"pd\" /* ɵɵtext */](1);\n        core[\"Pc\" /* ɵɵpipe */](2, \"translate\");\n        core[\"Dc\" /* ɵɵelementEnd */]();\n    }\n    if (rf & 2) {\n        core[\"lc\" /* ɵɵadvance */](1);\n        core[\"rd\" /* ɵɵtextInterpolate1 */](\" \", core[\"Qc\" /* ɵɵpipeBind1 */](2, 1, \"addon.messages.wouldliketocontactyou\"), \" \");\n    }\n}\nfunction AddonMessagesContactsPage_ng_template_21_ion_list_4_ion_item_1_Template(rf, ctx) {\n    if (rf & 1) {\n        const _r18 = core[\"Fc\" /* ɵɵgetCurrentView */]();\n        core[\"Ec\" /* ɵɵelementStart */](0, \"ion-item\", 15);\n        core[\"Mc\" /* ɵɵlistener */](\"click\", function AddonMessagesContactsPage_ng_template_21_ion_list_4_ion_item_1_Template_ion_item_click_0_listener() { core[\"fd\" /* ɵɵrestoreView */](_r18); const request_r15 = ctx.$implicit; const ctx_r17 = core[\"Oc\" /* ɵɵnextContext */](3); return ctx_r17.selectUser(request_r15.id); });\n        core[\"zc\" /* ɵɵelement */](1, \"core-user-avatar\", 22);\n        core[\"Ec\" /* ɵɵelementStart */](2, \"ion-label\");\n        core[\"zc\" /* ɵɵelement */](3, \"core-format-text\", 18);\n        core[\"nd\" /* ɵɵtemplate */](4, AddonMessagesContactsPage_ng_template_21_ion_list_4_ion_item_1_p_4_Template, 3, 3, \"p\", 23);\n        core[\"Dc\" /* ɵɵelementEnd */]();\n        core[\"Dc\" /* ɵɵelementEnd */]();\n    }\n    if (rf & 2) {\n        const request_r15 = ctx.$implicit;\n        const ctx_r14 = core[\"Oc\" /* ɵɵnextContext */](3);\n        core[\"mc\" /* ɵɵattribute */](\"aria-label\", request_r15.fullname)(\"aria-current\", request_r15.id == ctx_r14.selectedUserId ? \"page\" : \"false\");\n        core[\"lc\" /* ɵɵadvance */](1);\n        core[\"Vc\" /* ɵɵproperty */](\"user\", request_r15)(\"linkProfile\", false);\n        core[\"lc\" /* ɵɵadvance */](2);\n        core[\"Vc\" /* ɵɵproperty */](\"text\", request_r15.fullname)(\"contextInstanceId\", 0);\n        core[\"lc\" /* ɵɵadvance */](1);\n        core[\"Vc\" /* ɵɵproperty */](\"ngIf\", !request_r15.iscontact);\n    }\n}\nfunction AddonMessagesContactsPage_ng_template_21_ion_list_4_Template(rf, ctx) {\n    if (rf & 1) {\n        core[\"Ec\" /* ɵɵelementStart */](0, \"ion-list\", 13);\n        core[\"nd\" /* ɵɵtemplate */](1, AddonMessagesContactsPage_ng_template_21_ion_list_4_ion_item_1_Template, 5, 7, \"ion-item\", 14);\n        core[\"Dc\" /* ɵɵelementEnd */]();\n    }\n    if (rf & 2) {\n        const ctx_r12 = core[\"Oc\" /* ɵɵnextContext */](2);\n        core[\"lc\" /* ɵɵadvance */](1);\n        core[\"Vc\" /* ɵɵproperty */](\"ngForOf\", ctx_r12.requests);\n    }\n}\nfunction AddonMessagesContactsPage_ng_template_21_core_empty_box_5_Template(rf, ctx) {\n    if (rf & 1) {\n        core[\"zc\" /* ɵɵelement */](0, \"core-empty-box\", 21);\n        core[\"Pc\" /* ɵɵpipe */](1, \"translate\");\n    }\n    if (rf & 2) {\n        core[\"Vc\" /* ɵɵproperty */](\"message\", core[\"Qc\" /* ɵɵpipeBind1 */](1, 1, \"addon.messages.nocontactrequests\"));\n    }\n}\nfunction AddonMessagesContactsPage_ng_template_21_Template(rf, ctx) {\n    if (rf & 1) {\n        const _r20 = core[\"Fc\" /* ɵɵgetCurrentView */]();\n        core[\"Ec\" /* ɵɵelementStart */](0, \"ion-refresher\", 8);\n        core[\"Mc\" /* ɵɵlistener */](\"ionRefresh\", function AddonMessagesContactsPage_ng_template_21_Template_ion_refresher_ionRefresh_0_listener($event) { core[\"fd\" /* ɵɵrestoreView */](_r20); const ctx_r19 = core[\"Oc\" /* ɵɵnextContext */](); return ctx_r19.refreshData($event.target); });\n        core[\"zc\" /* ɵɵelement */](1, \"ion-refresher-content\", 9);\n        core[\"Pc\" /* ɵɵpipe */](2, \"translate\");\n        core[\"Dc\" /* ɵɵelementEnd */]();\n        core[\"Ec\" /* ɵɵelementStart */](3, \"core-loading\", 5);\n        core[\"nd\" /* ɵɵtemplate */](4, AddonMessagesContactsPage_ng_template_21_ion_list_4_Template, 2, 1, \"ion-list\", 10);\n        core[\"nd\" /* ɵɵtemplate */](5, AddonMessagesContactsPage_ng_template_21_core_empty_box_5_Template, 2, 3, \"core-empty-box\", 11);\n        core[\"Ec\" /* ɵɵelementStart */](6, \"core-infinite-loading\", 12);\n        core[\"Mc\" /* ɵɵlistener */](\"action\", function AddonMessagesContactsPage_ng_template_21_Template_core_infinite_loading_action_6_listener($event) { core[\"fd\" /* ɵɵrestoreView */](_r20); const ctx_r21 = core[\"Oc\" /* ɵɵnextContext */](); return ctx_r21.loadMore($event); });\n        core[\"Dc\" /* ɵɵelementEnd */]();\n        core[\"Dc\" /* ɵɵelementEnd */]();\n    }\n    if (rf & 2) {\n        const ctx_r1 = core[\"Oc\" /* ɵɵnextContext */]();\n        core[\"Vc\" /* ɵɵproperty */](\"disabled\", !ctx_r1.requestsLoaded);\n        core[\"lc\" /* ɵɵadvance */](1);\n        core[\"Wc\" /* ɵɵpropertyInterpolate */](\"pullingText\", core[\"Qc\" /* ɵɵpipeBind1 */](2, 7, \"core.pulltorefresh\"));\n        core[\"lc\" /* ɵɵadvance */](2);\n        core[\"Vc\" /* ɵɵproperty */](\"hideUntil\", ctx_r1.requestsLoaded);\n        core[\"lc\" /* ɵɵadvance */](1);\n        core[\"Vc\" /* ɵɵproperty */](\"ngIf\", ctx_r1.requests.length);\n        core[\"lc\" /* ɵɵadvance */](1);\n        core[\"Vc\" /* ɵɵproperty */](\"ngIf\", !ctx_r1.requests.length);\n        core[\"lc\" /* ɵɵadvance */](1);\n        core[\"Vc\" /* ɵɵproperty */](\"enabled\", ctx_r1.requestsCanLoadMore)(\"error\", ctx_r1.requestsLoadMoreError);\n    }\n}\n/**\n * Page that displays contacts and contact requests.\n */\nlet contacts_page_AddonMessagesContactsPage = /*@__PURE__*/ (() => {\n    class AddonMessagesContactsPage {\n        constructor() {\n            this.selected = 'confirmed';\n            this.requestsBadge = '';\n            this.confirmedLoaded = false;\n            this.confirmedInitialising = false;\n            this.confirmedCanLoadMore = false;\n            this.confirmedLoadMoreError = false;\n            this.confirmedContacts = [];\n            this.requestsLoaded = false;\n            this.requestsInitialising = false;\n            this.requestsCanLoadMore = false;\n            this.requestsLoadMoreError = false;\n            this.requests = [];\n            this.siteId = sites[\"b\" /* CoreSites */].getCurrentSiteId();\n            // Update the contact requests badge.\n            this.contactRequestsCountObserver = events[\"b\" /* CoreEvents */].on(messages[\"b\" /* AddonMessagesProvider */].CONTACT_REQUESTS_COUNT_EVENT, (data) => {\n                this.requestsBadge = data.count > 0 ? String(data.count) : '';\n            }, this.siteId);\n            // Update block status of a user.\n            this.memberInfoObserver = events[\"b\" /* CoreEvents */].on(messages[\"b\" /* AddonMessagesProvider */].MEMBER_INFO_CHANGED_EVENT, (data) => {\n                if (data.userBlocked || data.userUnblocked) {\n                    const user = this.confirmedContacts.find((user) => user.id == data.userId);\n                    if (user) {\n                        user.isblocked = !!data.userBlocked;\n                    }\n                }\n                else if (data.contactRemoved) {\n                    const index = this.confirmedContacts.findIndex((contact) => contact.id == data.userId);\n                    if (index >= 0) {\n                        this.confirmedContacts.splice(index, 1);\n                    }\n                }\n                else if (data.contactRequestConfirmed) {\n                    this.confirmedFetchData(true);\n                }\n                if (data.contactRequestConfirmed || data.contactRequestDeclined) {\n                    const index = this.requests.findIndex((request) => request.id == data.userId);\n                    if (index >= 0) {\n                        this.requests.splice(index, 1);\n                    }\n                }\n            }, sites[\"b\" /* CoreSites */].getCurrentSiteId());\n        }\n        /**\n         * Page being initialized.\n         */\n        ngOnInit() {\n            return Object(tslib_es6[\"a\" /* __awaiter */])(this, void 0, void 0, function* () {\n                messages[\"a\" /* AddonMessages */].getContactRequestsCount(this.siteId); // Badge already updated by the observer.\n                this.selected === 'confirmed'\n                    ? yield this.initConfirmed()\n                    : yield this.initRequests();\n            });\n        }\n        /**\n         * Initialise confirmed contacts.\n         */\n        initConfirmed() {\n            return Object(tslib_es6[\"a\" /* __awaiter */])(this, void 0, void 0, function* () {\n                if (this.confirmedInitialising) {\n                    return;\n                }\n                try {\n                    this.confirmedInitialising = true;\n                    yield this.confirmedFetchData();\n                    if (this.confirmedContacts.length && screen[\"a\" /* CoreScreen */].isTablet) {\n                        this.selectUser(this.confirmedContacts[0].id, true);\n                    }\n                }\n                finally {\n                    this.confirmedInitialising = false;\n                    this.confirmedLoaded = true;\n                }\n            });\n        }\n        /**\n         * Initialise contact requests.\n         */\n        initRequests() {\n            return Object(tslib_es6[\"a\" /* __awaiter */])(this, void 0, void 0, function* () {\n                if (this.requestsInitialising) {\n                    return;\n                }\n                try {\n                    this.requestsInitialising = true;\n                    yield this.requestsFetchData();\n                    if (this.requests.length && screen[\"a\" /* CoreScreen */].isTablet) {\n                        this.selectUser(this.requests[0].id, true);\n                    }\n                }\n                finally {\n                    this.requestsInitialising = false;\n                    this.requestsLoaded = true;\n                }\n            });\n        }\n        /**\n         * Fetch contacts.\n         *\n         * @param refresh True if we are refreshing contacts, false if we are loading more.\n         * @return Promise resolved when done.\n         */\n        confirmedFetchData(refresh = false) {\n            return Object(tslib_es6[\"a\" /* __awaiter */])(this, void 0, void 0, function* () {\n                this.confirmedLoadMoreError = false;\n                const limitFrom = refresh ? 0 : this.confirmedContacts.length;\n                if (limitFrom === 0) {\n                    // Always try to get latest data from server.\n                    yield messages[\"a\" /* AddonMessages */].invalidateUserContacts();\n                }\n                try {\n                    const result = yield messages[\"a\" /* AddonMessages */].getUserContacts(limitFrom);\n                    this.confirmedContacts = refresh ? result.contacts : this.confirmedContacts.concat(result.contacts);\n                    this.confirmedCanLoadMore = result.canLoadMore;\n                }\n                catch (error) {\n                    this.confirmedLoadMoreError = true;\n                    dom[\"a\" /* CoreDomUtils */].showErrorModalDefault(error, 'addon.messages.errorwhileretrievingcontacts', true);\n                }\n            });\n        }\n        /**\n         * Fetch contact requests.\n         *\n         * @param refresh True if we are refreshing contact requests, false if we are loading more.\n         * @return Promise resolved when done.\n         */\n        requestsFetchData(refresh = false) {\n            return Object(tslib_es6[\"a\" /* __awaiter */])(this, void 0, void 0, function* () {\n                this.requestsLoadMoreError = false;\n                const limitFrom = refresh ? 0 : this.requests.length;\n                if (limitFrom === 0) {\n                    // Always try to get latest data from server.\n                    yield messages[\"a\" /* AddonMessages */].invalidateContactRequestsCache();\n                }\n                try {\n                    const result = yield messages[\"a\" /* AddonMessages */].getContactRequests(limitFrom);\n                    this.requests = refresh ? result.requests : this.requests.concat(result.requests);\n                    this.requestsCanLoadMore = result.canLoadMore;\n                }\n                catch (error) {\n                    this.requestsLoadMoreError = true;\n                    dom[\"a\" /* CoreDomUtils */].showErrorModalDefault(error, 'addon.messages.errorwhileretrievingcontacts', true);\n                }\n            });\n        }\n        /**\n         * Refresh contacts or requests.\n         *\n         * @param refresher Refresher.\n         * @return Promise resolved when done.\n         */\n        refreshData(refresher) {\n            return Object(tslib_es6[\"a\" /* __awaiter */])(this, void 0, void 0, function* () {\n                try {\n                    if (this.selected == 'confirmed') {\n                        // No need to invalidate contacts, we always try to get the latest.\n                        yield this.confirmedFetchData(true);\n                    }\n                    else {\n                        // Refresh the number of contacts requests to update badges.\n                        messages[\"a\" /* AddonMessages */].refreshContactRequestsCount();\n                        // No need to invalidate contact requests, we always try to get the latest.\n                        yield this.requestsFetchData(true);\n                    }\n                }\n                finally {\n                    refresher === null || refresher === void 0 ? void 0 : refresher.complete();\n                }\n            });\n        }\n        /**\n         * Load more contacts or requests.\n         *\n         * @param infiniteComplete Infinite scroll complete function. Only used from core-infinite-loading.\n         * @return Resolved when done.\n         */\n        loadMore(infiniteComplete) {\n            return Object(tslib_es6[\"a\" /* __awaiter */])(this, void 0, void 0, function* () {\n                try {\n                    if (this.selected == 'confirmed') {\n                        // No need to invalidate contacts, we always try to get the latest.\n                        yield this.confirmedFetchData();\n                    }\n                    else {\n                        yield this.requestsFetchData();\n                    }\n                }\n                finally {\n                    infiniteComplete && infiniteComplete();\n                }\n            });\n        }\n        /**\n         * Navigate to the search page.\n         */\n        gotoSearch() {\n            services_navigator[\"a\" /* CoreNavigator */].navigateToSitePath('search');\n        }\n        selectTab(selected) {\n            if (selected !== 'confirmed' && selected !== 'requests') {\n                return;\n            }\n            this.selected = selected;\n            if (this.selected == 'confirmed' && !this.confirmedLoaded) {\n                this.initConfirmed();\n            }\n            if (this.selected == 'requests' && !this.requestsLoaded) {\n                this.initRequests();\n            }\n        }\n        /**\n         * Set the selected user and open the conversation in the split view if needed.\n         *\n         * @param userId Id of the selected user, undefined to use the last selected user in the tab.\n         * @param onInit Whether the contact was selected on initial load.\n         */\n        selectUser(userId, onInit = false) {\n            if (userId == this.selectedUserId && screen[\"a\" /* CoreScreen */].isTablet) {\n                // No user conversation to open or it is already opened.\n                return;\n            }\n            if (onInit && screen[\"a\" /* CoreScreen */].isMobile) {\n                // Do not open a conversation by default when split view is not visible.\n                return;\n            }\n            this.selectedUserId = userId;\n            const splitViewLoaded = services_navigator[\"a\" /* CoreNavigator */].isCurrentPathInTablet('**/messages/contacts/discussion');\n            const path = (splitViewLoaded ? '../' : '') + 'discussion';\n            services_navigator[\"a\" /* CoreNavigator */].navigate(path, { params: { userId } });\n        }\n        /**\n         * Page destroyed.\n         */\n        ngOnDestroy() {\n            var _a;\n            (_a = this.contactRequestsCountObserver) === null || _a === void 0 ? void 0 : _a.off();\n        }\n    }\n    AddonMessagesContactsPage.ɵfac = function AddonMessagesContactsPage_Factory(t) { return new (t || AddonMessagesContactsPage)(); };\n    AddonMessagesContactsPage.ɵcmp = core[\"sc\" /* ɵɵdefineComponent */]({ type: AddonMessagesContactsPage, selectors: [[\"page-addon-messages-contacts\"]], decls: 22, vars: 17, consts: [[\"slot\", \"start\"], [3, \"text\"], [\"slot\", \"end\"], [\"fill\", \"clear\", 3, \"click\"], [\"name\", \"fas-search\", \"slot\", \"icon-only\", \"aria-hidden\", \"true\"], [3, \"hideUntil\"], [3, \"title\", \"ionSelect\"], [\"badgeA11yText\", \"addon.messages.pendingcontactrequests\", 3, \"title\", \"badge\", \"ionSelect\"], [\"slot\", \"fixed\", 3, \"disabled\", \"ionRefresh\"], [3, \"pullingText\"], [\"class\", \"ion-no-margin\", 4, \"ngIf\"], [\"icon\", \"far-address-book\", 3, \"message\", 4, \"ngIf\"], [\"position\", \"bottom\", 3, \"enabled\", \"error\", \"action\"], [1, \"ion-no-margin\"], [\"class\", \"ion-text-wrap addon-messages-conversation-item\", \"button\", \"\", \"detail\", \"true\", 3, \"click\", 4, \"ngFor\", \"ngForOf\"], [\"button\", \"\", \"detail\", \"true\", 1, \"ion-text-wrap\", \"addon-messages-conversation-item\", 3, \"click\"], [\"slot\", \"start\", 3, \"user\", \"checkOnline\", \"linkProfile\"], [1, \"item-heading\"], [\"contextLevel\", \"system\", 3, \"text\", \"contextInstanceId\"], [\"name\", \"fas-user-slash\", \"slot\", \"end\", 4, \"ngIf\"], [\"name\", \"fas-user-slash\", \"slot\", \"end\"], [\"icon\", \"far-address-book\", 3, \"message\"], [\"slot\", \"start\", 3, \"user\", \"linkProfile\"], [4, \"ngIf\"]], template: function AddonMessagesContactsPage_Template(rf, ctx) {\n            if (rf & 1) {\n                core[\"Ec\" /* ɵɵelementStart */](0, \"ion-header\");\n                core[\"Ec\" /* ɵɵelementStart */](1, \"ion-toolbar\");\n                core[\"Ec\" /* ɵɵelementStart */](2, \"ion-buttons\", 0);\n                core[\"zc\" /* ɵɵelement */](3, \"ion-back-button\", 1);\n                core[\"Pc\" /* ɵɵpipe */](4, \"translate\");\n                core[\"Dc\" /* ɵɵelementEnd */]();\n                core[\"Ec\" /* ɵɵelementStart */](5, \"ion-title\");\n                core[\"Ec\" /* ɵɵelementStart */](6, \"h1\");\n                core[\"pd\" /* ɵɵtext */](7);\n                core[\"Pc\" /* ɵɵpipe */](8, \"translate\");\n                core[\"Dc\" /* ɵɵelementEnd */]();\n                core[\"Dc\" /* ɵɵelementEnd */]();\n                core[\"Ec\" /* ɵɵelementStart */](9, \"ion-buttons\", 2);\n                core[\"Ec\" /* ɵɵelementStart */](10, \"ion-button\", 3);\n                core[\"Mc\" /* ɵɵlistener */](\"click\", function AddonMessagesContactsPage_Template_ion_button_click_10_listener() { return ctx.gotoSearch(); });\n                core[\"Pc\" /* ɵɵpipe */](11, \"translate\");\n                core[\"zc\" /* ɵɵelement */](12, \"ion-icon\", 4);\n                core[\"Dc\" /* ɵɵelementEnd */]();\n                core[\"Dc\" /* ɵɵelementEnd */]();\n                core[\"Dc\" /* ɵɵelementEnd */]();\n                core[\"Dc\" /* ɵɵelementEnd */]();\n                core[\"Ec\" /* ɵɵelementStart */](13, \"ion-content\");\n                core[\"Ec\" /* ɵɵelementStart */](14, \"core-split-view\");\n                core[\"Ec\" /* ɵɵelementStart */](15, \"core-tabs\", 5);\n                core[\"Ec\" /* ɵɵelementStart */](16, \"core-tab\", 6);\n                core[\"Mc\" /* ɵɵlistener */](\"ionSelect\", function AddonMessagesContactsPage_Template_core_tab_ionSelect_16_listener() { return ctx.selectTab(\"confirmed\"); });\n                core[\"Pc\" /* ɵɵpipe */](17, \"translate\");\n                core[\"nd\" /* ɵɵtemplate */](18, AddonMessagesContactsPage_ng_template_18_Template, 7, 9, \"ng-template\");\n                core[\"Dc\" /* ɵɵelementEnd */]();\n                core[\"Ec\" /* ɵɵelementStart */](19, \"core-tab\", 7);\n                core[\"Mc\" /* ɵɵlistener */](\"ionSelect\", function AddonMessagesContactsPage_Template_core_tab_ionSelect_19_listener() { return ctx.selectTab(\"requests\"); });\n                core[\"Pc\" /* ɵɵpipe */](20, \"translate\");\n                core[\"nd\" /* ɵɵtemplate */](21, AddonMessagesContactsPage_ng_template_21_Template, 7, 9, \"ng-template\");\n                core[\"Dc\" /* ɵɵelementEnd */]();\n                core[\"Dc\" /* ɵɵelementEnd */]();\n                core[\"Dc\" /* ɵɵelementEnd */]();\n                core[\"Dc\" /* ɵɵelementEnd */]();\n            }\n            if (rf & 2) {\n                core[\"lc\" /* ɵɵadvance */](3);\n                core[\"Vc\" /* ɵɵproperty */](\"text\", core[\"Qc\" /* ɵɵpipeBind1 */](4, 7, \"core.back\"));\n                core[\"lc\" /* ɵɵadvance */](4);\n                core[\"qd\" /* ɵɵtextInterpolate */](core[\"Qc\" /* ɵɵpipeBind1 */](8, 9, \"addon.messages.contacts\"));\n                core[\"lc\" /* ɵɵadvance */](3);\n                core[\"mc\" /* ɵɵattribute */](\"aria-label\", core[\"Qc\" /* ɵɵpipeBind1 */](11, 11, \"addon.messages.searchcombined\"));\n                core[\"lc\" /* ɵɵadvance */](5);\n                core[\"Vc\" /* ɵɵproperty */](\"hideUntil\", true);\n                core[\"lc\" /* ɵɵadvance */](1);\n                core[\"Vc\" /* ɵɵproperty */](\"title\", core[\"Qc\" /* ɵɵpipeBind1 */](17, 13, \"addon.messages.contacts\"));\n                core[\"lc\" /* ɵɵadvance */](3);\n                core[\"Vc\" /* ɵɵproperty */](\"title\", core[\"Qc\" /* ɵɵpipeBind1 */](20, 15, \"addon.messages.requests\"))(\"badge\", ctx.requestsBadge);\n            }\n        }, directives: [ionic_angular[\"C\" /* IonHeader */], ionic_angular[\"Ab\" /* IonToolbar */], ionic_angular[\"m\" /* IonButtons */], ionic_angular[\"h\" /* IonBackButton */], ionic_angular[\"i\" /* IonBackButtonDelegate */], ionic_angular[\"yb\" /* IonTitle */], update_non_reactive_attributes[\"a\" /* CoreUpdateNonReactiveAttributesDirective */], ionic_angular[\"l\" /* IonButton */], ionic_angular[\"D\" /* IonIcon */], fa_icon[\"a\" /* CoreFaIconDirective */], content[\"a\" /* CoreContentDirective */], ionic_angular[\"v\" /* IonContent */], split_view[\"a\" /* CoreSplitViewComponent */], tabs[\"a\" /* CoreTabsComponent */], tab[\"a\" /* CoreTabComponent */], ionic_angular[\"bb\" /* IonRefresher */], ionic_angular[\"cb\" /* IonRefresherContent */], loading[\"a\" /* CoreLoadingComponent */], common[\"t\" /* NgIf */], infinite_loading[\"a\" /* CoreInfiniteLoadingComponent */], ionic_angular[\"P\" /* IonList */], common[\"s\" /* NgForOf */], ionic_angular[\"I\" /* IonItem */], user_avatar[\"a\" /* CoreUserAvatarComponent */], ionic_angular[\"O\" /* IonLabel */], format_text[\"a\" /* CoreFormatTextDirective */], empty_box[\"a\" /* CoreEmptyBoxComponent */]], pipes: [ngx_translate_core[\"d\" /* TranslatePipe */]], styles: [\"[_nghost-%COMP%]   .addon-message-discussion[_ngcontent-%COMP%]   ion-label[_ngcontent-%COMP%], [_nghost-%COMP%]   .addon-messages-conversation-item[_ngcontent-%COMP%]   ion-label[_ngcontent-%COMP%]{margin-right:0;margin-left:0}[_nghost-%COMP%]   .addon-message-discussion[_ngcontent-%COMP%]   .item-heading[_ngcontent-%COMP%]   core-format-text[_ngcontent-%COMP%], [_nghost-%COMP%]   .addon-messages-conversation-item[_ngcontent-%COMP%]   .item-heading[_ngcontent-%COMP%]   core-format-text[_ngcontent-%COMP%]{font-weight:700}[_nghost-%COMP%]   .addon-message-discussion[_ngcontent-%COMP%]   .item-heading[_ngcontent-%COMP%]   ion-icon[_ngcontent-%COMP%], [_nghost-%COMP%]   .addon-messages-conversation-item[_ngcontent-%COMP%]   .item-heading[_ngcontent-%COMP%]   ion-icon[_ngcontent-%COMP%]{margin-left:2px}@supports ((-webkit-margin-start:0) or (margin-inline-start:0)) or (-webkit-margin-start:0){[_nghost-%COMP%]   .addon-message-discussion[_ngcontent-%COMP%]   .item-heading[_ngcontent-%COMP%]   ion-icon[_ngcontent-%COMP%], [_nghost-%COMP%]   .addon-messages-conversation-item[_ngcontent-%COMP%]   .item-heading[_ngcontent-%COMP%]   ion-icon[_ngcontent-%COMP%]{margin-left:unset;-webkit-margin-start:2px;margin-inline-start:2px}}[_nghost-%COMP%]   .addon-message-discussion[_ngcontent-%COMP%]   ion-note[_ngcontent-%COMP%], [_nghost-%COMP%]   .addon-messages-conversation-item[_ngcontent-%COMP%]   ion-note[_ngcontent-%COMP%]{display:flex;flex-direction:column;align-self:flex-start;margin-left:2px}@supports ((-webkit-margin-start:0) or (margin-inline-start:0)) or (-webkit-margin-start:0){[_nghost-%COMP%]   .addon-message-discussion[_ngcontent-%COMP%]   ion-note[_ngcontent-%COMP%], [_nghost-%COMP%]   .addon-messages-conversation-item[_ngcontent-%COMP%]   ion-note[_ngcontent-%COMP%]{margin-left:unset;-webkit-margin-start:2px;margin-inline-start:2px}}[_nghost-%COMP%]   .addon-message-discussion[_ngcontent-%COMP%]   ion-note[_ngcontent-%COMP%]   ion-badge[_ngcontent-%COMP%], [_nghost-%COMP%]   .addon-message-discussion[_ngcontent-%COMP%]   ion-note[_ngcontent-%COMP%]   ion-icon[_ngcontent-%COMP%], [_nghost-%COMP%]   .addon-messages-conversation-item[_ngcontent-%COMP%]   ion-note[_ngcontent-%COMP%]   ion-badge[_ngcontent-%COMP%], [_nghost-%COMP%]   .addon-messages-conversation-item[_ngcontent-%COMP%]   ion-note[_ngcontent-%COMP%]   ion-icon[_ngcontent-%COMP%]{margin-top:3px;align-self:flex-end}[_nghost-%COMP%]   .addon-message-discussion[_ngcontent-%COMP%]   ion-note[_ngcontent-%COMP%]   .addon-message-last-message-date[_ngcontent-%COMP%], [_nghost-%COMP%]   .addon-messages-conversation-item[_ngcontent-%COMP%]   ion-note[_ngcontent-%COMP%]   .addon-message-last-message-date[_ngcontent-%COMP%]{white-space:nowrap;font-size:11px}[_nghost-%COMP%]   .addon-message-discussion[_ngcontent-%COMP%]   .addon-message-last-message[_ngcontent-%COMP%], [_nghost-%COMP%]   .addon-messages-conversation-item[_ngcontent-%COMP%]   .addon-message-last-message[_ngcontent-%COMP%]{display:flex;justify-content:flex-start}[_nghost-%COMP%]   .addon-message-discussion[_ngcontent-%COMP%]   .addon-message-last-message-user[_ngcontent-%COMP%], [_nghost-%COMP%]   .addon-messages-conversation-item[_ngcontent-%COMP%]   .addon-message-last-message-user[_ngcontent-%COMP%]{white-space:nowrap;color:var(--ion-text-color);margin-right:2px}@supports ((-webkit-margin-start:0) or (margin-inline-start:0)) or (-webkit-margin-start:0){[_nghost-%COMP%]   .addon-message-discussion[_ngcontent-%COMP%]   .addon-message-last-message-user[_ngcontent-%COMP%], [_nghost-%COMP%]   .addon-messages-conversation-item[_ngcontent-%COMP%]   .addon-message-last-message-user[_ngcontent-%COMP%]{margin-right:unset;-webkit-margin-end:2px;margin-inline-end:2px}}[_nghost-%COMP%]   .addon-message-discussion[_ngcontent-%COMP%]   .addon-message-last-message-text[_ngcontent-%COMP%], [_nghost-%COMP%]   .addon-messages-conversation-item[_ngcontent-%COMP%]   .addon-message-last-message-text[_ngcontent-%COMP%]{overflow:hidden;text-overflow:ellipsis;white-space:nowrap;flex-shrink:1}[_nghost-%COMP%]   .addon-message-discussion[_ngcontent-%COMP%]   .item-heading[_ngcontent-%COMP%]{margin-top:10px}[_nghost-%COMP%]   ion-item-divider[_ngcontent-%COMP%]   ion-badge[_ngcontent-%COMP%]{margin-left:16px;margin-right:16px}\"] });\n    return AddonMessagesContactsPage;\n})();\n\n// CONCATENATED MODULE: ./src/addons/messages/pages/contacts/contacts.module.ts\n// (C) Copyright 2015 Moodle Pty Ltd.\n//\n// Licensed under the Apache License, Version 2.0 (the \"License\");\n// you may not use this file except in compliance with the License.\n// You may obtain a copy of the License at\n//\n//     http://www.apache.org/licenses/LICENSE-2.0\n//\n// Unless required by applicable law or agreed to in writing, software\n// distributed under the License is distributed on an \"AS IS\" BASIS,\n// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n// See the License for the specific language governing permissions and\n// limitations under the License.\n\n\n\n\n\n\n\n\n\nconst mobileRoutes = [\n    {\n        path: '',\n        component: contacts_page_AddonMessagesContactsPage,\n    },\n    messages_lazy_module[\"AddonMessagesDiscussionRoute\"],\n];\nconst tabletRoutes = [\n    {\n        path: '',\n        component: contacts_page_AddonMessagesContactsPage,\n        children: [\n            messages_lazy_module[\"AddonMessagesDiscussionRoute\"],\n        ],\n    },\n];\nconst routes = [\n    ...Object(app_routing_module[\"c\" /* conditionalRoutes */])(mobileRoutes, () => screen[\"a\" /* CoreScreen */].isMobile),\n    ...Object(app_routing_module[\"c\" /* conditionalRoutes */])(tabletRoutes, () => screen[\"a\" /* CoreScreen */].isTablet),\n];\nlet contacts_module_AddonMessagesContactsPageModule = /*@__PURE__*/ (() => {\n    class AddonMessagesContactsPageModule {\n    }\n    AddonMessagesContactsPageModule.ɵmod = core[\"wc\" /* ɵɵdefineNgModule */]({ type: AddonMessagesContactsPageModule });\n    AddonMessagesContactsPageModule.ɵinj = core[\"vc\" /* ɵɵdefineInjector */]({ factory: function AddonMessagesContactsPageModule_Factory(t) { return new (t || AddonMessagesContactsPageModule)(); }, imports: [[\n                router[\"m\" /* RouterModule */].forChild(routes),\n                shared_module[\"a\" /* CoreSharedModule */],\n            ], router[\"m\" /* RouterModule */]] });\n    return AddonMessagesContactsPageModule;\n})();\n(function () { (typeof ngJitMode === \"undefined\" || ngJitMode) && core[\"kd\" /* ɵɵsetNgModuleScope */](contacts_module_AddonMessagesContactsPageModule, { declarations: [contacts_page_AddonMessagesContactsPage], imports: [router[\"m\" /* RouterModule */], shared_module[\"a\" /* CoreSharedModule */]], exports: [router[\"m\" /* RouterModule */]] }); })();\n\n\n/***/ })\n\n}]);","inputSourceMap":null}